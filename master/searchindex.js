Search.setIndex({"docnames": ["accelerators/gpu", "accelerators/tpu", "contribute/bazel", "contribute/codegen_migration", "contribute/configure-environment", "contribute/cpp_debugger", "contribute/op_lowering", "contribute/plugins", "features/pallas", "features/scan", "features/stablehlo", "features/torch_distributed", "features/triton", "index", "learn/_pjrt", "learn/api-guide", "learn/dynamic_shape", "learn/eager", "learn/pytorch-on-xla-devices", "learn/trace-vs-execution-time", "learn/troubleshoot", "learn/xla-advanced", "learn/xla-examples", "learn/xla-overview", "learn/xla-profiling", "notes/source_of_recompilation", "perf/amp", "perf/assume_pure", "perf/ddp", "perf/dynamo", "perf/fori_loop", "perf/fsdp_collectives", "perf/fsdp_spmd", "perf/quantized_ops", "perf/recompilation", "perf/spmd_advanced", "perf/spmd_basic", "perf/spmd_distributed_checkpoint", "perf/spmd_gpu", "tutorials/precision_tutorial"], "filenames": ["accelerators/gpu.md", "accelerators/tpu.md", "contribute/bazel.md", "contribute/codegen_migration.md", "contribute/configure-environment.md", "contribute/cpp_debugger.md", "contribute/op_lowering.md", "contribute/plugins.md", "features/pallas.md", "features/scan.md", "features/stablehlo.md", "features/torch_distributed.md", "features/triton.md", "index.rst", "learn/_pjrt.md", "learn/api-guide.rst", "learn/dynamic_shape.md", "learn/eager.md", "learn/pytorch-on-xla-devices.md", "learn/trace-vs-execution-time.md", "learn/troubleshoot.md", "learn/xla-advanced.md", "learn/xla-examples.md", "learn/xla-overview.md", "learn/xla-profiling.md", "notes/source_of_recompilation.md", "perf/amp.md", "perf/assume_pure.md", "perf/ddp.md", "perf/dynamo.md", "perf/fori_loop.md", "perf/fsdp_collectives.md", "perf/fsdp_spmd.md", "perf/quantized_ops.md", "perf/recompilation.md", "perf/spmd_advanced.md", "perf/spmd_basic.md", "perf/spmd_distributed_checkpoint.md", "perf/spmd_gpu.md", "tutorials/precision_tutorial.ipynb"], "titles": ["Learn about GPUs", "Learn about TPUs", "Building with Bazel", "Codegen Migration Guide", "Configure A Development Environment", "C++ Debugging", "Op Lowering Guide", "Custom Hardware Plugins", "Custom Kernels via Pallas", "Optimizing Repeated Layers with <code class=\"docutils literal notranslate\"><span class=\"pre\">scan</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">scan_layers</span></code>", "Torch Export to StableHLO", "Support for Torch Distributed", "Custom GPU Kernels via Triton", "PyTorch/XLA documentation", "PJRT Runtime", "PyTorch/XLA API", "Dynamic Shapes", "PyTorch/XLA Compile API and it\u2019s interaction with Eager mode.", "PyTorch on XLA Devices", "Tracing Time vs. Execution Time in PyTorch/XLA", "Troubleshooting Basics", "Advanced Topics in PyTorch XLA", "Converting code to PyTorch XLA", "Pytorch/XLA Overview", "Profiling and performance analysis", "Source of recompilations in torch_xla", "Automatic Mixed Precision", "Speed Up Tracing with <code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;assume_pure</span></code>", "Distributed Data Parallel (DDP)", "TorchDynamo Integration", "Optimize Memory Utilization with <code class=\"docutils literal notranslate\"><span class=\"pre\">while_loop</span></code>", "Fully Sharded Data Parallel (FSDP) with One Process Per Accelerator", "Fully Sharded Data Parallel (FSDP) using SPMD", "Quantized Operations", "Troubleshooting recompilations", "SPMD advanced topics", "SPMD User Guide", "Distributed Checkpointing", "Running SPMD on GPU", "Control MXU Floating Point Precision"], "terms": {"For": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 38], "inform": [0, 1, 3, 4, 5, 12, 14, 15, 17, 18, 20, 24, 25, 34, 38, 39], "googl": [0, 1, 8, 14, 18, 23, 39], "cloud": [0, 1, 2, 4, 7, 14, 18, 23, 29, 37], "see": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 14, 15, 16, 17, 18, 20, 22, 23, 24, 25, 26, 27, 29, 31, 34, 39], "machin": [0, 2, 4, 14, 20, 21, 23, 24, 38], "type": [0, 4, 5, 7, 10, 14, 15, 18, 19, 20, 23, 26, 28, 39], "ar": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 33, 34, 35, 36, 37, 39], "custom": [1, 3, 4, 5, 9, 10, 11, 13, 15, 17, 23, 25, 28, 31, 33, 34, 35, 36], "design": [1, 9, 14, 17, 18, 23, 29], "ai": [1, 22, 23], "acceler": [1, 4, 13, 14, 15, 16, 17, 18, 22, 23, 26, 39], "which": [1, 2, 3, 5, 6, 7, 10, 11, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 29, 31, 32, 34, 35, 37, 39], "optim": [1, 5, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 31, 32, 34, 39], "train": [1, 8, 9, 15, 16, 17, 18, 19, 20, 21, 22, 23, 26, 27, 35, 37, 38, 39], "infer": [1, 3, 13, 14, 15, 17, 18, 23, 24, 26, 35, 38], "larg": [1, 9, 14, 16, 21, 22, 23, 24, 25, 31, 34, 36], "model": [1, 3, 6, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 34, 35, 36, 37, 38, 39], "thei": [1, 2, 6, 7, 10, 11, 14, 15, 18, 19, 20, 21, 25, 26, 34, 35, 36], "ideal": [1, 2, 3, 25, 29, 34], "varieti": 1, "us": [1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 24, 26, 29, 31, 35, 37, 38, 39], "case": [1, 2, 3, 6, 9, 10, 14, 15, 18, 20, 21, 22, 23, 24, 27, 29, 32, 35], "chatbot": [1, 23], "code": [1, 3, 5, 6, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 34, 35], "gener": [1, 5, 6, 14, 15, 17, 18, 20, 21, 22, 23, 25, 34, 39], "media": [1, 23], "content": [1, 15, 23], "synthet": 1, "speech": 1, "vision": [1, 23, 31], "servic": [1, 2, 14, 23], "recommend": [1, 2, 3, 4, 5, 6, 14, 15, 17, 23, 26, 35, 39], "engin": [1, 20, 23], "person": 1, "among": 1, "other": [1, 2, 3, 5, 6, 8, 9, 14, 15, 16, 18, 20, 22, 23, 25, 26, 27, 28, 31, 32, 33, 34, 36], "scale": [1, 10, 13, 14, 15, 23, 26, 27, 29, 36], "cost": [1, 13, 17, 23, 27, 29, 39], "effici": [1, 9, 10, 13, 17, 20, 23, 29, 36], "wide": [1, 6, 23, 25, 34], "rang": [1, 6, 9, 14, 15, 19, 23, 27, 32, 35, 36, 39], "workload": [1, 14, 17, 18, 20, 23, 35, 36], "span": [1, 3, 17], "fine": 1, "tune": [1, 35, 36], "provid": [1, 2, 3, 6, 7, 8, 9, 15, 17, 18, 19, 20, 22, 23, 25, 26, 29, 30, 31, 33, 34, 35, 36, 37, 39], "versatil": [1, 23], "lead": [1, 9, 17, 18, 19, 20, 22, 23, 24, 27], "framework": [1, 23, 25, 33, 34], "includ": [1, 2, 6, 14, 15, 19, 20, 23, 25, 26, 30, 34, 36, 37, 39], "pytorch": [1, 6, 9, 11, 12, 14, 16, 24, 25, 26, 27, 28, 29, 30, 32, 33, 34, 35, 37, 38], "jax": [1, 7, 8, 9, 10, 14, 23], "tensorflow": [1, 2, 7, 14, 15, 20, 23, 25, 34], "seamlessli": [1, 23], "orchestr": 1, "through": [1, 3, 6, 7, 8, 9, 11, 18, 21, 23, 25, 26, 34, 37, 39], "integr": [1, 12, 13, 17, 33, 36], "kubernet": 1, "gke": 1, "leverag": [1, 12, 23, 38], "dynam": [1, 3, 6, 13, 18, 20, 21, 29], "schedul": [1, 22, 24], "improv": [1, 14, 18, 20, 21, 22, 23, 24, 26, 29, 35, 36], "scalabl": [1, 23], "all": [1, 2, 3, 5, 6, 9, 10, 11, 12, 14, 15, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 31, 34, 35, 37], "need": [1, 2, 3, 6, 10, 14, 15, 18, 19, 20, 21, 22, 23, 25, 28, 31, 32, 34, 35, 36, 39], "simultan": [1, 36], "look": [1, 3, 5, 6, 9, 17, 18, 20, 22, 24, 35], "simplest": [1, 36, 39], "wai": [1, 2, 6, 8, 10, 11, 14, 15, 18, 19, 24, 25, 28, 29, 33, 34, 35, 36], "develop": [1, 2, 5, 12, 13, 17, 18, 23, 28, 29, 33, 36], "can": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 31, 32, 33, 35, 36, 37, 38, 39], "also": [1, 2, 3, 5, 6, 7, 10, 11, 12, 14, 15, 18, 20, 21, 22, 23, 24, 25, 27, 29, 31, 32, 33, 34, 35, 36, 39], "vertex": 1, "fulli": [1, 13, 14, 17, 20, 36], "manag": [1, 8, 15, 26, 37], "platform": [1, 15], "more": [1, 2, 3, 4, 5, 6, 8, 10, 12, 14, 15, 17, 18, 22, 23, 25, 27, 34, 35, 36, 38, 39], "introduct": [1, 8], "set": [1, 2, 5, 9, 11, 14, 15, 20, 21, 22, 25, 26, 29, 31, 34, 35, 36, 37, 39], "up": [1, 2, 3, 5, 13, 14, 18, 19, 22, 23, 24, 25, 29, 32, 34, 39], "environ": [1, 2, 5, 13, 14, 16, 18, 21, 28, 35, 36, 37], "resourc": [1, 15, 20], "free": [2, 6, 10, 20, 26, 28, 31], "softwar": [2, 20], "tool": [2, 6, 24, 31, 36, 39], "autom": 2, "openxla": [2, 7, 10, 17, 23, 29, 33], "both": [2, 4, 5, 6, 11, 14, 17, 22, 25, 26, 29, 31, 32, 33, 34, 36, 37], "make": [2, 4, 5, 10, 12, 14, 18, 19, 20, 21, 22, 23, 24, 25, 28, 29, 34, 35, 39], "good": [2, 3, 6, 24, 25, 34, 35], "fit": [2, 3, 24, 31], "well": [2, 3, 7, 14, 15, 22, 24, 25, 34, 35, 36], "extern": [2, 4, 8], "seen": [2, 19, 21, 29], "workspac": [2, 20], "file": [2, 4, 9, 14, 15, 20, 22, 24, 26, 27, 28], "http_archiv": 2, "name": [2, 4, 5, 6, 14, 15, 20, 25, 32, 34, 35, 36], "patch_arg": 2, "l": [2, 39], "p1": 2, "patch_tool": 2, "patch": [2, 20], "openxla_patch": 2, "gpu_nvml": 2, "diff": [2, 14, 22], "gpu_race_condit": 2, "count_down": 2, "strip_prefix": 2, "xla_hash": 2, "url": 2, "http": [2, 3, 4, 8, 9, 10, 12, 14, 15, 20, 22, 23, 31], "github": [2, 3, 4, 5, 6, 9, 12, 14, 15, 20, 22, 28, 31], "com": [2, 3, 4, 8, 9, 12, 14, 15, 20, 22, 23, 31], "archiv": 2, "tar": 2, "gz": 2, "you": [2, 4, 7, 8, 10, 12, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 27, 28, 29, 31, 32, 35, 36, 38, 39], "specifi": [2, 5, 10, 11, 15, 17, 18, 19, 23, 31, 35, 36], "revis": 2, "want": [2, 5, 6, 10, 14, 15, 18, 20, 22, 25, 29, 34, 35, 36, 38], "field": 2, "alwai": [2, 14, 18, 20, 25, 34, 36], "determinist": 2, "commit": [2, 22], "aka": 2, "pin": [2, 15], "mai": [2, 3, 5, 7, 9, 14, 18, 20, 21, 22, 24, 25, 26, 27, 34, 35, 36, 39], "ad": [2, 5, 6, 10, 15, 18, 19, 20, 21, 22, 24, 25, 27, 29, 30, 34, 35, 39], "resolv": 2, "prepar": [2, 19], "hermet": 2, "differ": [2, 3, 7, 15, 17, 18, 20, 22, 24, 25, 27, 28, 30, 31, 32, 34, 35, 36, 39], "mechan": [2, 9, 19], "deploi": 2, "becaus": [2, 3, 9, 14, 17, 18, 21, 22, 24, 26, 27, 35, 39], "local": [2, 4, 14, 15, 18, 20, 35], "checkout": [2, 9, 20], "thi": [2, 3, 4, 6, 7, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 37, 38, 39], "ha": [2, 3, 4, 5, 6, 8, 9, 10, 14, 15, 18, 19, 21, 22, 24, 25, 34, 35, 36, 39], "built": [2, 4, 36, 39], "from": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 15, 16, 17, 20, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 35, 36, 37, 39], "sourc": [2, 3, 5, 6, 7, 9, 13, 14, 15, 20, 23, 34], "instal": [2, 3, 4, 6, 7, 8, 12, 13, 14, 20, 22, 23], "system": [2, 23, 36, 39], "version": [2, 3, 4, 5, 8, 14, 18, 22, 23, 24, 26, 27, 35], "compat": [2, 14, 23, 33, 37], "e": [2, 4, 10, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 27, 31, 33, 34, 35, 36], "g": [2, 4, 5, 10, 11, 14, 15, 16, 17, 19, 20, 21, 23, 25, 27, 33, 34, 35, 36], "codegen": [2, 6, 13], "torchgen": [2, 3], "python": [2, 3, 4, 5, 6, 7, 9, 10, 12, 13, 14, 15, 16, 19, 20, 21, 22, 23, 24, 25, 28, 29, 34, 35], "modul": [2, 8, 9, 10, 15, 18, 20, 28, 31, 32, 35, 39], "should": [2, 3, 4, 6, 7, 12, 14, 15, 18, 19, 20, 24, 25, 26, 30, 31, 34, 35, 36, 37], "The": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 27, 28, 29, 31, 33, 34, 35, 36, 37, 38, 39], "directori": [2, 3, 6, 9], "either": [2, 6, 11, 14, 15, 20, 25, 26, 34], "bzl": 2, "overriden": 2, "command": [2, 3, 4, 9, 14, 18, 20, 22, 23, 28, 31], "line": [2, 3, 5, 10, 15, 17, 18, 20, 22, 25, 31, 34], "override_repositori": 2, "org_tensorflow": 2, "path": [2, 5, 7, 15, 18, 20, 23, 25, 31, 34], "export": [2, 3, 4, 6, 13, 14, 20, 23], "tf_repo": 2, "torch_repo": 2, "pleas": [2, 3, 6, 11, 14, 15, 18, 20, 26, 31, 32, 33, 35, 38, 39], "sure": [2, 5, 18, 19, 20, 39], "overridden": [2, 3], "repositori": [2, 14], "appropri": [2, 18, 24], "been": [2, 5, 6, 14, 15, 18, 21, 22, 25, 34, 35], "use_cuda": [2, 5], "0": [2, 3, 4, 5, 7, 9, 10, 12, 13, 14, 15, 16, 18, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 38, 39], "setup": [2, 3, 5, 7, 10, 18, 28], "py": [2, 3, 4, 5, 6, 9, 11, 12, 14, 16, 17, 18, 20, 22, 24, 27, 28, 31, 38], "bdist_wheel": 2, "expect": [2, 3, 7, 12, 14, 15, 18, 20, 25, 29, 33, 34, 39], "object": [2, 10, 15, 35], "present": [2, 37], "new_local_repositori": 2, "build_fil": 2, "pytorch_local_dir": 2, "header": 2, "directli": [2, 3, 6, 7, 14, 15, 18, 20, 22, 23, 25, 26, 31, 34, 35, 37], "share": [2, 3, 7, 14, 18, 20, 35], "libtorch": 2, "so": [2, 3, 7, 10, 12, 14, 15, 16, 18, 20, 21, 22, 23, 25, 31, 34, 37, 39], "same": [2, 3, 6, 7, 9, 12, 14, 15, 18, 20, 21, 23, 24, 25, 26, 27, 30, 33, 34, 35, 36, 38, 39], "where": [2, 4, 8, 9, 11, 14, 15, 17, 18, 19, 20, 24, 25, 31, 32, 34, 36, 39], "lib": [2, 5, 7], "contain": [2, 3, 6, 7, 9, 10, 12, 14, 15, 20, 22, 24, 25, 27, 34, 36], "work": [2, 3, 9, 10, 11, 14, 15, 16, 18, 19, 20, 25, 27, 29, 33, 34, 35], "s": [2, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14, 15, 16, 18, 19, 20, 22, 23, 24, 26, 27, 28, 29, 33, 35, 37, 39], "requir": [2, 3, 6, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 25, 26, 34, 35, 37, 38, 39], "pass": [2, 6, 9, 10, 12, 14, 15, 17, 19, 21, 22, 26, 27, 35, 36, 39], "isystemextern": 2, "compil": [2, 5, 6, 7, 10, 12, 13, 14, 15, 16, 19, 22, 23, 24, 25, 26, 29, 32, 33, 34, 36, 37], "find": [2, 3, 6, 8, 9, 14, 20, 22, 24, 28, 32], "satisfi": [2, 35], "them": [2, 3, 6, 9, 14, 15, 17, 18, 19, 20, 21, 22, 25, 34, 36, 39], "some": [2, 3, 6, 9, 14, 15, 16, 18, 20, 27, 28, 33, 35, 36, 39], "user": [2, 4, 5, 7, 9, 13, 14, 17, 18, 20, 21, 25, 29, 30, 32, 33, 34, 35, 37], "bring": [2, 3], "pybind11": 2, "embed": [2, 9], "link": [2, 3], "against": [2, 28], "libpython": 2, "instead": [2, 10, 11, 14, 15, 18, 20, 22, 23, 25, 27, 28, 29, 31, 34, 35, 37], "These": [2, 3, 6, 8, 9, 14, 21, 22, 33, 37, 39], "pybind11_emb": 2, "option": [2, 3, 4, 5, 7, 14, 15, 20, 33, 35, 37], "transit": [2, 17, 18, 23], "simpl": [2, 3, 8, 9, 14, 21, 26, 31], "torch_xla": [2, 4, 6, 7, 8, 9, 11, 12, 13, 14, 16, 18, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 39], "csrc": [2, 6], "runtim": [2, 3, 4, 7, 13, 18, 20, 28, 31, 35, 36, 37], "configr": 2, "via": [2, 4, 13, 14, 17, 19, 23, 30, 31, 35, 36], "bazelrc": 2, "take": [2, 3, 9, 10, 12, 15, 18, 19, 20, 22, 23, 24, 25, 34, 35], "flag": [2, 3, 5, 10, 15, 16, 26], "config": [2, 3, 4, 10], "remote_cach": 2, "configur": [2, 3, 6, 13, 14, 15, 18, 20, 22, 37], "gcloud": [2, 4, 14, 18, 22, 23], "usual": [2, 3, 5, 6, 18, 20], "faster": [2, 5, 14, 21, 22, 25, 27, 29, 34], "authent": [2, 14], "easi": [2, 9, 14, 18, 25, 34, 39], "express": [2, 27, 36], "complex": [2, 12, 17, 27, 29], "lot": [2, 18, 20, 21, 25, 34], "gain": [2, 14], "have": [2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 17, 18, 20, 21, 22, 23, 24, 25, 27, 28, 29, 31, 32, 34, 35, 37, 39], "singl": [2, 9, 15, 17, 21, 23, 24, 25, 28, 29, 31, 32, 34, 35, 36, 38], "graph": [2, 9, 10, 12, 14, 15, 17, 18, 19, 20, 22, 23, 24, 25, 27, 28, 29, 34, 35], "everyth": [2, 10, 25, 28, 34], "therefor": [2, 18, 20, 22, 24], "separ": [2, 3, 5, 6, 10, 17, 18, 21, 29, 31, 32], "rest": [2, 14, 20, 25, 34], "plu": [2, 19, 28, 30], "whole": [2, 15, 17, 25, 29, 34], "everythin": 2, "els": [2, 10, 18, 20, 25, 34], "enough": [2, 24, 25, 34], "normal": [2, 3, 14, 18, 25, 32, 34, 35], "achiev": [2, 6, 17, 28, 36], "invok": [2, 3, 29, 35], "standard": [2, 19], "c": [2, 3, 6, 13, 14, 20, 25, 26, 27, 34], "bind": 2, "simpli": [2, 9, 14, 17], "_xlac": [2, 12, 18, 20, 25, 34], "client": [2, 7, 14, 15], "togeth": [2, 14, 18, 28, 31, 35, 36], "when": [2, 3, 5, 6, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 29, 31, 35, 36, 37, 39], "chang": [2, 5, 6, 13, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 33, 34, 35], "abl": [2, 18, 25, 34, 37, 39], "without": [2, 6, 9, 10, 14, 15, 17, 18, 19, 20, 21, 22, 24, 35, 36, 37, 39], "iter": [2, 9, 15, 16, 17, 18, 19, 20, 21, 29, 35], "cycl": [2, 18], "come": [2, 15, 25, 34], "There": [2, 3, 10, 18, 20, 24, 25, 28, 29, 34, 35], "plenti": 2, "backend": [2, 3, 11, 13, 14, 17, 23, 25, 29, 30, 33, 34, 35, 37, 39], "we": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 34, 35, 38], "our": [2, 3, 4, 5, 6, 7, 8, 11, 14, 18, 20, 23, 25, 26, 28, 29, 34, 35, 36], "gc": [2, 37], "storag": [2, 4, 8, 18, 20, 23, 31, 37], "under": [2, 3, 6, 9, 14, 15, 17, 18, 28], "disabl": [2, 15, 17, 18, 20, 21, 22], "default": [2, 6, 10, 14, 15, 17, 18, 19, 20, 22, 26, 31, 35, 37, 39], "speed": [2, 5, 13, 15, 22, 23, 25, 29, 34, 39], "increment": [2, 3], "huge": [2, 20, 22, 25, 28, 34], "margin": 2, "almost": 2, "enabl": [2, 5, 9, 12, 15, 16, 17, 18, 20, 21, 23, 24, 26, 28, 33, 35, 36, 37], "ci": [2, 6], "To": [2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 17, 18, 19, 20, 22, 24, 25, 31, 32, 34, 35, 37, 38, 39], "ensur": [2, 9, 15, 18, 25, 27, 32, 34, 35, 37], "credenti": 2, "auth": [2, 14], "applic": [2, 20, 23, 33, 37], "login": [2, 22], "launch": [2, 5, 14, 15, 16, 18, 19, 22, 28, 29, 31], "browser": 2, "gcp": [2, 4, 14], "variou": [2, 12, 17, 23], "individu": [2, 31, 32, 36], "who": [2, 5, 28], "access": [2, 3, 6, 8, 14, 15, 18, 19, 20, 21, 22, 25, 34, 37, 39], "project": [2, 4, 7, 14, 18, 23], "one": [2, 3, 6, 8, 9, 14, 15, 18, 20, 21, 22, 24, 25, 29, 30, 31, 32, 34, 35, 36, 38, 39], "onli": [2, 3, 5, 6, 9, 11, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 34, 36, 37, 39], "google_default_credenti": 2, "token": [2, 17, 22, 33], "out": [2, 6, 9, 10, 14, 15, 18, 20, 22, 26, 29, 35, 39], "box": [2, 6, 35], "log": [2, 20, 21, 22], "permiss": 2, "add": [2, 3, 5, 6, 12, 15, 18, 21, 22, 24, 25, 29, 30, 31, 34], "new": [2, 3, 4, 5, 6, 11, 18, 19, 20, 21, 22, 25, 29, 34, 35], "role": [2, 17], "In": [2, 3, 5, 6, 7, 8, 9, 11, 14, 15, 16, 18, 19, 20, 21, 22, 25, 26, 27, 29, 34, 35, 36, 37, 39], "account": [2, 22], "kei": [2, 4, 7, 9, 14, 20, 21, 23, 37], "google_credenti": 2, "On": [2, 14, 15, 37], "docker": 2, "network": [2, 14, 15, 18, 20, 26, 35, 36, 39], "cloudbuild": 2, "down": [2, 5, 6, 22, 39], "imag": [2, 14, 23, 25, 28, 31, 34], "do": [2, 3, 5, 6, 10, 14, 15, 16, 18, 20, 21, 22, 24, 25, 26, 27, 28, 31, 33, 34, 35, 39], "doe": [2, 3, 5, 14, 15, 16, 18, 19, 20, 21, 24, 25, 26, 27, 34, 35, 36], "read": [2, 4, 6, 14, 15, 35], "write": [2, 6, 12, 15, 18, 19, 36], "silo": 2, "each": [2, 3, 5, 6, 11, 12, 14, 15, 18, 19, 20, 21, 22, 25, 27, 29, 31, 32, 34, 35, 36, 37, 39], "uniqu": [2, 18, 22, 25, 27, 34], "benefit": [2, 5, 17, 23, 33, 37], "consist": [2, 11, 14, 19], "remote_default_exec_properti": 2, "some_silo_kei": 2, "bazel_remote_cach": 2, "1": [2, 4, 7, 8, 9, 10, 11, 13, 14, 15, 17, 18, 20, 21, 24, 26, 27, 28, 29, 30, 31, 32, 35, 36, 38, 39], "silo_nam": 2, "your": [2, 3, 7, 9, 10, 14, 18, 19, 20, 21, 22, 23, 25, 27, 28, 32, 34, 35, 36, 37, 39], "tpuvm_mod": 2, "gcloud_service_key_fil": 2, "application_default_credenti": 2, "json": [2, 5], "might": [2, 3, 6, 15, 18, 20, 21, 22, 24, 25, 34], "help": [2, 18, 20, 21, 23, 24, 25, 34], "too": [2, 5, 20, 25, 34], "cannot": [2, 8, 9, 24, 25, 26, 31, 34, 39], "here": [2, 3, 6, 8, 10, 16, 18, 19, 21, 22, 25, 28, 29, 31, 32, 34, 35, 36, 37], "author": [2, 39], "usernam": [2, 5], "behavior": [2, 3, 6, 14, 15, 18, 20, 26, 27], "function": [2, 6, 7, 8, 9, 10, 11, 12, 15, 17, 18, 20, 22, 24, 29, 30, 32, 33, 37, 39], "intend": [2, 17], "first": [2, 3, 4, 9, 10, 12, 14, 15, 16, 19, 20, 21, 22, 24, 28, 35, 36, 37, 38, 39], "time": [2, 3, 4, 5, 13, 14, 15, 16, 20, 21, 22, 24, 25, 27, 29, 30, 34, 35, 39], "slow": [2, 5, 9, 20, 22], "scratch": [2, 3], "veri": [2, 7, 8, 18, 21, 22, 25, 34], "fast": [2, 25, 34], "updat": [2, 3, 5, 10, 11, 18, 19, 22, 23, 25, 26, 34, 35], "onc": [2, 11, 15, 18, 20, 21, 22, 25, 27, 29, 34, 35, 39], "again": [2, 3, 5, 18, 21, 39], "bit": [2, 15, 18, 33], "slower": [2, 17, 20, 21, 28, 39], "per": [2, 13, 14, 15, 17, 18, 20, 26, 28, 29, 33], "until": [2, 15, 18, 19, 21, 37], "next": [2, 5, 15, 19, 20, 21, 22, 25, 33, 34, 35, 39], "quit": 2, "current": [2, 5, 7, 8, 14, 15, 16, 17, 18, 19, 24, 25, 27, 29, 30, 32, 33, 34, 35, 38], "migrat": [2, 13, 14], "futur": [2, 3, 4, 7, 14, 17, 18, 20, 24, 25, 27, 32, 34], "plafrom": 2, "cpp": [2, 5, 6, 20], "main": [2, 4, 10, 11, 12, 14, 17, 35], "Of": 2, "cours": 2, "pjrt": [2, 15, 18, 23, 35], "Not": 2, "environment": 2, "variabl": [2, 4, 5, 14, 16, 21, 25, 34], "miss": [2, 6, 15, 20], "common": [2, 14, 18, 25, 32, 33, 34, 36, 37], "part": [2, 3, 7, 12, 14, 15, 17, 20, 21, 24, 35, 39], "ones": [2, 15, 25, 34], "helper": [2, 3, 15], "script": [2, 3, 4, 8, 14, 18, 19, 20, 22, 24, 26, 28, 38, 39], "run_test": 2, "sh": 2, "r": [2, 22], "xla_client": 2, "pure": [2, 3, 9, 17, 27], "easili": [2, 6, 25, 29, 34], "execut": [2, 5, 12, 13, 14, 15, 17, 18, 22, 23, 24, 25, 26, 27, 28, 29, 34, 35, 36, 38, 39], "parallel": [2, 13, 14, 15, 20, 21, 23, 35, 36], "sinc": [2, 3, 6, 14, 18, 20, 24, 25, 26, 28, 29, 32, 34, 35, 37], "xrt": [2, 15], "port": [2, 14, 38], "gpu": [2, 6, 7, 8, 16, 20, 22, 23, 35, 39], "tpu": [2, 3, 6, 7, 8, 9, 15, 16, 17, 19, 20, 24, 28, 29, 30, 36, 37, 38], "devic": [2, 3, 4, 6, 7, 9, 11, 13, 14, 15, 16, 17, 19, 20, 21, 23, 24, 25, 26, 27, 28, 29, 30, 33, 34, 37, 39], "avail": [2, 14, 15, 18, 20, 21, 22, 25, 31, 34, 38], "reason": [2, 3, 6, 14, 22, 28], "bundl": 2, "target": [2, 14, 17, 18, 24, 25, 26, 29, 34], "sequenti": [2, 15], "calcul": [2, 17, 39], "visual": [2, 35, 36, 39], "lcov": 2, "describ": [2, 3, 4, 5, 10, 15, 18, 22, 24, 26, 28, 36], "document": [2, 3, 4, 6, 7, 10, 14, 18, 26, 27, 28, 33], "editor": 2, "choic": [2, 25, 34], "gutter": 2, "vscode": 2, "power": 2, "like": [2, 3, 4, 5, 6, 8, 9, 10, 14, 15, 17, 18, 19, 20, 21, 23, 25, 26, 31, 34, 35, 39], "clangd": 2, "refer": [2, 3, 6, 8, 11, 12, 14, 15, 16, 18, 23, 31, 33, 35, 36, 38], "autocomplet": 2, "semant": [2, 6, 20, 25, 34], "understand": [2, 10, 17, 19, 22, 24, 25, 34], "underli": [2, 15, 18, 36], "stack": [2, 5, 9, 18, 20, 25, 26, 34, 35], "combin": [2, 6, 9, 15, 25, 27, 34], "studio": 2, "extens": [2, 4, 5, 6, 7], "featur": [2, 5, 8, 10, 14, 16, 20, 23, 28, 33, 35, 36, 37], "assist": 2, "edit": 2, "As": [2, 3, 5, 9, 10, 21, 22, 24, 25, 27, 32, 34], "distutil": 2, "ltc": 3, "lazi": [3, 15, 17, 19, 20, 23, 25, 27, 29, 34, 35], "tensor": [3, 5, 6, 9, 10, 11, 13, 14, 15, 16, 19, 21, 22, 23, 24, 26, 27, 29, 30, 32, 33, 35, 36, 39], "core": [3, 5, 6, 11, 13, 14, 15, 17, 18, 19, 20, 22, 23, 24, 26, 28, 29, 30, 31, 32, 33, 36], "clean": [3, 5, 20, 29], "exist": [3, 14, 15, 18, 20, 23, 29, 35], "stub": 3, "over": [3, 5, 9, 14, 15, 17, 18, 21, 22, 31, 36, 37], "6": [3, 4, 6, 9, 15, 20, 22, 25, 34, 36, 39], "were": [3, 17, 18, 20, 21, 22, 24, 25, 34, 39], "complet": [3, 15, 17, 18, 20], "process": [3, 5, 6, 7, 11, 12, 13, 14, 15, 17, 20, 22, 23, 24, 28, 33], "found": [3, 14, 22, 39], "ref": [3, 4, 14], "oper": [3, 5, 9, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 27, 36, 37, 39], "xla_native_funct": [3, 6], "yaml": [3, 6], "replac": [3, 5, 9, 22, 30], "support": [3, 7, 8, 9, 10, 12, 13, 14, 15, 16, 23, 25, 27, 29, 30, 31, 34, 35, 37, 38, 39], "an": [3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 17, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 31, 32, 34, 35, 36, 37, 39], "equival": [3, 39], "full_codegen": 3, "NOT": 3, "introduc": [3, 8, 11, 14, 17, 20, 21, 24, 27, 28, 35], "ani": [3, 5, 8, 14, 15, 16, 17, 18, 20, 22, 23, 24, 25, 26, 27, 28, 31, 32, 34, 35, 36, 37, 38, 39], "purpos": [3, 6, 9, 17, 33], "info": [3, 5, 15, 20, 25, 34, 36, 39], "about": [3, 4, 13, 14, 15, 17, 18, 22, 23, 25, 34, 36], "dispatch": [3, 5, 6, 19, 37], "exyang": 3, "blog": [3, 27], "post": [3, 15, 20, 27], "follow": [3, 5, 6, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 28, 31, 32, 34, 35, 36, 38], "instruct": [3, 5, 6, 19, 21, 22], "depend": [3, 4, 6, 16, 17, 18, 22, 25, 26, 27, 34, 36], "build": [3, 6, 13, 17, 18, 19, 22, 24, 31, 39], "It": [3, 4, 5, 6, 9, 11, 15, 16, 18, 19, 21, 22, 23, 24, 25, 29, 31, 32, 33, 34, 35, 36, 39], "experi": [3, 5, 6, 14, 17, 23, 28, 37, 39], "workstat": [3, 6], "cpu": [3, 6, 11, 15, 19, 20, 21, 22, 24, 25, 31, 33, 34, 35, 37, 39], "pjrt_devic": [3, 6, 7, 14, 16, 18, 20, 28, 30, 38, 39], "re": [3, 14, 15, 17, 20, 24, 25, 26, 27, 30, 34], "familiar": [3, 13, 18, 23], "issu": [3, 6, 9, 14, 15, 17, 18, 20, 22, 24, 26, 28, 32], "3560": 3, "track": [3, 20, 37], "statu": [3, 20], "put": [3, 6, 18, 20, 28, 39], "alia": [3, 11, 15], "avoid": [3, 18, 20, 21, 22, 24, 26], "duplic": 3, "mention": [3, 6, 25, 29, 34], "below": [3, 6, 10, 11, 14, 18, 22, 25, 26, 34, 37, 38], "live": [3, 6, 15, 25, 34], "folder": [3, 4, 5, 6], "except": [3, 6, 21, 23, 24, 35], "torch": [3, 4, 5, 8, 9, 12, 13, 15, 16, 18, 19, 20, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 39], "shape_infer": 3, "shape": [3, 6, 8, 9, 10, 12, 13, 15, 20, 21, 23, 27, 30, 35, 36, 39], "defin": [3, 5, 6, 8, 10, 12, 15, 19, 22, 26, 30, 32, 35, 36, 39], "input": [3, 6, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 23, 26, 27, 30, 32, 35, 36, 37], "return": [3, 6, 7, 8, 9, 10, 11, 15, 17, 18, 20, 22, 25, 27, 28, 29, 30, 33, 34, 35, 37, 39], "output": [3, 4, 5, 8, 9, 10, 11, 12, 14, 15, 18, 20, 26, 27, 28, 29, 30, 31, 35, 39], "manual": [3, 6, 8, 20, 31], "gen_lazy_tensor": 3, "data": [3, 11, 13, 14, 15, 17, 18, 19, 22, 23, 25, 26, 29, 34, 36, 37], "aten": [3, 5, 6, 10, 20, 25, 34], "specif": [3, 5, 9, 15, 17, 18, 19, 21, 22, 23, 24, 26, 28, 33, 36], "run_gen_lazy_tensor": 3, "dest": 3, "lazy_ir": 3, "class": [3, 7, 9, 10, 11, 15, 18, 27, 28, 31, 33, 36, 37, 39], "genlazyir": 3, "back": [3, 6, 15, 18, 20, 22, 35], "todai": [3, 16], "most": [3, 7, 14, 15, 19, 20, 29], "categori": [3, 32], "goal": [3, 4, 6, 11, 39], "move": [3, 14, 15, 20, 25, 27, 28, 34, 37, 39], "necessari": [3, 15, 20, 22, 26], "call": [3, 5, 6, 10, 11, 12, 14, 15, 16, 17, 18, 20, 22, 23, 24, 25, 26, 27, 29, 30, 31, 34, 35, 37, 39], "upstream": [3, 11, 16, 27], "api": [3, 6, 10, 14, 18, 23, 25, 28, 29, 31, 33, 34, 35, 37], "xlanativefunct": [3, 6], "column": 3, "declar": [3, 6], "anoth": [3, 16, 18, 20, 22, 25, 34, 39], "wrap": [3, 6, 7, 8, 15, 18, 21, 22, 24, 26, 27, 28, 31, 32, 33, 35], "around": [3, 14, 25, 31, 34, 36], "xlatensor": [3, 6, 15, 35], "construct": [3, 6, 18, 21, 31, 35, 37], "aten_xla_typ": [3, 6], "Will": 3, "method": [3, 10, 14, 15, 19, 26, 32, 35, 37], "map": [3, 6, 11, 15], "node": [3, 6, 11, 12, 15, 20, 25, 34, 38], "remov": [3, 14, 20, 22], "tensor_method": [3, 6], "possibl": [3, 14, 18, 20, 23, 24, 31, 32, 35, 39], "multipl": [3, 11, 15, 17, 19, 21, 25, 28, 29, 33, 34, 36, 39], "few": [3, 18, 20, 22, 25, 28, 34, 37], "simpler": [3, 14], "go": [3, 18, 22, 26, 35], "unari": 3, "binari": [3, 5, 7, 23, 29, 39], "exampl": [3, 4, 5, 6, 7, 10, 11, 14, 15, 16, 17, 18, 20, 21, 23, 24, 25, 27, 28, 29, 32, 33, 34, 35, 36, 37, 38, 39], "characterist": 3, "fallback": [3, 6], "_adaptive_avg_pool3d": 3, "condit": [3, 17, 18, 25, 30, 34], "issupportedadaptivepool": 3, "xlahelp": 3, "i64list": 3, "self": [3, 6, 7, 9, 10, 11, 15, 18, 22, 27, 28, 33, 35], "size": [3, 9, 11, 12, 14, 16, 18, 20, 21, 22, 24, 25, 34, 36, 37, 39], "output_size_list": 3, "pool_dim": 3, "nativ": [3, 5, 6, 14, 17, 20, 26, 28, 35], "call_fallback_fn": 3, "xla_fallback": 3, "aten_op": 3, "output_s": 3, "wip": 3, "evolv": 3, "At": [3, 5, 7, 15, 23], "point": [3, 4, 5, 6, 7, 13, 15, 18, 19, 23, 24, 25, 26, 34], "self_tensor": 3, "static": [3, 16, 17, 25, 34], "bool": [3, 15], "sync_upd": 3, "sys_util": 3, "getenvbool": 3, "xla_tensor_update_sync": 3, "true": [3, 5, 9, 14, 15, 17, 19, 21, 22, 25, 28, 31, 34, 35, 37, 39], "xla_check": 3, "dst_tensor": 3, "updatefromtensor": 3, "sync": [3, 14, 15, 17, 18, 20, 21, 22, 23, 24, 26, 28], "complic": [3, 6, 8, 17], "would": [3, 4, 6, 14, 15, 18, 19, 20, 22, 25, 30, 34, 39], "someth": [3, 9, 22, 24], "ab": [3, 31], "const": [3, 6, 11], "torch_lazy_fn_count": 3, "bridg": [3, 23, 29], "atenfromxlatensor": 3, "getxlatensor": 3, "fail": [3, 5, 15, 18, 20, 37], "explain": [3, 7, 18, 20, 21, 22, 25, 27, 34], "later": [3, 21, 24, 27], "still": [3, 11, 14, 18, 19, 25, 26, 28, 34, 37], "If": [3, 4, 5, 6, 9, 10, 14, 15, 18, 19, 20, 21, 22, 23, 24, 25, 27, 33, 34, 35, 36, 39], "while": [3, 9, 10, 11, 13, 15, 17, 18, 19, 21, 23, 25, 28, 34], "error": [3, 10, 15, 18, 20], "involv": [3, 15, 19, 25, 34, 35], "problem": [3, 25, 34], "yet": [3, 6, 11], "attempt": [3, 37], "unblock": [3, 37], "snippet": [3, 5, 18, 35, 36], "auto": [3, 6, 15, 31, 37], "common_devic": 3, "getxladevic": 3, "torch_internal_assert": 3, "xlatensorptr": 3, "lazy_self": 3, "getxlatensororcreateforwrappednumb": 3, "nodeptr": 3, "reusenod": 3, "getirvalu": 3, "makenod": 3, "cachenod": 3, "creat": [3, 5, 10, 12, 13, 14, 15, 20, 21, 22, 23, 26, 27, 28, 35, 36, 37, 39], "std": [3, 11, 28], "get": [3, 6, 14, 15, 16, 22, 23, 25, 28, 31, 33, 34], "check": [3, 4, 6, 10, 15, 18, 33], "reus": [3, 9, 18, 21, 22, 23, 26, 27], "previou": [3, 5, 14, 18, 19, 22, 25, 34, 36, 39], "creation": [3, 15], "correspond": [3, 6, 11, 15, 21, 26, 31, 35, 36], "cach": [3, 8, 15, 16, 23, 27], "newli": 3, "And": [3, 25, 28, 34, 35], "within": [3, 15, 17, 18, 20, 24, 33, 36, 37], "note": [3, 4, 8, 11, 12, 14, 15, 17, 18, 20, 21, 22, 24, 25, 29, 31, 32, 33, 34, 36], "done": [3, 4, 8, 18, 20, 21, 22, 24, 25, 34, 39], "public": [3, 14], "xlanod": 3, "xlavalu": 3, "opkind": [3, 6], "absoutputshap": 3, "num_output": [3, 25, 34], "mhash": 3, "string": [3, 11, 15, 35, 39], "tostr": 3, "overrid": [3, 15, 26], "stringstream": 3, "ss": 3, "str": [3, 7, 10, 15, 39], "xlaopvector": 3, "loweringcontext": 3, "loctx": 3, "A": [3, 7, 13, 14, 15, 17, 18, 19, 21, 25, 26, 32, 33, 34, 35, 36], "coupl": [3, 18, 20], "thing": [3, 20, 24, 27], "keep": [3, 4, 14, 16, 20, 25, 34, 39], "mind": [3, 14, 20], "clone": [3, 14, 20, 22], "even": [3, 14, 15, 17, 18, 20, 25, 27, 28, 34, 39], "everi": [3, 6, 8, 9, 14, 15, 18, 20, 25, 27, 29, 34, 35, 37], "outputshap": 3, "xla_shap": 3, "overli": 3, "simplifi": 3, "buildxxxop": 3, "slightli": [3, 6, 15], "better": [3, 6, 14, 17, 18, 20, 22, 24, 25, 29, 30, 34], "maximumoutputshap": 3, "lower_for_shape_fn": 3, "absl": 3, "xlaop": [3, 6], "operand": 3, "promot": 3, "max": [3, 25, 34, 37], "second": [3, 9, 10, 12, 14, 16, 17, 20, 22, 28, 36, 38], "inferoutputshap": 3, "comput": [3, 4, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 34, 35, 36], "logic": [3, 9, 15, 25, 30, 34, 35, 36], "two": [3, 5, 7, 14, 15, 18, 19, 20, 21, 22, 24, 25, 34, 35, 36, 39], "xla_input": 3, "getoutputop": 3, "returnop": 3, "buildab": 3, "origin": [3, 22], "genericop": 3, "modifi": [3, 18, 22, 26, 29, 35, 39], "abov": [3, 6, 7, 10, 14, 15, 16, 18, 20, 21, 22, 24, 25, 28, 29, 34, 36], "delet": 3, "sometim": [3, 21, 23, 25, 34], "being": [3, 15, 18, 21, 28, 36, 39], "tensor_op": 3, "cross": [3, 15, 18, 35], "s1": [3, 35], "sub": 3, "mul": [3, 15, 25, 34, 39], "u2": 3, "v3": [3, 18, 28], "u3": 3, "v2": [3, 4, 18], "irnod": 3, "those": [3, 5, 6, 15, 20, 24, 28], "long": [3, 9, 17, 19, 20, 21, 22, 24, 25, 28, 34], "term": [3, 12, 17, 20, 25, 34, 39], "rid": [3, 25, 34], "composit": [3, 6], "end": [3, 6, 12, 14, 15, 16, 18, 20, 21, 22, 28, 31, 32], "exp": 3, "pow": 3, "norm_exp": 3, "vector": [3, 12], "don": [3, 6, 14, 16, 18, 20, 25, 31, 34], "t": [3, 6, 14, 15, 16, 18, 19, 20, 25, 26, 31, 32, 34, 35, 36, 37], "build_cpp_test": 3, "skip": [3, 6, 20, 29], "desir": [3, 22, 36, 37], "test_ptxla": 3, "gtest_filt": 3, "atenxlatensortest": 3, "testab": 3, "correct": [3, 19, 25, 27, 34], "counter": [3, 6, 15, 20], "correctli": [3, 20, 32], "bitwise_left_shift": 3, "pull": [3, 26, 28, 31], "8865": 3, "erf": 3, "erfc": 3, "erfinv": 3, "3659": 3, "binary_cross_entropi": [3, 26], "backward": [3, 6, 9, 14, 17, 18, 26, 28, 29, 31, 32], "3809": 3, "scalar": [3, 6, 15, 20, 25, 34], "addcdiv": 3, "addcmul": 3, "3768": 3, "neg": 3, "index": [3, 4, 7, 8, 14, 15, 18, 20, 22, 36, 38], "amin": 3, "amax": 3, "3771": 3, "special": [3, 10, 12, 21, 35, 39], "partial": [3, 25, 31, 32, 34], "adaptive_avgpool3d": 3, "3790": 3, "guid": [4, 5, 8, 9, 13, 14, 18, 21, 23, 24, 31, 32, 35], "interact": [4, 13, 14], "start": [4, 5, 14, 18, 19, 20, 22, 24], "colab": [4, 20, 39], "kaggl": 4, "preinstal": [4, 14], "ecosystem": [4, 17, 23, 33], "packag": [4, 12, 13, 18, 23, 26, 28, 39], "date": [4, 39], "list": [4, 5, 6, 9, 15, 22, 26, 27, 30, 35, 36], "readm": [4, 20, 22], "prerequisit": [4, 35], "remot": 4, "quota": 4, "request": [4, 5, 6, 15, 20, 22, 25, 26, 28, 34, 35, 36], "offici": [4, 5, 20], "ssh": [4, 14, 18, 22, 23], "regist": [4, 6, 7, 10, 11, 14, 37], "agent": 4, "alreadi": [4, 8, 12, 15, 20, 24, 25, 28, 31, 34, 37], "befor": [4, 5, 8, 11, 14, 15, 18, 19, 20, 21, 24, 25, 26, 28, 29, 32, 34, 35, 37, 39], "begin": [4, 18, 19, 35, 39], "zone": [4, 14, 18, 22, 23], "tpu_typ": 4, "8": [4, 9, 10, 12, 14, 15, 17, 18, 21, 22, 23, 24, 25, 28, 29, 33, 34, 35, 36], "vm": [4, 14, 18, 20, 22, 23, 28], "assum": [4, 7, 8, 15, 18, 19, 25, 28, 32, 34, 35, 36], "id_ed25519": 4, "ubuntu2204": 4, "base": [4, 11, 14, 15, 17, 18, 20, 22, 23, 25, 27, 31, 34, 35, 36, 39], "metadata": [4, 20], "cat": [4, 26], "pub": 4, "ip": [4, 14, 15, 37, 38], "format": [4, 10, 15, 20, 23, 29, 33, 39], "valu": [4, 5, 6, 9, 12, 14, 15, 16, 18, 20, 21, 22, 25, 27, 30, 34, 35, 38, 39], "networkendpoint": 4, "accessconfig": 4, "externalip": 4, "123": 4, "give": [4, 20, 24, 33, 35, 36], "friendli": 4, "easier": [4, 22, 25, 34], "echo": 4, "host": [4, 14, 15, 18, 19, 20, 21, 22, 23, 24, 26, 31, 37, 38], "n": [4, 15, 28, 33, 36], "hostnam": 4, "test": [4, 5, 7, 8, 12, 14, 16, 27, 28, 31, 38, 39], "vs": [4, 9, 13, 14, 25, 34], "palett": 4, "select": [4, 5, 14, 15, 37], "visualstudio": 4, "doc": [4, 8, 9, 14, 15, 18, 25, 34], "__": [4, 14], "just": [4, 8, 14, 18, 19, 25, 28, 31, 34, 37], "titl": [4, 14], "open": [4, 5, 6, 7, 14, 20, 23], "window": 4, "termin": [4, 37], "mkdir": 4, "ptxla": 4, "Then": [4, 5, 10, 22], "ui": 4, "venv": 4, "virtual": [4, 5, 15], "latest": [4, 8, 18], "releas": [4, 7, 8, 11, 14, 17, 18, 20, 23, 29, 31, 32, 33, 35], "pip": [4, 8, 12, 13, 22], "numpi": [4, 8, 10, 15, 24, 36], "f": [4, 8, 10, 15, 18, 28, 31, 33, 37, 39], "googleapi": [4, 8, 23], "libtpu": [4, 7, 14, 39], "wheel": [4, 23, 31], "html": [4, 8, 14, 15, 31], "import": [4, 5, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 20, 21, 22, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 39], "set_device_typ": 4, "print": [4, 5, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 25, 27, 28, 29, 34, 35, 37, 39], "real_devic": 4, "run": [4, 5, 6, 8, 9, 12, 13, 14, 15, 16, 17, 19, 21, 23, 24, 25, 26, 27, 28, 29, 31, 33, 34, 36, 37, 39], "2": [4, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 23, 24, 27, 29, 30, 31, 32, 33, 35, 36, 38, 39], "3": [4, 6, 7, 8, 9, 10, 12, 15, 17, 20, 21, 22, 29, 30, 31, 33, 35, 36, 39], "4": [4, 7, 8, 9, 10, 14, 15, 18, 20, 22, 25, 29, 30, 31, 33, 34, 35, 36, 39], "5": [4, 9, 11, 15, 16, 20, 22, 25, 27, 28, 31, 33, 34, 36], "7": [4, 15, 20, 28, 29, 36, 39], "number": [4, 5, 9, 12, 14, 15, 16, 17, 20, 21, 22, 27, 31, 35, 36], "vari": [4, 14, 17, 25, 32, 34], "That": [4, 9, 25, 27, 34], "now": [4, 10, 11, 12, 14, 18, 21, 22, 24, 25, 34, 35, 39], "realist": 4, "show": [5, 9, 10, 11, 14, 18, 20, 28, 39], "how": [5, 6, 8, 9, 10, 11, 12, 14, 15, 18, 19, 20, 22, 23, 24, 25, 26, 34, 35, 38, 39], "contributor": 5, "xla": [5, 6, 9, 10, 11, 12, 14, 16, 24, 25, 27, 28, 29, 30, 32, 34, 35, 37, 38], "conda": 5, "forg": 5, "probabl": [5, 25, 34], "interest": [5, 28, 39], "o0": 5, "use_custom_debinfo": 5, "file1": 5, "file2": 5, "caus": [5, 6, 14, 15, 17, 18, 20, 24, 25, 26, 34], "prevent": [5, 15, 17, 22, 26, 29, 35], "perform": [5, 6, 8, 10, 11, 12, 13, 15, 18, 21, 22, 23, 26, 27, 28, 29, 31, 33, 35, 39], "meaning": 5, "semicolon": 5, "let": [5, 8, 14, 17, 18, 20, 22, 24, 29], "suggest": [5, 20], "step": [5, 9, 14, 15, 17, 18, 19, 20, 22, 24, 25, 26, 27, 28, 29, 31, 32, 34, 35, 37], "identifi": [5, 7, 15, 17, 18, 36, 37, 39], "similar": [5, 6, 14, 17, 22, 23, 24, 28, 30, 33], "src": [5, 37], "linear": [5, 14, 15, 18, 23, 26, 27, 28, 33], "breakpoint": 5, "session": 5, "discov": [5, 37], "addit": [5, 6, 7, 12, 14, 18, 20, 21, 22, 24, 26, 28], "rebuild": 5, "newfil": 5, "readi": [5, 22], "howev": [5, 6, 8, 9, 10, 17, 20, 21, 22, 24, 35], "full": [5, 12, 15, 18, 19, 20, 31, 39], "unfortun": 5, "touch": [5, 28, 37], "its": [5, 6, 11, 14, 16, 17, 18, 19, 20, 23, 27, 28, 29, 31, 35, 39], "timestamp": [5, 19], "reliabl": [5, 14], "rebuilt": 5, "wa": [5, 14, 15, 17, 20, 24, 25, 34, 37, 39], "use_rocm_kernel_assert": 5, "off": [5, 15, 21], "has_wmissing_prototyp": 5, "has_werror_missing_prototyp": 5, "util": [5, 8, 10, 13, 15, 17, 18, 20, 28, 31, 32, 33, 36, 37], "scalarop": 5, "emptytensor": 5, "shut": 5, "must": [5, 6, 7, 9, 11, 14, 15, 18, 19, 20, 27, 32, 37, 38], "pack": [5, 39], "publish": 5, "microsoft": 5, "search": [5, 6], "ms": [5, 27], "cpptool": 5, "tab": 5, "sampl": [5, 10, 14, 15, 20], "ll": [5, 6, 9, 25, 34, 39], "adjust": [5, 18], "match": [5, 6, 10, 15, 17, 18, 20], "interpret": [5, 15, 25, 34, 39], "cppdbg": 5, "program": [5, 8, 9, 10, 12, 15, 18, 20, 21, 25, 29, 34, 35, 36], "home": 5, "miniconda3": 5, "env": [5, 14, 15, 35], "torch310": 5, "bin": 5, "arg": [5, 10, 15, 18, 22, 30, 31], "cwd": 5, "workspacefold": 5, "externalconsol": 5, "fals": [5, 10, 11, 15, 18, 19, 31, 35, 39], "mimod": 5, "setupcommand": 5, "descript": 5, "pretti": [5, 18, 25, 28, 34], "text": [5, 20], "ignorefailur": 5, "disassembl": 5, "flavor": 5, "intel": 5, "prelaunchtask": 5, "activ": [5, 9, 15, 18, 20, 28, 31, 32, 33], "midebuggerpath": 5, "locat": [5, 15], "But": [5, 18, 20, 25, 34, 39], "quirk": 5, "switch": [5, 9, 17, 18, 20, 25, 28, 34], "between": [5, 11, 14, 16, 17, 18, 20, 21, 23, 24, 25, 26, 28, 30, 34, 35, 39], "vadimcn": 5, "id": [5, 14, 15, 20, 23, 36], "click": 5, "left": [5, 20], "red": 5, "dot": [5, 10, 20], "displai": [5, 24], "indic": [5, 9, 15, 20, 24, 25, 34, 36], "dropdown": 5, "right": [5, 17, 19, 25, 29, 34], "green": 5, "plai": 5, "button": 5, "rule": [5, 24, 26], "after": [5, 6, 9, 11, 14, 15, 17, 18, 19, 20, 22, 25, 30, 34, 35], "empti": [5, 15], "white": 5, "circl": 5, "load": [5, 12, 14, 15, 20, 23, 28, 31, 33, 37], "librari": [5, 6, 7, 10, 22, 23, 24, 36, 37], "trigger": [5, 17, 20, 21, 22, 25, 27, 34], "einsum": [5, 27], "yellow": 5, "arrow": 5, "collect": [5, 14, 28, 29, 36, 37], "certain": [5, 11, 20, 25, 26, 34, 39], "diagnost": 5, "turn": [5, 20, 39], "cuda": [5, 14, 15, 18, 19, 22, 25, 26, 33, 34, 38], "handl": [5, 7, 19, 20, 25, 31, 32, 34, 35, 36], "trace": [5, 9, 13, 14, 15, 17, 20, 21, 23, 24, 25, 26, 28, 29, 34, 35], "ld_library_path": 5, "cflag": 5, "dhas_torch_show_dispatch_trac": 5, "demonstr": [5, 9, 11, 17, 24, 26, 37, 39], "offer": [6, 10, 15, 17, 23, 32, 33], "implement": [6, 8, 9, 11, 13, 14, 17, 20, 25, 29, 31, 32, 34], "convert": [6, 10, 13, 15, 18, 23, 24, 27, 28, 39], "higher": [6, 9, 20, 37], "level": [6, 9, 15, 20, 23, 24, 29, 33, 37], "represent": [6, 9, 15, 18, 23, 39], "i": [6, 9, 10, 14, 15, 18, 25, 27, 31, 34, 35, 36, 39], "hlo": [6, 9, 15, 18, 20, 21, 23], "beyond": 6, "scope": 6, "forward": [6, 10, 17, 18, 26, 27, 28, 29, 32, 33], "haven": [6, 25, 34], "signific": [6, 17, 19, 20, 21, 22, 23, 24, 29], "slowdown": [6, 20, 28], "best": [6, 8, 17, 29, 33, 36], "what": [6, 18, 21, 22, 27], "debug": [6, 13, 17, 25, 33, 34, 36], "pt": [6, 14, 18, 20, 23], "profil": [6, 13, 14, 22, 23], "_ctc_loss": [6, 20], "_ctc_loss_backward": [6, 20], "contribut": [6, 39], "definit": [6, 18, 25, 34], "native_funct": 6, "kernel": [6, 9, 10, 13, 25, 33, 34], "aten_fallback": 6, "h": [6, 39], "repo": [6, 18, 20, 22, 28], "sequenc": [6, 9, 15], "explicitli": [6, 17, 18, 19, 20, 21, 25, 26, 34], "compos": 6, "serv": [6, 22], "interfac": [6, 7, 18, 20, 37], "machineri": [6, 10], "registerxla": 6, "registerautogradxla": 6, "entri": [6, 7], "pytorch_xla": 6, "world": [6, 8, 14, 25, 29, 34, 37], "written": [6, 22, 37], "paramet": [6, 10, 14, 15, 18, 20, 26, 27, 28, 32, 35, 37, 38], "result": [6, 9, 11, 14, 15, 16, 18, 19, 20, 21, 22, 23, 28, 30, 35, 39], "wrapper": [6, 17, 18, 28, 31, 32], "inplac": [6, 15, 35], "ir": [6, 15, 20, 21, 23, 25, 27, 34], "insid": [6, 18, 21, 22, 24, 27, 35], "stand": 6, "intermedi": [6, 9, 14, 20, 21, 23, 39], "smaller": [6, 21, 22, 24, 25, 34], "inherit": 6, "dai": 6, "unless": [6, 20, 25, 34], "verifi": [6, 13, 15, 39], "test_oper": 6, "test_aten_xla_tensor": 6, "yield": [6, 18, 20, 39], "break": [6, 17, 21, 22, 25, 34, 39], "grasp": 6, "capabl": [6, 23], "minim": [6, 13, 23, 24], "pr": [6, 20, 31], "vanilla": 6, "lerp": 6, "variant": [6, 25, 26, 34], "lerp_": 6, "scalar_out": 6, "tensor_out": 6, "prototyp": [6, 35], "weight": [6, 15, 20, 32, 33], "lerp_out": 6, "namespac": [6, 20], "wrapper_scalar_lerp": 6, "No": [6, 14, 16, 25, 27, 33, 34], "deviceguard": 6, "omit": [6, 14, 36, 38], "anonym": 6, "wrapper_scalar_lerp_": 6, "wrapper_scalar_lerp__tmp": 6, "_copy_from": 6, "m": [6, 10, 11, 25, 31, 34, 36, 39], "impl": [6, 10, 11], "torch_fn": 6, "automat": [6, 7, 13, 14, 15, 18, 20, 21, 25, 31, 34, 36, 37], "explicit": [6, 19, 23, 26, 31], "place": [6, 11, 15, 22, 24, 26, 35, 37, 39], "interned_str": 6, "symbol": [6, 25, 34], "submit": [6, 19, 20, 21, 26], "team": [7, 29], "tf": [7, 20, 25, 34], "close": [7, 17], "expos": [7, 14, 18, 21, 35], "deviceplugin": 7, "short": [7, 20, 25, 34], "pjrtclient": 7, "mirror": 7, "pjrt_api": 7, "straightforward": [7, 15, 24], "detail": [7, 8, 9, 10, 11, 14, 15, 18, 20, 25, 34, 36], "concret": [7, 25, 34], "placehold": 7, "pjrt_library_path": 7, "extra": [7, 28, 32, 39], "multiprocess": [7, 14, 15, 18], "compon": [7, 39], "least": [7, 15, 24], "cpuplugin": 7, "def": [7, 8, 9, 10, 11, 12, 14, 15, 17, 18, 19, 22, 27, 28, 29, 30, 32, 33, 39], "library_path": 7, "os": [7, 14, 18, 28], "join": [7, 15], "dirnam": 7, "__file__": 7, "pjrt_c_api_cpu_plugin": 7, "exmapl": 7, "pyproject": 7, "toml": 7, "torch_xla_cpu_plugin": 7, "With": [7, 8, 14, 16, 25, 29, 34], "initi": [7, 11, 14, 15, 18, 19, 22, 28, 30, 37], "experiment": [7, 8, 9, 12, 13, 14, 16, 17, 27, 28, 29, 30, 32, 33, 35, 37], "state": [7, 9, 15, 19, 31], "becom": [7, 8, 9, 14, 17, 18, 20, 22, 25, 34], "stabl": [7, 14, 23, 24, 31], "rise": 8, "openai": [8, 12], "triton": [8, 13], "popular": 8, "commun": [8, 11, 14, 15, 18, 21, 22, 24, 29, 36], "instanc": [8, 11, 15, 31, 37], "order": [8, 9, 15, 18, 19, 20, 22, 24, 35, 36], "pariti": 8, "continu": [8, 14, 23, 29], "push": 8, "custom_kernel": 8, "jax_import_guard": 8, "pl": [8, 14, 18, 35], "jnp": [8, 10], "add_vectors_kernel": 8, "x_ref": 8, "y_ref": 8, "o_ref": 8, "x": [8, 9, 10, 12, 15, 18, 20, 21, 25, 27, 28, 30, 31, 32, 33, 34, 35, 36, 39], "y": [8, 9, 10, 12, 15, 20, 21, 23, 25, 27, 31, 32, 33, 34, 35, 36, 39], "jit": [8, 10, 12, 18, 29], "add_vector": 8, "arrai": [8, 10, 15, 24, 32, 36], "pallas_cal": 8, "out_shap": 8, "shapedtypestruct": 8, "dtype": [8, 10, 12, 14, 25, 26, 27, 33, 34, 39], "otherwis": [8, 15, 20, 21, 23, 24, 25, 32, 34], "hang": 8, "lock": 8, "q": [8, 10], "randn": [8, 10, 14, 15, 17, 18, 27, 28, 29, 33, 35, 36], "128": [8, 9, 10, 14, 31, 33, 38], "k": [8, 10, 20], "v": [8, 10, 27], "make_kernel_from_palla": 8, "pt_kernel": 8, "lambda": [8, 27, 31], "liner": 8, "flash": [8, 9, 12], "attent": [8, 9, 10, 12], "besid": 8, "op": [8, 9, 10, 13, 15, 17, 19, 20, 21, 25, 26, 34, 35, 36], "suppor": 8, "flash_attent": [8, 27], "paged_attent": 8, "queri": [8, 14], "squeez": 8, "dim": [8, 9, 15], "key_cach": 8, "value_cach": 8, "context_len": 8, "block_tabl": 8, "pages_per_compute_block": 8, "megacore_mod": 8, "none": [8, 10, 11, 15, 20, 32, 35, 36], "vllm": 8, "effect": [8, 15, 27, 39], "memori": [8, 13, 15, 16, 20, 23, 24, 25, 31, 34], "kv": 8, "proper": [8, 36], "jax_nightly_releas": 8, "jaxlib_nightly_releas": 8, "authorit": 8, "dev": [8, 23, 28], "en": [8, 31], "consid": [9, 14, 18, 19, 21, 22], "mani": [9, 14, 15, 20, 22, 23, 24, 25, 27, 34, 38, 39], "homogen": 9, "llm": [9, 22], "drop": [9, 16, 20], "loop": [9, 17, 18, 20, 21, 22, 23, 24, 25, 27, 32, 34, 37], "bunch": [9, 10], "decod": [9, 17, 27], "subsequ": [9, 19, 22, 23], "significantli": [9, 14, 17, 18, 22, 23], "reduc": [9, 11, 14, 15, 16, 18, 19, 20, 21, 22, 24, 31], "hand": [9, 18], "lower": [9, 10, 13, 17, 20, 23, 25, 26, 34], "lax": 9, "Its": [9, 15, 17], "primari": [9, 23], "hood": 9, "itself": [9, 12, 15, 23, 31], "typic": [9, 15, 19, 23], "transform": [9, 19, 22, 31, 36], "run_decoder_lay": 9, "hidden_st": 9, "decoder_lay": 9, "unrol": 9, "flat": [9, 36], "shown": [9, 14, 17, 25, 34], "decoder_with_scan": 9, "root": [9, 15, 25, 34, 39], "python3": [9, 14, 16, 18, 20, 22, 27, 31], "train_decoder_only_bas": [9, 17, 20], "decoderwithscan": 9, "appli": [9, 11, 15, 18, 19, 26, 31, 32, 37], "dimens": [9, 15, 16, 35, 36], "carri": [9, 25, 34, 35], "along": [9, 15, 19, 31, 36], "fn": [9, 15], "callabl": [9, 15, 31], "tupl": [9, 10, 15, 25, 30, 32, 34, 36], "init": [9, 14, 18, 28, 29, 30], "xs": [9, 15, 32, 35, 36], "roughli": [9, 39], "equal": [9, 36, 39], "ys": 9, "len": [9, 15, 21], "append": [9, 20], "scan_exampl": 9, "scan_example_cumsum": 9, "cumul": [9, 19, 30], "sum": [9, 11, 15, 26, 31, 32], "scan_example_pytre": 9, "pytre": 9, "final": [9, 19, 28, 35, 39], "histori": 9, "15": [9, 22, 39], "count": [9, 15, 20], "mean": [9, 14, 15, 16, 17, 18, 19, 20, 21, 24, 25, 28, 32, 34, 35], "0000": 9, "5000": 9, "figur": [9, 11, 16, 36], "repe": 9, "bound": 9, "compar": [9, 14, 18, 20, 28, 29, 30], "overhead": [9, 14, 17, 19, 27, 28, 29], "especi": [9, 14, 15, 17, 22, 23, 29, 35], "finish": [9, 15, 19, 24], "9m35": 9, "4m59": 9, "hidden": 9, "num": 9, "head": 9, "512": [9, 36], "500": 9, "metric": [9, 15, 28], "is_fn_pur": 9, "is_layer_pur": 9, "final_carri": 9, "init_scan": 9, "xs_scan": 9, "input_data": 9, "traceabl": [9, 11], "particular": [9, 22, 24], "palla": [9, 13], "incompat": 9, "save": [9, 15, 20, 23, 27, 31, 37], "chip": [9, 14, 17], "256": [9, 14], "50": [9, 20, 22, 30], "2048": [9, 14], "compiletim": [9, 20], "totalsampl": [9, 20], "accumul": [9, 15, 23], "02m57s694ms418": 9, "595u": 9, "valuer": [9, 20], "02s112ms586": 9, "097u": 9, "rate": [9, 20, 28], "054285": 9, "percentil": [9, 20], "023ms113": 9, "470u": 9, "10": [9, 14, 15, 18, 20, 22, 25, 27, 28, 29, 30, 33, 34, 37, 39], "20": [9, 16, 18, 20, 28, 33, 39], "54s644ms733": 9, "284u": 9, "80": [9, 20], "01m03s028ms571": 9, "841u": 9, "90": [9, 20], "95": [9, 20], "99": [9, 20, 28], "29s996ms941": 9, "409u": 9, "02s529ms591": 9, "388u": 9, "158152": 9, "018ms636": 9, "571u": 9, "11s983ms003": 9, "171u": 9, "18s995ms301": 9, "667u": 9, "maximum": [9, 15, 16, 24, 33], "1m03": 9, "19": [9, 28, 29, 39], "7253": 9, "comment": [9, 25, 34], "accomplish": 10, "exportedprogram": 10, "fx": [10, 29], "exported_program_to_stablehlo": 10, "mlir": 10, "torchvis": [10, 17, 29], "torchax": 10, "tx": 10, "resnet18": [10, 17, 29], "sample_input": 10, "224": [10, 17], "mlir_modul": 10, "store": [10, 12, 15, 20], "feel": [10, 20, 28], "explor": [10, 23], "org": [10, 14, 15, 31], "tutori": [10, 12, 15, 20, 22, 28, 35, 39], "jfunc": 10, "shapeddtypestruct": 10, "float32": [10, 26, 39], "last": [10, 20, 36, 39], "constant": [10, 20, 21, 35], "convent": 10, "ed": 10, "appear": [10, 18, 20, 24], "paramt": 10, "jfunc_inlin": 10, "scaled_dot_product_attent": 10, "decompos": 10, "low": [10, 16, 20, 39], "dure": [10, 15, 19, 20, 21, 24, 29, 31, 35], "captur": [10, 15, 17, 19, 20, 21, 22, 24], "downstream": [10, 26], "ml": [10, 36, 39], "crucial": [10, 17, 19], "geneart": 10, "pattern": [10, 20, 25, 29, 34], "challeng": 10, "prone": 10, "robust": 10, "outlin": [10, 33], "pratic": 10, "scaled_product_attent": 10, "centric": 10, "unittest": 10, "nn": [10, 14, 15, 18, 28, 29, 31, 33, 35], "impl_abstract": 10, "jaten": 10, "jlibrari": 10, "mylib": 10, "basic": [10, 17, 18, 25, 28, 34], "sdpa": 10, "compositeexplicitautograd": 10, "_mylib_scaled_dot_product_attent": 10, "product": [10, 15, 39], "transpos": [10, 25, 34], "dropout_p": 10, "is_caus": 10, "_mylib_scaled_dot_product_attention_meta": 10, "empty_lik": [10, 12], "decomposit": 10, "register_torch_composit": 10, "softmax": 10, "register_jax_composit": 10, "_aten_softmax": 10, "_softmax": 10, "static_argnum": 10, "librarytest": 10, "testcas": 10, "manual_se": [10, 14, 15], "default_env": 10, "use_torch_native_for_cpu_tensor": 10, "test_basic_sdpa_librari": 10, "customopexampl": 10, "rand": [10, 25, 34, 39], "32": [10, 15, 20, 23, 24, 36], "64": [10, 17, 29, 31], "module_str": 10, "todo": 10, "produc": [10, 19, 25, 26, 28, 34], "assertin": 10, "__name__": [10, 14, 18, 28], "__main__": [10, 14, 18, 28], "emit": 10, "repres": [10, 14, 15, 25, 34, 39], "region": [10, 15, 20, 26, 35], "th": [10, 36], "xla_model": [11, 13, 14, 18, 19, 20, 22, 26, 28, 29, 30, 31, 32, 33, 36], "adopt": [11, 25, 34], "reimplement": [11, 14], "_c10d_function": 11, "all_reduc": [11, 15, 26], "processgroupxla": 11, "deriv": 11, "processgroup": 11, "xla_backend": [11, 14, 28, 37], "_create_xla_process_group": 11, "prefix_stor": 11, "rank": [11, 14, 15, 28, 31, 36, 37], "timeout": 11, "assert": [11, 28, 39], "xr": [11, 14, 15, 18, 26, 28, 31, 32, 35, 36, 37], "is_spmd": [11, 15], "spmd": [11, 13, 18, 21, 27, 37], "group": [11, 14, 15, 28, 35], "_register_xla_backend": 11, "dist": [11, 14, 28, 37], "register_backend": 11, "allreduc": 11, "all_reduce_opt": 11, "allgath": 11, "output_tensors_list": 11, "input_tensor": 11, "opt": [11, 18], "_mp_fn": [11, 14, 18], "init_process_group": [11, 14, 28, 37], "init_method": [11, 14, 37], "progress": [11, 22], "blob": [11, 12, 14, 15], "distributed_c10d": 11, "_exception_logg": 11, "all_gath": [11, 14, 15], "tensor_list": 11, "async_op": 11, "_get_default_group": 11, "remap": 11, "_functional_collect": 11, "all_reduce_inplac": 11, "eventu": 11, "reach": [11, 15, 39], "rewrit": [11, 24, 25, 34, 35], "reduceop": 11, "group_nam": 11, "torch_library_impl": 11, "four": [11, 21], "align": [11, 17], "signatur": 11, "remain": [11, 18, 22, 25, 34, 38], "restrict": 11, "usag": [11, 15, 17, 20, 24, 25, 31, 32, 34, 37], "test_collective_ops_tpu": 11, "scenario": [11, 19, 23, 29], "reduct": [11, 15], "aggreg": 11, "all_gather_into_tensor": 11, "gather": [11, 15, 20, 35], "reduce_scatter_tensor": 11, "across": [11, 13, 14, 15, 17, 18, 20, 31, 32, 36], "all_to_all_singl": 11, "output_split_s": 11, "input_split_s": 11, "although": [11, 14, 25, 34, 39], "accept": [11, 35], "argument": [11, 12, 15, 19, 22, 26, 27, 29, 31], "1s": 11, "limit": [11, 14, 15, 18], "reflect": [11, 19, 36], "compromis": 11, "maintain": [11, 13, 39], "constraint": [11, 14, 20], "alltoal": [11, 15], "high": [12, 13, 15, 16, 23, 28, 33, 39], "deep": [12, 17, 20], "learn": [12, 14, 17, 23, 36, 39], "languag": [12, 27], "empow": 12, "potenti": [12, 14, 15, 18, 20], "given": [12, 15, 20, 21, 25, 27, 28, 31, 34, 36, 39], "add_kernel": 12, "x_ptr": 12, "pointer": 12, "y_ptr": 12, "output_ptr": 12, "n_element": 12, "block_siz": 12, "tl": 12, "constexpr": 12, "element": [12, 15, 25, 32, 34, 35, 36, 39], "01": 12, "l28": 12, "pid": 12, "program_id": 12, "axi": [12, 15, 32, 36], "block_start": 12, "offset": 12, "arang": 12, "mask": [12, 20, 25, 34], "xla_triton": 12, "16": [12, 18, 23, 31, 33, 36], "int64": 12, "grid": 12, "cdiv": 12, "triton_cal": 12, "kwarg": [12, 15, 31, 35], "payload": [12, 14, 15], "regard": [12, 18, 29], "buffer": [12, 15, 27], "_xla_gpu_custom_cal": 12, "dep": 12, "job": [13, 15, 21, 29], "thousand": [13, 14], "mfu": 13, "hardwar": [13, 15, 17, 20, 22, 26], "__version__": [13, 20], "overview": 13, "analysi": [13, 22, 29], "topic": [13, 23, 36], "control": [13, 15, 16, 18, 20, 35], "mxu": 13, "float": [13, 15, 25, 26, 34], "precis": [13, 15], "checkpoint": [13, 14, 21, 23, 31, 36], "ddp": [13, 14], "shard": [13, 15, 37], "fsdp": [13, 15, 35, 36], "One": [13, 15, 16, 18, 21], "stablehlo": [13, 15], "mix": [13, 15, 36], "torchdynamo": 13, "quantiz": 13, "repeat": [13, 23], "layer": [13, 16, 17, 27, 31, 32, 35], "scan": 13, "scan_lay": 13, "while_loop": 13, "assume_pur": 13, "eager": [13, 15, 19, 25, 28, 33, 34], "mode": [13, 15, 19, 25, 28, 33, 34, 35, 37, 39], "recompil": [13, 16, 17, 18, 20, 21], "bazel": 13, "plugin": [13, 14, 23], "encount": [14, 18, 20], "bug": [14, 20, 28], "tag": [14, 15], "r2": [14, 20, 35], "renam": 14, "torchrun": [14, 18, 38], "xpu": 14, "neuron": [14, 18], "xrt_tpu_config": 14, "impact": [14, 15, 17, 20, 25, 28, 34, 39], "30": [14, 31], "preview": 14, "thread": [14, 15, 18, 20, 37], "safe": 14, "section": [14, 18, 20, 22, 24, 35, 36], "broadcast": 14, "replica": [14, 15], "broadcast_master_param": 14, "random": [14, 15, 17, 21, 27, 33, 39], "global": [14, 15, 18, 27, 35, 37], "rng": [14, 15], "pjrt_backend": 14, "v4": [14, 15, 17, 18, 21, 22, 23, 24, 29, 35], "distributeddataparallel": 14, "parallel_load": [14, 15, 18, 20], "global_ordin": [14, 15, 18, 28, 31], "world_siz": [14, 15, 26, 28, 31, 35], "42": [14, 27], "gradient_as_bucket_view": [14, 28], "loss_fn": [14, 17, 18, 26, 28, 29], "mseloss": [14, 28], "sgd": [14, 18, 26, 28, 29], "lr": [14, 18, 28, 29, 31, 32], "001": [14, 28], "zero_grad": [14, 17, 18, 26, 28], "loss": [14, 17, 18, 26, 29, 31, 32, 39], "confirm": 14, "p": [14, 20, 25, 34, 39], "localservic": 14, "localhost": 14, "51011": 14, "master_addr": 14, "master_port": 14, "12355": [14, 38], "Or": [14, 18, 25, 34], "grpc": 14, "torchbench": 14, "observ": [14, 17, 28], "35": [14, 20], "copi": [14, 15, 18, 20, 22], "worker": [14, 15, 18, 22, 23, 31, 32, 37], "tpuvm": [14, 18, 23, 35], "mnist": [14, 18, 20, 26], "test_train_mp_mnist": [14, 28], "fake_data": [14, 20, 28, 38], "alpha": [14, 18], "central2": [14, 23], "b": [14, 15, 19, 23, 25, 26, 27, 29, 34, 36], "resnet50": [14, 17, 18, 29, 31], "git": [14, 20, 22, 31], "depth": [14, 20], "branch": [14, 20, 25, 34], "test_train_mp_imagenet": [14, 20, 28], "batch_siz": [14, 31, 38], "num_epoch": [14, 28, 31], "By": [14, 15, 22, 25, 34, 39], "tpu_process_bound": 14, "tpu_visible_chip": 14, "r1": 14, "13": [14, 18, 28, 30], "docker_imag": 14, "gcr": 14, "io": [14, 31], "privat": 14, "sudo": [14, 23], "rm": 14, "privileg": 14, "net": [14, 24, 26], "gpu_num_devic": 14, "nnode": [14, 38], "nproc": [14, 15], "num_gpu_devic": 14, "pjrt_distribut": 14, "physic": [14, 35, 36, 39], "12": [14, 20, 29, 31], "number_gpu_vm": [14, 38], "node_rank": [14, 38], "current_node_rank": 14, "nproc_per_nod": [14, 38], "number_local_gpu_devic": 14, "rdzv_endpoint": [14, 38], "internal_ip_address": 14, "multinode_train": 14, "endpoint": [14, 38], "form": [14, 20, 25, 34, 38], "intern": [14, 15, 17, 18, 19, 20, 25, 34, 35, 38, 39], "address": [14, 15, 17, 35, 38], "machine_0": 14, "machine_1": 14, "machine_0_internal_ip_address": [14, 38], "ident": 14, "page": 14, "mostli": [14, 31], "interchang": 14, "perspect": [14, 18], "subtl": 14, "importantli": [14, 27], "architectur": [14, 31], "spawn": [14, 15, 18, 22], "server": [14, 15, 24], "thu": [14, 17, 19, 20], "batch": [14, 18, 20, 21, 22, 24, 35], "latenc": 14, "serial": [14, 18], "deseri": 14, "send": [14, 18, 21, 22, 35], "constrain": [14, 15], "direct": [14, 19, 20], "independ": [14, 17, 18, 20], "plan": 14, "xla_dist": 14, "scp": [14, 18], "sdk": 14, "enhanc": [14, 17], "stabil": [14, 20, 26], "xmp": [14, 18, 22], "substanti": 14, "mesh": [14, 15, 32], "master": [14, 15, 18, 37], "connect": [14, 15, 35], "practic": [14, 17, 25, 32, 34, 36], "unreli": 14, "due": [14, 17, 20, 21, 24, 38, 39], "inbound": 14, "could": [14, 21, 25, 34, 35, 39], "failur": 14, "forc": [14, 15, 20, 25, 30, 34], "entir": [14, 31], "restart": 14, "much": [14, 18, 21, 22, 24, 25, 27, 29, 34], "impos": 14, "transfer": [14, 15, 19, 20, 24, 35], "middl": [14, 24, 25, 34], "unwant": 14, "permit": 14, "subset": [14, 36], "particip": [14, 15], "old": 14, "alter": 14, "synchron": [14, 17, 18, 23, 35, 37], "barrier": [14, 15, 18, 19, 22], "all_gather_object": 14, "gloo": [14, 28, 37], "new_group": 14, "subgroup": 14, "monitor": 14, "context": [14, 15, 17, 20, 25, 26, 34], "altern": [14, 23, 25, 26, 33, 34], "less": [14, 25, 29, 34, 39], "than": [14, 20, 25, 28, 31, 34, 39], "perf": [14, 25, 34], "md": [14, 15], "strongli": 14, "_all_gath": 14, "int": [14, 15, 25, 27, 34, 35, 39], "int32": 14, "zeros_lik": 14, "_": [14, 19, 29, 30], "get_world_s": 14, "averag": 14, "task": [14, 17], "175": 14, "chart": 14, "breakdown": 14, "tfrt": 14, "legaci": 14, "streamexecutor": 14, "tpu_legaci": 14, "happen": [14, 15, 17, 18, 20, 21, 22, 24, 25, 34], "comparison": [14, 36], "device_count": [15, 35], "wait": [15, 19, 20, 24], "reset_scop": 15, "pend": [15, 19], "whether": [15, 18, 26], "block": [15, 19, 31, 35], "reset": 15, "scopecontext": 15, "full_graph": [15, 17], "max_different_graph": 15, "lazytensor": [15, 21, 23], "decid": [15, 20, 25, 27, 34], "funciton": 15, "act": [15, 18, 23], "throw": [15, 18], "exit": [15, 20, 26, 28], "pt_xla_debug": 15, "messag": [15, 18, 20], "dump": [15, 20], "allow": [15, 18, 20, 22, 23, 24, 26, 35, 36, 37, 39], "rais": [15, 20, 39], "exceed": 15, "foo": 15, "sin": [15, 27], "co": 15, "foo2": 15, "compiled_foo2": 15, "seed": 15, "integ": [15, 20, 36], "subpackag": 15, "mp": 15, "etc": [15, 20, 25, 34, 35], "set_mat_mul_precis": [15, 39], "liter": 15, "highest": [15, 37, 39], "mat": [15, 39], "conv": 15, "32bit": 15, "matrix": [15, 18, 19, 39], "convolut": 15, "trade": [15, 21, 25, 34], "accuraci": [15, 28, 31, 39], "fastest": 15, "downcast": 15, "fp32": 15, "bf16": [15, 39], "multipli": [15, 18, 36, 39], "three": [15, 18, 39], "approxim": 15, "14": 15, "slowest": 15, "six": [15, 39], "22": [15, 28], "precision_tutori": 15, "empir": [15, 39], "behav": [15, 20, 39], "get_mat_mul_precis": 15, "device_typ": 15, "local_process_count": 15, "local_device_count": 15, "total": [15, 19, 25, 34, 36, 39], "addressable_device_count": 15, "visibl": [15, 25, 34], "global_device_count": 15, "global_runtime_device_count": [15, 32, 35, 36], "ordin": [15, 18], "guarante": [15, 19, 27], "predict": 15, "relationship": [15, 18, 20], "nor": 15, "contigu": [15, 18, 20], "local_ordin": 15, "get_master_ip": 15, "retriev": [15, 18, 25, 29, 34, 35, 36, 39], "discoveri": 15, "use_spmd": [15, 35, 36, 37], "non": [15, 17, 25, 26, 27, 34, 36], "replic": [15, 35, 36], "spmd_advanc": 15, "initialize_cach": [15, 18], "readonli": [15, 18], "persist": [15, 18, 37], "xla_devic": 15, "devkind": 15, "deprec": 15, "xla_device_hw": 15, "union": 15, "real": [15, 29], "is_master_ordin": 15, "multi": [15, 16, 28, 35, 38], "num_host": 15, "boolean": 15, "reduce_typ": 15, "pin_layout": 15, "xm": [15, 18, 20, 22, 26, 28, 29, 30, 31, 32, 33, 36], "reduce_sum": 15, "reduce_mul": 15, "reduce_and": 15, "reduce_or": 15, "reduce_min": 15, "reduce_max": 15, "layout": [15, 23, 33, 36], "pine": 15, "corrupt": 15, "unpin": 15, "hlomodul": 15, "hold": [15, 35], "channel_id": 15, "use_global_device_id": 15, "channel": [15, 33], "replicagroup": 15, "all_to_al": 15, "split_dimens": 15, "concat_dimens": 15, "split_count": 15, "www": 15, "operation_semant": 15, "upon": 15, "split": [15, 36], "concat": 15, "add_step_closur": 15, "closur": 15, "run_async": 15, "report": 15, "consol": 15, "tensorboard": [15, 24], "intermediari": 15, "inspect": [15, 39], "materi": [15, 19, 20, 21, 25, 34, 35], "queu": 15, "though": [15, 18, 28], "advis": 15, "throttl": 15, "event": 15, "asynchron": [15, 19, 35, 37], "wait_device_op": 15, "async": [15, 29], "whose": [15, 16, 36], "optimizer_step": [15, 18, 19, 21, 26, 28, 31], "optimizer_arg": 15, "dict": [15, 27, 31], "gradid": 15, "parallelload": [15, 35], "dataparallel": 15, "loader": [15, 19, 20, 22, 29], "dictionari": 15, "gradient": [15, 18, 19, 26, 31, 37], "file_or_path": 15, "textio": 15, "master_onli": [15, 31], "global_mast": 15, "care": [15, 18, 20, 25, 34], "taken": [15, 18, 19, 20, 25, 28, 34, 37], "view": [15, 18, 20], "recreat": [15, 18], "destin": [15, 18], "nest": [15, 31], "obj_to_sav": 15, "path_to_sav": 15, "rendezv": 15, "byte": 15, "xla_rendezv": 15, "sent": [15, 19, 20], "exchang": 15, "posit": 15, "mesh_reduc": 15, "reduce_fn": 15, "toxlatensorarena": 15, "receiv": 15, "np": [15, 32, 36], "test_accuraci": 15, "set_rng_stat": 15, "get_rng_stat": 15, "get_memory_info": 15, "memoryinfo": 15, "bytes_us": 15, "290816": 15, "bytes_limit": 15, "34088157184": 15, "peak_bytes_us": 15, "500816": 15, "get_stablehlo": 15, "var": [15, 35], "xla_hlo_debug": [15, 20], "get_stablehlo_bytecod": 15, "bytecod": [15, 29], "mpdeviceload": [15, 18, 21, 22, 35], "dataload": [15, 17, 18, 28, 35, 37], "background": [15, 37], "upload": [15, 24, 35], "per_device_load": [15, 35], "constructor": 15, "train_device_load": 15, "train_load": [15, 18, 35], "xla_multiprocess": 15, "daemon": 15, "start_method": 15, "moment": 15, "valueerror": [15, 39], "mark_shard": [15, 27, 32, 35, 36], "xlashardedtensor": [15, 37], "partition_spec": [15, 35, 36], "nonetyp": 15, "annot": [15, 35], "partit": [15, 35], "spec": [15, 35], "spmdpartition": [15, 35], "topolog": [15, 18, 35], "partitionspec": 15, "ax": [15, 35, 36], "mesh_shap": [15, 32, 35, 36], "num_devic": [15, 32, 35, 36], "device_id": [15, 32, 35, 36], "clear_shard": 15, "clear": [15, 17], "cast": [15, 26], "t1": [15, 18, 20, 36], "get_1d_mesh": 15, "set_global_mesh": 15, "get_global_mesh": 15, "axis_nam": [15, 35], "ndarrai": 15, "flatten": 15, "reshap": 15, "fill": 15, "row": [15, 36], "major": [15, 23, 36], "global_runtime_device_attribut": [15, 36], "length": [15, 25, 34], "get_xla_supported_devic": 15, "get_logical_mesh": [15, 36], "ordereddict": [15, 35, 36], "hybridmesh": [15, 35], "ici_mesh_shap": [15, 35], "dcn_mesh_shap": [15, 35], "hybrid": 15, "ici": 15, "dcn": [15, 35], "increas": [15, 27], "intens": 15, "mdl": 15, "inner": [15, 31, 35], "outer": [15, 31, 32, 35], "slice": [15, 21, 22, 35, 36], "eager_mod": [15, 17], "d": [15, 25, 26, 34], "eagerli": [15, 17, 18, 20, 25, 34], "metrics_report": [15, 20], "short_metrics_report": [15, 20], "counter_nam": 15, "metric_nam": 15, "counter_valu": 15, "metric_data": 15, "total_sampl": 15, "retain": 15, "circular": 15, "in_tensor": 16, "randint": [16, 33], "out_tensor": 16, "nonzero": [16, 20, 22, 24, 25, 34, 39], "word": [16, 25, 27, 34], "25": 16, "further": [16, 21, 22, 24, 28], "categor": 16, "unbound": 16, "alloc": [16, 36], "infinit": [16, 32, 39], "phase": [16, 17], "perceptron": 16, "mlp": 16, "xla_experiment": 16, "masked_select": 16, "masked_scatt": 16, "your_script": [16, 22], "100": [16, 20, 27, 31], "29": [16, 28, 29], "49": [16, 29], "03": 16, "102": 16, "hit": [16, 25, 34], "198": 16, "1953": 16, "motiv": 16, "excess": 16, "half": [16, 39], "try": [16, 20, 22, 24, 25, 34], "ds": 16, "test_dynamic_shape_model": 16, "testdynamicshapemodel": 16, "test_backward_pass_with_dynamic_input": 16, "record": [17, 18, 19, 20, 23, 27], "defer": [17, 18, 19], "approach": [17, 18, 19, 25, 28, 31, 34, 39], "usabl": 17, "ambigu": 17, "struggl": 17, "distinguish": 17, "whenev": 17, "preprocess": [17, 33], "expens": [17, 20, 25, 34], "difficulti": 17, "opaqu": [17, 18, 20], "natur": 17, "shift": 17, "priorit": 17, "preserv": [17, 18, 20], "immedi": [17, 18, 19, 23, 35], "flexibl": [17, 33], "decor": [17, 27], "mark": 17, "boundari": 17, "feedback": 17, "outsid": [17, 18], "leak": 17, "catch": [17, 18], "accident": 17, "compiled_model": 17, "awai": [17, 19], "summar": [17, 26], "temporarili": 17, "resum": [17, 31], "abstract": [17, 33, 35], "balanc": 17, "distinct": [17, 19], "workflow": [17, 18, 23], "advantag": [17, 18, 22, 23], "enclos": 17, "step_fn": 17, "logit": [17, 32], "aim": [17, 23, 25, 34], "quantifi": 17, "conduct": 17, "llama2": 17, "fake": [17, 37], "300": [17, 20], "measur": [17, 24], "clearli": 17, "illustr": [17, 21, 22, 24], "147": 17, "65": [17, 20], "tradit": [17, 29], "45": 17, "li": 17, "throughput": 17, "regular": [18, 20, 33], "t0": 18, "mm": [18, 26, 39], "neural": [18, 39], "l_in": 18, "l_out": 18, "floattensor": 18, "highlight": [18, 21], "nllloss": 18, "momentum": 18, "acquir": 18, "distribut": [18, 20, 23, 27, 31, 32, 35, 36], "mp_device_load": 18, "multithread": [18, 20], "assign": [18, 19, 22], "own": [18, 31], "onto": [18, 21], "preload": [18, 21], "overlap": [18, 24, 29, 35], "batches_per_execut": 18, "consolid": [18, 31], "all_reduce_gradi": 18, "parent": 18, "talk": 18, "howto": 18, "focu": [18, 23, 25, 34], "train_mnist_xla": 18, "infrastructur": 18, "awar": 18, "fakedata": 18, "fuse": [18, 21], "invis": 18, "caller": 18, "insert": [18, 24], "paper": 18, "unlik": [18, 21], "appreci": 18, "accommod": 18, "previous": 18, "state_dict": [18, 31, 37], "footprint": 18, "xser": 18, "stream": 18, "amount": [18, 20, 21, 25, 34], "restor": 18, "load_state_dict": [18, 37], "unavail": [18, 20], "aw": 18, "occur": [18, 39], "evalu": [18, 20, 21, 22, 23, 25, 27, 34], "fix": [18, 20, 21, 24, 27, 29, 32], "incorrectli": 18, "solut": [18, 20, 25, 33, 34, 39], "feed": 18, "testmodel": 18, "__init__": [18, 27, 28, 33], "super": [18, 27, 28], "pre": 18, "determin": 18, "warn": [18, 20, 39], "pt_xla_debug_level": [18, 20], "_set_allow_execut": 18, "earli": [18, 25, 34], "relat": [18, 22], "troubleshoot": 18, "consum": [18, 25, 34], "doesn": [18, 19, 20, 25, 32, 34], "disk": 18, "your_cache_path": 18, "mount": 18, "mp_fn": 18, "tmp": [18, 20, 31], "xla_cache_": 18, "runnabl": [18, 28, 32], "essenti": [19, 39], "emploi": 19, "primarili": 19, "side": [19, 25, 27, 34], "period": [19, 24], "spend": [19, 21], "durat": [19, 24, 37], "conceptu": [19, 36, 39], "start_tim": 19, "perf_count": 19, "matmul": [19, 26, 39], "incorrect": 19, "end_tim": 19, "elapsed_tim": 19, "predominantli": 19, "took": 19, "actual": [19, 22, 23, 25, 28, 34, 35], "devid": 19, "exemplifi": 19, "warm": 19, "translat": [19, 20], "isol": 19, "steadi": 19, "benchmark": 19, "isn": [19, 25, 34, 37], "exclud": 19, "sever": 19, "item": [19, 20, 22, 24, 39], "condition": 19, "often": [19, 20, 23, 25, 27, 34], "unlazi": 19, "structur": [19, 31, 35], "run_model": 19, "start_loop_tim": 19, "num_step": 19, "FOR": 19, "end_loop_tim": 19, "elapsed_loop_tim": 19, "spent": [19, 20], "largli": 19, "proce": [19, 25, 34], "inclus": 19, "lag": 19, "behind": 19, "run_model_step": 19, "subject": 20, "peculiar": 20, "detial": 20, "cu121": 20, "t2": [20, 36], "200": 20, "nightli": [20, 23, 31, 35], "rx": 20, "conclud": 20, "diagnos": 20, "extrem": [20, 27], "slip": 20, "analyz": [20, 24], "summari": 20, "frequent": 20, "21": 20, "11": [20, 25, 34], "transferfromdevicetim": 20, "23": [20, 39], "hash": 20, "c74c3b91b855b2b123f833b0d5f86943": 20, "107": 20, "frame": 20, "dk3": 20, "1055": 20, "44": 20, "__next__": 20, "train_loop_fn": 20, "48": [20, 28], "start_train": 20, "73": 20, "548000": 20, "gb": 20, "922460": 20, "alias": [20, 26], "547871": 20, "124478": 20, "028210": 20, "cal": 20, "steptrac": 20, "tri": [20, 22], "mark_step": 20, "frequenc": 20, "pair": 20, "met": 20, "destroi": 20, "202": 20, "06m09s401ms746": 20, "001u": 20, "778ms572": 20, "062u": 20, "425201": 20, "001ms32": 20, "778u": 20, "001ms61": 20, "283u": 20, "001ms79": 20, "236u": 20, "001ms110": 20, "973u": 20, "001ms228": 20, "773u": 20, "001ms339": 20, "183u": 20, "001ms434": 20, "305u": 20, "002ms921": 20, "063u": 20, "21s102ms853": 20, "173u": 20, "cachedsynctensor": 20, "395": [20, 28], "area": 20, "rout": 20, "qualifi": 20, "33": [20, 28, 29], "_local_scalar_dens": 20, "epoch": [20, 22, 31], "clear_al": 20, "xla_dynamo_debug": 20, "bottleneck": [20, 21, 22, 24, 27], "notebook": [20, 39], "train_resnet_benchmark": 20, "bad": 20, "degrad": [20, 22], "speedup": [20, 29], "indirect": 20, "variat": 20, "pad": [20, 21, 25, 34, 36], "ask": [20, 25, 34], "substitut": 20, "flow": 20, "clip_grad_norm": 20, "problemat": 20, "clip_grad_norm_": 20, "dramat": 20, "total_norm": 20, "zero": [20, 31, 37], "param_norm": 20, "grad": 20, "norm": [20, 39], "norm_typ": 20, "add_": 20, "clip_coef": 20, "max_norm": 20, "1e": [20, 29], "mul_": 20, "data_parallel": 20, "dataset": [20, 28, 31], "small": [20, 21, 24, 25, 28, 29, 34], "stride": 20, "reconstruct": 20, "shallow": 20, "ty": 20, "made": [20, 22, 24, 25, 34], "_get_xla_tensors_text": [20, 25, 34], "_get_xla_tensors_hlo": 20, "prior": [20, 37], "degre": 20, "xla_ir_debug": 20, "henc": [20, 29], "respons": [20, 21, 29, 37], "propag": 20, "xla_save_tensors_fil": 20, "realli": [20, 25, 34], "big": [20, 25, 34, 39], "sheet": 20, "xla_save_tensors_fmt": 20, "graphviz": 20, "xla_flag": 20, "xla_dump_to": 20, "dir_nam": 20, "unoptim": 20, "optimz": 20, "xla_metrics_fil": 20, "xla_save_hlo_fil": 20, "offend": 20, "xla_sync_wait": 20, "xla_use_eager_debug_mod": 20, "bypass": 20, "overal": [20, 24], "optimizaiton": 20, "tf_cpp_log_thread_id": 20, "tf_cpp_vmodul": 20, "vlog": 20, "tf_cpp_min_log_level": 20, "tf_vlog": 20, "xla_dump_hlo_graph": 20, "xla_util": 20, "save1": 20, "xla_graph_executor": 20, "pjrt_computation_cli": 20, "dir": 20, "pytorch_test_with_slow": 20, "test_torch": 20, "test_put_xla_uint8": 20, "torch_test_devic": 20, "pytorch_test_bas": 20, "fed": 21, "pod": [21, 23], "attach": [21, 35], "callback": [21, 22], "xla_tensor_z": 21, "cut": [21, 25, 34], "transferfromdevic": [21, 24], "tell": [21, 25, 34], "properti": [21, 25, 34], "suppos": 21, "tensors_on_devic": 21, "z": [21, 25, 34, 39], "subgraph": [21, 25, 34], "signal": 21, "far": 21, "fusion": [21, 23], "worth": [21, 25, 34], "magic": [21, 25, 34], "treat": [21, 36], "xla_no_special_scalar": 21, "guidelin": 22, "rememb": 22, "txt2img": 22, "prompt": 22, "photograph": 22, "astronaut": 22, "ride": 22, "hors": 22, "modif": [22, 23], "ldm": 22, "ddim": 22, "precision_scop": 22, "addition": [22, 26, 31], "frozenclipembedd": 22, "simplic": [22, 25, 34], "top": 22, "attr": 22, "statement": [22, 25, 34], "bar": 22, "stop": 22, "fall": [22, 32], "difficult": 22, "discuss": 22, "investig": [22, 24, 28, 39], "cover": [22, 35], "huggingfac": 22, "sd": 22, "xl": [22, 24], "cd": [22, 31], "text_to_imag": 22, "inference_tpu_single_devic": 22, "lora": 22, "model_id": 22, "stabilityai": 22, "9": [22, 25, 28, 31, 34, 39], "pipelin": [22, 24], "dpmsolvermultistepschedul": 22, "txt": 22, "invisible_watermark": 22, "safetensor": 22, "agre": 22, "licens": 22, "card": 22, "cli": 22, "_your_copied_token__": 22, "pipe": 22, "hour": 22, "wherea": 22, "likewis": 22, "gpt": 22, "min": 22, "mayb": 22, "notic": [22, 39], "piec": 22, "__call__": 22, "caveat": [22, 24], "unnecessari": [22, 27, 35], "communit": 22, "my_funct": 22, "debug_single_process": 22, "tpu_nam": [22, 23], "hypercomput": 22, "recip": 22, "algebra": 23, "research": [23, 39], "massiv": 23, "inferenc": 23, "frontend": [23, 25, 34], "readabl": 23, "opcod": 23, "seri": 23, "highli": 23, "tailor": 23, "deeper": 23, "dive": 23, "deliv": 23, "tackl": 23, "ambiti": 23, "know": [23, 25, 27, 28, 34], "love": 23, "smooth": 23, "minor": [23, 39], "compel": 23, "price": 23, "ratio": 23, "focus": 23, "theoret": [23, 25, 34], "v5": 23, "v6": 23, "nvidia": [23, 38, 39], "runtime_vers": 23, "project_id": 23, "accelerator_typ": 23, "your_tpu_nam": 23, "subnetwork": 23, "tpusubnet": 23, "pip3": 23, "cp38": 23, "linux_x86_64": 23, "whl": 23, "apt": 23, "libopenbla": 23, "libgl1": 23, "diffus": [23, 24], "advanc": [23, 36], "concept": [23, 35, 36], "thumb": 24, "constantli": 24, "idl": 24, "inference_tpu_": 24, "capture_profil": 24, "gap": 24, "xp": 24, "u": 24, "portion": 24, "busi": 24, "scroll": 24, "occupi": 24, "latter": [24, 31], "largest": 24, "zoom": 24, "timelin": 24, "examin": 24, "did": 24, "pipe_watermark": 24, "closer": 24, "preced": 24, "proceed": [24, 32], "watermark": 24, "cv2": 24, "pywt": 24, "leav": 24, "broken": 24, "rerun": 24, "scale_model_input": 24, "dynamo": [24, 29, 33], "hurt": [25, 34], "hard": [25, 28, 29, 34], "pov": [25, 34], "sai": [25, 34], "assur": [25, 34], "gone": [25, 34], "coverag": [25, 34], "explan": [25, 34], "mainli": [25, 34], "beginn": [25, 34], "propos": [25, 34], "reli": [25, 34], "impract": [25, 34], "assumpt": [25, 34], "ye": [25, 33, 34], "sentenc": [25, 34], "bucket": [25, 34, 37], "kinda": [25, 34], "anti": [25, 34], "matter": [25, 34], "workaround": [25, 34], "okai": [25, 34], "teach": [25, 34], "sort": [25, 34], "obviou": [25, 34], "s64": [25, 34], "inde": [25, 34], "_get_xla_tensor_dimension_s": [25, 34], "commonli": [25, 34], "wrong": [25, 34], "wors": [25, 34], "upper": [25, 34], "nit": [25, 34], "solv": [25, 34], "kept": [25, 34], "accessor": [25, 34], "2d": [25, 32, 34, 36], "implicitli": [25, 34], "doubl": [25, 34, 39], "overload": [25, 34], "IS": [25, 34], "explod": [25, 34], "convers": [25, 34], "cheap": [25, 34], "ve": [25, 34], "hoc": [25, 34], "think": [25, 34], "verison": [25, 34], "bla": [25, 34], "blabla": [25, 34], "uglier": [25, 34], "win": [25, 34], "pars": [25, 34], "torchscript": [25, 34], "somehow": [25, 34], "merg": [25, 34], "lazili": [25, 34, 35, 37], "properli": [25, 34], "thought": [25, 34], "trivial": [25, 34], "effort": [25, 34, 35], "why": [25, 34], "bandwidth": [25, 34], "automag": [25, 34], "gold": [25, 34], "smart": [25, 34], "trick": [25, 34], "tbh": [25, 34], "longer": [25, 34], "unawar": [25, 34], "hope": [25, 34], "smash": [25, 34], "blocker": [25, 34], "ahead": [25, 34], "nnc": [25, 34], "exactli": [25, 27, 34], "brian": [25, 34], "hirsh": [25, 34], "bdhirsh": [25, 34], "question": [25, 34], "Is": [25, 34], "stick": [25, 34], "torch_warn": [25, 34], "yea": [25, 34], "hei": [25, 34], "won": [25, 26, 34], "blaze": [25, 34], "abil": [25, 28, 34], "devirtu": [25, 34], "sound": [25, 34], "great": [25, 34], "truth": [25, 34], "irvalu": [25, 34], "enforc": [25, 34], "discrep": [25, 34], "followup": [25, 34], "1000": [25, 34], "my": [25, 34, 37], "presenc": [25, 34], "get_dimention_s": [25, 34], "didn": [25, 34], "exponenti": [25, 34], "blowup": [25, 34], "fewer": [25, 34], "opportun": [25, 34], "recogn": [25, 29, 34], "feasibl": [25, 34], "annoi": [25, 34], "wasn": [25, 34], "materiz": [25, 34], "combo": [25, 34], "extend": [26, 39], "datatyp": 26, "float16": 26, "bfloat16": [26, 33], "syncfre": 26, "autocast": 26, "es": 26, "elig": 26, "suppli": 26, "addmm": 26, "addmm_": 26, "prefer": 26, "float64": 26, "respect": [26, 36], "unlist": 26, "__matmul__": 26, "addbmm": 26, "addmv": 26, "addr": 26, "baddbmm": 26, "bmm": 26, "conv1d": 26, "conv2d": [26, 31], "conv3d": 26, "conv_transpose1d": 26, "conv_transpose2d": 26, "conv_transpose3d": 26, "relu": [26, 28], "prelu": 26, "max_pool2d": 26, "batch_norm": 26, "log_softmax": 26, "binary_cross_entropy_with_logit": 26, "prod": 26, "cdist": 26, "chloeski": 26, "invers": 26, "reflection_pad": 26, "replication_pad": 26, "mse_loss": 26, "cosine_embbeding_loss": 26, "nll_loss": 26, "multilabel_margin_loss": 26, "qr": 26, "svd": 26, "triangular_solv": 26, "linalg_svd": 26, "linalg_inv_ex": 26, "widest": 26, "index_copi": 26, "scaler": [26, 33], "gradscal": 26, "_fetch_gradi": 26, "xla_use_f16": 26, "underflow": 26, "imagenet": 26, "elimin": 27, "primer": 27, "exce": 27, "math": 27, "pseudo": 27, "Such": 27, "repeatedli": 27, "do_some_math": 27, "simul": 27, "ten": [27, 30], "func": 27, "functional_cal": 27, "mymodul": [27, 35], "pure_forward": 27, "param": 27, "cached_forward": 27, "named_paramet": 27, "named_buff": 27, "unit": [27, 28, 39], "testbridge_test_onli": 27, "test_trace_transformer_with_spda_attent": 27, "test_assume_pur": 27, "benchmark_iter": 27, "140": 27, "1342": 27, "24": 27, "1658": 27, "pai": 27, "front": 27, "recurs": [27, 31, 32], "minimum": [28, 31, 32, 39], "nccl": 28, "new_rank": 28, "ddp_model": 28, "launcher": 28, "demo_fn": 28, "five": 28, "sy": 28, "tempfil": 28, "cleanup": 28, "destroy_process_group": 28, "toymodel": 28, "net1": 28, "1000000": 28, "net2": 28, "demo_bas": 28, "label": 28, "run_demo": 28, "tot": 28, "statist": 28, "median": 28, "90th": 28, "deviat": 28, "cv": 28, "418": 28, "54": 28, "419": 28, "430": 28, "40": 28, "76": 28, "02": [28, 39], "97": 28, "407": 28, "60": 28, "39": 28, "seem": 28, "17864": 28, "20108": 28, "96": 28, "24351": 28, "74": 28, "5866": 28, "83": [28, 39], "10701": 28, "11770": 28, "00": 28, "14313": 28, "78": 28, "3102": 28, "92": 28, "41": [28, 29], "round": [28, 39], "heavili": 28, "sens": 28, "amort": 28, "logdir": 28, "o": 28, "converg": 28, "caution": 28, "known": 28, "crash": 28, "unmodifi": 29, "hook": 29, "biggest": [29, 31], "torchfx": 29, "technolog": 29, "a_xla": 29, "b_xla": 29, "compiled_cod": 29, "eval_model": 29, "xla_resnet18": 29, "eval": 29, "dynamo_resnet18": 29, "no_grad": 29, "resnet": [29, 38], "18": 29, "bench": 29, "59": 29, "resnext50_32x4d": 29, "91": 29, "alexnet": 29, "28": 29, "mobilenet_v2": 29, "62": 29, "mnasnet1_0": 29, "68": 29, "vgg16": 29, "bert_pytorch": 29, "squeezenet1_1": 29, "timm_vision_transform": 29, "52": 29, "geomean": 29, "04": 29, "train_model": 29, "crossentropyloss": 29, "pred": 29, "train_model_main": 29, "dynamo_train_model": 29, "xla_optim": 29, "weight_decai": 29, "extract": 29, "07": 29, "43": 29, "81": 29, "87": 29, "fwd": 29, "bwd": 29, "e2": 29, "hide": 29, "larger": [29, 31], "wit": 29, "promis": 29, "expand": 29, "excit": 29, "upcom": [29, 35], "invest": 29, "_higher_order_op": 30, "fori_loop": 30, "cond_fn": 30, "body_fn": 30, "bodi": 30, "iteri": 30, "init_v": 30, "functionaltensor": 30, "lvl": 30, "51": 30, "xlafullyshardeddataparallel": 31, "my_modul": [31, 32], "adam": [31, 32], "0001": [31, 32], "leftov": [31, 32], "arxiv": 31, "1910": 31, "02054": 31, "reshard_after_forward": 31, "test_train_mp_mnist_fsdp_with_ckpt": 31, "test_train_mp_imagenet_fsdp": 31, "interleav": 31, "submodul": 31, "fsdpvitmodel": 31, "checkpoint_modul": [31, 32], "3524": 31, "auto_wrap_polici": [31, 32], "size_based_auto_wrap_polici": 31, "polici": [31, 35], "100m": 31, "transformer_auto_wrap_polici": [31, 32], "transformer_layer_cl": [31, 32], "auto_wrapper_cal": 31, "remateri": 31, "get_shard_metadata": 31, "consolidate_sharded_model_checkpoint": 31, "stitch": 31, "ckpt": 31, "shard_metadata": 31, "ckpt_path": 31, "pth": 31, "consolidate_sharded_ckpt": 31, "ckpt_prefix": 31, "your_sharded_checkpoint_fil": 31, "ckpt_suffix": 31, "_rank": 31, "inspir": 31, "fairscal": 31, "fullyshardeddataparallel": 31, "readthedoc": 31, "resort": 31, "train_resnet_fsdp_auto_wrap": 31, "newer": [31, 39], "98": 31, "drop_last": 31, "use_nested_fsdp": 31, "use_gradient_checkpoint": 31, "final_ckpt": 31, "75": 31, "download": 31, "1k": 31, "datadir": 31, "test_set_batch_s": 31, "eval_interv": 31, "num_warmup_epoch": 31, "lr_scheduler_divide_every_n_epoch": 31, "lr_scheduler_divisor": 31, "residu": 31, "algorithm": [31, 32, 39], "ronghanghu": 31, "vit_10b_fsdp_exampl": 31, "vit": 31, "review": 32, "spmd_fully_sharded_data_parallel": 32, "spmdfullyshardeddataparallel": 32, "fsdpv2": 32, "autowrap": 32, "decoderlay": 32, "functool": 32, "decoder_only_model": 32, "shard_output": 32, "0th": 32, "children": 32, "blockwis": 33, "int4": 33, "analog": 33, "classifi": 33, "choos": [33, 37], "docstr": 33, "xla_quantized_matmul": 33, "n_input_featur": 33, "n_output_featur": 33, "w_int": 33, "127": 33, "int8": 33, "matmul_output": 33, "quantized_matmul": 33, "x_xla": 33, "w_int_xla": 33, "scaler_xla": 33, "matmul_output_xla": 33, "w": 33, "f_dynamo": 33, "dynamo_out_xla": 33, "myqlinearforxlabackend": 33, "load_weight": 33, "processed_w": 33, "processed_scal": 33, "stuff": 33, "orig_model": 33, "mymodel": 33, "q_weight": 33, "q_weights_for_xla": 33, "process_for_xla": 33, "q_linear": 33, "xlaquantizedlinear": 33, "in_featur": 33, "out_featur": 33, "load_quantized_weight": 33, "sym": 33, "asym": 33, "w8a16": 33, "w8a8": 33, "w4a8": 33, "input_shard": 35, "4d": 35, "shardingspec": 35, "input_mesh": 35, "s2": 35, "s3": 35, "s4": 35, "_after": 35, "_the": 35, "forth": 35, "techniqu": 35, "decis": 35, "nice": 35, "arrang": [35, 36], "center": 35, "multislic": 35, "denot": 35, "hardcod": 35, "rfc": [35, 38], "delai": 35, "subclass": 35, "__torch_dispatch__": 35, "global_tensor": 35, "strictli": 35, "local_shard": 35, "xlashard": 35, "ongo": 35, "distributedtensor": 35, "proof": 35, "distribute_tensor": 35, "init_device_mesh": 35, "big_tensor": 35, "100000": 35, "88": 35, "my_dtensor": 35, "stai": 35, "dynamo_mark_shard": 35, "placement": 35, "visualize_tensor_shard": 35, "visualize_shard": 35, "rich": 35, "2x2": 35, "generated_t": 35, "use_color": 35, "style": [35, 36], "tile": 35, "partial_repl": 35, "envvar": 35, "xla_auto_spmd": 35, "distribute_modul": 35, "auto_polici": 35, "device_mesh": 35, "sharded_model": 35, "behvaior": 35, "xla_auto_use_group_shard": 35, "reshard": 35, "xla_auto_spmd_mesh": 35, "unset": 35, "matric": [36, 39], "book": 36, "hint": 36, "strategi": 36, "dimension": 36, "mpi": 36, "necessarili": 36, "3d": 36, "1d": 36, "interconnect": 36, "core_on_chip": 36, "num_cor": 36, "coord": 36, "attribut": 36, "slice_index": 36, "coordin": 36, "divis": 36, "dedic": 37, "planner": 37, "spmdsaveplann": 37, "spmdloadplann": 37, "dist_cp": 37, "distributed_checkpoint": 37, "xc": 37, "storage_writ": 37, "filesystemwrit": 37, "checkpoint_dir": 37, "storage_read": 37, "filesystemread": 37, "all_step": 37, "save_async": 37, "preemption": 37, "detect": 37, "provis": 37, "queuedresourc": 37, "autocheckpoint": 37, "chkpt_on_preempt": 37, "fsspec": 37, "filesystem": 37, "prime_optim": 37, "chkpt_mgr": 37, "gs": 37, "tracked_step": 37, "best_step": 37, "prime": 37, "enumer": [37, 39], "unprim": 37, "destruct": 37, "num_gpu_machin": 38, "rank_of_current_machin": 38, "machine_0_ip_address": 38, "training_or_inference_script_using_spmd": 38, "xla_use_spmd": 38, "test_train_spmd_imagenet": 38, "yaoshiang": 39, "ho": 39, "2025": 39, "05": 39, "silicon": 39, "inexpens": 39, "tradeoff": 39, "v100": 39, "tensorcor": 39, "numer": 39, "tf32": 39, "mantissa": 39, "intuit": 39, "imagin": 39, "digit": 39, "decim": 39, "111": 39, "222": 39, "84": 39, "021642": 39, "twice": 39, "72": 39, "011": 39, "022": 39, "compris": 39, "fourth": 39, "ignor": 39, "000242": 39, "littl": 39, "rel": 39, "2002": 39, "1012": 39, "0214": 39, "tripl": 39, "idea": 39, "medium": 39, "nine": 39, "hh": 39, "hm": 39, "mh": 39, "hl": 39, "lh": 39, "lm": 39, "room": 39, "varianc": 39, "valid": 39, "set_printopt": 39, "sci_mod": 39, "linewidth": 39, "240": 39, "epsilon": 39, "ep": 39, "finfo": 39, "0078125": 39, "00000000000000000000": 39, "00781250000000000000": 39, "vice": 39, "versa": 39, "encourag": 39, "rather": 39, "struct": 39, "binary_fraction_to_fp32": 39, "bstr": 39, "0b1": 39, "invalid": 39, "fraction_bit": 39, "fp32_to_binary_fract": 39, "fp32_float": 39, "x_byte": 39, "endian": 39, "ieee": 39, "754": 39, "as_int": 39, "unpack": 39, "uint32": 39, "sign": 39, "31": 39, "expon": 39, "0xff": 39, "0x7fffff": 39, "0b": 39, "08b": 39, "023b": 39, "get_rand_matrix": 39, "diagon": 39, "1024": 39, "999": 39, "ey": 39, "rand_": 39, "bf16_ep": 39, "one_plus_half_ep": 39, "00390625": 39, "8th": 39, "lost": 39, "reconfirm": 39, "ones_bf16": 39, "01111111": 39, "00000001000000000000000": 39, "00000000000000000000000": 39, "wise": 39, "z_ref": 39, "00000010000000010000000": 39, "0078277587890625": 39, "saw": 39, "01110000101000111101100": 39, "440000057220459": 39, "01110000101000111101101": 39, "4400001764297485": 39}, "objects": {"": [[15, 0, 0, "-", "torch_xla"]], "torch_xla": [[15, 0, 0, "-", "backends"], [15, 1, 1, "", "compile"], [15, 1, 1, "", "device"], [15, 1, 1, "", "device_count"], [15, 1, 1, "", "devices"], [15, 0, 0, "-", "experimental"], [15, 1, 1, "", "manual_seed"], [15, 0, 0, "-", "runtime"], [15, 1, 1, "", "sync"]], "torch_xla.backends": [[15, 1, 1, "", "get_mat_mul_precision"], [15, 1, 1, "", "set_mat_mul_precision"]], "torch_xla.core": [[15, 0, 0, "-", "xla_model"]], "torch_xla.core.xla_model": [[15, 1, 1, "", "add_step_closure"], [15, 1, 1, "", "all_gather"], [15, 1, 1, "", "all_reduce"], [15, 1, 1, "", "all_to_all"], [15, 1, 1, "", "get_memory_info"], [15, 1, 1, "", "get_rng_state"], [15, 1, 1, "", "get_stablehlo"], [15, 1, 1, "", "get_stablehlo_bytecode"], [15, 1, 1, "", "is_master_ordinal"], [15, 1, 1, "", "mesh_reduce"], [15, 1, 1, "", "optimizer_step"], [15, 1, 1, "", "rendezvous"], [15, 1, 1, "", "save"], [15, 1, 1, "", "set_rng_state"], [15, 1, 1, "", "wait_device_ops"], [15, 1, 1, "", "xla_device"], [15, 1, 1, "", "xla_device_hw"]], "torch_xla.debug": [[15, 0, 0, "-", "metrics"]], "torch_xla.debug.metrics": [[15, 1, 1, "", "counter_names"], [15, 1, 1, "", "counter_value"], [15, 1, 1, "", "metric_data"], [15, 1, 1, "", "metric_names"], [15, 1, 1, "", "metrics_report"], [15, 1, 1, "", "short_metrics_report"]], "torch_xla.distributed": [[15, 0, 0, "-", "parallel_loader"], [15, 0, 0, "-", "spmd"], [15, 0, 0, "-", "xla_multiprocessing"]], "torch_xla.distributed.parallel_loader": [[15, 2, 1, "", "MpDeviceLoader"]], "torch_xla.distributed.spmd": [[15, 2, 1, "", "HybridMesh"], [15, 2, 1, "", "Mesh"], [15, 1, 1, "", "clear_sharding"], [15, 1, 1, "", "get_1d_mesh"], [15, 1, 1, "", "get_global_mesh"], [15, 1, 1, "", "mark_sharding"], [15, 1, 1, "", "set_global_mesh"]], "torch_xla.distributed.xla_multiprocessing": [[15, 1, 1, "", "spawn"]], "torch_xla.experimental": [[15, 1, 1, "", "eager_mode"]], "torch_xla.runtime": [[15, 1, 1, "", "addressable_device_count"], [15, 1, 1, "", "device_type"], [15, 1, 1, "", "get_master_ip"], [15, 1, 1, "", "global_device_count"], [15, 1, 1, "", "global_ordinal"], [15, 1, 1, "", "global_runtime_device_count"], [15, 1, 1, "", "initialize_cache"], [15, 1, 1, "", "is_spmd"], [15, 1, 1, "", "local_device_count"], [15, 1, 1, "", "local_ordinal"], [15, 1, 1, "", "local_process_count"], [15, 1, 1, "", "use_spmd"], [15, 1, 1, "", "world_size"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"]}, "titleterms": {"learn": [0, 1, 13], "about": [0, 1], "gpu": [0, 12, 13, 14, 26, 38], "tpu": [1, 4, 13, 14, 18, 22, 23, 26, 31, 35, 39], "build": [2, 5], "bazel": 2, "depend": [2, 8, 12], "how": [2, 17, 27, 28, 33, 36], "xla": [2, 3, 4, 7, 8, 13, 15, 17, 18, 19, 20, 21, 22, 23, 26, 31, 33, 36, 39], "librari": 2, "torch": [2, 10, 11, 14, 17, 35], "plugin": [2, 7], "remot": 2, "cach": [2, 9, 18, 21], "run": [2, 3, 18, 20, 22, 35, 38], "test": [2, 3, 6, 20, 30], "code": [2, 4, 22, 33], "coverag": 2, "languag": 2, "server": 2, "pytorch": [2, 3, 4, 5, 7, 8, 10, 13, 15, 17, 18, 19, 20, 21, 22, 23, 31, 36, 39], "codegen": 3, "migrat": 3, "guid": [3, 6, 36], "befor": [3, 6], "you": [3, 5, 6, 9, 25, 34], "start": [3, 6, 13, 25, 34], "file": [3, 5, 6], "structur": [3, 6], "old": 3, "op": [3, 6, 11, 33], "lower": [3, 6, 11, 39], "step": [3, 4, 23], "1": [3, 22, 25, 34], "identifi": 3, "2": [3, 22, 25, 34], "inspect": 3, "gener": [3, 10], "lazyir": 3, "h": 3, "3": [3, 25, 34], "implement": [3, 7, 22], "miss": 3, "ir": 3, "function": [3, 27], "torch_xla": [3, 15, 17, 19, 25], "csrc": 3, "ops_xla_shape_fn": 3, "cpp": 3, "4": 3, "ops_lower_fn": 3, "5": 3, "cleanup": 3, "verifi": [3, 5], "result": 3, "sampl": 3, "pr": 3, "configur": [4, 5], "A": [4, 5, 20], "develop": 4, "environ": [4, 20], "visual": 4, "studio": 4, "creat": [4, 18], "connect": 4, "your": [4, 5, 8], "set": 4, "up": [4, 27], "workspac": 4, "next": [4, 23], "c": [5, 7], "debug": [5, 15, 18, 20, 35], "why": [5, 23], "would": 5, "need": 5, "thi": [5, 9], "instal": [5, 31], "gdb": 5, "The": [5, 20], "gnu": 5, "project": 5, "debugg": 5, "symbol": 5, "built": [5, 8], "vscode": 5, "lldb": 5, "realist": 5, "command": 5, "futur": 5, "work": [5, 17], "understand": [6, 20], "oper": [6, 10, 20, 25, 26, 33, 34], "unit": [6, 20], "tip": 6, "custom": [7, 8, 12], "hardwar": [7, 23, 39], "pjrt": [7, 14], "api": [7, 11, 13, 15, 17], "packag": 7, "kernel": [8, 12], "via": [8, 12], "palla": 8, "adopt": 8, "abov": 8, "compat": [8, 9], "us": [8, 9, 10, 23, 25, 27, 28, 32, 33, 34, 36], "flashattent": 8, "exampl": [8, 9, 22, 26, 30, 31], "usag": [8, 30], "integr": [8, 29, 35], "pagedattent": 8, "write": 8, "own": 8, "optim": [9, 30, 35, 37], "repeat": 9, "layer": 9, "scan": 9, "scan_lay": 9, "when": [9, 25, 34], "should": 9, "limit": [9, 27], "aotautograd": 9, "requir": 9, "compil": [9, 17, 18, 20, 21, 35], "time": [9, 18, 19], "experi": 9, "refer": [9, 13, 22], "export": 10, "stablehlo": 10, "extract_jax": 10, "inlin": 10, "some": [10, 25, 34], "weight": 10, "preserv": 10, "high": 10, "level": 10, "composit": 10, "support": [11, 26, 33], "distribut": [11, 13, 14, 15, 28, 37], "collect": 11, "stack": 11, "non": 11, "dynamo": [11, 20], "case": [11, 19, 25, 30, 34, 39], "descript": 11, "triton": 12, "document": 13, "get": [13, 20, 39], "tutori": 13, "basic": [13, 20], "train": [13, 14, 29, 31], "advanc": [13, 21, 35], "techniqu": 13, "troubleshoot": [13, 20, 34], "contribut": 13, "runtim": [14, 15], "tl": 14, "dr": 14, "benefit": 14, "quickstart": 14, "cpu": [14, 18], "pod": [14, 18, 22, 31, 35], "docker": 14, "singl": [14, 18, 22], "node": 14, "multi": [14, 18], "differ": 14, "from": [14, 18, 25, 34], "xrt": 14, "multithread": 14, "v2": 14, "v3": [14, 31], "chang": 14, "xm": 14, "rendezv": 14, "perform": [14, 17, 19, 20, 24], "new": 14, "backend": 15, "xla_model": 15, "spmd": [15, 32, 35, 36, 38], "experiment": 15, "dynam": [16, 25, 34], "shape": [16, 25, 34], "bound": [16, 25, 34], "s": [17, 25, 34], "interact": 17, "eager": 17, "mode": [17, 36], "overview": [17, 23], "challeng": 17, "lazytensor": 17, "vs": [17, 19], "benchmark": [17, 20, 27, 28], "devic": [18, 22, 35, 36], "an": 18, "tensor": [18, 20, 25, 34], "ar": 18, "model": [18, 33], "multipl": [18, 22], "process": [18, 31, 37], "deep": 18, "dive": 18, "lazi": 18, "memori": [18, 30], "layout": 18, "move": 18, "save": 18, "load": [18, 21, 35], "unexpect": 18, "materi": 18, "dure": 18, "aot": 18, "ahead": 18, "trace": [18, 19, 27], "flag": 18, "recommend": 18, "further": [18, 36], "read": [18, 36], "execut": [19, 20, 21], "illustr": 19, "common": [19, 20], "pitfal": 19, "measur": 19, "onli": 19, "end": 19, "trigger": 19, "ensur": 19, "complet": 19, "studi": 19, "correctli": 19, "profil": [19, 20, 24], "loop": [19, 30], "sync": 19, "saniti": 20, "check": 20, "version": 20, "simpl": [20, 30], "calcul": 20, "resnet": [20, 31], "With": 20, "fake": [20, 28], "data": [20, 21, 28, 31, 32, 35], "tool": [20, 35], "auto": [20, 35], "metric": 20, "analysi": [20, 24], "report": 20, "clear": 20, "known": 20, "caveat": 20, "quirk": 20, "more": 20, "variabl": 20, "combin": 20, "reproduc": 20, "ci": 20, "cd": 20, "failur": 20, "topic": [21, 35], "synchron": 21, "block": 21, "barrier": 21, "graph": 21, "convert": 22, "stabl": 22, "diffus": 22, "infer": [22, 29], "lightn": 22, "hf": 22, "target": 23, "setup": 23, "sourc": 25, "recompil": [25, 34], "let": [25, 34], "first": [25, 34], "fact": [25, 34], "constraint": [25, 34], "input": [25, 34], "dataset": [25, 34], "output": [25, 32, 34], "can": [25, 34], "fix": [25, 34], "without": [25, 34], "queri": [25, 34], "its": [25, 34], "real": [25, 28, 34], "dimens": [25, 34], "what": [25, 34, 36], "control": [25, 30, 34, 39], "flow": [25, 34], "conclus": [25, 34, 39], "appendix": [25, 34], "automat": 26, "mix": 26, "precis": [26, 39], "amp": 26, "best": 26, "practic": 26, "speed": 27, "assume_pur": 27, "background": [27, 28], "motiv": [27, 28], "nn": 27, "modul": [27, 33], "parallel": [28, 31, 32], "ddp": 28, "distributeddataparallel": 28, "resnet50": 28, "mnist": [28, 31], "disclaim": 28, "torchdynamo": 29, "featur": 29, "gap": 29, "take": 29, "awai": 29, "util": 30, "while_loop": 30, "group": [30, 37], "pure": 30, "python": 30, "while": 30, "fulli": [31, 32], "shard": [31, 32, 35, 36], "fsdp": [31, 32], "One": 31, "per": 31, "acceler": 31, "script": 31, "imagenet": 31, "clone": 31, "repo": 31, "8": 31, "50": 31, "10": 31, "billion": 31, "paramet": 31, "gradient": 32, "checkpoint": [32, 37], "quantiz": 33, "call": 33, "swap": 33, "matrix": 33, "multipli": 33, "awar": 35, "host": 35, "virtual": 35, "hybrid": 35, "mesh": [35, 36], "xlashardedtensor": 35, "dtensor": 35, "activ": 35, "user": 36, "partit": 36, "spec": 36, "which": 36, "hold": 36, "checkpointmanag": 37, "restor": 37, "state": 37, "mxu": 39, "float": 39, "point": 39, "introduct": 39, "higher": 39, "math": 39, "prepar": 39, "readi": 39, "look": 39, "directli": 39, "bit": 39, "examin": 39, "number": 39, "fp32": 39, "bfloat16": 39, "edg": 39}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})