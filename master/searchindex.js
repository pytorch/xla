Search.setIndex({"docnames": ["accelerators/gpu", "accelerators/tpu", "contribute/bazel", "contribute/codegen_migration", "contribute/configure-environment", "contribute/op_lowering", "contribute/plugins", "features/distop", "features/pallas", "features/scan", "features/stablehlo", "features/triton", "index", "learn/api-guide", "learn/dynamic_shape", "learn/eager", "learn/pjrt", "learn/pytorch-on-xla-devices", "learn/troubleshoot", "learn/xla-overview", "notes/source_of_recompilation", "perf/amp", "perf/ddp", "perf/dynamo", "perf/fori_loop", "perf/fsdp", "perf/fsdpv2", "perf/quantized_ops", "perf/recompilation", "perf/spmd_advanced", "perf/spmd_basic", "perf/spmd_distributed_checkpoint", "perf/spmd_gpu"], "filenames": ["accelerators/gpu.md", "accelerators/tpu.md", "contribute/bazel.md", "contribute/codegen_migration.md", "contribute/configure-environment.md", "contribute/op_lowering.md", "contribute/plugins.md", "features/distop.md", "features/pallas.md", "features/scan.md", "features/stablehlo.md", "features/triton.md", "index.rst", "learn/api-guide.rst", "learn/dynamic_shape.md", "learn/eager.md", "learn/pjrt.md", "learn/pytorch-on-xla-devices.md", "learn/troubleshoot.md", "learn/xla-overview.md", "notes/source_of_recompilation.md", "perf/amp.md", "perf/ddp.md", "perf/dynamo.md", "perf/fori_loop.md", "perf/fsdp.md", "perf/fsdpv2.md", "perf/quantized_ops.md", "perf/recompilation.md", "perf/spmd_advanced.md", "perf/spmd_basic.md", "perf/spmd_distributed_checkpoint.md", "perf/spmd_gpu.md"], "titles": ["Learn about GPUs", "Learn about TPUs", "Bazel in Pytorch/XLA", "Codegen migration Guide", "Configure a development environment", "OP Lowering Guide", "Custom Hardware Plugins", "Support of Torch Distributed API in PyTorch/XLA", "Custom Kernels via Pallas", "Guide for using <code class=\"docutils literal notranslate\"><span class=\"pre\">scan</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">scan_layers</span></code>", "Torch Export to StableHLO", "Custom GPU Kernels via Triton", "PyTorch/XLA documentation", "PyTorch/XLA API", "Dynamic shape", "Eager Mode + Compile API", "PJRT Runtime", "PyTorch on XLA Devices", "Troubleshoot", "Pytorch/XLA overview", "Source of recompilations in torch_xla", "Automatic Mixed Precision", "How to do DistributedDataParallel(DDP)", "TorchDynamo integration in PyTorch XLA", "Optimize memory utilization using <code class=\"docutils literal notranslate\"><span class=\"pre\">while_loop</span></code>", "Fully Sharded Data Parallel in PyTorch XLA", "Fully Sharded Data Parallel using SPMD", "Quantized Operations for XLA (Experimental feature)", "Source of recompilations in Pytorch/XLA", "PyTorch/XLA SPMD advanced topics", "PyTorch/XLA SPMD User Guide", "Distributed Checkpointing", "Running SPMD on GPU"], "terms": {"For": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 32], "inform": [0, 1, 3, 4, 11, 13, 15, 16, 17, 18, 19, 20, 28, 32], "googl": [0, 1, 8, 16, 17], "cloud": [0, 1, 2, 4, 6, 12, 16, 17, 23, 31], "see": [0, 1, 2, 3, 4, 5, 6, 9, 10, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 25, 28], "machin": [0, 2, 4, 16, 18, 19, 32], "type": [0, 4, 6, 10, 13, 16, 17, 18, 19, 21, 22], "ar": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 25, 27, 28, 29, 30, 31], "custom": [1, 3, 4, 7, 9, 10, 12, 13, 20, 22, 25, 27, 28, 29, 30], "design": [1, 9, 16, 17, 23, 26, 30], "ai": [1, 19], "acceler": [1, 4, 13, 14, 16, 17, 19, 21], "which": [1, 2, 3, 5, 6, 7, 9, 10, 13, 14, 16, 17, 18, 19, 20, 21, 23, 25, 26, 28, 29, 31], "optim": [1, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 28], "train": [1, 8, 9, 13, 14, 17, 18, 19, 21, 29, 31, 32], "infer": [1, 3, 13, 16, 21, 29, 32], "larg": [1, 9, 14, 16, 19, 20, 25, 28, 30], "model": [1, 3, 5, 9, 10, 11, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 25, 26, 28, 29, 30, 31, 32], "thei": [1, 2, 5, 6, 7, 13, 16, 17, 18, 19, 20, 21, 28, 29, 30], "ideal": [1, 2, 3, 20, 23, 28], "varieti": 1, "us": [1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 15, 16, 17, 18, 19, 21, 23, 25, 29, 31, 32], "case": [1, 2, 3, 5, 9, 10, 13, 16, 17, 18, 19, 23, 26, 29], "chatbot": 1, "code": [1, 3, 5, 9, 10, 11, 13, 15, 16, 17, 18, 20, 22, 23, 28, 29], "gener": [1, 5, 13, 15, 16, 17, 18, 19, 20, 28], "media": 1, "content": [1, 13], "synthet": 1, "speech": 1, "vision": [1, 25], "servic": [1, 2, 16], "recommend": [1, 2, 3, 4, 5, 13, 15, 16, 17, 21, 29], "engin": [1, 18], "person": 1, "among": 1, "other": [1, 2, 3, 5, 8, 9, 13, 14, 16, 17, 18, 19, 20, 21, 22, 27, 28, 30], "scale": [1, 10, 13, 16, 21, 23, 30], "cost": [1, 23], "effici": [1, 9, 10, 18, 19, 23, 30], "wide": [1, 5, 20, 28], "rang": [1, 5, 9, 13, 16, 26, 29, 30], "workload": [1, 16, 17, 18, 29, 30], "span": [1, 3], "fine": 1, "tune": [1, 29, 30], "provid": [1, 2, 3, 5, 6, 8, 13, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31], "versatil": 1, "lead": [1, 9, 18, 19], "framework": [1, 12, 15, 20, 27, 28], "includ": [1, 2, 5, 13, 16, 18, 19, 20, 21, 24, 28, 30, 31], "pytorch": [1, 5, 9, 11, 14, 15, 16, 20, 21, 22, 24, 27, 31, 32], "jax": [1, 6, 8, 9, 10, 16], "tensorflow": [1, 2, 6, 13, 16, 18, 20, 28], "seamlessli": 1, "orchestr": 1, "through": [1, 3, 5, 6, 7, 8, 9, 17, 19, 20, 21, 28, 31], "integr": [1, 11, 12, 26, 27, 30], "kubernet": 1, "gke": 1, "leverag": [1, 11, 32], "dynam": [1, 3, 5, 12, 18, 19, 23], "schedul": [1, 19], "improv": [1, 9, 16, 17, 18, 19, 21, 23, 29, 30], "scalabl": 1, "all": [1, 2, 3, 5, 7, 9, 10, 11, 13, 16, 17, 18, 19, 20, 21, 22, 25, 26, 28, 29, 31], "need": [1, 2, 3, 5, 10, 13, 16, 17, 18, 19, 20, 22, 25, 26, 28, 29, 30], "simultan": [1, 30], "look": [1, 3, 5, 9, 17, 18, 19, 29], "simplest": [1, 30], "wai": [1, 2, 5, 7, 8, 10, 13, 16, 17, 19, 20, 22, 23, 27, 28, 29, 30], "develop": [1, 2, 11, 12, 15, 17, 22, 23, 27, 30], "can": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 25, 26, 27, 29, 30, 31, 32], "also": [1, 2, 3, 5, 6, 7, 10, 11, 13, 15, 16, 17, 18, 19, 20, 23, 25, 26, 27, 28, 29, 30], "vertex": 1, "fulli": [1, 12, 15, 16, 18, 30], "manag": [1, 8, 13, 21, 31], "platform": 1, "more": [1, 2, 3, 4, 5, 8, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 28, 29, 30, 32], "introduct": [1, 8], "set": [1, 2, 7, 13, 16, 18, 19, 20, 21, 23, 25, 28, 29, 30, 31], "up": [1, 2, 3, 16, 17, 19, 20, 23, 26, 28], "environ": [1, 2, 12, 16, 17, 19, 22, 29, 30, 31], "resourc": [1, 13, 18], "i": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 29, 31], "free": [2, 5, 10, 14, 18, 21, 22, 25], "softwar": [2, 18], "tool": [2, 5, 19, 25, 30], "autom": 2, "openxla": [2, 6, 10, 15, 23, 27], "both": [2, 4, 5, 7, 16, 19, 20, 21, 23, 25, 26, 27, 28, 30, 31], "make": [2, 4, 10, 11, 15, 16, 17, 18, 19, 20, 22, 23, 28, 29], "good": [2, 3, 5, 19, 20, 28, 29], "fit": [2, 3, 19, 25], "well": [2, 3, 6, 13, 16, 19, 20, 28, 30], "extern": [2, 4, 8], "seen": [2, 19, 23], "workspac": [2, 18], "file": [2, 4, 9, 13, 16, 18, 19, 21, 22], "http_archiv": 2, "name": [2, 4, 5, 13, 16, 18, 20, 26, 28, 29, 30], "org_tensorflow": 2, "strip_prefix": 2, "f7759359f8420d3ca7b9fd19493f2a01bd47b4ef": 2, "url": 2, "http": [2, 3, 4, 8, 9, 10, 11, 13, 16, 18, 19, 25, 29], "github": [2, 3, 4, 5, 9, 11, 13, 16, 18, 19, 22, 25, 29], "com": [2, 3, 4, 8, 9, 11, 13, 16, 18, 19, 25, 29], "archiv": 2, "tar": 2, "gz": 2, "pin": [2, 13], "updat": [2, 3, 7, 10, 17, 19, 20, 21, 28, 29], "point": [2, 3, 4, 5, 6, 13, 19, 20, 21, 28], "thi": [2, 3, 4, 5, 6, 7, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32], "repositori": [2, 16], "differ": [2, 3, 6, 13, 17, 18, 19, 20, 22, 24, 25, 28, 29, 30], "revis": 2, "patch": [2, 18], "mai": [2, 3, 6, 9, 16, 17, 18, 19, 20, 21, 28, 29, 30], "ad": [2, 5, 10, 13, 17, 19, 20, 23, 24, 28, 29], "resolv": 2, "prepar": 2, "hermet": 2, "mechan": 2, "deploi": 2, "becaus": [2, 3, 9, 15, 16, 17, 19, 21, 29], "local": [2, 4, 13, 16, 17, 18, 29], "checkout": [2, 9, 18], "ha": [2, 3, 4, 5, 8, 9, 10, 13, 15, 16, 17, 19, 20, 28, 29, 30], "built": [2, 4, 30], "from": [2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 14, 18, 19, 21, 22, 23, 24, 25, 26, 29, 30, 31], "sourc": [2, 3, 5, 6, 9, 12, 13, 18], "instal": [2, 3, 4, 5, 6, 8, 11, 16, 18, 19], "system": [2, 30], "version": [2, 3, 4, 8, 16, 19, 21, 29], "compat": [2, 16, 27, 31], "e": [2, 4, 6, 7, 10, 13, 14, 16, 18, 19, 20, 21, 25, 27, 28, 29, 30], "g": [2, 4, 6, 7, 10, 13, 14, 16, 18, 19, 20, 27, 28, 29, 30, 31], "codegen": [2, 5, 12], "torchgen": [2, 3], "python": [2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14, 16, 18, 19, 20, 22, 23, 28, 29], "modul": [2, 8, 9, 10, 13, 17, 18, 22, 25, 26, 29], "should": [2, 3, 4, 5, 6, 11, 13, 15, 16, 17, 18, 19, 20, 21, 24, 25, 28, 29, 30, 31], "The": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32], "directori": [2, 3, 5, 9], "either": [2, 5, 7, 13, 16, 18, 20, 21, 28], "bzl": 2, "overriden": 2, "command": [2, 3, 4, 9, 16, 17, 18, 19, 22, 25], "line": [2, 3, 10, 13, 15, 17, 18, 19, 20, 25, 28], "override_repositori": 2, "path": [2, 6, 13, 17, 18, 20, 25, 28], "export": [2, 3, 4, 5, 12, 16, 18, 19], "tf_repo": 2, "torch_repo": 2, "pleas": [2, 3, 5, 7, 13, 16, 17, 18, 19, 21, 25, 26, 27, 29, 32], "sure": [2, 17, 18], "overridden": [2, 3], "appropri": [2, 19], "been": [2, 5, 13, 16, 17, 19, 20, 28, 29], "use_cuda": 2, "0": [2, 3, 4, 6, 9, 10, 11, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 32], "setup": [2, 3, 6, 10, 17, 22], "py": [2, 3, 4, 5, 7, 9, 11, 14, 15, 16, 17, 18, 19, 22, 25, 29, 32], "bdist_wheel": 2, "expect": [2, 3, 6, 11, 15, 16, 18, 20, 23, 27, 28], "object": [2, 10, 13, 29], "present": [2, 31], "new_local_repositori": 2, "build_fil": 2, "pytorch_local_dir": 2, "header": 2, "directli": [2, 3, 5, 6, 13, 16, 17, 18, 19, 20, 21, 25, 28, 29, 31], "share": [2, 3, 6, 16, 17, 18, 29], "libtorch": 2, "so": [2, 3, 6, 10, 11, 13, 14, 16, 17, 18, 19, 20, 25, 28, 31], "same": [2, 3, 5, 6, 9, 11, 13, 15, 16, 17, 18, 19, 20, 21, 24, 27, 28, 29, 30, 32], "where": [2, 4, 7, 8, 9, 13, 14, 16, 17, 18, 19, 20, 25, 26, 28, 30], "lib": [2, 6], "contain": [2, 3, 5, 6, 9, 10, 11, 13, 16, 18, 19, 20, 28, 30], "work": [2, 3, 7, 9, 10, 13, 14, 16, 17, 18, 19, 20, 23, 27, 28, 29, 30], "": [2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18, 19, 21, 22, 23, 27, 29, 30, 31], "requir": [2, 3, 5, 10, 13, 14, 16, 17, 18, 19, 20, 21, 28, 29, 31, 32], "pass": [2, 5, 9, 10, 11, 13, 16, 19, 21, 29, 30], "isystemextern": 2, "compil": [2, 5, 6, 10, 11, 12, 13, 14, 16, 19, 20, 21, 23, 26, 27, 28, 30, 31], "find": [2, 3, 5, 9, 16, 18, 19, 22, 26], "satisfi": [2, 29], "them": [2, 3, 5, 9, 13, 16, 17, 18, 19, 20, 28, 30], "some": [2, 3, 5, 9, 13, 14, 15, 16, 17, 18, 22, 27, 29, 30], "user": [2, 4, 6, 12, 15, 16, 17, 18, 19, 20, 23, 24, 26, 27, 28, 29, 31], "bring": [2, 3, 26], "pybind11": 2, "embed": [2, 9], "link": [2, 3], "against": [2, 22], "libpython": 2, "instead": [2, 7, 13, 15, 16, 17, 18, 19, 20, 22, 23, 25, 28, 29, 31], "These": [2, 3, 5, 8, 9, 16, 19, 27, 31], "pybind11_emb": 2, "option": [2, 3, 4, 6, 13, 16, 18, 19, 27, 29, 31], "transit": [2, 17], "simpl": [2, 3, 8, 9, 16, 19, 21, 25, 30], "torch_xla": [2, 4, 5, 6, 7, 8, 9, 11, 14, 15, 16, 17, 18, 19, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31], "csrc": [2, 5], "runtim": [2, 3, 4, 6, 12, 17, 18, 22, 25, 29, 30, 31], "configr": 2, "via": [2, 4, 12, 16, 24, 25, 26, 29, 30], "bazelrc": 2, "take": [2, 3, 9, 11, 13, 17, 18, 19, 20, 28, 29], "flag": [2, 3, 10, 13, 14, 21], "config": [2, 3, 4, 10], "remote_cach": 2, "configur": [2, 3, 5, 12, 13, 16, 18, 19, 31], "gcloud": [2, 4, 16, 17, 19], "usual": [2, 3, 5, 15, 17, 18], "faster": [2, 16, 19, 20, 23, 28], "authent": [2, 16], "easi": [2, 9, 16, 17, 20, 28], "express": [2, 26, 30], "complex": [2, 11, 23], "lot": [2, 17, 18, 19, 20, 28], "gain": [2, 16], "have": [2, 3, 4, 5, 6, 8, 9, 10, 13, 16, 17, 18, 19, 20, 22, 23, 25, 26, 28, 29, 31], "singl": [2, 9, 13, 15, 20, 22, 23, 25, 26, 28, 29, 30, 32], "graph": [2, 9, 10, 11, 13, 15, 16, 17, 18, 19, 20, 22, 23, 28, 29], "everyth": [2, 20, 22, 28], "therefor": [2, 18, 19], "separ": [2, 3, 5, 17, 19, 23, 25, 26], "rest": [2, 16, 18, 20, 28], "plu": [2, 22, 24], "whole": [2, 13, 15, 20, 23, 28], "everythin": 2, "els": [2, 18, 20, 28], "enough": [2, 19, 20, 28], "normal": [2, 3, 16, 20, 26, 28, 29], "achiev": [2, 5, 15, 22, 30], "invok": [2, 3, 23, 29], "standard": 2, "c": [2, 3, 5, 16, 18, 20, 21, 28], "bind": 2, "simpli": [2, 16], "_xlac": [2, 11, 18, 20, 28], "client": [2, 6, 13, 16], "togeth": [2, 15, 16, 17, 22, 25, 29, 30], "when": [2, 3, 5, 7, 11, 13, 14, 15, 16, 17, 18, 19, 21, 23, 25, 29, 30, 31], "chang": [2, 5, 14, 17, 18, 19, 20, 21, 22, 27, 28, 29], "abl": [2, 17, 20, 28, 31], "without": [2, 5, 10, 13, 16, 18, 19, 29, 30, 31], "iter": [2, 9, 13, 14, 17, 18, 19, 23, 29], "cycl": 2, "come": [2, 13, 20, 28], "There": [2, 3, 10, 15, 17, 18, 19, 20, 22, 23, 28, 29], "plenti": 2, "backend": [2, 3, 7, 13, 15, 16, 20, 23, 24, 27, 28, 29, 31], "we": [2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 32], "our": [2, 3, 4, 5, 6, 7, 8, 14, 16, 17, 18, 20, 21, 22, 23, 28, 29, 30], "gc": [2, 31], "storag": [2, 4, 8, 17, 18, 19, 25, 31], "you": [2, 4, 6, 8, 10, 11, 13, 14, 15, 16, 17, 18, 19, 22, 23, 25, 26, 29, 30, 32], "under": [2, 3, 5, 9, 13, 16, 17, 22], "disabl": [2, 13, 15, 18, 19], "default": [2, 5, 10, 13, 15, 16, 17, 18, 19, 21, 25, 29, 31], "speed": [2, 9, 19, 20, 23, 28], "increment": [2, 3], "huge": [2, 18, 19, 20, 22, 28], "margin": 2, "almost": 2, "alwai": [2, 16, 17, 18, 20, 28, 30], "enabl": [2, 11, 13, 14, 15, 18, 19, 21, 22, 27, 29, 30, 31], "ci": [2, 5], "To": [2, 3, 4, 5, 6, 8, 9, 11, 13, 14, 15, 16, 18, 19, 20, 25, 26, 28, 29, 31, 32], "ensur": [2, 9, 13, 20, 26, 28, 29, 31], "credenti": 2, "auth": [2, 16], "applic": [2, 18, 27, 31], "login": [2, 19], "launch": [2, 13, 16, 17, 19, 22, 23, 25], "browser": 2, "gcp": [2, 4, 16], "variou": [2, 11], "individu": [2, 25, 26, 30], "who": [2, 22], "access": [2, 3, 5, 8, 13, 16, 17, 18, 19, 20, 28, 31], "project": [2, 4, 6, 16, 17, 19], "one": [2, 3, 5, 8, 9, 13, 16, 17, 18, 19, 20, 23, 24, 25, 26, 28, 29, 30, 32], "onli": [2, 3, 5, 7, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 28, 30, 31], "specifi": [2, 7, 10, 13, 17, 19, 25, 29, 30], "google_default_credenti": 2, "token": [2, 15, 19, 27], "out": [2, 5, 9, 13, 14, 15, 16, 17, 18, 19, 21, 23, 29], "box": [2, 5, 29], "log": [2, 18, 19], "permiss": 2, "add": [2, 3, 5, 11, 13, 17, 18, 19, 20, 23, 24, 25, 28], "new": [2, 3, 4, 5, 7, 15, 17, 18, 19, 20, 23, 28, 29], "role": 2, "In": [2, 3, 5, 6, 7, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 28, 29, 30, 31], "account": [2, 19], "kei": [2, 4, 6, 9, 16, 18, 19, 31], "google_credenti": 2, "On": [2, 16, 31], "docker": 2, "network": [2, 13, 16, 17, 18, 21, 29, 30], "cloudbuild": 2, "down": [2, 5, 19], "imag": [2, 16, 19, 20, 22, 25, 28], "do": [2, 3, 5, 10, 12, 14, 16, 17, 18, 19, 20, 21, 25, 27, 28, 29], "doe": [2, 3, 13, 14, 16, 17, 18, 19, 20, 21, 28, 29, 30], "read": [2, 4, 5, 13, 16, 29], "write": [2, 5, 11, 13, 17, 30], "silo": 2, "each": [2, 3, 5, 7, 11, 13, 16, 17, 18, 19, 20, 23, 25, 26, 28, 29, 30, 31], "uniqu": [2, 17, 19, 20, 28], "benefit": [2, 19, 26, 27, 31], "consist": [2, 7, 16], "remote_default_exec_properti": 2, "some_silo_kei": 2, "bazel_remote_cach": 2, "1": [2, 4, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18, 21, 22, 23, 24, 25, 26, 29, 30, 32], "silo_nam": 2, "your": [2, 3, 6, 8, 9, 16, 17, 18, 19, 20, 22, 26, 28, 29, 30, 31], "tpuvm_mod": 2, "gcloud_service_key_fil": 2, "application_default_credenti": 2, "json": 2, "might": [2, 3, 5, 13, 17, 18, 19, 20, 28], "help": [2, 9, 18, 19, 20, 28], "too": [2, 18, 20, 28], "cannot": [2, 8, 9, 19, 20, 21, 25, 28], "here": [2, 3, 5, 8, 10, 14, 17, 19, 20, 22, 23, 25, 26, 28, 29, 30, 31], "author": 2, "usernam": 2, "behavior": [2, 3, 5, 16, 17, 18, 21], "function": [2, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 18, 19, 23, 24, 26, 27, 31], "intend": 2, "first": [2, 3, 4, 9, 10, 11, 13, 14, 16, 18, 19, 22, 29, 30, 31, 32], "time": [2, 3, 4, 13, 14, 16, 17, 18, 19, 20, 23, 24, 28, 29], "slow": [2, 9, 18, 19], "scratch": [2, 3], "veri": [2, 6, 8, 9, 15, 17, 19, 20, 28], "fast": [2, 20, 28], "onc": [2, 7, 13, 17, 18, 19, 20, 23, 28, 29], "again": [2, 3, 17, 19], "bit": [2, 17, 27], "slower": [2, 9, 18, 19, 22], "per": [2, 13, 16, 17, 18, 21, 22, 23, 27], "until": [2, 13, 17, 19, 31], "next": [2, 9, 13, 18, 19, 20, 27, 28, 29], "quit": 2, "current": [2, 6, 8, 13, 14, 15, 16, 17, 19, 20, 23, 24, 26, 27, 28, 29, 32], "migrat": [2, 12, 16], "futur": [2, 3, 4, 6, 14, 16, 17, 18, 19, 20, 26, 28], "plafrom": 2, "cpp": [2, 5], "main": [2, 3, 4, 7, 10, 11, 15, 16, 29], "Of": 2, "cours": 2, "pjrt": [2, 12, 13, 17, 29], "Not": 2, "environment": 2, "variabl": [2, 4, 14, 16, 19, 20, 28], "miss": [2, 5, 13, 18], "common": [2, 16, 20, 26, 27, 28, 30, 31], "part": [2, 3, 6, 11, 13, 15, 16, 18, 19, 29], "ones": [2, 13, 20, 28], "helper": [2, 3, 13], "script": [2, 3, 4, 8, 16, 17, 18, 19, 21, 22, 32], "run_test": 2, "sh": 2, "r": [2, 19], "xla_client": 2, "pure": [2, 3], "easili": [2, 5, 20, 23, 28], "execut": [2, 11, 13, 15, 16, 17, 19, 20, 21, 22, 23, 28, 29, 30, 32], "parallel": [2, 12, 13, 16, 18, 22, 29, 30], "sinc": [2, 3, 5, 16, 17, 18, 19, 20, 21, 22, 23, 26, 28, 31], "xrt": [2, 13], "port": [2, 16, 32], "gpu": [2, 5, 6, 8, 12, 14, 18, 19, 29], "tpu": [2, 3, 5, 6, 8, 9, 12, 13, 14, 18, 22, 23, 24, 30, 31, 32], "devic": [2, 3, 4, 5, 6, 7, 9, 12, 13, 14, 15, 16, 18, 20, 21, 22, 23, 24, 27, 28, 31], "avail": [2, 13, 16, 17, 18, 19, 20, 25, 28, 32], "reason": [2, 3, 5, 15, 16, 19, 22], "bundl": 2, "target": [2, 15, 16, 17, 19, 20, 21, 23, 28], "sequenti": [2, 13], "calcul": 2, "visual": [2, 29, 30], "lcov": 2, "describ": [2, 3, 4, 10, 13, 17, 19, 21, 22, 30], "document": [2, 3, 4, 5, 6, 10, 16, 17, 21, 22, 27], "editor": 2, "choic": [2, 20, 28], "gutter": 2, "vscode": 2, "power": 2, "like": [2, 3, 4, 5, 8, 9, 10, 13, 16, 17, 18, 19, 20, 21, 25, 28, 29], "clangd": 2, "refer": [2, 3, 5, 7, 8, 11, 13, 14, 16, 17, 25, 27, 29, 30, 32], "autocomplet": 2, "semant": [2, 5, 18, 20, 28], "understand": [2, 10, 19, 20, 28], "underli": [2, 13, 17, 30], "stack": [2, 9, 17, 18, 20, 21, 28, 29], "combin": [2, 5, 9, 13, 20, 28], "studio": 2, "extens": [2, 4, 5, 6], "featur": [2, 8, 10, 14, 16, 18, 22, 26, 29, 30, 31], "assist": 2, "edit": 2, "As": [2, 3, 10, 19, 20, 26, 28], "distutil": 2, "ltc": 3, "lazi": [3, 18, 19, 20, 23, 28, 29], "tensor": [3, 5, 7, 9, 10, 13, 14, 16, 19, 21, 23, 24, 26, 27, 29, 30], "core": [3, 5, 7, 13, 15, 16, 17, 18, 19, 22, 23, 24, 25, 26, 27, 30], "clean": [3, 18, 23], "exist": [3, 13, 15, 16, 17, 18, 23, 29], "stub": 3, "over": [3, 9, 13, 15, 16, 17, 19, 25, 30, 31], "6": [3, 4, 5, 9, 13, 18, 19, 20, 28, 30], "were": [3, 17, 18, 19, 20, 28], "complet": [3, 13, 17, 18], "process": [3, 5, 6, 7, 11, 13, 15, 16, 18, 19, 22, 25, 27], "found": [3, 16, 19], "ref": [3, 4, 16], "oper": [3, 7, 9, 11, 12, 13, 16, 17, 19, 30, 31], "xla_native_funct": [3, 5], "yaml": [3, 5], "blob": [3, 7, 9, 11, 13, 16, 29], "master": [3, 9, 13, 16, 17, 31], "_": [3, 9, 16, 23, 24], "replac": [3, 9, 19, 24], "support": [3, 6, 8, 9, 10, 11, 13, 14, 16, 20, 23, 24, 25, 28, 29, 31, 32], "an": [3, 4, 5, 6, 7, 8, 9, 10, 13, 16, 18, 19, 20, 21, 22, 23, 25, 26, 28, 29, 30, 31], "equival": 3, "full_codegen": 3, "NOT": 3, "introduc": [3, 7, 8, 15, 16, 18, 19, 22, 29], "ani": [3, 8, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 28, 29, 30, 31, 32], "purpos": [3, 5, 9, 27], "info": [3, 13, 18, 20, 28, 30], "about": [3, 4, 15, 16, 17, 19, 20, 28, 30], "dispatch": [3, 5, 31], "exyang": 3, "blog": 3, "post": [3, 13, 18], "follow": [3, 5, 8, 9, 10, 11, 13, 15, 16, 17, 18, 19, 20, 22, 25, 26, 28, 29, 30, 32], "instruct": [3, 5, 19], "depend": [3, 4, 5, 14, 15, 17, 19, 20, 21, 28, 30], "build": [3, 5, 17, 19, 25], "It": [3, 4, 5, 7, 13, 14, 15, 17, 19, 20, 23, 25, 26, 27, 28, 29, 30], "experi": [3, 5, 15, 16, 22, 31], "workstat": [3, 5], "cpu": [3, 5, 7, 13, 18, 19, 20, 25, 27, 28, 29, 31], "pjrt_devic": [3, 5, 6, 14, 16, 17, 18, 22, 24, 32], "re": [3, 13, 15, 16, 18, 19, 20, 21, 24, 26, 28], "familiar": [3, 17, 26], "issu": [3, 5, 9, 13, 15, 16, 17, 18, 19, 21, 22, 26], "3560": 3, "track": [3, 18, 31], "statu": [3, 18], "put": [3, 5, 17, 18, 22], "alia": [3, 7, 13], "avoid": [3, 18, 19, 21], "duplic": 3, "mention": [3, 5, 20, 23, 28], "below": [3, 5, 7, 10, 15, 16, 19, 20, 21, 28, 31, 32], "live": [3, 5, 13, 20, 28], "folder": [3, 4, 5], "except": [3, 5, 19, 29], "torch": [3, 4, 8, 9, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31], "shape_infer": 3, "shape": [3, 5, 8, 9, 10, 11, 12, 13, 18, 19, 24, 29, 30], "defin": [3, 5, 8, 10, 11, 13, 19, 21, 24, 26, 29, 30], "input": [3, 5, 7, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 24, 26, 29, 30, 31], "return": [3, 5, 6, 7, 8, 9, 10, 13, 15, 17, 18, 19, 20, 22, 23, 24, 27, 28, 29, 31], "output": [3, 4, 7, 8, 9, 10, 11, 13, 16, 17, 18, 21, 22, 23, 24, 25, 29], "manual": [3, 5, 8, 15, 18, 25], "gen_lazy_tensor": 3, "data": [3, 7, 12, 13, 15, 16, 17, 19, 20, 21, 23, 28, 30, 31], "aten": [3, 5, 10, 18, 20, 28], "specif": [3, 9, 13, 17, 19, 21, 22, 27, 30], "run_gen_lazy_tensor": 3, "dest": 3, "lazy_ir": 3, "class": [3, 6, 7, 9, 10, 13, 22, 25, 27, 30, 31], "genlazyir": 3, "back": [3, 5, 13, 17, 18, 19, 29], "todai": [3, 14], "most": [3, 6, 13, 16, 18, 23], "categori": [3, 26], "goal": [3, 4, 5, 7, 15], "move": [3, 13, 16, 18, 20, 22, 28, 31], "necessari": [3, 13, 18, 21], "call": [3, 5, 7, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 28, 29, 31], "upstream": [3, 7, 14, 23], "api": [3, 5, 10, 12, 16, 17, 20, 22, 23, 25, 27, 28, 29, 30, 31], "xlanativefunct": [3, 5], "column": 3, "declar": [3, 5], "anoth": [3, 14, 17, 18, 19, 20, 28], "wrap": [3, 5, 6, 8, 13, 15, 17, 19, 21, 22, 25, 26, 27, 29], "around": [3, 16, 20, 25, 28, 30], "xlatensor": [3, 5, 13, 29], "construct": [3, 5, 17, 19, 25, 29, 30, 31], "aten_xla_typ": [3, 5], "Will": 3, "method": [3, 10, 13, 16, 21, 26, 29, 31], "map": [3, 5, 7, 13], "node": [3, 5, 7, 11, 18, 20, 28, 32], "remov": [3, 16, 18, 19], "tensor_method": [3, 5], "possibl": [3, 16, 17, 18, 19, 25, 26, 29], "multipl": [3, 7, 13, 15, 20, 23, 27, 28, 30], "few": [3, 17, 18, 19, 20, 22, 28, 31], "simpler": [3, 16], "go": [3, 15, 17, 19, 21, 29], "unari": 3, "binari": [3, 6, 23], "exampl": [3, 4, 5, 6, 7, 10, 13, 14, 15, 16, 17, 18, 20, 22, 23, 27, 28, 29, 30, 31, 32], "characterist": 3, "fallback": [3, 5], "_adaptive_avg_pool3d": 3, "condit": [3, 20, 24, 28], "issupportedadaptivepool": 3, "xlahelp": 3, "i64list": 3, "self": [3, 5, 6, 7, 9, 10, 13, 19, 22, 27, 29], "size": [3, 7, 9, 11, 14, 16, 17, 18, 19, 20, 28, 30, 31], "output_size_list": 3, "pool_dim": 3, "nativ": [3, 5, 15, 16, 18, 21, 22, 29], "call_fallback_fn": 3, "xla_fallback": 3, "aten_op": 3, "output_s": 3, "wip": 3, "evolv": 3, "At": [3, 6, 13], "self_tensor": 3, "static": [3, 14, 20, 28], "bool": [3, 13], "sync_upd": 3, "sys_util": 3, "getenvbool": 3, "xla_tensor_update_sync": 3, "true": [3, 13, 15, 16, 19, 20, 22, 25, 28, 29, 31], "xla_check": 3, "dst_tensor": 3, "updatefromtensor": 3, "sync": [3, 13, 15, 18, 19, 21], "complic": [3, 5, 8], "would": [3, 4, 5, 9, 13, 16, 17, 18, 19, 20, 24, 28], "someth": [3, 9, 19], "ab": [3, 25], "const": [3, 5, 7], "torch_lazy_fn_count": 3, "bridg": [3, 23], "atenfromxlatensor": 3, "getxlatensor": 3, "fail": [3, 13, 17, 18, 31], "explain": [3, 6, 17, 18, 19, 20, 28, 30], "later": [3, 19], "still": [3, 7, 16, 17, 20, 21, 22, 28, 31], "If": [3, 4, 5, 9, 13, 16, 17, 18, 19, 20, 27, 28, 29, 30], "while": [3, 7, 9, 10, 13, 19, 20, 22, 28], "error": [3, 10, 13, 17, 18], "involv": [3, 20, 28, 29], "problem": [3, 9, 20, 28], "yet": [3, 5, 7], "attempt": [3, 31], "unblock": [3, 31], "snippet": [3, 17, 29, 30], "auto": [3, 5, 13, 25, 31], "common_devic": 3, "getxladevic": 3, "torch_internal_assert": 3, "xlatensorptr": 3, "lazy_self": 3, "getxlatensororcreateforwrappednumb": 3, "nodeptr": 3, "reusenod": 3, "getirvalu": 3, "makenod": 3, "cachenod": 3, "creat": [3, 10, 11, 13, 16, 18, 19, 21, 22, 29, 30, 31], "std": [3, 7, 22], "get": [3, 5, 13, 14, 15, 16, 19, 20, 22, 25, 27, 28], "check": [3, 4, 5, 10, 13, 17, 27, 30], "reus": [3, 9, 17, 19, 21], "previou": [3, 16, 17, 19, 20, 28, 30], "creation": [3, 13], "correspond": [3, 5, 7, 13, 19, 21, 25, 29, 30], "cach": [3, 8, 13, 14, 19], "newli": 3, "And": [3, 20, 22, 28, 29], "within": [3, 13, 17, 18, 19, 27, 30, 31], "note": [3, 4, 7, 8, 11, 13, 15, 16, 17, 18, 19, 20, 23, 25, 26, 27, 28, 30], "done": [3, 4, 8, 17, 18, 19, 20, 28], "public": [3, 16], "xlanod": 3, "xlavalu": 3, "opkind": [3, 5], "absoutputshap": 3, "num_output": [3, 20, 28], "mhash": 3, "string": [3, 7, 13, 29], "tostr": 3, "overrid": [3, 13, 21], "stringstream": 3, "ss": 3, "str": [3, 6, 10, 13], "xlaopvector": 3, "loweringcontext": 3, "loctx": 3, "A": [3, 4, 6, 13, 16, 17, 19, 20, 21, 26, 27, 28, 29, 30], "coupl": [3, 17, 18], "thing": [3, 18, 19], "keep": [3, 4, 14, 16, 18, 20, 28], "mind": [3, 16, 18], "clone": [3, 16, 18, 19], "even": [3, 13, 16, 17, 18, 20, 22, 28], "everi": [3, 5, 8, 9, 13, 16, 17, 18, 20, 23, 28, 29, 31], "outputshap": 3, "xla_shap": 3, "overli": 3, "simplifi": 3, "buildxxxop": 3, "slightli": [3, 5, 13], "better": [3, 5, 15, 16, 17, 18, 19, 20, 23, 24, 28], "maximumoutputshap": 3, "lower_for_shape_fn": 3, "absl": 3, "xlaop": [3, 5], "operand": 3, "promot": 3, "max": [3, 20, 28, 31], "second": [3, 9, 10, 11, 14, 16, 18, 19, 22, 30, 32], "inferoutputshap": 3, "comput": [3, 4, 13, 16, 17, 18, 19, 20, 21, 28, 29, 30], "logic": [3, 9, 13, 15, 20, 24, 28, 29, 30], "two": [3, 6, 13, 16, 18, 19, 20, 28, 29, 30], "xla_input": 3, "getoutputop": 3, "returnop": 3, "buildab": 3, "origin": [3, 19], "genericop": 3, "modifi": [3, 19, 21, 23, 29], "abov": [3, 5, 6, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 28, 30], "delet": 3, "sometim": [3, 19, 20, 28], "being": [3, 13, 17, 19, 22, 30], "tensor_op": 3, "cross": [3, 13, 17, 29], "s1": [3, 29], "sub": 3, "mul": [3, 20, 28], "u2": 3, "v3": [3, 17, 22], "u3": 3, "v2": [3, 4, 17], "irnod": 3, "those": [3, 5, 13, 18, 19, 22], "long": [3, 9, 15, 18, 19, 20, 22, 28], "term": [3, 11, 15, 18, 20, 28], "rid": [3, 20, 28], "composit": [3, 5], "end": [3, 5, 11, 13, 14, 16, 17, 18, 19, 22, 25, 26], "exp": 3, "pow": 3, "norm_exp": 3, "vector": [3, 11], "don": [3, 5, 14, 15, 16, 17, 18, 20, 25, 28], "t": [3, 5, 13, 14, 15, 16, 17, 18, 20, 21, 25, 26, 28, 29, 30, 31], "build_cpp_test": 3, "skip": [3, 5, 18, 23], "desir": [3, 19, 30, 31], "test_ptxla": 3, "gtest_filt": 3, "atenxlatensortest": 3, "testab": 3, "correct": [3, 20, 28], "counter": [3, 5, 13, 18], "correctli": [3, 18, 26], "bitwise_left_shift": 3, "pull": [3, 21, 22, 25], "8865": 3, "gt": [3, 4, 10, 16, 19], "erf": 3, "erfc": 3, "erfinv": 3, "3659": 3, "binary_cross_entropi": [3, 21], "backward": [3, 5, 9, 15, 16, 17, 21, 22, 23, 25, 26], "3809": 3, "scalar": [3, 5, 18, 20, 28], "addcdiv": 3, "addcmul": 3, "3768": 3, "neg": 3, "index": [3, 4, 6, 13, 16, 17, 18, 19, 30, 32], "amin": 3, "amax": 3, "3771": 3, "special": [3, 10, 11, 19, 29], "partial": [3, 20, 25, 26, 28], "adaptive_avgpool3d": 3, "3790": 3, "guid": [4, 12, 16, 17, 19, 25, 26, 29], "interact": [4, 16], "start": [4, 15, 16, 17, 18, 19], "colab": [4, 18], "kaggl": 4, "preinstal": [4, 16], "ecosystem": [4, 27], "packag": [4, 11, 12, 17, 19, 21, 22], "date": 4, "list": [4, 5, 9, 13, 19, 21, 24, 29, 30], "readm": [4, 18, 19], "prerequisit": 4, "remot": 4, "quota": 4, "request": [4, 5, 13, 18, 19, 20, 21, 22, 28, 29, 30], "offici": [4, 18], "ssh": [4, 16, 17, 19], "regist": [4, 5, 6, 7, 10, 16, 31], "agent": 4, "alreadi": [4, 8, 11, 13, 18, 19, 20, 22, 25, 28, 31], "befor": [4, 7, 8, 13, 16, 17, 18, 19, 20, 21, 22, 23, 26, 28, 29, 31], "begin": [4, 17, 29], "zone": [4, 16, 17, 19], "tpu_typ": 4, "8": [4, 10, 11, 13, 15, 16, 17, 19, 20, 22, 23, 27, 28, 29, 30], "vm": [4, 16, 17, 18, 19, 22], "assum": [4, 6, 8, 13, 17, 20, 22, 26, 28, 29, 30], "id_ed25519": 4, "ubuntu2204": 4, "base": [4, 7, 13, 15, 16, 18, 19, 20, 25, 28, 29, 30], "metadata": [4, 18], "cat": [4, 21], "pub": 4, "ip": [4, 13, 16, 31, 32], "format": [4, 10, 13, 18, 19, 23, 27], "valu": [4, 5, 9, 11, 13, 14, 16, 18, 19, 20, 24, 28, 29, 32], "networkendpoint": 4, "accessconfig": 4, "externalip": 4, "123": 4, "give": [4, 18, 19, 27, 29, 30], "friendli": 4, "easier": [4, 15, 19, 20, 28], "echo": 4, "host": [4, 13, 16, 17, 18, 19, 21, 25, 31, 32], "n": [4, 13, 22, 27, 30], "hostnam": 4, "test": [4, 6, 8, 11, 14, 16, 22, 25, 32], "v": [4, 8, 9, 10, 16, 20, 28], "palett": 4, "select": [4, 13, 16, 31], "visualstudio": 4, "doc": [4, 9, 13, 15, 16, 17, 20, 26, 28, 29], "__": [4, 16], "just": [4, 8, 15, 16, 17, 20, 22, 25, 28, 31], "titl": [4, 16], "open": [4, 5, 6, 16, 18], "window": 4, "termin": [4, 31], "mkdir": 4, "ptxla": 4, "Then": [4, 10, 19], "ui": 4, "venv": 4, "virtual": [4, 13], "latest": [4, 9], "releas": [4, 6, 7, 8, 9, 16, 17, 18, 19, 23, 25, 26, 27, 29], "pip": [4, 8, 11, 19], "numpi": [4, 8, 10, 13, 19, 30], "f": [4, 8, 10, 13, 17, 22, 25, 27, 31], "googleapi": [4, 8, 19], "libtpu": [4, 6, 16], "wheel": [4, 19, 25], "html": [4, 8, 9, 16, 25], "import": [4, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 22, 23, 24, 25, 26, 27, 29, 30, 31], "set_device_typ": 4, "print": [4, 9, 10, 13, 14, 16, 17, 18, 19, 20, 22, 23, 28, 29, 31], "real_devic": 4, "run": [4, 5, 8, 9, 11, 12, 13, 14, 15, 16, 20, 21, 22, 23, 27, 28, 30, 31], "2": [4, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 23, 24, 25, 27, 29, 30, 32], "3": [4, 5, 6, 8, 9, 10, 11, 13, 15, 18, 19, 23, 24, 25, 27, 29, 30], "4": [4, 6, 8, 9, 10, 13, 16, 17, 18, 19, 20, 23, 24, 25, 27, 28, 29, 30], "5": [4, 7, 9, 13, 14, 18, 19, 20, 22, 25, 27, 28, 30], "7": [4, 13, 18, 22, 23, 30], "number": [4, 11, 13, 14, 15, 16, 18, 19, 25, 29, 30], "vari": [4, 16, 20, 26, 28], "That": [4, 9, 20, 28], "now": [4, 7, 10, 11, 15, 16, 17, 19, 20, 28, 29], "realist": 4, "librari": [5, 6, 10, 19, 30, 31], "offer": [5, 10, 26, 27], "implement": [5, 7, 8, 9, 15, 16, 18, 20, 23, 25, 26, 28], "xla": [5, 9, 10, 11, 14, 15, 16, 20, 22, 24, 26, 31, 32], "its": [5, 7, 14, 16, 17, 18, 22, 23, 25, 29, 30], "convert": [5, 10, 13, 17, 22], "higher": [5, 9, 18, 31], "level": [5, 9, 18, 19, 23, 27, 31], "represent": [5, 9, 13, 17, 19], "hlo": [5, 9, 13, 17, 18, 19], "beyond": 5, "scope": 5, "forward": [5, 10, 15, 21, 22, 23, 26, 27], "haven": [5, 20, 28], "caus": [5, 13, 15, 16, 17, 18, 19, 20, 21, 28], "signific": [5, 18, 19, 23], "slowdown": [5, 18, 22], "must": [5, 6, 7, 9, 13, 16, 17, 18, 26, 31, 32], "best": [5, 8, 23, 27, 30], "perform": [5, 7, 8, 10, 11, 13, 15, 17, 21, 22, 23, 25, 27, 29], "what": [5, 17, 19], "debug": [5, 15, 20, 27, 28, 30], "pt": [5, 16, 17, 18, 19], "profil": [5, 16], "_ctc_loss": [5, 18], "_ctc_loss_backward": [5, 18], "contribut": 5, "definit": [5, 17, 20, 28], "native_funct": 5, "after": [5, 7, 9, 13, 16, 17, 18, 19, 20, 24, 28, 29], "kernel": [5, 9, 10, 12, 20, 27, 28], "aten_fallback": 5, "h": 5, "search": 5, "repo": [5, 17, 18, 19, 22], "sequenc": [5, 9, 13], "explicitli": [5, 17, 18, 19, 20, 21, 28], "compos": 5, "match": [5, 10, 13, 17, 18], "serv": [5, 19], "interfac": [5, 6, 17, 18, 26, 31], "machineri": [5, 10], "registerxla": 5, "registerautogradxla": 5, "entri": [5, 6], "pytorch_xla": 5, "world": [5, 8, 16, 20, 23, 28, 31], "written": [5, 19, 31], "paramet": [5, 13, 16, 17, 18, 21, 22, 26, 29, 31, 32], "result": [5, 7, 9, 13, 14, 16, 17, 18, 19, 22, 24, 29], "wrapper": [5, 17, 22, 25, 26], "inplac": [5, 13, 29], "ir": [5, 13, 18, 19, 20, 28], "insid": [5, 17, 19, 29], "stand": 5, "intermedi": [5, 9, 16, 18, 19], "smaller": [5, 19, 20, 28], "inherit": 5, "dai": 5, "addit": [5, 6, 11, 16, 17, 18, 19, 21, 22], "unless": [5, 18, 20, 28], "want": [5, 9, 10, 13, 15, 16, 17, 18, 19, 20, 23, 28, 29, 30, 32], "verifi": 5, "test_oper": 5, "test_aten_xla_tensor": 5, "yield": [5, 17, 18], "break": [5, 19, 20, 28], "grasp": 5, "capabl": 5, "how": [5, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 28, 29, 32], "similar": [5, 16, 19, 22, 24, 27], "minim": [5, 19], "pr": [5, 18, 25], "vanilla": 5, "lerp": 5, "variant": [5, 20, 21, 28], "lerp_": 5, "scalar_out": 5, "tensor_out": 5, "prototyp": [5, 29], "weight": [5, 10, 13, 18, 26, 27], "lerp_out": 5, "howev": [5, 8, 9, 10, 18, 19, 29], "namespac": [5, 18], "wrapper_scalar_lerp": 5, "No": [5, 14, 16, 20, 27, 28], "deviceguard": 5, "omit": [5, 16, 30, 32], "anonym": 5, "wrapper_scalar_lerp_": 5, "wrapper_scalar_lerp__tmp": 5, "_copy_from": 5, "m": [5, 7, 10, 20, 25, 28, 30], "impl": [5, 7, 10], "torch_fn": 5, "automat": [5, 6, 12, 13, 16, 17, 18, 19, 20, 25, 28, 30, 31], "u": [5, 16, 18, 19, 20, 23, 28], "explicit": [5, 21, 25], "place": [5, 7, 13, 19, 21, 29, 31], "ll": [5, 9, 20, 28], "interned_str": 5, "symbol": [5, 20, 28], "submit": [5, 18, 19, 21], "team": [6, 23], "direclti": 6, "tf": [6, 18, 20, 28], "close": 6, "expos": [6, 16, 17, 19, 29], "deviceplugin": 6, "handl": [6, 15, 18, 20, 25, 26, 28, 29, 30], "short": [6, 18, 20, 28], "pjrtclient": 6, "mirror": 6, "pjrt_api": 6, "straightforward": [6, 13, 19], "detail": [6, 7, 8, 9, 10, 13, 14, 16, 17, 18, 19, 20, 28, 30], "concret": [6, 20, 28], "placehold": 6, "pjrt_library_path": 6, "extra": [6, 22, 26], "multiprocess": [6, 13, 16, 17], "compon": 6, "least": [6, 19], "cpuplugin": 6, "def": [6, 7, 8, 9, 10, 11, 13, 15, 16, 17, 19, 22, 23, 24, 26, 27], "library_path": 6, "o": [6, 16, 22], "join": [6, 13], "dirnam": 6, "__file__": 6, "pjrt_c_api_cpu_plugin": 6, "identifi": [6, 13, 30, 31], "exmapl": 6, "pyproject": 6, "toml": 6, "torch_xla_cpu_plugin": 6, "With": [6, 8, 14, 16, 20, 23, 28], "initi": [6, 7, 13, 16, 17, 19, 22, 24, 31], "experiment": [6, 8, 9, 11, 12, 14, 15, 16, 17, 22, 23, 24, 26, 29, 31], "state": [6, 9, 13, 25], "becom": [6, 8, 9, 16, 18, 19, 20, 28], "stabl": [6, 16, 25], "xla_model": [7, 16, 17, 18, 19, 22, 23, 24, 25, 26, 27, 30], "adopt": [7, 20, 28], "traceabl": [7, 9], "commun": [7, 8, 13, 16, 17, 19, 23, 30], "reimplement": [7, 16], "_c10d_function": 7, "figur": [7, 9, 14, 30], "show": [7, 9, 10, 16, 17, 18, 22], "all_reduc": [7, 13, 21], "between": [7, 14, 16, 17, 18, 19, 20, 21, 22, 24, 28, 29], "processgroupxla": 7, "deriv": 7, "processgroup": 7, "xla_backend": [7, 16, 22, 31], "_create_xla_process_group": 7, "prefix_stor": 7, "rank": [7, 13, 16, 22, 25, 30, 31], "timeout": 7, "assert": [7, 22], "xr": [7, 13, 16, 17, 21, 22, 25, 26, 29, 30, 31], "is_spmd": [7, 13], "spmd": [7, 12, 17, 19, 31], "group": [7, 13, 16, 22, 29], "_register_xla_backend": 7, "dist": [7, 16, 22, 31], "register_backend": 7, "allreduc": 7, "all_reduce_opt": 7, "allgath": 7, "output_tensors_list": 7, "input_tensor": 7, "opt": [7, 17], "none": [7, 8, 10, 13, 18, 26, 29, 30], "_mp_fn": [7, 16, 17], "init_process_group": [7, 16, 22, 31], "init_method": [7, 16, 31], "progress": [7, 19], "instanc": [7, 8, 13, 25, 31], "distributed_c10d": 7, "_exception_logg": 7, "all_gath": [7, 13, 16], "tensor_list": 7, "async_op": 7, "fals": [7, 10, 13, 17, 25, 29], "_get_default_group": 7, "certain": [7, 18, 20, 21, 28], "remap": 7, "_functional_collect": 7, "all_reduce_inplac": 7, "eventu": 7, "reach": [7, 13], "rewrit": [7, 19, 20, 28, 29], "reduceop": 7, "group_nam": 7, "torch_library_impl": 7, "four": [7, 19], "align": [7, 15], "signatur": 7, "remain": [7, 17, 19, 20, 28, 32], "restrict": 7, "appli": [7, 9, 13, 21, 25, 26, 31], "usag": [7, 13, 18, 19, 20, 25, 26, 28, 31], "test_collective_ops_tpu": 7, "demonstr": [7, 9, 19, 21, 26, 31], "scenario": [7, 23], "sum": [7, 9, 13, 21, 25, 26], "reduct": [7, 13], "aggreg": 7, "all_gather_into_tensor": 7, "gather": [7, 13, 18, 29], "reduce_scatter_tensor": 7, "reduc": [7, 9, 13, 14, 15, 16, 17, 18, 19, 25], "across": [7, 13, 16, 17, 18, 25, 30], "all_to_all_singl": 7, "output_split_s": 7, "input_split_s": 7, "although": [7, 16, 20, 28], "accept": [7, 29], "argument": [7, 11, 13, 19, 21, 23, 25], "limit": [7, 13, 16, 17], "reflect": [7, 30], "compromis": 7, "maintain": 7, "constraint": [7, 16, 18], "alltoal": [7, 13], "rise": 8, "openai": [8, 11], "triton": [8, 12], "popular": 8, "order": [8, 9, 13, 17, 18, 19, 29, 30], "pariti": 8, "continu": [8, 16, 23], "push": 8, "let": [8, 16, 17, 18, 19, 23, 30], "custom_kernel": 8, "jax_import_guard": 8, "pl": [8, 16, 17, 29], "jnp": [8, 10], "add_vectors_kernel": 8, "x_ref": 8, "y_ref": 8, "o_ref": 8, "x": [8, 9, 10, 11, 13, 17, 18, 19, 20, 22, 24, 25, 26, 27, 28, 29, 30], "y": [8, 9, 10, 11, 13, 18, 19, 20, 25, 26, 27, 28, 29, 30], "jit": [8, 10, 11, 23], "add_vector": 8, "arrai": [8, 10, 13, 19, 26, 30], "pallas_cal": 8, "out_shap": 8, "shapedtypestruct": 8, "dtype": [8, 10, 11, 16, 20, 21, 27, 28], "otherwis": [8, 13, 18, 19, 20, 26, 28], "program": [8, 9, 10, 11, 13, 18, 19, 20, 23, 28, 29, 30], "hang": 8, "lock": 8, "q": [8, 10], "randn": [8, 10, 13, 15, 16, 17, 22, 23, 27, 29, 30], "128": [8, 10, 16, 25, 27, 32], "k": [8, 10, 18], "make_kernel_from_palla": 8, "pt_kernel": 8, "lambda": [8, 25], "liner": 8, "flash": [8, 9, 11], "attent": [8, 9, 10, 11], "besid": 8, "op": [8, 9, 10, 12, 13, 15, 18, 19, 20, 21, 28, 29, 30], "suppor": 8, "flash_attent": 8, "paged_attent": 8, "queri": [8, 16], "squeez": 8, "dim": [8, 9, 13], "key_cach": 8, "value_cach": 8, "context_len": 8, "block_tabl": 8, "pages_per_compute_block": 8, "megacore_mod": 8, "vllm": 8, "util": [8, 10, 12, 13, 17, 18, 22, 25, 26, 27, 30, 31], "effect": [8, 13], "memori": [8, 12, 13, 14, 18, 19, 20, 25, 28], "kv": 8, "proper": [8, 30], "jax_nightly_releas": 8, "jaxlib_nightly_releas": 8, "consid": [9, 16, 19], "mani": [9, 13, 16, 18, 19, 20, 28, 32], "homogen": 9, "layer": [9, 14, 15, 25, 26, 29], "llm": [9, 19], "drop": [9, 14, 18], "loop": [9, 15, 17, 18, 19, 20, 26, 28, 31], "bunch": [9, 10], "decod": [9, 15], "trace": [9, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 28, 29], "subsequ": [9, 19], "significantli": [9, 16, 17, 19], "hand": [9, 17], "lower": [9, 10, 12, 18, 19, 20, 21, 28], "lax": 9, "readthedoc": [9, 25], "io": [9, 16, 25], "en": [9, 25], "_autosummari": 9, "Its": [9, 13], "primari": 9, "hood": 9, "sort": [9, 20, 28], "itself": [9, 11, 13, 25], "typic": [9, 13], "transform": [9, 19, 25, 30], "run_decoder_lay": 9, "hidden_st": 9, "decoder_lay": 9, "unrol": 9, "flat": [9, 30], "shown": [9, 16, 20, 28], "decoder_with_scan": 9, "root": [9, 13, 20, 28], "python3": [9, 14, 16, 17, 18, 19, 25], "train_decoder_only_bas": [9, 15, 18], "decoderwithscan": 9, "dimens": [9, 13, 14, 29, 30], "carri": [9, 20, 28, 29], "along": [9, 13, 25, 30], "fn": [9, 13], "callabl": [9, 13, 25], "tupl": [9, 10, 13, 20, 24, 26, 28, 30], "init": [9, 16, 17, 22, 23, 24], "roughli": 9, "equal": [9, 30], "len": [9, 13, 19], "append": [9, 18], "much": [9, 15, 16, 17, 19, 20, 23, 28], "scan_exampl": 9, "scan_example_cumsum": 9, "cumul": [9, 24], "scan_example_pytre": 9, "pytre": 9, "final": [9, 22, 29], "histori": 9, "15": [9, 19], "count": [9, 13, 18], "mean": [9, 13, 16, 17, 18, 19, 20, 22, 26, 28, 29], "0000": 9, "5000": 9, "particular": [9, 19], "palla": [9, 12], "incompat": 9, "nightli": [9, 18, 19, 25, 29], "bound": 9, "compar": [9, 15, 16, 17, 18, 22, 23, 24], "fact": 9, "than": [9, 16, 18, 20, 22, 25, 28], "due": [9, 16, 18, 19, 32], "less": [9, 16, 20, 23, 28], "situat": 9, "anywai": 9, "save": [9, 13, 18, 25, 31], "chip": [9, 15, 16], "hidden": 9, "256": [9, 16], "num": 9, "50": [9, 18, 19, 24], "head": 9, "2048": [9, 16], "step": [9, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 28, 29, 31], "metric": [9, 13, 22], "compiletim": [9, 18], "totalsampl": [9, 18], "accumul": [9, 13], "02m57s694ms418": 9, "595u": 9, "valuer": [9, 18], "02s112ms586": 9, "097u": 9, "rate": [9, 18, 22], "054285": 9, "percentil": [9, 18], "023ms113": 9, "470u": 9, "10": [9, 13, 16, 17, 18, 19, 20, 22, 23, 24, 27, 28, 31], "20": [9, 14, 17, 18, 22, 27], "54s644ms733": 9, "284u": 9, "80": [9, 18], "01m03s028ms571": 9, "841u": 9, "90": [9, 18], "95": [9, 18], "99": [9, 18, 22], "29s996ms941": 9, "409u": 9, "02s529ms591": 9, "388u": 9, "158152": 9, "018ms636": 9, "571u": 9, "11s983ms003": 9, "171u": 9, "18s995ms301": 9, "667u": 9, "maximum": [9, 13, 14, 19, 27], "1m03": 9, "19": [9, 22, 23], "switch": [9, 17, 18, 20, 22, 28], "7253": 9, "comment": [9, 20, 28], "accomplish": 10, "exportedprogram": 10, "fx": [10, 23], "exported_program_to_stablehlo": 10, "mlir": 10, "torchvis": [10, 15, 23], "torch_xla2": 10, "tx": 10, "resnet18": [10, 15, 23], "sampl": [10, 13, 16, 18], "sample_input": 10, "224": [10, 15], "mlir_modul": 10, "store": [10, 11, 13, 18], "feel": [10, 14, 18, 22], "explor": 10, "org": [10, 13, 16, 25], "tutori": [10, 11, 18, 19, 22, 29], "jfunc": 10, "shapeddtypestruct": 10, "float32": [10, 21], "last": [10, 18, 30], "scaled_dot_product_attent": 10, "decompos": 10, "low": [10, 14, 18], "dure": [10, 13, 18, 19, 23, 25, 29], "captur": [10, 13, 18, 19], "downstream": [10, 21], "ml": [10, 30], "crucial": 10, "geneart": 10, "pattern": [10, 18, 20, 23, 28], "challeng": 10, "prone": 10, "robust": 10, "outlin": [10, 27], "pratic": 10, "scaled_product_attent": 10, "centric": 10, "unittest": 10, "nn": [10, 13, 16, 17, 22, 23, 25, 27, 29], "impl_abstract": 10, "jaten": 10, "jlibrari": 10, "mylib": 10, "basic": [10, 17, 19, 20, 22, 28], "sdpa": 10, "compositeexplicitautograd": 10, "_mylib_scaled_dot_product_attent": 10, "dot": [10, 18], "product": 10, "transpos": [10, 20, 28], "dropout_p": 10, "is_caus": 10, "_mylib_scaled_dot_product_attention_meta": 10, "empty_lik": [10, 11], "decomposit": 10, "register_torch_composit": 10, "softmax": 10, "register_jax_composit": 10, "_aten_softmax": 10, "_softmax": 10, "static_argnum": 10, "librarytest": 10, "testcas": 10, "manual_se": [10, 13, 16], "default_env": 10, "use_torch_native_for_cpu_tensor": 10, "test_basic_sdpa_librari": 10, "customopexampl": 10, "arg": [10, 13, 17, 19, 24, 25], "rand": [10, 20, 28], "32": [10, 13, 18, 19, 30], "64": [10, 15, 23, 25], "module_str": 10, "todo": 10, "produc": [10, 20, 21, 22, 28], "assertin": 10, "__name__": [10, 16, 17, 22], "__main__": [10, 16, 17, 22], "emit": 10, "repres": [10, 13, 16, 20, 28], "region": [10, 13, 15, 18, 21, 29], "th": [10, 30], "high": [11, 14, 19, 22, 27], "deep": [11, 12, 18], "learn": [11, 16], "languag": 11, "empow": 11, "full": [11, 13, 17, 18, 25], "potenti": [11, 13, 16, 18, 26], "given": [11, 13, 18, 19, 20, 22, 25, 28, 30], "add_kernel": 11, "x_ptr": 11, "pointer": 11, "y_ptr": 11, "output_ptr": 11, "n_element": 11, "block_siz": 11, "tl": 11, "constexpr": 11, "element": [11, 13, 20, 26, 28, 29, 30], "01": 11, "l28": 11, "pid": 11, "program_id": 11, "axi": [11, 13, 26, 30], "block_start": 11, "offset": 11, "arang": 11, "mask": [11, 18, 20, 28], "load": [11, 13, 16, 18, 22, 25, 27, 31], "xla_triton": 11, "16": [11, 17, 19, 25, 27, 30], "int64": 11, "grid": 11, "cdiv": 11, "triton_cal": 11, "kwarg": [11, 13, 25, 29], "payload": [11, 13, 16], "regard": [11, 17, 23], "buffer": [11, 13], "_xla_gpu_custom_cal": 11, "dep": 11, "connect": [12, 13, 16, 29], "overview": [12, 30], "eager": [12, 13, 20, 22, 27, 28], "mode": [12, 13, 20, 22, 27, 28, 29, 31], "troubleshoot": 12, "stablehlo": [12, 13], "scan": 12, "scan_lay": 12, "mix": [12, 13, 30], "precis": 12, "advanc": [12, 30], "topic": [12, 30], "distribut": [12, 17, 18, 22, 25, 26, 29, 30], "checkpoint": [12, 16, 19, 25, 30], "distributeddataparallel": [12, 16], "ddp": [12, 16], "torchdynamo": 12, "while_loop": 12, "shard": [12, 13, 31], "quantiz": 12, "recompil": [12, 14, 15, 17, 18, 19], "hardwar": [12, 13, 18, 19, 21], "plugin": [12, 16], "bazel": 12, "int": [13, 16, 20, 28, 29], "device_count": [13, 29], "address": [13, 16, 29, 32], "wait": [13, 18, 19], "pend": [13, 15], "whether": [13, 17, 21], "block": [13, 19, 25, 29], "finish": [13, 19], "full_graph": 13, "num_different_graphs_allow": 13, "lazytensor": [13, 15, 19], "happen": [13, 15, 16, 17, 18, 19, 20, 28], "decid": [13, 18, 20, 28], "funciton": 13, "act": [13, 17], "context": [13, 16, 18, 20, 21, 28], "throw": [13, 17], "exit": [13, 18, 21, 22], "pt_xla_debug": 13, "messag": [13, 18], "dump": [13, 18], "allow": [13, 17, 18, 19, 21, 29, 30, 31], "rais": [13, 18], "exceed": 13, "foo": 13, "sin": 13, "co": 13, "foo2": 13, "compiled_foo2": 13, "seed": 13, "random": [13, 15, 16, 19, 27], "integ": [13, 18, 30], "rng": [13, 16], "device_typ": 13, "local_process_count": 13, "local_device_count": 13, "total": [13, 20, 28, 30], "addressable_device_count": 13, "visibl": [13, 20, 28], "global_device_count": 13, "global_runtime_device_count": [13, 26, 29, 30], "especi": [13, 16, 19, 23, 29], "world_siz": [13, 16, 21, 22, 25, 29], "particip": [13, 16], "job": [13, 19, 23], "global_ordin": [13, 16, 17, 22, 25], "global": [13, 16, 17, 29, 31], "ordin": [13, 17], "thread": [13, 16, 17, 18, 31], "guarante": 13, "predict": 13, "relationship": [13, 17, 18], "worker": [13, 16, 17, 19, 25, 31], "id": [13, 16, 18, 19, 30], "nor": 13, "contigu": [13, 17, 18], "local_ordin": 13, "get_master_ip": 13, "retriev": [13, 17, 20, 23, 28, 29], "discoveri": 13, "use_spmd": [13, 29, 30, 31], "forc": [13, 16, 18, 20, 24, 28], "non": [13, 15, 20, 21, 28, 30], "replic": [13, 29, 30], "spmd_advanc": 13, "md": [13, 16], "initialize_cach": [13, 17], "readonli": [13, 17], "persist": [13, 17, 31], "xla_devic": [13, 16, 17, 18, 19, 21, 22, 23, 24, 27, 30], "devkind": 13, "cuda": [13, 16, 17, 19, 20, 21, 27, 28, 32], "deprec": 13, "xla_device_hw": 13, "union": 13, "real": [13, 23], "is_master_ordin": 13, "multi": [13, 14, 29, 32], "num_host": 13, "boolean": 13, "indic": [13, 18, 19, 20, 28, 30], "reduce_typ": 13, "float": [13, 20, 21, 28], "pin_layout": 13, "One": [13, 14, 19, 25], "xm": [13, 15, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 30], "reduce_sum": 13, "reduce_mul": 13, "reduce_and": 13, "reduce_or": 13, "reduce_min": 13, "reduce_max": 13, "replica": [13, 16], "layout": [13, 27, 30], "pine": 13, "prevent": [13, 19, 21, 23, 29], "corrupt": 13, "unpin": 13, "hlomodul": 13, "constrain": [13, 16], "hold": [13, 29], "channel_id": 13, "use_global_device_id": 13, "channel": [13, 27], "interpret": [13, 20, 28], "replicagroup": 13, "all_to_al": 13, "split_dimens": 13, "concat_dimens": 13, "split_count": 13, "www": 13, "operation_semant": 13, "upon": 13, "split": [13, 30], "concat": 13, "add_step_closur": 13, "closur": 13, "run_async": 13, "report": 13, "consol": 13, "tensorboard": [13, 19], "etc": [13, 15, 18, 20, 28, 29], "intermediari": 13, "inspect": 13, "barrier": [13, 16, 17, 19], "materi": [13, 18, 19, 20, 28, 29], "queu": 13, "though": [13, 17, 22], "advis": 13, "throttl": 13, "event": 13, "asynchron": [13, 29, 31], "wait_device_op": 13, "async": [13, 23], "whose": [13, 14, 30], "empti": 13, "optimizer_step": [13, 17, 19, 21, 22, 25], "optimizer_arg": 13, "dict": [13, 25], "gradid": 13, "parallelload": [13, 29], "dataparallel": 13, "loader": [13, 18, 19, 23], "dictionari": 13, "gradient": [13, 17, 21, 25, 31], "file_or_path": 13, "textio": 13, "master_onli": [13, 25], "global_mast": 13, "transfer": [13, 16, 18, 19, 29], "care": [13, 17, 18, 20, 28], "taken": [13, 17, 18, 20, 22, 28, 31], "view": [13, 17, 18], "recreat": [13, 17], "destin": [13, 17], "nest": [13, 25], "locat": 13, "control": [13, 14, 17, 18, 29], "obj_to_sav": 13, "path_to_sav": 13, "rendezv": 13, "tag": [13, 16], "byte": 13, "b": [13, 16, 19, 20, 21, 23, 28, 30], "mesh": [13, 16, 26], "server": [13, 16, 19], "xla_rendezv": 13, "sent": [13, 18], "exchang": 13, "posit": 13, "mesh_reduc": 13, "reduce_fn": 13, "toxlatensorarena": 13, "receiv": 13, "copi": [13, 16, 17, 18, 19], "np": [13, 26, 30], "accuraci": [13, 22, 25], "test_accuraci": 13, "set_rng_stat": 13, "get_rng_stat": 13, "get_memory_info": 13, "memoryinfo": 13, "bytes_us": 13, "290816": 13, "bytes_limit": 13, "34088157184": 13, "peak_bytes_us": 13, "500816": 13, "get_stablehlo": 13, "env": [13, 16, 29], "var": [13, 29], "xla_hlo_debug": [13, 18], "get_stablehlo_bytecod": 13, "bytecod": [13, 23], "parallel_load": [13, 16, 17, 18], "mpdeviceload": [13, 17, 19, 29], "dataload": [13, 17, 19, 22, 29, 31], "background": [13, 31], "upload": [13, 19, 29], "per_device_load": [13, 29], "constructor": 13, "train_device_load": 13, "train_load": [13, 17, 29], "xla_multiprocess": 13, "spawn": [13, 16, 17, 19], "nproc": [13, 16], "daemon": 13, "start_method": 13, "moment": 13, "valueerror": 13, "mark_shard": [13, 26, 29, 30], "xlashardedtensor": [13, 31], "partition_spec": [13, 29, 30], "nonetyp": 13, "annot": [13, 29, 30], "partit": [13, 29], "spec": [13, 29], "intern": [13, 16, 17, 18, 20, 28, 29, 32], "spmdpartition": [13, 29], "topologi": [13, 17, 29], "partitionspec": 13, "ax": [13, 29, 30], "mesh_shap": [13, 26, 29, 30], "impact": [13, 16, 18, 20, 22, 28], "num_devic": [13, 26, 29, 30], "device_id": [13, 26, 29, 30], "linear": [13, 16, 17, 21, 22, 27], "clear_shard": 13, "clear": 13, "cast": [13, 21], "t1": [13, 17, 18, 30], "get_1d_mesh": 13, "set_global_mesh": 13, "get_global_mesh": 13, "axis_nam": [13, 29], "v4": [13, 15, 16, 17, 19, 23, 29], "ndarrai": 13, "flatten": 13, "reshap": 13, "fill": 13, "row": [13, 30], "major": [13, 30], "global_runtime_device_attribut": [13, 30], "length": [13, 20, 28], "get_xla_supported_devic": 13, "get_logical_mesh": [13, 30], "ordereddict": [13, 29, 30], "hybridmesh": [13, 29], "ici_mesh_shap": [13, 29], "dcn_mesh_shap": [13, 29], "hybrid": 13, "ici": 13, "dcn": [13, 29], "increas": 13, "intens": 13, "mdl": 13, "inner": [13, 25, 29], "outer": [13, 25, 26, 29], "slice": [13, 19, 29, 30], "fsdp": [13, 25, 26, 29, 30], "eager_mod": [13, 15], "wa": [13, 16, 18, 19, 20, 28, 31], "d": [13, 14, 20, 21, 28], "eagerli": [13, 15, 17, 18, 20, 28], "metrics_report": [13, 18], "short_metrics_report": [13, 18], "counter_nam": 13, "metric_nam": 13, "activ": [13, 17, 18, 22, 25, 26, 27], "counter_valu": 13, "metric_data": 13, "total_sampl": 13, "retain": 13, "circular": 13, "natur": 14, "in_tensor": 14, "randint": [14, 27], "out_tensor": 14, "nonzero": [14, 18, 19, 20, 28], "word": [14, 20, 28], "25": 14, "further": [14, 19, 22], "categor": 14, "unbound": 14, "alloc": [14, 30], "infinit": [14, 26], "phase": 14, "perceptron": 14, "mlp": 14, "xla_experiment": 14, "masked_select": 14, "masked_scatt": 14, "your_script": [14, 19], "100": [14, 18, 25], "29": [14, 22, 23], "49": [14, 23], "03": 14, "102": 14, "hit": [14, 20, 28], "198": 14, "1953": 14, "motiv": 14, "excess": 14, "half": 14, "try": [14, 18, 19, 20, 28], "test_dynamic_shape_model": 14, "testdynamicshapemodel": 14, "test_backward_pass_with_dynamic_input": 14, "plan": [14, 16], "expand": [14, 23], "review": [14, 26], "rfc": [14, 29, 32], "mark_step": [15, 16, 17, 18, 19, 22], "actual": [15, 19, 20, 22, 28, 29], "drawback": 15, "approach": [15, 20, 22, 25, 28], "often": [15, 18, 20, 28], "confus": 15, "preprocess": [15, 27], "small": [15, 18, 19, 20, 22, 23, 28], "leak": 15, "expens": [15, 18, 20, 28], "hard": [15, 20, 22, 23, 28], "why": [15, 20, 28], "mitig": 15, "ux": 15, "mark": [15, 17], "compiled_model": 15, "right": [15, 20, 23, 28], "awai": 15, "pretti": [15, 17, 20, 22, 28], "straight": 15, "enter": 15, "reenabl": 15, "perfomr": 15, "recommen": 15, "overhad": 15, "step_fn": 15, "loss_fn": [15, 16, 17, 21, 22, 23], "zero_grad": [15, 16, 17, 21, 22], "logit": [15, 26], "loss": [15, 16, 17, 21, 23, 25, 26], "ask": [15, 18, 20, 28], "refactor": 15, "llama2": 15, "fake": [15, 31], "300": [15, 18], "observ": [15, 16, 22], "147": 15, "65": [15, 18], "45": 15, "perfomran": 15, "tri": [15, 19], "resnet50": [15, 16, 17, 23, 25], "exepct": 15, "meant": 15, "encount": [16, 18, 19], "bug": [16, 18, 22], "r2": [16, 18, 29], "renam": 16, "torchrun": [16, 17, 32], "xpu": 16, "neuron": 16, "xrt_tpu_config": 16, "30": [16, 25], "thousand": 16, "preview": 16, "safe": 16, "section": [16, 17, 18, 19, 29, 30], "broadcast": 16, "broadcast_master_param": 16, "pjrt_backend": 16, "diff": [16, 19], "42": 16, "gradient_as_bucket_view": [16, 22], "mseloss": [16, 22], "sgd": [16, 17, 21, 22, 23], "lr": [16, 17, 22, 23, 25, 26], "001": [16, 22], "confirm": 16, "p": [16, 18, 20, 28], "localservic": 16, "localhost": 16, "51011": 16, "master_addr": 16, "master_port": 16, "12355": [16, 32], "Or": [16, 17, 20, 28], "overhead": [16, 22, 23], "grpc": 16, "torchbench": 16, "35": [16, 18], "tpuvm": [16, 17, 19, 29], "mnist": [16, 17, 18, 21], "test_train_mp_mnist": [16, 22], "fake_data": [16, 18, 22, 32], "alpha": [16, 17], "central2": [16, 19], "git": [16, 18, 19, 25], "depth": [16, 18], "branch": [16, 18, 20, 28], "test_train_mp_imagenet": [16, 18, 22], "batch_siz": [16, 25, 32], "num_epoch": [16, 22, 25], "By": [16, 20, 28], "tpu_process_bound": 16, "tpu_visible_chip": 16, "r1": 16, "13": [16, 17, 22, 24], "docker_imag": 16, "gcr": 16, "privat": 16, "sudo": [16, 19], "rm": 16, "privileg": 16, "net": [16, 19, 21], "gpu_num_devic": 16, "nnode": [16, 32], "num_gpu_devic": 16, "pjrt_distribut": 16, "physic": [16, 29, 30], "12": [16, 18, 23, 25], "number_gpu_vm": [16, 32], "node_rank": [16, 32], "current_node_rank": 16, "nproc_per_nod": [16, 32], "number_local_gpu_devic": 16, "rdzv_endpoint": [16, 32], "internal_ip_address": 16, "multinode_train": 16, "endpoint": [16, 32], "form": [16, 18, 20, 28, 32], "machine_0": 16, "machine_1": 16, "machine_0_internal_ip_address": [16, 32], "ident": 16, "page": 16, "mostli": [16, 25], "interchang": 16, "perspect": [16, 17], "subtl": 16, "importantli": 16, "architectur": [16, 25], "thu": [16, 18], "batch": [16, 17, 18, 19, 29], "latenc": 16, "serial": [16, 17], "deseri": 16, "send": [16, 17, 19, 29], "direct": [16, 18], "independ": [16, 17, 18], "xla_dist": 16, "scp": [16, 17], "sdk": 16, "collect": [16, 22, 23, 30, 31], "enhanc": 16, "stabil": [16, 18, 21], "xmp": [16, 17, 19], "substanti": 16, "practic": [16, 20, 26, 28, 30], "unreli": 16, "inbound": 16, "could": [16, 19, 20, 28, 29, 30], "failur": 16, "entir": [16, 25], "restart": 16, "impos": 16, "middl": [16, 19, 20, 28], "unwant": 16, "permit": 16, "subset": [16, 30], "old": 16, "alter": 16, "synchron": [16, 17, 19, 29, 31], "all_gather_object": 16, "gloo": [16, 22, 31], "subgroup": 16, "monitor": 16, "altern": [16, 20, 21, 27, 28], "reliabl": 16, "strongli": 16, "_all_gath": 16, "int32": 16, "zeros_lik": 16, "get_world_s": 16, "averag": 16, "task": 16, "175": 16, "chart": 16, "breakdown": 16, "tfrt": 16, "legaci": 16, "streamexecutor": 16, "tpu_legaci": 16, "comparison": [16, 30], "regular": [17, 18, 19, 27], "t0": 17, "matrix": 17, "multipli": [17, 30], "mm": [17, 21], "neural": 17, "l_in": 17, "l_out": 17, "floattensor": 17, "highlight": [17, 19], "nllloss": 17, "momentum": 17, "acquir": 17, "mp_device_load": 17, "three": 17, "multithread": [17, 18], "assign": [17, 19], "own": [17, 25], "onto": 17, "preload": [17, 19], "overlap": [17, 19, 23, 29], "batches_per_execut": 17, "consolid": [17, 25], "all_reduce_gradi": 17, "parent": 17, "talk": 17, "howto": 17, "focu": [17, 20, 28], "train_mnist_xla": 17, "outsid": 17, "infrastructur": 17, "awar": 17, "fakedata": 17, "But": [17, 18, 20, 28], "immedi": [17, 29], "record": [17, 18, 19], "defer": 17, "fuse": [17, 19], "invis": 17, "caller": 17, "insert": [17, 19], "paper": 17, "opaqu": [17, 18], "appear": [17, 18, 19], "unlik": [17, 19], "adjust": 17, "preserv": [17, 18], "appreci": 17, "accommod": 17, "previous": 17, "state_dict": [17, 25, 31], "footprint": 17, "xser": 17, "stream": 17, "amount": [17, 18, 19, 20, 28], "restor": 17, "load_state_dict": [17, 31], "unavail": [17, 18], "consum": [17, 20, 28], "doesn": [17, 18, 20, 26, 28], "disk": 17, "occur": 17, "your_cache_path": 17, "mount": 17, "mp_fn": 17, "tmp": [17, 18, 25], "xla_cache_": 17, "runnabl": [17, 22, 26], "subject": 18, "peculiar": 18, "detial": 18, "__version__": 18, "cu121": 18, "t2": [18, 30], "200": 18, "rx": 18, "conclud": 18, "diagnos": 18, "extrem": 18, "pt_xla_debug_level": 18, "slip": 18, "analyz": [18, 19], "summari": 18, "frequent": 18, "21": 18, "11": [18, 20, 28], "transferfromdevicetim": 18, "23": 18, "hash": 18, "c74c3b91b855b2b123f833b0d5f86943": 18, "107": 18, "frame": 18, "trigger": [18, 19, 20, 28], "dk3": 18, "1055": 18, "44": 18, "__next__": 18, "train_loop_fn": 18, "48": [18, 22], "start_train": 18, "73": 18, "548000": 18, "gb": 18, "922460": 18, "alias": [18, 21], "547871": 18, "124478": 18, "028210": 18, "steptrac": 18, "frequenc": 18, "pair": 18, "met": 18, "spent": [18, 19], "destroi": 18, "202": 18, "06m09s401ms746": 18, "001u": 18, "778ms572": 18, "062u": 18, "425201": 18, "001ms32": 18, "778u": 18, "001ms61": 18, "283u": 18, "001ms79": 18, "236u": 18, "001ms110": 18, "973u": 18, "001ms228": 18, "773u": 18, "001ms339": 18, "183u": 18, "001ms434": 18, "305u": 18, "002ms921": 18, "063u": 18, "21s102ms853": 18, "173u": 18, "cachedsynctensor": 18, "395": [18, 22], "area": 18, "rout": 18, "qualifi": 18, "33": [18, 22, 23], "_local_scalar_dens": 18, "epoch": [18, 19, 25], "clear_al": 18, "xla_dynamo_debug": 18, "bottleneck": [18, 19], "notebook": 18, "train_resnet_benchmark": 18, "behav": 18, "evalu": [18, 19, 20, 28], "suggest": 18, "bad": 18, "degrad": [18, 19], "speedup": [18, 23], "constant": [18, 19, 29], "indirect": 18, "solut": [18, 20, 27, 28], "variat": 18, "pad": [18, 19, 20, 28, 30], "fix": [18, 19, 23, 26], "translat": 18, "item": [18, 19], "substitut": 18, "flow": 18, "clip_grad_norm": 18, "problemat": 18, "clip_grad_norm_": 18, "dramat": 18, "total_norm": 18, "zero": [18, 25, 31], "param_norm": 18, "grad": 18, "norm": 18, "norm_typ": 18, "add_": 18, "clip_coef": 18, "max_norm": 18, "1e": [18, 23], "mul_": 18, "data_parallel": 18, "dataset": [18, 22, 25], "stride": 18, "reconstruct": 18, "shallow": 18, "ty": 18, "made": [18, 19, 20, 28, 29], "_get_xla_tensors_text": [18, 20, 28], "_get_xla_tensors_hlo": 18, "prior": [18, 31], "degre": 18, "xla_ir_debug": 18, "henc": [18, 23], "respons": [18, 19, 23, 31], "propag": 18, "xla_save_tensors_fil": 18, "realli": [18, 20, 23, 28], "big": [18, 20, 28], "left": 18, "sheet": 18, "xla_save_tensors_fmt": 18, "text": 18, "graphviz": 18, "xla_flag": 18, "xla_dump_to": 18, "dir_nam": 18, "unoptim": 18, "optimz": 18, "xla_metrics_fil": 18, "xla_save_hlo_fil": 18, "offend": 18, "xla_sync_wait": 18, "xla_use_eager_debug_mod": 18, "bypass": 18, "overal": [18, 19], "optimizaiton": 18, "tf_cpp_log_thread_id": 18, "tf_cpp_vmodul": 18, "vlog": 18, "tf_cpp_min_log_level": 18, "turn": 18, "warn": 18, "tf_vlog": 18, "xla_dump_hlo_graph": 18, "xla_util": 18, "cc": 18, "save1": 18, "xla_graph_executor": 18, "pjrt_computation_cli": 18, "dir": 18, "pytorch_test_with_slow": 18, "test_torch": 18, "test_put_xla_uint8": 18, "torch_test_devic": 18, "pytorch_test_bas": 18, "brief": 19, "reader": 19, "modif": 19, "fetch": 19, "discuss": [19, 30], "readabl": 19, "opcod": 19, "fed": 19, "attach": [19, 29], "callback": 19, "xla_tensor_z": 19, "cut": [19, 20, 28], "transferfromdevic": 19, "tell": [19, 20, 28], "properti": [19, 20, 28], "illustr": [19, 30], "suppos": 19, "tensors_on_devic": 19, "z": [19, 20, 28], "subgraph": [19, 20, 28], "signal": 19, "far": 19, "suitabl": 19, "trade": [19, 20, 28], "off": 19, "spend": 19, "fusion": 19, "worth": [19, 20, 28], "latter": [19, 25], "runtime_vers": 19, "project_id": 19, "accelerator_typ": 19, "tpu_nam": 19, "your_tpu_nam": 19, "subnetwork": 19, "tpusubnet": 19, "pip3": 19, "cp38": 19, "linux_x86_64": 19, "whl": 19, "apt": 19, "libopenbla": 19, "dev": [19, 22], "libgl1": 19, "hypercomput": 19, "recipi": 19, "guidelin": 19, "bar": 19, "rememb": 19, "txt2img": 19, "prompt": 19, "photograph": 19, "astronaut": 19, "ride": 19, "hors": 19, "relat": 19, "precision_scop": 19, "addition": [19, 21, 25], "frozenclipembedd": 19, "simplic": [19, 20, 28], "ddim": 19, "top": 19, "attr": 19, "statement": [19, 20, 28], "stop": 19, "fall": [19, 26], "difficult": 19, "readi": 19, "investig": [19, 22], "cover": [19, 29], "huggingfac": 19, "sd": 19, "xl": 19, "cd": [19, 25], "text_to_imag": 19, "inference_tpu_single_devic": 19, "lora": 19, "model_id": 19, "stabilityai": 19, "9": [19, 20, 22, 25, 28], "pipelin": 19, "dpmsolvermultistepschedul": 19, "txt": 19, "invisible_watermark": 19, "safetensor": 19, "agre": 19, "licens": 19, "card": 19, "cli": 19, "_your_copied_token__": 19, "pipe": 19, "hour": 19, "wherea": 19, "likewis": 19, "gpt": 19, "min": 19, "advantag": 19, "mayb": 19, "notic": 19, "piec": 19, "__call__": 19, "commit": 19, "caveat": 19, "rule": [19, 21], "thumb": 19, "durat": [19, 31], "constantli": 19, "idl": 19, "inference_tpu_": 19, "capture_profil": 19, "gap": 19, "xp": 19, "measur": 19, "portion": 19, "busi": 19, "scroll": 19, "occupi": 19, "displai": 19, "largest": 19, "zoom": 19, "timelin": 19, "period": 19, "examin": 19, "did": 19, "pipe_watermark": 19, "closer": 19, "preced": 19, "proceed": [19, 26], "watermark": 19, "cv2": 19, "pywt": 19, "leav": 19, "broken": 19, "rerun": 19, "scale_model_input": 19, "dynamo": [19, 23, 27], "ran": 19, "my_funct": 19, "preocess": 19, "debug_single_process": 19, "magic": [19, 20, 28], "treat": [19, 30], "xla_no_special_scalar": 19, "hurt": [20, 28], "perf": [20, 28], "pov": [20, 28], "sai": [20, 28], "assur": [20, 28], "gone": [20, 28], "coverag": [20, 28], "aim": [20, 26, 28], "explan": [20, 28], "mainli": [20, 28], "beginn": [20, 28], "propos": [20, 28], "reli": [20, 28], "impract": [20, 28], "assumpt": [20, 28], "ye": [20, 27, 28], "sentenc": [20, 28], "bucket": [20, 28, 31], "kinda": [20, 28], "anti": [20, 28], "frontend": [20, 28], "matter": [20, 28], "workaround": [20, 28], "okai": [20, 28], "teach": [20, 28], "theoret": [20, 28], "obviou": [20, 28], "s64": [20, 28], "inde": [20, 28], "_get_xla_tensor_dimension_s": [20, 28], "commonli": [20, 28, 30], "wrong": [20, 28], "wors": [20, 28], "probabl": [20, 28], "know": [20, 22, 28], "upper": [20, 28], "nit": [20, 28], "solv": [20, 28], "kept": [20, 28], "earli": [20, 28], "accessor": [20, 28], "2d": [20, 26, 28, 30], "implicitli": [20, 28], "doubl": [20, 28], "overload": [20, 28], "explod": [20, 28], "convers": [20, 28], "cheap": [20, 28], "ve": [20, 28], "hoc": [20, 28], "think": [20, 28], "verison": [20, 28], "bla": [20, 28], "blabla": [20, 28], "proce": [20, 28], "uglier": [20, 28], "win": [20, 28], "pars": [20, 28], "torchscript": [20, 28], "somehow": [20, 28], "merg": [20, 28], "lazili": [20, 28, 29, 31], "properli": [20, 28], "thought": [20, 28], "trivial": [20, 28], "effort": [20, 28, 29], "side": [20, 28], "bandwidth": [20, 28], "automag": [20, 28], "gold": [20, 28], "smart": [20, 28], "trick": [20, 28], "tbh": [20, 28], "longer": [20, 28], "unawar": [20, 28], "hope": [20, 28], "smash": [20, 28], "blocker": [20, 28], "ahead": [20, 28], "nnc": [20, 28], "exactli": [20, 28], "brian": [20, 28], "hirsh": [20, 28], "bdhirsh": [20, 28], "question": [20, 28], "stick": [20, 28], "torch_warn": [20, 28], "yea": [20, 28], "hei": [20, 28], "won": [20, 21, 28], "blaze": [20, 28], "isn": [20, 28, 31], "abil": [20, 22, 28], "devirtu": [20, 28], "sound": [20, 28], "great": [20, 28], "truth": [20, 28], "irvalu": [20, 28], "enforc": [20, 28], "discrep": [20, 28], "followup": [20, 28], "1000": [20, 28], "my": [20, 28, 31], "presenc": [20, 28], "get_dimention_s": [20, 28], "didn": [20, 28], "exponenti": [20, 28], "blowup": [20, 28], "fewer": [20, 28], "opportun": [20, 28], "recogn": [20, 23, 28], "feasibl": [20, 28], "annoi": [20, 28], "wasn": [20, 28], "materiz": [20, 28], "combo": [20, 28], "extend": 21, "datatyp": 21, "float16": 21, "bfloat16": [21, 27], "syncfre": 21, "autocast": 21, "summar": 21, "elig": 21, "suppli": 21, "addmm": 21, "addmm_": 21, "prefer": 21, "float64": 21, "respect": [21, 30], "unlist": 21, "__matmul__": 21, "addbmm": 21, "addmv": 21, "addr": 21, "baddbmm": 21, "bmm": 21, "conv1d": 21, "conv2d": [21, 25], "conv3d": 21, "conv_transpose1d": 21, "conv_transpose2d": 21, "conv_transpose3d": 21, "matmul": 21, "relu": [21, 22], "prelu": 21, "max_pool2d": 21, "batch_norm": 21, "log_softmax": 21, "binary_cross_entropy_with_logit": 21, "prod": 21, "cdist": 21, "chloeski": 21, "invers": 21, "reflection_pad": 21, "replication_pad": 21, "mse_loss": 21, "cosine_embbeding_loss": 21, "nll_loss": 21, "multilabel_margin_loss": 21, "qr": 21, "svd": 21, "triangular_solv": 21, "linalg_svd": 21, "linalg_inv_ex": 21, "widest": 21, "index_copi": 21, "scaler": [21, 27], "gradscal": 21, "_fetch_gradi": 21, "xla_use_f16": 21, "underflow": 21, "imagenet": 21, "minimum": [22, 25, 26], "nccl": 22, "new_rank": 22, "ddp_model": 22, "launcher": 22, "demo_fn": 22, "touch": [22, 31], "five": 22, "sy": 22, "tempfil": 22, "cleanup": 22, "destroy_process_group": 22, "toymodel": 22, "__init__": [22, 27], "super": [22, 23], "net1": 22, "1000000": 22, "net2": 22, "demo_bas": 22, "label": 22, "run_demo": 22, "tot": 22, "statist": 22, "unit": 22, "median": 22, "90th": 22, "deviat": 22, "cv": 22, "418": 22, "54": 22, "419": 22, "22": 22, "430": 22, "40": 22, "76": 22, "02": 22, "97": 22, "407": 22, "60": 22, "39": 22, "seem": 22, "17864": 22, "20108": 22, "96": 22, "24351": 22, "74": 22, "5866": 22, "83": 22, "10701": 22, "11770": 22, "00": 22, "14313": 22, "78": 22, "3102": 22, "92": 22, "41": [22, 23], "round": 22, "heavili": [22, 23], "sens": 22, "amort": 22, "logdir": 22, "converg": 22, "caution": 22, "interest": 22, "known": 22, "crash": 22, "unmodifi": 23, "hook": 23, "biggest": [23, 25], "torchfx": 23, "technologi": 23, "a_xla": 23, "b_xla": 23, "compiled_cod": 23, "eval_model": 23, "xla_resnet18": 23, "eval": 23, "dynamo_resnet18": 23, "no_grad": 23, "resent18": 23, "analysi": 23, "bench": 23, "59": 23, "resnext50_32x4d": 23, "91": 23, "alexnet": 23, "28": 23, "mobilenet_v2": 23, "18": 23, "62": 23, "mnasnet1_0": 23, "68": 23, "vgg16": 23, "bert_pytorch": 23, "squeezenet1_1": 23, "timm_vision_transform": 23, "52": 23, "geomean": 23, "04": 23, "train_model": 23, "crossentropyloss": 23, "pred": 23, "train_model_main": 23, "dynamo_train_model": 23, "xla_optim": 23, "weight_decai": 23, "extract": 23, "07": 23, "43": 23, "81": 23, "87": 23, "fwd": 23, "bwd": 23, "e2": 23, "hide": 23, "larger": [23, 25], "wit": 23, "promis": 23, "tradit": 23, "excit": 23, "upcom": [23, 29], "invest": 23, "matur": 23, "stori": 23, "_higher_order_op": 24, "fori_loop": 24, "cond_fn": 24, "body_fn": 24, "bodi": 24, "iteri": 24, "init_v": 24, "functionaltensor": 24, "lvl": 24, "ten": 24, "51": 24, "xlafullyshardeddataparallel": 25, "my_modul": [25, 26], "adam": [25, 26], "0001": [25, 26], "leftov": [25, 26], "arxiv": 25, "1910": 25, "02054": 25, "reshard_after_forward": 25, "test_train_mp_mnist_fsdp_with_ckpt": 25, "test_train_mp_imagenet_fsdp": 25, "interleav": 25, "submodul": 25, "fsdpvitmodel": 25, "checkpoint_modul": [25, 26], "3524": 25, "auto_wrap_polici": [25, 26], "size_based_auto_wrap_polici": 25, "polici": [25, 29], "100m": 25, "transformer_auto_wrap_polici": [25, 26], "transformer_layer_cl": [25, 26], "auto_wrapper_cal": 25, "remateri": 25, "resum": 25, "get_shard_metadata": 25, "consolidate_sharded_model_checkpoint": 25, "stitch": 25, "ckpt": 25, "shard_metadata": 25, "ckpt_path": 25, "pth": 25, "consolidate_sharded_ckpt": 25, "ckpt_prefix": 25, "your_sharded_checkpoint_fil": 25, "ckpt_suffix": 25, "_rank": 25, "inspir": 25, "structur": [25, 29], "fairscal": 25, "fullyshardeddataparallel": 25, "resort": 25, "train_resnet_fsdp_auto_wrap": 25, "newer": 25, "recurs": [25, 26], "98": 25, "drop_last": 25, "use_nested_fsdp": 25, "use_gradient_checkpoint": 25, "final_ckpt": 25, "75": 25, "download": 25, "1k": 25, "datadir": 25, "test_set_batch_s": 25, "eval_interv": 25, "num_warmup_epoch": 25, "lr_scheduler_divide_every_n_epoch": 25, "lr_scheduler_divisor": 25, "residu": 25, "algorithm": [25, 26], "ronghanghu": 25, "vit_10b_fsdp_exampl": 25, "vit": 25, "fsdpv2": 26, "famou": 26, "enjoi": 26, "tabl": 26, "spmd_fully_sharded_data_parallel": 26, "spmdfullyshardeddataparallel": 26, "autowrap": 26, "decoderlay": 26, "functool": 26, "decoder_only_model": 26, "shard_output": 26, "0th": 26, "children": 26, "fork": 26, "hf": 26, "abstract": [27, 29], "blockwis": 27, "int4": 27, "analog": 27, "classifi": 27, "flexibl": 27, "choos": [27, 31], "docstr": 27, "xla_quantized_matmul": 27, "n_input_featur": 27, "n_output_featur": 27, "w_int": 27, "127": 27, "int8": 27, "matmul_output": 27, "quantized_matmul": 27, "x_xla": 27, "w_int_xla": 27, "scaler_xla": 27, "matmul_output_xla": 27, "w": 27, "f_dynamo": 27, "dynamo_out_xla": 27, "myqlinearforxlabackend": 27, "load_weight": 27, "processed_w": 27, "processed_scal": 27, "stuff": 27, "orig_model": 27, "mymodel": 27, "q_weight": 27, "q_weights_for_xla": 27, "process_for_xla": 27, "q_linear": 27, "xlaquantizedlinear": 27, "in_featur": 27, "out_featur": 27, "load_quantized_weight": 27, "sym": 27, "asym": 27, "w8a16": 27, "w8a8": 27, "w4a8": 27, "gspmd": [29, 30], "proced": 29, "src": [29, 31], "_input_sharding_": 29, "4d": 29, "input_shard": 29, "shardingspec": 29, "input_mesh": 29, "s2": 29, "s3": 29, "s4": 29, "_after": 29, "_the": 29, "unnecessari": 29, "forth": 29, "techniqu": 29, "decis": 29, "nice": 29, "arrang": [29, 30], "center": 29, "multislic": 29, "denot": 29, "hardcod": 29, "delai": 29, "subclass": 29, "__torch_dispatch__": 29, "global_tensor": 29, "strictli": 29, "local_shard": 29, "xlashard": 29, "4e8e5511555073ce8b6d1a436bf808c9333dcac6": 29, "xla_sharded_tensor": 29, "l12": 29, "ongo": 29, "distributedtensor": 29, "proof": 29, "concept": [29, 30], "distribute_tensor": 29, "devicemesh": 29, "big_tensor": 29, "100000": 29, "88": 29, "my_dtensor": 29, "stai": 29, "dynamo_mark_shard": 29, "placement": 29, "visualize_tensor_shard": 29, "visualize_shard": 29, "rich": 29, "2x2": 29, "generated_t": 29, "use_color": 29, "style": [29, 30], "tile": 29, "partial_repl": 29, "envvar": 29, "xla_auto_spmd": 29, "_tensor": 29, "distribute_modul": 29, "auto_polici": 29, "device_mesh": 29, "mymodul": 29, "sharded_model": 29, "behvaior": 29, "xla_auto_use_group_shard": 29, "reshard": 29, "xla_auto_spmd_mesh": 29, "unset": 29, "conceptu": 30, "matric": 30, "book": 30, "hint": 30, "strategi": 30, "dimension": 30, "mpi": 30, "necessarili": 30, "512": 30, "3d": 30, "1d": 30, "interconnect": 30, "core_on_chip": 30, "num_cor": 30, "coord": 30, "attribut": 30, "slice_index": 30, "coordin": 30, "divis": 30, "dedic": 31, "planner": 31, "spmdsaveplann": 31, "spmdloadplann": 31, "dist_cp": 31, "distributed_checkpoint": 31, "xc": 31, "storage_writ": 31, "filesystemwrit": 31, "checkpoint_dir": 31, "storage_read": 31, "filesystemread": 31, "all_step": 31, "save_async": 31, "preemption": 31, "detect": 31, "provis": 31, "queuedresourc": 31, "autocheckpoint": 31, "chkpt_on_preempt": 31, "fsspec": 31, "filesystem": 31, "prime_optim": 31, "chkpt_mgr": 31, "tracked_step": 31, "highest": 31, "best_step": 31, "prime": 31, "enumer": 31, "unprim": 31, "destruct": 31, "discov": 31, "nvidia": 32, "resnet": 32, "num_gpu_machin": 32, "rank_of_current_machin": 32, "machine_0_ip_address": 32, "training_or_inference_script_using_spmd": 32, "xla_use_spmd": 32, "test_train_spmd_imagenet": 32}, "objects": {"": [[13, 0, 0, "-", "torch_xla"]], "torch_xla": [[13, 1, 1, "", "compile"], [13, 1, 1, "", "device"], [13, 1, 1, "", "device_count"], [13, 1, 1, "", "devices"], [13, 0, 0, "-", "experimental"], [13, 1, 1, "", "manual_seed"], [13, 0, 0, "-", "runtime"], [13, 1, 1, "", "sync"]], "torch_xla.core": [[13, 0, 0, "-", "xla_model"]], "torch_xla.core.xla_model": [[13, 1, 1, "", "add_step_closure"], [13, 1, 1, "", "all_gather"], [13, 1, 1, "", "all_reduce"], [13, 1, 1, "", "all_to_all"], [13, 1, 1, "", "get_memory_info"], [13, 1, 1, "", "get_rng_state"], [13, 1, 1, "", "get_stablehlo"], [13, 1, 1, "", "get_stablehlo_bytecode"], [13, 1, 1, "", "is_master_ordinal"], [13, 1, 1, "", "mesh_reduce"], [13, 1, 1, "", "optimizer_step"], [13, 1, 1, "", "rendezvous"], [13, 1, 1, "", "save"], [13, 1, 1, "", "set_rng_state"], [13, 1, 1, "", "wait_device_ops"], [13, 1, 1, "", "xla_device"], [13, 1, 1, "", "xla_device_hw"]], "torch_xla.debug": [[13, 0, 0, "-", "metrics"]], "torch_xla.debug.metrics": [[13, 1, 1, "", "counter_names"], [13, 1, 1, "", "counter_value"], [13, 1, 1, "", "metric_data"], [13, 1, 1, "", "metric_names"], [13, 1, 1, "", "metrics_report"], [13, 1, 1, "", "short_metrics_report"]], "torch_xla.distributed": [[13, 0, 0, "-", "parallel_loader"], [13, 0, 0, "-", "spmd"], [13, 0, 0, "-", "xla_multiprocessing"]], "torch_xla.distributed.parallel_loader": [[13, 2, 1, "", "MpDeviceLoader"]], "torch_xla.distributed.spmd": [[13, 2, 1, "", "HybridMesh"], [13, 2, 1, "", "Mesh"], [13, 1, 1, "", "clear_sharding"], [13, 1, 1, "", "get_1d_mesh"], [13, 1, 1, "", "get_global_mesh"], [13, 1, 1, "", "mark_sharding"], [13, 1, 1, "", "set_global_mesh"]], "torch_xla.distributed.xla_multiprocessing": [[13, 1, 1, "", "spawn"]], "torch_xla.experimental": [[13, 1, 1, "", "eager_mode"]], "torch_xla.runtime": [[13, 1, 1, "", "addressable_device_count"], [13, 1, 1, "", "device_type"], [13, 1, 1, "", "get_master_ip"], [13, 1, 1, "", "global_device_count"], [13, 1, 1, "", "global_ordinal"], [13, 1, 1, "", "global_runtime_device_count"], [13, 1, 1, "", "initialize_cache"], [13, 1, 1, "", "is_spmd"], [13, 1, 1, "", "local_device_count"], [13, 1, 1, "", "local_ordinal"], [13, 1, 1, "", "local_process_count"], [13, 1, 1, "", "use_spmd"], [13, 1, 1, "", "world_size"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"]}, "titleterms": {"learn": [0, 1, 12], "about": [0, 1, 12], "gpu": [0, 11, 16, 21, 32], "tpu": [1, 4, 16, 17, 19, 21, 25, 29], "bazel": 2, "pytorch": [2, 3, 4, 6, 7, 8, 10, 12, 13, 17, 18, 19, 23, 25, 28, 29, 30], "xla": [2, 3, 4, 6, 7, 8, 12, 13, 17, 18, 19, 21, 23, 25, 27, 28, 29, 30], "depend": [2, 8, 11], "how": [2, 22, 27, 30], "build": 2, "librari": 2, "torch": [2, 7, 10, 16, 29], "plugin": [2, 6], "remot": 2, "cach": [2, 17], "run": [2, 3, 17, 18, 19, 29, 32], "test": [2, 3, 5, 18, 24], "code": [2, 4, 19, 27], "coverag": 2, "languag": 2, "server": 2, "codegen": 3, "migrat": 3, "guid": [3, 5, 9, 30], "befor": [3, 5], "you": [3, 5, 9, 20, 28], "start": [3, 5, 20, 28], "file": [3, 5], "structur": [3, 5], "old": 3, "op": [3, 5, 7, 27], "lower": [3, 5, 7], "step": [3, 4], "1": [3, 19, 20, 28], "identifi": 3, "2": [3, 19, 20, 26, 28], "inspect": 3, "gener": [3, 10], "lazyir": 3, "h": 3, "3": [3, 20, 28], "implement": [3, 6, 19], "miss": 3, "ir": 3, "function": 3, "torch_xla": [3, 13, 20], "csrc": 3, "ops_xla_shape_fn": 3, "cpp": 3, "4": 3, "ops_lower_fn": 3, "5": 3, "cleanup": 3, "verifi": 3, "result": 3, "sampl": 3, "pr": 3, "configur": 4, "develop": 4, "environ": [4, 18], "visual": 4, "studio": 4, "creat": [4, 17], "connect": 4, "your": 4, "set": 4, "up": 4, "workspac": 4, "next": 4, "understand": [5, 18], "oper": [5, 10, 18, 20, 21, 27, 28], "unit": [5, 18], "tip": 5, "custom": [6, 8, 11], "hardwar": 6, "pjrt": [6, 16], "c": 6, "api": [6, 7, 13, 15], "packag": 6, "support": [7, 21, 27], "distribut": [7, 13, 16, 31], "collect": 7, "stack": 7, "non": 7, "dynamo": [7, 18], "case": [7, 20, 24, 28], "descript": 7, "kernel": [8, 11], "via": [8, 11], "palla": 8, "adopt": 8, "abov": 8, "compat": [8, 9], "us": [8, 9, 10, 20, 22, 24, 26, 27, 28, 30], "built": 8, "flashattent": 8, "exampl": [8, 9, 19, 21, 24, 25, 26], "usag": [8, 15, 24], "integr": [8, 23, 29], "pagedattent": 8, "scan": 9, "scan_lay": 9, "when": [9, 20, 28], "should": 9, "thi": 9, "limit": 9, "aotautograd": 9, "requir": 9, "overhead": 9, "compil": [9, 15, 17, 18, 29], "time": 9, "experi": 9, "refer": [9, 19], "export": 10, "stablehlo": 10, "extract_jax": 10, "preserv": 10, "high": 10, "level": 10, "composit": 10, "triton": 11, "document": 12, "acceler": 12, "featur": [12, 23, 27], "improv": 12, "workload": 12, "perform": [12, 16, 18, 19], "contribut": 12, "runtim": [13, 16], "xla_model": 13, "spmd": [13, 26, 29, 30, 32], "experiment": [13, 27], "debug": [13, 18, 29], "dynam": [14, 20, 28], "shape": [14, 20, 28], "bound": [14, 20, 28], "eager": 15, "mode": [15, 30], "basic": 15, "infer": [15, 19, 23], "train": [15, 16, 23, 25], "benchmark": [15, 18, 22], "tl": 16, "dr": 16, "benefit": 16, "quickstart": 16, "cpu": [16, 17], "pod": [16, 17, 19, 25, 29], "docker": 16, "singl": [16, 17, 19], "node": 16, "multi": [16, 17], "differ": 16, "from": [16, 17, 20, 28], "xrt": 16, "multithread": 16, "v2": 16, "v3": [16, 25], "chang": 16, "xm": 16, "rendezv": 16, "new": 16, "devic": [17, 19, 29, 30], "an": 17, "tensor": [17, 18, 20, 28], "ar": 17, "model": [17, 27], "multipl": [17, 19], "process": [17, 31], "deep": 17, "dive": 17, "lazi": 17, "memori": [17, 24], "layout": 17, "move": 17, "save": 17, "load": [17, 29], "further": [17, 30], "read": [17, 30], "troubleshoot": 18, "saniti": 18, "check": 18, "version": 18, "A": 18, "simpl": [18, 24], "calcul": 18, "resnet": [18, 25], "With": 18, "fake": [18, 22], "data": [18, 22, 25, 26, 29], "tool": [18, 29], "auto": [18, 29], "metric": 18, "analysi": [18, 19], "execut": 18, "get": 18, "report": 18, "The": 18, "clear": 18, "profil": [18, 19], "known": 18, "caveat": 18, "quirk": 18, "more": 18, "variabl": 18, "common": 18, "combin": 18, "reproduc": 18, "ci": 18, "cd": 18, "failur": 18, "overview": 19, "setup": 19, "convert": 19, "stabl": 19, "diffus": 19, "lightn": 19, "hf": 19, "sourc": [20, 28], "recompil": [20, 28], "let": [20, 28], "": [20, 28], "first": [20, 28], "some": [20, 28], "fact": [20, 28], "constraint": [20, 28], "input": [20, 28], "dataset": [20, 28], "output": [20, 26, 28], "can": [20, 28], "fix": [20, 28], "without": [20, 28], "queri": [20, 28], "its": [20, 28], "real": [20, 22, 28], "dimens": [20, 28], "what": [20, 28, 30], "i": [20, 28, 30], "control": [20, 24, 28], "flow": [20, 28], "conclus": [20, 28], "appendix": [20, 28], "automat": 21, "mix": 21, "precis": 21, "amp": 21, "best": 21, "practic": 21, "do": 22, "distributeddataparallel": 22, "ddp": 22, "background": 22, "motiv": 22, "resnet50": 22, "mnist": [22, 25], "disclaim": 22, "torchdynamo": 23, "gap": 23, "take": 23, "awai": 23, "optim": [24, 29, 31], "util": 24, "while_loop": 24, "group": [24, 31], "pure": 24, "python": 24, "while": 24, "loop": 24, "fulli": [25, 26], "shard": [25, 26, 29, 30], "parallel": [25, 26], "script": 25, "imagenet": 25, "instal": 25, "clone": 25, "repo": 25, "8": 25, "50": 25, "10": 25, "billion": 25, "paramet": 25, "gradient": 26, "checkpoint": [26, 31], "huggingfac": 26, "llama": 26, "quantiz": 27, "call": 27, "modul": 27, "swap": 27, "matrix": 27, "multipli": 27, "advanc": 29, "topic": 29, "awar": 29, "host": 29, "virtual": 29, "hybrid": 29, "mesh": [29, 30], "xlashardedtensor": 29, "dtensor": 29, "activ": 29, "user": 30, "partit": 30, "spec": 30, "which": 30, "hold": 30, "checkpointmanag": 31, "restor": 31, "state": 31}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"Learn about GPUs": [[0, "learn-about-gpus"]], "Learn about TPUs": [[1, "learn-about-tpus"]], "Bazel in Pytorch/XLA": [[2, "bazel-in-pytorch-xla"]], "Bazel dependencies": [[2, "bazel-dependencies"]], "How to build XLA libraries": [[2, "how-to-build-xla-libraries"]], "How to build the Torch/XLA plugin": [[2, "how-to-build-the-torch-xla-plugin"]], "Remote caching": [[2, "remote-caching"]], "Running tests": [[2, "running-tests"]], "Code coverage": [[2, "code-coverage"]], "Language Server": [[2, "language-server"]], "Building PyTorch/XLA": [[2, "building-pytorch-xla"]], "Codegen migration Guide": [[3, "codegen-migration-guide"]], "Before you start": [[3, "before-you-start"], [5, "before-you-start"]], "File structure": [[3, "file-structure"], [5, "file-structure"]], "PyTorch Codegen files": [[3, "pytorch-codegen-files"]], "PyTorch/XLA Codegen files": [[3, "pytorch-xla-codegen-files"]], "PyTorch/XLA Old Op Lowering files": [[3, "pytorch-xla-old-op-lowering-files"]], "Codegen step by step": [[3, "codegen-step-by-step"]], "1. Identify the op": [[3, "identify-the-op"]], "2. Codegen the op and inspect the generated file": [[3, "codegen-the-op-and-inspect-the-generated-file"]], "LazyIr.h": [[3, "lazyir-h"]], "3. Implement the missing IR function": [[3, "implement-the-missing-ir-function"]], "torch_xla/csrc/ops/ops_xla_shape_fn.h": [[3, "torch-xla-csrc-ops-ops-xla-shape-fn-h"]], "torch_xla/csrc/ops/ops_xla_shape_fn.cpp": [[3, "torch-xla-csrc-ops-ops-xla-shape-fn-cpp"]], "4. Implement the lowering function": [[3, "implement-the-lowering-function"]], "torch_xla/csrc/ops/ops_lower_fn.cpp": [[3, "torch-xla-csrc-ops-ops-lower-fn-cpp"]], "5. Cleanup": [[3, "cleanup"]], "Run the test and verify the result": [[3, "run-the-test-and-verify-the-result"]], "Sample PRs": [[3, "sample-prs"]], "Configure a development environment": [[4, "configure-a-development-environment"]], "Visual Studio Code": [[4, "visual-studio-code"]], "Creating and connecting to your TPU": [[4, "creating-and-connecting-to-your-tpu"]], "Setting up a Visual Studio Code workspace with PyTorch/XLA": [[4, "setting-up-a-visual-studio-code-workspace-with-pytorch-xla"]], "Next steps": [[4, "next-steps"]], "OP Lowering Guide": [[5, "op-lowering-guide"]], "Understanding the operation": [[5, "understanding-the-operation"]], "Unit Test": [[5, "unit-test"]], "Tips": [[5, "tips"]], "Custom Hardware Plugins": [[6, "custom-hardware-plugins"]], "Implementing a PJRT Plugin": [[6, "implementing-a-pjrt-plugin"]], "PJRT C API Implementation": [[6, "pjrt-c-api-implementation"]], "PyTorch/XLA Plugin Package": [[6, "pytorch-xla-plugin-package"]], "Support of Torch Distributed API in PyTorch/XLA": [[7, "support-of-torch-distributed-api-in-pytorch-xla"]], "Collective ops lowering": [[7, "collective-ops-lowering"]], "Collective ops lowering stack": [[7, "collective-ops-lowering-stack"]], "non-Dynamo case": [[7, "non-dynamo-case"]], "Dynamo case": [[7, "dynamo-case"]], "API description": [[7, "api-description"]], "Custom Kernels via Pallas": [[8, "custom-kernels-via-pallas"]], "Adopt the above kernel to be compatible with PyTorch/XLA": [[8, "adopt-the-above-kernel-to-be-compatible-with-pytorch-xla"]], "Use built-in kernels": [[8, "use-built-in-kernels"]], "FlashAttention": [[8, "id1"]], "Example usage": [[8, "example-usage"], [8, "id3"]], "Integration Example": [[8, "integration-example"], [8, "id4"]], "PagedAttention": [[8, "id2"]], "Dependencies": [[8, "dependencies"], [11, "dependencies"]], "Guide for using scan and scan_layers": [[9, "guide-for-using-scan-and-scan-layers"]], "When should you use this": [[9, "when-should-you-use-this"]], "scan_layers example": [[9, "scan-layers-example"]], "scan example": [[9, "scan-example"]], "Limitations": [[9, "limitations"]], "AOTAutograd compatibility requirement": [[9, "aotautograd-compatibility-requirement"]], "AOTAutograd overhead": [[9, "aotautograd-overhead"]], "Compile time experiments": [[9, "compile-time-experiments"]], "References": [[9, "references"]], "Torch Export to StableHLO": [[10, "torch-export-to-stablehlo"]], "Using torch.export": [[10, "using-torch-export"]], "Using extract_jax": [[10, "using-extract-jax"]], "Preserving High-Level PyTorch Operations in StableHLO by generating stablehlo.composite": [[10, "preserving-high-level-pytorch-operations-in-stablehlo-by-generating-stablehlo-composite"]], "Custom GPU Kernels via Triton": [[11, "custom-gpu-kernels-via-triton"]], "PyTorch/XLA documentation": [[12, "pytorch-xla-documentation"]], "Learn about Pytorch/XLA": [[12, null]], "Learn about accelerators": [[12, null]], "PyTorch/XLA features": [[12, null]], "Improve Pytorch/XLA workload performance": [[12, null]], "Contribute to Pytorch/XLA": [[12, null]], "PyTorch/XLA API": [[13, "pytorch-xla-api"]], "torch_xla": [[13, "module-torch_xla"]], "runtime": [[13, "module-torch_xla.runtime"]], "xla_model": [[13, "module-torch_xla.core.xla_model"]], "distributed": [[13, "module-torch_xla.distributed.parallel_loader"]], "spmd": [[13, "module-torch_xla.distributed.spmd"]], "experimental": [[13, "module-torch_xla.experimental"]], "debug": [[13, "module-torch_xla.debug.metrics"]], "Dynamic shape": [[14, "dynamic-shape"]], "Bounded dynamic shape": [[14, "bounded-dynamic-shape"]], "Eager Mode + Compile API": [[15, "eager-mode-compile-api"]], "Basic Usage": [[15, "basic-usage"]], "Inference": [[15, "inference"], [23, "inference"]], "Training": [[15, "training"], [23, "training"]], "Benchmark": [[15, "benchmark"]], "PJRT Runtime": [[16, "pjrt-runtime"]], "TL;DR": [[16, "tl-dr"]], "Benefits": [[16, "benefits"]], "Quickstart": [[16, "quickstart"]], "CPU": [[16, "cpu"]], "TPU": [[16, "tpu"]], "Pods": [[16, "pods"]], "Docker": [[16, "docker"]], "GPU": [[16, "gpu"]], "Single-node GPU training": [[16, "single-node-gpu-training"]], "Multi-node GPU training": [[16, "multi-node-gpu-training"]], "Differences from XRT": [[16, "differences-from-xrt"]], "Multithreading on TPU v2/v3": [[16, "id3"]], "Changes to xm.rendezvous": [[16, "changes-to-xm-rendezvous"]], "PJRT and torch.distributed": [[16, "pjrt-and-torch-distributed"]], "Performance": [[16, "performance"]], "New TPU runtime": [[16, "new-tpu-runtime"]], "PyTorch on XLA Devices": [[17, "pytorch-on-xla-devices"]], "Creating an XLA Tensor": [[17, "creating-an-xla-tensor"]], "XLA Tensors are PyTorch Tensors": [[17, "xla-tensors-are-pytorch-tensors"]], "Running Models on XLA Devices": [[17, "running-models-on-xla-devices"]], "Running on a Single XLA Device": [[17, "running-on-a-single-xla-device"]], "Running on Multiple XLA Devices with Multi-processing": [[17, "running-on-multiple-xla-devices-with-multi-processing"]], "Running on TPU Pods": [[17, "running-on-tpu-pods"]], "XLA Tensor Deep Dive": [[17, "id3"]], "XLA Tensors are Lazy": [[17, "xla-tensors-are-lazy"]], "Memory Layout": [[17, "memory-layout"]], "Moving XLA Tensors to and from the CPU": [[17, "moving-xla-tensors-to-and-from-the-cpu"]], "Saving and Loading XLA Tensors": [[17, "saving-and-loading-xla-tensors"]], "Compilation Caching": [[17, "compilation-caching"]], "Further Reading": [[17, "further-reading"], [30, "further-reading"]], "Troubleshoot": [[18, "troubleshoot"]], "Sanity Check": [[18, "sanity-check"]], "Check PyTorch/XLA Version": [[18, "check-pytorch-xla-version"]], "Perform A Simple Calculation": [[18, "perform-a-simple-calculation"]], "Run Resnet With Fake Data": [[18, "run-resnet-with-fake-data"]], "Performance Debugging": [[18, "performance-debugging"]], "PyTorch/XLA Debugging Tool": [[18, "pytorch-xla-debugging-tool"]], "Perform A Auto-Metrics Analysis": [[18, "perform-a-auto-metrics-analysis"]], "Compilation & Execution Analysis": [[18, "compilation-execution-analysis"]], "Get A Metrics Report": [[18, "get-a-metrics-report"]], "Understand The Metrics Report": [[18, "understand-the-metrics-report"]], "Clear The Metrics Report": [[18, "clear-the-metrics-report"]], "PyTorch/XLA + Dynamo Debugging Tool": [[18, "pytorch-xla-dynamo-debugging-tool"]], "Performance Profiling": [[18, "performance-profiling"]], "Simple Benchmarking": [[18, "simple-benchmarking"]], "Known Performance Caveats": [[18, "known-performance-caveats"]], "XLA Tensor Quirks": [[18, "xla-tensor-quirks"]], "More Debugging Tools": [[18, "more-debugging-tools"]], "Debugging Tensor Operations": [[18, "debugging-tensor-operations"]], "Environment Variables": [[18, "environment-variables"]], "Common Debugging Environment Variables Combinations": [[18, "common-debugging-environment-variables-combinations"]], "Reproducing PyTorch/XLA CI/CD unit test failures.": [[18, "reproducing-pytorch-xla-ci-cd-unit-test-failures"]], "Pytorch/XLA overview": [[19, "pytorch-xla-overview"]], "TPU Setup": [[19, "tpu-setup"]], "Reference implementations": [[19, "reference-implementations"]], "Converting code to PyTorch XLA": [[19, "converting-code-to-pytorch-xla"]], "Example 1. Stable Diffusion inference in PyTorch Lightning on a Single TPU Device": [[19, "example-1-stable-diffusion-inference-in-pytorch-lightning-on-a-single-tpu-device"]], "Example 2. HF Stable Diffusion Inference": [[19, "example-2-hf-stable-diffusion-inference"]], "Running on a Single TPU device": [[19, "running-on-a-single-tpu-device"]], "Profiling and performance analysis": [[19, "profiling-and-performance-analysis"]], "Running on Multiple TPU Devices": [[19, "running-on-multiple-tpu-devices"]], "Running on Pods": [[19, "running-on-pods"]], "Source of recompilations in torch_xla": [[20, "source-of-recompilations-in-torch-xla"]], "Let\u2019s first start with some facts/constraints:": [[20, "lets-first-start-with-some-facts-constraints"], [28, "lets-first-start-with-some-facts-constraints"]], "#1. From input dataset.": [[20, "from-input-dataset"], [28, "from-input-dataset"]], "#2. From operator output": [[20, "from-operator-output"], [28, "from-operator-output"]], "2.1 Bounded dynamic shape can fix the case when you use the tensor with dynamic shape as a Tensor, without querying its real dimension.": [[20, "bounded-dynamic-shape-can-fix-the-case-when-you-use-the-tensor-with-dynamic-shape-as-a-tensor-without-querying-its-real-dimension"], [28, "bounded-dynamic-shape-can-fix-the-case-when-you-use-the-tensor-with-dynamic-shape-as-a-tensor-without-querying-its-real-dimension"]], "2.2 what if real dimension is queried on a tensor with dynamic shape?": [[20, "what-if-real-dimension-is-queried-on-a-tensor-with-dynamic-shape"], [28, "what-if-real-dimension-is-queried-on-a-tensor-with-dynamic-shape"]], "#3. From control flow": [[20, "from-control-flow"], [28, "from-control-flow"]], "Conclusion:": [[20, "conclusion"], [28, "conclusion"]], "Appendix:": [[20, "appendix"], [28, "appendix"]], "Automatic Mixed Precision": [[21, "automatic-mixed-precision"]], "AMP for XLA:TPU": [[21, "amp-for-xla-tpu"]], "AMP for XLA:TPU Best Practices": [[21, "amp-for-xla-tpu-best-practices"]], "Supported Operators": [[21, "supported-operators"]], "AMP for XLA:GPU": [[21, "amp-for-xla-gpu"]], "AMP for XLA:GPU Best Practices": [[21, "amp-for-xla-gpu-best-practices"]], "Examples": [[21, "examples"]], "How to do DistributedDataParallel(DDP)": [[22, "how-to-do-distributeddataparallel-ddp"]], "Background / Motivation": [[22, "background-motivation"]], "How to use DistributedDataParallel": [[22, "how-to-use-distributeddataparallel"]], "Benchmarking": [[22, "benchmarking"]], "Resnet50 with fake data": [[22, "resnet50-with-fake-data"]], "MNIST with fake data": [[22, "mnist-with-fake-data"]], "MNIST with real data": [[22, "mnist-with-real-data"]], "Disclaimer": [[22, "disclaimer"]], "TorchDynamo integration in PyTorch XLA": [[23, "torchdynamo-integration-in-pytorch-xla"]], "Integration": [[23, "integration"]], "Feature gaps": [[23, "feature-gaps"]], "Take away": [[23, "take-away"]], "Optimize memory utilization using while_loop": [[24, "optimize-memory-utilization-using-while-loop"]], "while_loop": [[24, "while-loop"]], "Usage:": [[24, "usage"]], "simple example with while_loop:": [[24, "simple-example-with-while-loop"]], "Control group test case": [[24, "control-group-test-case"]], "Control group example with pure python while loop": [[24, "control-group-example-with-pure-python-while-loop"]], "Fully Sharded Data Parallel in PyTorch XLA": [[25, "fully-sharded-data-parallel-in-pytorch-xla"]], "Example training scripts on MNIST and ImageNet": [[25, "example-training-scripts-on-mnist-and-imagenet"]], "Installation": [[25, "installation"]], "Clone PyTorch/XLA repo": [[25, "clone-pytorch-xla-repo"]], "Train MNIST on v3-8 TPU": [[25, "train-mnist-on-v3-8-tpu"]], "Train ImageNet with ResNet-50 on v3-8 TPU": [[25, "train-imagenet-with-resnet-50-on-v3-8-tpu"]], "Example training scripts on TPU pod (with 10 billion parameters)": [[25, "example-training-scripts-on-tpu-pod-with-10-billion-parameters"]], "Fully Sharded Data Parallel using SPMD": [[26, "fully-sharded-data-parallel-using-spmd"]], "Sharding output": [[26, "sharding-output"]], "Gradient checkpointing": [[26, "gradient-checkpointing"]], "HuggingFace Llama 2 Example": [[26, "huggingface-llama-2-example"]], "Quantized Operations for XLA (Experimental feature)": [[27, "quantized-operations-for-xla-experimental-feature"]], "How to use:": [[27, "how-to-use"]], "Call XLA quantized op in model code": [[27, "call-xla-quantized-op-in-model-code"]], "Module Swap": [[27, "module-swap"]], "Supported Quantized Operations:": [[27, "supported-quantized-operations"]], "Matrix Multiply": [[27, "matrix-multiply"]], "Source of recompilations in Pytorch/XLA": [[28, "source-of-recompilations-in-pytorch-xla"]], "PyTorch/XLA SPMD advanced topics": [[29, "pytorch-xla-spmd-advanced-topics"]], "Sharding-Aware Host-to-Device Data Loading": [[29, "sharding-aware-host-to-device-data-loading"]], "Virtual Device Optimization": [[29, "virtual-device-optimization"]], "Hybrid Mesh": [[29, "hybrid-mesh"]], "Running SPMD on TPU Pod": [[29, "running-spmd-on-tpu-pod"]], "XLAShardedTensor": [[29, "xlashardedtensor"]], "DTensor Integration": [[29, "dtensor-integration"]], "Activation Sharding for torch.compile": [[29, "activation-sharding-for-torch-compile"]], "SPMD Debugging Tool": [[29, "spmd-debugging-tool"]], "Auto-Sharding": [[29, "auto-sharding"]], "PyTorch/XLA SPMD User Guide": [[30, "pytorch-xla-spmd-user-guide"]], "What is PyTorch/XLA SPMD?": [[30, "what-is-pytorch-xla-spmd"]], "How to use PyTorch/XLA SPMD?": [[30, "how-to-use-pytorch-xla-spmd"]], "SPMD Mode": [[30, "spmd-mode"]], "Mesh": [[30, "mesh"]], "Partition spec": [[30, "partition-spec"]], "Which device holds which shard?": [[30, "which-device-holds-which-shard"]], "Distributed Checkpointing": [[31, "distributed-checkpointing"]], "CheckpointManager": [[31, "checkpointmanager"]], "Restoring Optimizer State": [[31, "restoring-optimizer-state"]], "Process Groups": [[31, "process-groups"]], "Running SPMD on GPU": [[32, "running-spmd-on-gpu"]]}, "indexentries": {"hybridmesh (class in torch_xla.distributed.spmd)": [[13, "torch_xla.distributed.spmd.HybridMesh"]], "mesh (class in torch_xla.distributed.spmd)": [[13, "torch_xla.distributed.spmd.Mesh"]], "mpdeviceloader (class in torch_xla.distributed.parallel_loader)": [[13, "torch_xla.distributed.parallel_loader.MpDeviceLoader"]], "add_step_closure() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.add_step_closure"]], "addressable_device_count() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.addressable_device_count"]], "all_gather() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.all_gather"]], "all_reduce() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.all_reduce"]], "all_to_all() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.all_to_all"]], "clear_sharding() (in module torch_xla.distributed.spmd)": [[13, "torch_xla.distributed.spmd.clear_sharding"]], "compile() (in module torch_xla)": [[13, "torch_xla.compile"]], "counter_names() (in module torch_xla.debug.metrics)": [[13, "torch_xla.debug.metrics.counter_names"]], "counter_value() (in module torch_xla.debug.metrics)": [[13, "torch_xla.debug.metrics.counter_value"]], "device() (in module torch_xla)": [[13, "torch_xla.device"]], "device_count() (in module torch_xla)": [[13, "torch_xla.device_count"]], "device_type() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.device_type"]], "devices() (in module torch_xla)": [[13, "torch_xla.devices"]], "eager_mode() (in module torch_xla.experimental)": [[13, "torch_xla.experimental.eager_mode"]], "get_1d_mesh() (in module torch_xla.distributed.spmd)": [[13, "torch_xla.distributed.spmd.get_1d_mesh"]], "get_global_mesh() (in module torch_xla.distributed.spmd)": [[13, "torch_xla.distributed.spmd.get_global_mesh"]], "get_master_ip() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.get_master_ip"]], "get_memory_info() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.get_memory_info"]], "get_rng_state() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.get_rng_state"]], "get_stablehlo() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.get_stablehlo"]], "get_stablehlo_bytecode() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.get_stablehlo_bytecode"]], "global_device_count() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.global_device_count"]], "global_ordinal() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.global_ordinal"]], "global_runtime_device_count() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.global_runtime_device_count"]], "initialize_cache() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.initialize_cache"]], "is_master_ordinal() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.is_master_ordinal"]], "is_spmd() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.is_spmd"]], "local_device_count() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.local_device_count"]], "local_ordinal() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.local_ordinal"]], "local_process_count() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.local_process_count"]], "manual_seed() (in module torch_xla)": [[13, "torch_xla.manual_seed"]], "mark_sharding() (in module torch_xla.distributed.spmd)": [[13, "torch_xla.distributed.spmd.mark_sharding"]], "mesh_reduce() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.mesh_reduce"]], "metric_data() (in module torch_xla.debug.metrics)": [[13, "torch_xla.debug.metrics.metric_data"]], "metric_names() (in module torch_xla.debug.metrics)": [[13, "torch_xla.debug.metrics.metric_names"]], "metrics_report() (in module torch_xla.debug.metrics)": [[13, "torch_xla.debug.metrics.metrics_report"]], "module": [[13, "module-torch_xla"], [13, "module-torch_xla.core.xla_model"], [13, "module-torch_xla.debug.metrics"], [13, "module-torch_xla.distributed.parallel_loader"], [13, "module-torch_xla.distributed.spmd"], [13, "module-torch_xla.distributed.xla_multiprocessing"], [13, "module-torch_xla.experimental"], [13, "module-torch_xla.runtime"]], "optimizer_step() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.optimizer_step"]], "rendezvous() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.rendezvous"]], "save() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.save"]], "set_global_mesh() (in module torch_xla.distributed.spmd)": [[13, "torch_xla.distributed.spmd.set_global_mesh"]], "set_rng_state() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.set_rng_state"]], "short_metrics_report() (in module torch_xla.debug.metrics)": [[13, "torch_xla.debug.metrics.short_metrics_report"]], "spawn() (in module torch_xla.distributed.xla_multiprocessing)": [[13, "torch_xla.distributed.xla_multiprocessing.spawn"]], "sync() (in module torch_xla)": [[13, "torch_xla.sync"]], "torch_xla": [[13, "module-torch_xla"]], "torch_xla.core.xla_model": [[13, "module-torch_xla.core.xla_model"]], "torch_xla.debug.metrics": [[13, "module-torch_xla.debug.metrics"]], "torch_xla.distributed.parallel_loader": [[13, "module-torch_xla.distributed.parallel_loader"]], "torch_xla.distributed.spmd": [[13, "module-torch_xla.distributed.spmd"]], "torch_xla.distributed.xla_multiprocessing": [[13, "module-torch_xla.distributed.xla_multiprocessing"]], "torch_xla.experimental": [[13, "module-torch_xla.experimental"]], "torch_xla.runtime": [[13, "module-torch_xla.runtime"]], "use_spmd() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.use_spmd"]], "wait_device_ops() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.wait_device_ops"]], "world_size() (in module torch_xla.runtime)": [[13, "torch_xla.runtime.world_size"]], "xla_device() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.xla_device"]], "xla_device_hw() (in module torch_xla.core.xla_model)": [[13, "torch_xla.core.xla_model.xla_device_hw"]]}})