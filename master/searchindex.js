Search.setIndex({"docnames": ["accelerators/gpu", "accelerators/tpu", "contribute/bazel", "contribute/codegen_migration", "contribute/configure-environment", "contribute/cpp_debugger", "contribute/op_lowering", "contribute/plugins", "features/distop", "features/pallas", "features/scan", "features/stablehlo", "features/triton", "index", "learn/api-guide", "learn/dynamic_shape", "learn/eager", "learn/pjrt", "learn/pytorch-on-xla-devices", "learn/troubleshoot", "learn/xla-overview", "notes/source_of_recompilation", "perf/amp", "perf/assume_pure", "perf/ddp", "perf/dynamo", "perf/fori_loop", "perf/fsdp", "perf/fsdpv2", "perf/quantized_ops", "perf/recompilation", "perf/spmd_advanced", "perf/spmd_basic", "perf/spmd_distributed_checkpoint", "perf/spmd_gpu"], "filenames": ["accelerators/gpu.md", "accelerators/tpu.md", "contribute/bazel.md", "contribute/codegen_migration.md", "contribute/configure-environment.md", "contribute/cpp_debugger.md", "contribute/op_lowering.md", "contribute/plugins.md", "features/distop.md", "features/pallas.md", "features/scan.md", "features/stablehlo.md", "features/triton.md", "index.rst", "learn/api-guide.rst", "learn/dynamic_shape.md", "learn/eager.md", "learn/pjrt.md", "learn/pytorch-on-xla-devices.md", "learn/troubleshoot.md", "learn/xla-overview.md", "notes/source_of_recompilation.md", "perf/amp.md", "perf/assume_pure.md", "perf/ddp.md", "perf/dynamo.md", "perf/fori_loop.md", "perf/fsdp.md", "perf/fsdpv2.md", "perf/quantized_ops.md", "perf/recompilation.md", "perf/spmd_advanced.md", "perf/spmd_basic.md", "perf/spmd_distributed_checkpoint.md", "perf/spmd_gpu.md"], "titles": ["Learn about GPUs", "Learn about TPUs", "Bazel in Pytorch/XLA", "Codegen migration Guide", "Configure a development environment", "C++ Debugging", "OP Lowering Guide", "Custom Hardware Plugins", "Support of Torch Distributed API in PyTorch/XLA", "Custom Kernels via Pallas", "Guide for using <code class=\"docutils literal notranslate\"><span class=\"pre\">scan</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">scan_layers</span></code>", "Torch Export to StableHLO", "Custom GPU Kernels via Triton", "PyTorch/XLA documentation", "PyTorch/XLA API", "Dynamic shape", "Eager Mode + Compile API", "PJRT Runtime", "PyTorch on XLA Devices", "Troubleshoot", "Pytorch/XLA overview", "Source of recompilations in torch_xla", "Automatic Mixed Precision", "Use <code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;assume_pure</span></code> to speed up lazy tensor tracing", "How to do DistributedDataParallel(DDP)", "TorchDynamo integration in PyTorch XLA", "Optimize memory utilization using <code class=\"docutils literal notranslate\"><span class=\"pre\">while_loop</span></code>", "Fully Sharded Data Parallel in PyTorch XLA", "Fully Sharded Data Parallel using SPMD", "Quantized Operations for XLA (Experimental feature)", "Source of recompilations in Pytorch/XLA", "PyTorch/XLA SPMD advanced topics", "PyTorch/XLA SPMD User Guide", "Distributed Checkpointing", "Running SPMD on GPU"], "terms": {"For": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 34], "inform": [0, 1, 3, 4, 5, 12, 14, 16, 17, 18, 19, 20, 21, 30, 34], "googl": [0, 1, 9, 17, 18], "cloud": [0, 1, 2, 4, 7, 13, 17, 18, 25, 33], "see": [0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 27, 30], "machin": [0, 2, 4, 17, 19, 20, 34], "type": [0, 4, 5, 7, 11, 14, 17, 18, 19, 20, 22, 24], "ar": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 27, 29, 30, 31, 32, 33], "custom": [1, 3, 4, 5, 8, 10, 11, 13, 14, 21, 24, 27, 29, 30, 31, 32], "design": [1, 10, 17, 18, 25, 28, 32], "ai": [1, 20], "acceler": [1, 4, 14, 15, 17, 18, 20, 22], "which": [1, 2, 3, 5, 6, 7, 8, 10, 11, 14, 15, 17, 18, 19, 20, 21, 22, 25, 27, 28, 30, 31, 33], "optim": [1, 5, 13, 14, 16, 17, 18, 19, 20, 21, 22, 24, 25, 27, 28, 30], "train": [1, 9, 10, 14, 15, 18, 19, 20, 22, 23, 31, 33, 34], "infer": [1, 3, 14, 17, 22, 31, 34], "larg": [1, 10, 15, 17, 20, 21, 27, 30, 32], "model": [1, 3, 6, 10, 11, 12, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 32, 33, 34], "thei": [1, 2, 5, 6, 7, 8, 14, 17, 18, 19, 20, 21, 22, 30, 31, 32], "ideal": [1, 2, 3, 21, 25, 30], "varieti": 1, "us": [1, 2, 3, 4, 6, 7, 8, 12, 13, 14, 16, 17, 18, 19, 20, 22, 25, 27, 31, 33, 34], "case": [1, 2, 3, 6, 10, 11, 14, 17, 18, 19, 20, 23, 25, 28, 31], "chatbot": 1, "code": [1, 3, 6, 10, 11, 12, 14, 16, 17, 18, 19, 21, 23, 24, 25, 30, 31], "gener": [1, 6, 14, 16, 17, 18, 19, 20, 21, 30], "media": 1, "content": [1, 14], "synthet": 1, "speech": 1, "vision": [1, 27], "servic": [1, 2, 17], "recommend": [1, 2, 3, 4, 5, 6, 14, 16, 17, 18, 22, 31], "engin": [1, 19], "person": 1, "among": 1, "other": [1, 2, 3, 6, 9, 10, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 29, 30, 32], "scale": [1, 11, 14, 17, 22, 23, 25, 32], "cost": [1, 23, 25], "effici": [1, 10, 11, 19, 20, 25, 32], "wide": [1, 6, 21, 30], "rang": [1, 6, 10, 14, 17, 23, 28, 31, 32], "workload": [1, 17, 18, 19, 31, 32], "span": [1, 3], "fine": 1, "tune": [1, 31, 32], "provid": [1, 2, 3, 6, 7, 9, 14, 18, 19, 20, 21, 22, 25, 26, 27, 29, 30, 31, 32, 33], "versatil": 1, "lead": [1, 10, 19, 20, 23], "framework": [1, 13, 16, 21, 29, 30], "includ": [1, 2, 6, 14, 17, 19, 20, 21, 22, 26, 30, 32, 33], "pytorch": [1, 6, 10, 12, 15, 16, 17, 21, 22, 23, 24, 26, 29, 33, 34], "jax": [1, 7, 9, 10, 11, 17], "tensorflow": [1, 2, 7, 14, 17, 19, 21, 30], "seamlessli": 1, "orchestr": 1, "through": [1, 3, 6, 7, 8, 9, 10, 18, 20, 21, 22, 30, 33], "integr": [1, 5, 12, 13, 28, 29, 32], "kubernet": 1, "gke": 1, "leverag": [1, 12, 34], "dynam": [1, 3, 6, 13, 19, 20, 25], "schedul": [1, 20], "improv": [1, 10, 17, 18, 19, 20, 22, 25, 31, 32], "scalabl": 1, "all": [1, 2, 3, 6, 8, 10, 11, 12, 14, 17, 18, 19, 20, 21, 22, 23, 24, 27, 28, 30, 31, 33], "need": [1, 2, 3, 6, 11, 14, 17, 18, 19, 20, 21, 24, 27, 28, 30, 31, 32], "simultan": [1, 32], "look": [1, 3, 5, 6, 10, 18, 19, 20, 31], "simplest": [1, 32], "wai": [1, 2, 6, 8, 9, 11, 14, 17, 18, 20, 21, 24, 25, 29, 30, 31, 32], "develop": [1, 2, 5, 12, 13, 16, 18, 24, 25, 29, 32], "can": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 27, 28, 29, 31, 32, 33, 34], "also": [1, 2, 3, 5, 6, 7, 8, 11, 12, 14, 16, 17, 18, 19, 20, 21, 23, 25, 27, 28, 29, 30, 31, 32], "vertex": 1, "fulli": [1, 13, 16, 17, 19, 32], "manag": [1, 9, 14, 22, 33], "platform": 1, "more": [1, 2, 3, 4, 6, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 23, 30, 31, 32, 34], "introduct": [1, 9], "set": [1, 2, 5, 8, 14, 17, 19, 20, 21, 22, 25, 27, 30, 31, 32, 33], "up": [1, 2, 3, 5, 17, 18, 20, 21, 25, 28, 30], "environ": [1, 2, 5, 13, 17, 18, 20, 24, 31, 32, 33], "resourc": [1, 14, 19], "i": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 31, 33], "free": [2, 6, 11, 15, 19, 22, 24, 27], "softwar": [2, 19], "tool": [2, 6, 20, 27, 32], "autom": 2, "openxla": [2, 7, 11, 16, 25, 29], "both": [2, 4, 5, 6, 8, 17, 20, 21, 22, 25, 27, 28, 29, 30, 32, 33], "make": [2, 4, 5, 11, 12, 16, 17, 18, 19, 20, 21, 24, 25, 30, 31], "good": [2, 3, 5, 6, 20, 21, 30, 31], "fit": [2, 3, 20, 27], "well": [2, 3, 7, 14, 17, 20, 21, 30, 32], "extern": [2, 4, 9], "seen": [2, 20, 25], "workspac": [2, 19], "file": [2, 4, 10, 14, 17, 19, 20, 22, 23, 24], "http_archiv": 2, "name": [2, 4, 5, 6, 14, 17, 19, 21, 28, 30, 31, 32], "org_tensorflow": 2, "strip_prefix": 2, "f7759359f8420d3ca7b9fd19493f2a01bd47b4ef": 2, "url": 2, "http": [2, 3, 4, 5, 9, 10, 11, 12, 14, 17, 19, 20, 27, 31], "github": [2, 3, 4, 5, 6, 10, 12, 14, 17, 19, 20, 24, 27, 31], "com": [2, 3, 4, 5, 9, 10, 12, 14, 17, 19, 20, 27, 31], "archiv": 2, "tar": 2, "gz": 2, "pin": [2, 14], "updat": [2, 3, 5, 8, 11, 18, 20, 21, 22, 30, 31], "point": [2, 3, 4, 5, 6, 7, 14, 20, 21, 22, 30], "thi": [2, 3, 4, 6, 7, 8, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34], "repositori": [2, 17], "differ": [2, 3, 7, 14, 18, 19, 20, 21, 23, 24, 26, 27, 30, 31, 32], "revis": 2, "patch": [2, 19], "mai": [2, 3, 5, 7, 10, 17, 18, 19, 20, 21, 22, 23, 30, 31, 32], "ad": [2, 5, 6, 11, 14, 18, 20, 21, 23, 25, 26, 30, 31], "resolv": 2, "prepar": 2, "hermet": 2, "mechan": 2, "deploi": 2, "becaus": [2, 3, 5, 10, 16, 17, 18, 20, 22, 23, 31], "local": [2, 4, 14, 17, 18, 19, 31], "checkout": [2, 10, 19], "ha": [2, 3, 4, 5, 6, 9, 10, 11, 14, 16, 17, 18, 20, 21, 30, 31, 32], "built": [2, 4, 32], "from": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 14, 15, 19, 20, 22, 23, 24, 25, 26, 27, 28, 31, 32, 33], "sourc": [2, 3, 5, 6, 7, 10, 13, 14, 19], "instal": [2, 3, 4, 6, 7, 9, 12, 17, 19, 20], "system": [2, 32], "version": [2, 3, 4, 5, 9, 17, 20, 22, 23, 31], "compat": [2, 17, 29, 33], "e": [2, 4, 7, 8, 11, 14, 15, 17, 19, 20, 21, 22, 23, 27, 29, 30, 31, 32], "g": [2, 4, 5, 7, 8, 11, 14, 15, 17, 19, 20, 21, 23, 29, 30, 31, 32, 33], "codegen": [2, 6, 13], "torchgen": [2, 3], "python": [2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 17, 19, 20, 21, 24, 25, 30, 31], "modul": [2, 9, 10, 11, 14, 18, 19, 24, 27, 28, 31], "should": [2, 3, 4, 6, 7, 12, 14, 16, 17, 18, 19, 20, 21, 22, 26, 27, 30, 31, 32, 33], "The": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34], "directori": [2, 3, 6, 10], "either": [2, 6, 8, 14, 17, 19, 21, 22, 30], "bzl": 2, "overriden": 2, "command": [2, 3, 4, 10, 17, 18, 19, 20, 24, 27], "line": [2, 3, 5, 11, 14, 16, 18, 19, 20, 21, 27, 30], "override_repositori": 2, "path": [2, 5, 7, 14, 18, 19, 21, 27, 30], "export": [2, 3, 4, 6, 13, 17, 19, 20], "tf_repo": 2, "torch_repo": 2, "pleas": [2, 3, 6, 8, 14, 17, 18, 19, 20, 22, 27, 28, 29, 31, 34], "sure": [2, 5, 18, 19], "overridden": [2, 3], "appropri": [2, 20], "been": [2, 6, 14, 17, 18, 20, 21, 30, 31], "use_cuda": [2, 5], "0": [2, 3, 4, 5, 7, 10, 11, 12, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 34], "setup": [2, 3, 5, 7, 11, 18, 24], "py": [2, 3, 4, 5, 6, 8, 10, 12, 15, 16, 17, 18, 19, 20, 23, 24, 27, 31, 34], "bdist_wheel": 2, "expect": [2, 3, 7, 12, 16, 17, 19, 21, 25, 29, 30], "object": [2, 11, 14, 31], "present": [2, 33], "new_local_repositori": 2, "build_fil": 2, "pytorch_local_dir": 2, "header": 2, "directli": [2, 3, 6, 7, 14, 17, 18, 19, 20, 21, 22, 27, 30, 31, 33], "share": [2, 3, 7, 17, 18, 19, 31], "libtorch": 2, "so": [2, 3, 5, 7, 11, 12, 14, 15, 17, 18, 19, 20, 21, 27, 30, 33], "same": [2, 3, 6, 7, 10, 12, 14, 16, 17, 18, 19, 20, 21, 22, 23, 26, 29, 30, 31, 32, 34], "where": [2, 4, 8, 9, 10, 14, 15, 17, 18, 19, 20, 21, 27, 28, 30, 32], "lib": [2, 5, 7], "contain": [2, 3, 6, 7, 10, 11, 12, 14, 17, 19, 20, 21, 23, 30, 32], "work": [2, 3, 8, 10, 11, 14, 15, 17, 18, 19, 20, 21, 23, 25, 29, 30, 31, 32], "": [2, 3, 4, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18, 19, 20, 22, 23, 24, 25, 29, 31, 32, 33], "requir": [2, 3, 5, 6, 11, 14, 15, 17, 18, 19, 20, 21, 22, 30, 31, 33, 34], "pass": [2, 6, 10, 11, 12, 14, 17, 20, 22, 23, 31, 32], "isystemextern": 2, "compil": [2, 6, 7, 11, 12, 13, 14, 15, 17, 20, 21, 22, 25, 28, 29, 30, 32, 33], "find": [2, 3, 6, 9, 10, 17, 19, 20, 24, 28], "satisfi": [2, 31], "them": [2, 3, 6, 10, 14, 17, 18, 19, 20, 21, 30, 32], "some": [2, 3, 6, 10, 14, 15, 16, 17, 18, 19, 23, 24, 29, 31, 32], "user": [2, 4, 7, 13, 16, 17, 18, 19, 20, 21, 25, 26, 28, 29, 30, 31, 33], "bring": [2, 3, 28], "pybind11": 2, "embed": [2, 10], "link": [2, 3], "against": [2, 24], "libpython": 2, "instead": [2, 5, 8, 14, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 30, 31, 33], "These": [2, 3, 6, 9, 10, 17, 20, 29, 33], "pybind11_emb": 2, "option": [2, 3, 4, 7, 14, 17, 19, 20, 29, 31, 33], "transit": [2, 18], "simpl": [2, 3, 9, 10, 17, 20, 22, 27, 32], "torch_xla": [2, 4, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18, 19, 20, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33], "csrc": [2, 6], "runtim": [2, 3, 4, 7, 13, 18, 19, 24, 27, 31, 32, 33], "configr": 2, "via": [2, 4, 13, 17, 26, 27, 28, 31, 32], "bazelrc": 2, "take": [2, 3, 10, 12, 14, 18, 19, 20, 21, 30, 31], "flag": [2, 3, 5, 11, 14, 15, 22], "config": [2, 3, 4, 11], "remote_cach": 2, "configur": [2, 3, 6, 13, 14, 17, 19, 20, 33], "gcloud": [2, 4, 17, 18, 20], "usual": [2, 3, 6, 16, 18, 19], "faster": [2, 5, 17, 20, 21, 23, 25, 30], "authent": [2, 17], "easi": [2, 10, 17, 18, 21, 30], "express": [2, 23, 28, 32], "complex": [2, 12, 23, 25], "lot": [2, 18, 19, 20, 21, 30], "gain": [2, 17], "have": [2, 3, 4, 5, 6, 7, 9, 10, 11, 14, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 30, 31, 33], "singl": [2, 5, 10, 14, 16, 21, 24, 25, 27, 28, 30, 31, 32, 34], "graph": [2, 10, 11, 12, 14, 16, 17, 18, 19, 20, 21, 23, 24, 25, 30, 31], "everyth": [2, 21, 24, 30], "therefor": [2, 19, 20], "separ": [2, 3, 6, 18, 20, 25, 27, 28], "rest": [2, 17, 19, 21, 30], "plu": [2, 24, 26], "whole": [2, 14, 16, 21, 25, 30], "everythin": 2, "els": [2, 19, 21, 30], "enough": [2, 20, 21, 30], "normal": [2, 3, 17, 21, 28, 30, 31], "achiev": [2, 6, 16, 24, 32], "invok": [2, 3, 25, 31], "standard": 2, "c": [2, 3, 6, 17, 19, 21, 22, 23, 30], "bind": 2, "simpli": [2, 17], "_xlac": [2, 12, 19, 21, 30], "client": [2, 7, 14, 17], "togeth": [2, 16, 17, 18, 24, 27, 31, 32], "when": [2, 3, 6, 8, 12, 14, 15, 16, 17, 18, 19, 20, 22, 23, 25, 27, 31, 32, 33], "chang": [2, 6, 15, 18, 19, 20, 21, 22, 24, 29, 30, 31], "abl": [2, 18, 21, 30, 33], "without": [2, 6, 11, 14, 17, 19, 20, 31, 32, 33], "iter": [2, 10, 14, 15, 18, 19, 20, 25, 31], "cycl": 2, "come": [2, 14, 21, 30], "There": [2, 3, 11, 16, 18, 19, 20, 21, 24, 25, 30, 31], "plenti": 2, "backend": [2, 3, 8, 14, 16, 17, 21, 25, 26, 29, 30, 31, 33], "we": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 34], "our": [2, 3, 4, 5, 6, 7, 8, 9, 15, 17, 18, 19, 21, 22, 24, 25, 30, 31, 32], "gc": [2, 33], "storag": [2, 4, 9, 18, 19, 20, 27, 33], "you": [2, 4, 7, 9, 11, 12, 14, 15, 16, 17, 18, 19, 20, 23, 24, 25, 27, 28, 31, 32, 34], "under": [2, 3, 6, 10, 14, 17, 18, 24], "disabl": [2, 14, 16, 19, 20], "default": [2, 6, 11, 14, 16, 17, 18, 19, 20, 22, 27, 31, 33], "speed": [2, 5, 10, 20, 21, 25, 30], "increment": [2, 3], "huge": [2, 19, 20, 21, 24, 30], "margin": 2, "almost": 2, "alwai": [2, 17, 18, 19, 21, 30, 32], "enabl": [2, 5, 12, 14, 15, 16, 19, 20, 22, 24, 29, 31, 32, 33], "ci": [2, 6], "To": [2, 3, 4, 6, 7, 9, 10, 12, 14, 15, 16, 17, 19, 20, 21, 27, 28, 30, 31, 33, 34], "ensur": [2, 10, 14, 21, 23, 28, 30, 31, 33], "credenti": 2, "auth": [2, 17], "applic": [2, 19, 29, 33], "login": [2, 20], "launch": [2, 5, 14, 17, 18, 20, 24, 25, 27], "browser": 2, "gcp": [2, 4, 17], "variou": [2, 12], "individu": [2, 27, 28, 32], "who": [2, 5, 24], "access": [2, 3, 6, 9, 14, 17, 18, 19, 20, 21, 30, 33], "project": [2, 4, 7, 17, 18, 20], "one": [2, 3, 5, 6, 9, 10, 14, 17, 18, 19, 20, 21, 25, 26, 27, 28, 30, 31, 32, 34], "onli": [2, 3, 5, 6, 8, 10, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 30, 32, 33], "specifi": [2, 5, 8, 11, 14, 18, 20, 27, 31, 32], "google_default_credenti": 2, "token": [2, 16, 20, 29], "out": [2, 6, 10, 14, 15, 16, 17, 18, 19, 20, 22, 25, 31], "box": [2, 6, 31], "log": [2, 19, 20], "permiss": 2, "add": [2, 3, 5, 6, 12, 14, 18, 19, 20, 21, 25, 26, 27, 30], "new": [2, 3, 4, 6, 8, 16, 18, 19, 20, 21, 25, 30, 31], "role": 2, "In": [2, 3, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 30, 31, 32, 33], "account": [2, 20], "kei": [2, 4, 5, 7, 10, 17, 19, 20, 33], "google_credenti": 2, "On": [2, 17, 33], "docker": 2, "network": [2, 14, 17, 18, 19, 22, 31, 32], "cloudbuild": 2, "down": [2, 5, 6, 20], "imag": [2, 17, 20, 21, 24, 27, 30], "do": [2, 3, 5, 6, 11, 13, 15, 17, 18, 19, 20, 21, 22, 23, 27, 29, 30, 31], "doe": [2, 3, 5, 14, 15, 17, 18, 19, 20, 21, 22, 23, 30, 31, 32], "read": [2, 4, 6, 14, 17, 31], "write": [2, 6, 12, 14, 18, 32], "silo": 2, "each": [2, 3, 5, 6, 8, 12, 14, 17, 18, 19, 20, 21, 23, 25, 27, 28, 30, 31, 32, 33], "uniqu": [2, 18, 20, 21, 23, 30], "benefit": [2, 5, 20, 28, 29, 33], "consist": [2, 8, 17], "remote_default_exec_properti": 2, "some_silo_kei": 2, "bazel_remote_cach": 2, "1": [2, 4, 7, 8, 9, 10, 11, 14, 16, 17, 18, 19, 22, 23, 24, 25, 26, 27, 28, 31, 32, 34], "silo_nam": 2, "your": [2, 3, 7, 10, 17, 18, 19, 20, 21, 23, 24, 28, 30, 31, 32, 33], "tpuvm_mod": 2, "gcloud_service_key_fil": 2, "application_default_credenti": 2, "json": [2, 5], "might": [2, 3, 6, 14, 18, 19, 20, 21, 30], "help": [2, 5, 10, 19, 20, 21, 30], "too": [2, 19, 21, 30], "cannot": [2, 9, 10, 20, 21, 22, 27, 30], "here": [2, 3, 5, 6, 9, 11, 15, 18, 20, 21, 24, 25, 27, 28, 30, 31, 32, 33], "author": 2, "usernam": [2, 5], "behavior": [2, 3, 6, 17, 18, 19, 22, 23], "function": [2, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19, 20, 25, 26, 28, 29, 33], "intend": 2, "first": [2, 3, 4, 5, 10, 11, 12, 14, 15, 17, 19, 20, 24, 31, 32, 33, 34], "time": [2, 3, 4, 5, 14, 15, 17, 18, 19, 20, 21, 23, 25, 26, 30, 31], "slow": [2, 5, 10, 19, 20], "scratch": [2, 3], "veri": [2, 7, 9, 10, 16, 18, 20, 21, 30], "fast": [2, 21, 30], "onc": [2, 8, 14, 18, 19, 20, 21, 23, 25, 30, 31], "again": [2, 3, 5, 18, 20], "bit": [2, 18, 29], "slower": [2, 10, 19, 20, 24], "per": [2, 14, 17, 18, 19, 22, 24, 25, 29], "until": [2, 14, 18, 20, 33], "next": [2, 5, 10, 14, 19, 20, 21, 29, 30, 31], "quit": 2, "current": [2, 5, 7, 9, 14, 15, 16, 17, 18, 20, 21, 23, 25, 26, 28, 29, 30, 31, 34], "migrat": [2, 13, 17], "futur": [2, 3, 4, 7, 15, 17, 18, 19, 20, 21, 23, 28, 30], "plafrom": 2, "cpp": [2, 5, 6], "main": [2, 3, 4, 8, 11, 12, 16, 17, 31], "Of": 2, "cours": 2, "pjrt": [2, 13, 14, 18, 31], "Not": 2, "environment": 2, "variabl": [2, 4, 5, 15, 17, 20, 21, 30], "miss": [2, 6, 14, 19], "common": [2, 5, 17, 21, 28, 29, 30, 32, 33], "part": [2, 3, 7, 12, 14, 16, 17, 19, 20, 31], "ones": [2, 14, 21, 30], "helper": [2, 3, 14], "script": [2, 3, 4, 9, 17, 18, 19, 20, 22, 24, 34], "run_test": 2, "sh": 2, "r": [2, 20], "xla_client": 2, "pure": [2, 3, 23], "easili": [2, 6, 21, 25, 30], "execut": [2, 5, 12, 14, 16, 17, 18, 20, 21, 22, 23, 24, 25, 30, 31, 32, 34], "parallel": [2, 13, 14, 17, 19, 24, 31, 32], "sinc": [2, 3, 5, 6, 17, 18, 19, 20, 21, 22, 24, 25, 28, 30, 33], "xrt": [2, 14], "port": [2, 17, 34], "gpu": [2, 6, 7, 9, 13, 15, 19, 20, 31], "tpu": [2, 3, 6, 7, 9, 10, 13, 14, 15, 19, 24, 25, 26, 32, 33, 34], "devic": [2, 3, 4, 6, 7, 8, 10, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 26, 29, 30, 33], "avail": [2, 14, 17, 18, 19, 20, 21, 27, 30, 34], "reason": [2, 3, 6, 16, 17, 20, 24], "bundl": 2, "target": [2, 16, 17, 18, 20, 21, 22, 25, 30], "sequenti": [2, 14], "calcul": 2, "visual": [2, 31, 32], "lcov": 2, "describ": [2, 3, 4, 11, 14, 18, 20, 22, 24, 32], "document": [2, 3, 4, 6, 7, 11, 17, 18, 22, 23, 24, 29], "editor": 2, "choic": [2, 21, 30], "gutter": 2, "vscode": 2, "power": 2, "like": [2, 3, 4, 5, 6, 9, 10, 11, 14, 17, 18, 19, 20, 21, 22, 27, 30, 31], "clangd": 2, "refer": [2, 3, 6, 8, 9, 12, 14, 15, 17, 18, 27, 29, 31, 32, 34], "autocomplet": 2, "semant": [2, 6, 19, 21, 30], "understand": [2, 11, 20, 21, 30], "underli": [2, 14, 18, 32], "stack": [2, 5, 10, 18, 19, 21, 22, 30, 31], "combin": [2, 6, 10, 14, 21, 23, 30], "studio": 2, "extens": [2, 4, 5, 6, 7], "featur": [2, 5, 9, 11, 15, 17, 19, 24, 28, 31, 32, 33], "assist": 2, "edit": 2, "As": [2, 3, 11, 20, 21, 23, 28, 30], "distutil": 2, "ltc": 3, "lazi": [3, 19, 20, 21, 25, 30, 31], "tensor": [3, 5, 6, 8, 10, 11, 14, 15, 17, 20, 22, 25, 26, 28, 29, 31, 32], "core": [3, 5, 6, 8, 14, 16, 17, 18, 19, 20, 24, 25, 26, 27, 28, 29, 32], "clean": [3, 5, 19, 25], "exist": [3, 14, 16, 17, 18, 19, 25, 31], "stub": 3, "over": [3, 5, 10, 14, 16, 17, 18, 20, 27, 32, 33], "6": [3, 4, 6, 10, 14, 19, 20, 21, 30, 32], "were": [3, 18, 19, 20, 21, 30], "complet": [3, 14, 18, 19], "process": [3, 6, 7, 8, 12, 14, 16, 17, 19, 20, 24, 27, 29], "found": [3, 17, 20], "ref": [3, 4, 17], "oper": [3, 5, 8, 10, 12, 13, 14, 17, 18, 20, 23, 32, 33], "xla_native_funct": [3, 6], "yaml": [3, 6], "blob": [3, 5, 8, 10, 12, 14, 17, 31], "master": [3, 10, 14, 17, 18, 33], "_": [3, 5, 10, 17, 25, 26], "replac": [3, 5, 10, 20, 26], "support": [3, 5, 7, 9, 10, 11, 12, 14, 15, 17, 21, 23, 25, 26, 27, 30, 31, 33, 34], "an": [3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 17, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 32, 33], "equival": 3, "full_codegen": 3, "NOT": 3, "introduc": [3, 8, 9, 16, 17, 19, 20, 23, 24, 31], "ani": [3, 9, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 27, 28, 30, 31, 32, 33, 34], "purpos": [3, 6, 10, 29], "info": [3, 5, 14, 19, 21, 30, 32], "about": [3, 4, 16, 17, 18, 20, 21, 30, 32], "dispatch": [3, 5, 6, 33], "exyang": 3, "blog": [3, 23], "post": [3, 14, 19, 23], "follow": [3, 5, 6, 9, 10, 11, 12, 14, 16, 17, 18, 19, 20, 21, 24, 27, 28, 30, 31, 32, 34], "instruct": [3, 5, 6, 20], "depend": [3, 4, 6, 15, 16, 18, 20, 21, 22, 23, 30, 32], "build": [3, 6, 18, 20, 27], "It": [3, 4, 5, 6, 8, 14, 15, 16, 18, 20, 21, 25, 27, 28, 29, 30, 31, 32], "experi": [3, 5, 6, 16, 17, 24, 33], "workstat": [3, 6], "cpu": [3, 6, 8, 14, 19, 20, 21, 27, 29, 30, 31, 33], "pjrt_devic": [3, 6, 7, 15, 17, 18, 19, 24, 26, 34], "re": [3, 14, 16, 17, 19, 20, 21, 22, 23, 26, 28, 30], "familiar": [3, 18, 28], "issu": [3, 5, 6, 10, 14, 16, 17, 18, 19, 20, 22, 24, 28], "3560": 3, "track": [3, 19, 33], "statu": [3, 19], "put": [3, 6, 18, 19, 24], "alia": [3, 8, 14], "avoid": [3, 19, 20, 22], "duplic": 3, "mention": [3, 6, 21, 25, 30], "below": [3, 6, 8, 11, 16, 17, 20, 21, 22, 30, 33, 34], "live": [3, 6, 14, 21, 30], "folder": [3, 4, 5, 6], "except": [3, 6, 20, 31], "torch": [3, 4, 5, 9, 10, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32, 33], "shape_infer": 3, "shape": [3, 6, 9, 10, 11, 12, 13, 14, 19, 20, 23, 26, 31, 32], "defin": [3, 6, 9, 11, 12, 14, 20, 22, 26, 28, 31, 32], "input": [3, 6, 8, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 22, 23, 26, 28, 31, 32, 33], "return": [3, 6, 7, 8, 9, 10, 11, 14, 16, 18, 19, 20, 21, 23, 24, 25, 26, 29, 30, 31, 33], "output": [3, 4, 5, 8, 9, 10, 11, 12, 14, 17, 18, 19, 22, 23, 24, 25, 26, 27, 31], "manual": [3, 6, 9, 16, 19, 27], "gen_lazy_tensor": 3, "data": [3, 5, 8, 13, 14, 16, 17, 18, 20, 21, 22, 25, 30, 32, 33], "aten": [3, 5, 6, 11, 19, 21, 30], "specif": [3, 5, 10, 14, 18, 20, 22, 24, 29, 32], "run_gen_lazy_tensor": 3, "dest": 3, "lazy_ir": 3, "class": [3, 7, 8, 10, 11, 14, 23, 24, 27, 29, 32, 33], "genlazyir": 3, "back": [3, 6, 14, 18, 19, 20, 31], "todai": [3, 15], "most": [3, 7, 14, 17, 19, 25], "categori": [3, 28], "goal": [3, 4, 6, 8, 16], "move": [3, 14, 17, 19, 21, 23, 24, 30, 33], "necessari": [3, 14, 19, 22], "call": [3, 5, 6, 8, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 30, 31, 33], "upstream": [3, 8, 15, 23, 25], "api": [3, 6, 11, 13, 17, 18, 21, 24, 25, 27, 29, 30, 31, 32, 33], "xlanativefunct": [3, 6], "column": 3, "declar": [3, 6], "anoth": [3, 5, 15, 18, 19, 20, 21, 30], "wrap": [3, 6, 7, 9, 14, 16, 18, 20, 22, 23, 24, 27, 28, 29, 31], "around": [3, 17, 21, 27, 30, 32], "xlatensor": [3, 6, 14, 31], "construct": [3, 6, 18, 20, 27, 31, 32, 33], "aten_xla_typ": [3, 6], "Will": 3, "method": [3, 11, 14, 17, 22, 28, 31, 33], "map": [3, 6, 8, 14], "node": [3, 6, 8, 12, 19, 21, 30, 34], "remov": [3, 17, 19, 20], "tensor_method": [3, 6], "possibl": [3, 17, 18, 19, 20, 27, 28, 31], "multipl": [3, 8, 14, 16, 21, 25, 29, 30, 32], "few": [3, 18, 19, 20, 21, 24, 30, 33], "simpler": [3, 17], "go": [3, 16, 18, 20, 22, 31], "unari": 3, "binari": [3, 5, 7, 25], "exampl": [3, 4, 5, 6, 7, 8, 11, 14, 15, 16, 17, 18, 19, 21, 23, 24, 25, 29, 30, 31, 32, 33, 34], "characterist": 3, "fallback": [3, 6], "_adaptive_avg_pool3d": 3, "condit": [3, 21, 26, 30], "issupportedadaptivepool": 3, "xlahelp": 3, "i64list": 3, "self": [3, 6, 7, 8, 10, 11, 14, 20, 23, 24, 29, 31], "size": [3, 8, 10, 12, 15, 17, 18, 19, 20, 21, 30, 32, 33], "output_size_list": 3, "pool_dim": 3, "nativ": [3, 5, 6, 16, 17, 19, 22, 24, 31], "call_fallback_fn": 3, "xla_fallback": 3, "aten_op": 3, "output_s": 3, "wip": 3, "evolv": 3, "At": [3, 5, 7, 14], "self_tensor": 3, "static": [3, 15, 21, 30], "bool": [3, 14], "sync_upd": 3, "sys_util": 3, "getenvbool": 3, "xla_tensor_update_sync": 3, "true": [3, 5, 14, 16, 17, 20, 21, 24, 27, 30, 31, 33], "xla_check": 3, "dst_tensor": 3, "updatefromtensor": 3, "sync": [3, 14, 16, 19, 20, 22], "complic": [3, 6, 9], "would": [3, 4, 6, 10, 14, 17, 18, 19, 20, 21, 26, 30], "someth": [3, 10, 20], "ab": [3, 27], "const": [3, 6, 8], "torch_lazy_fn_count": 3, "bridg": [3, 25], "atenfromxlatensor": 3, "getxlatensor": 3, "fail": [3, 5, 14, 18, 19, 33], "explain": [3, 7, 18, 19, 20, 21, 23, 30, 32], "later": [3, 20, 23], "still": [3, 8, 17, 18, 21, 22, 24, 30, 33], "If": [3, 4, 6, 10, 14, 17, 18, 19, 20, 21, 23, 29, 30, 31, 32], "while": [3, 8, 10, 11, 14, 20, 21, 24, 30], "error": [3, 11, 14, 18, 19], "involv": [3, 21, 30, 31], "problem": [3, 10, 21, 30], "yet": [3, 5, 6, 8], "attempt": [3, 33], "unblock": [3, 33], "snippet": [3, 18, 31, 32], "auto": [3, 6, 14, 27, 33], "common_devic": 3, "getxladevic": 3, "torch_internal_assert": 3, "xlatensorptr": 3, "lazy_self": 3, "getxlatensororcreateforwrappednumb": 3, "nodeptr": 3, "reusenod": 3, "getirvalu": 3, "makenod": 3, "cachenod": 3, "creat": [3, 5, 11, 12, 14, 17, 19, 20, 22, 23, 24, 31, 32, 33], "std": [3, 8, 24], "get": [3, 5, 6, 14, 15, 16, 17, 20, 21, 24, 27, 29, 30], "check": [3, 4, 6, 11, 14, 18, 29, 32], "reus": [3, 10, 18, 20, 22, 23], "previou": [3, 5, 17, 18, 20, 21, 30, 32], "creation": [3, 14], "correspond": [3, 6, 8, 14, 20, 22, 27, 31, 32], "cach": [3, 9, 14, 15, 20, 23], "newli": 3, "And": [3, 21, 24, 30, 31], "within": [3, 14, 18, 19, 20, 29, 32, 33], "note": [3, 4, 8, 9, 12, 14, 16, 17, 18, 19, 20, 21, 25, 27, 28, 29, 30, 32], "done": [3, 4, 9, 18, 19, 20, 21, 30], "public": [3, 17], "xlanod": 3, "xlavalu": 3, "opkind": [3, 6], "absoutputshap": 3, "num_output": [3, 21, 30], "mhash": 3, "string": [3, 8, 14, 31], "tostr": 3, "overrid": [3, 14, 22], "stringstream": 3, "ss": 3, "str": [3, 7, 11, 14], "xlaopvector": 3, "loweringcontext": 3, "loctx": 3, "A": [3, 4, 7, 14, 17, 18, 20, 21, 22, 28, 29, 30, 31, 32], "coupl": [3, 18, 19], "thing": [3, 19, 20, 23], "keep": [3, 4, 15, 17, 19, 21, 30], "mind": [3, 17, 19], "clone": [3, 17, 19, 20], "even": [3, 14, 17, 18, 19, 21, 23, 24, 30], "everi": [3, 5, 6, 9, 10, 14, 17, 18, 19, 21, 23, 25, 30, 31, 33], "outputshap": 3, "xla_shap": 3, "overli": 3, "simplifi": 3, "buildxxxop": 3, "slightli": [3, 6, 14], "better": [3, 6, 16, 17, 18, 19, 20, 21, 25, 26, 30], "maximumoutputshap": 3, "lower_for_shape_fn": 3, "absl": 3, "xlaop": [3, 6], "operand": 3, "promot": 3, "max": [3, 21, 30, 33], "second": [3, 5, 10, 11, 12, 15, 17, 19, 20, 24, 32, 34], "inferoutputshap": 3, "comput": [3, 4, 14, 17, 18, 19, 20, 21, 22, 23, 30, 31, 32], "logic": [3, 10, 14, 16, 21, 26, 30, 31, 32], "two": [3, 5, 7, 14, 17, 19, 20, 21, 30, 31, 32], "xla_input": 3, "getoutputop": 3, "returnop": 3, "buildab": 3, "origin": [3, 20], "genericop": 3, "modifi": [3, 20, 22, 25, 31], "abov": [3, 6, 7, 14, 15, 16, 17, 18, 19, 20, 21, 24, 25, 30, 32], "delet": 3, "sometim": [3, 20, 21, 30], "being": [3, 5, 14, 18, 20, 24, 32], "tensor_op": 3, "cross": [3, 14, 18, 31], "s1": [3, 31], "sub": 3, "mul": [3, 21, 30], "u2": 3, "v3": [3, 18, 24], "u3": 3, "v2": [3, 4, 18], "irnod": 3, "those": [3, 5, 6, 14, 19, 20, 24], "long": [3, 10, 16, 19, 20, 21, 24, 30], "term": [3, 12, 16, 19, 21, 30], "rid": [3, 21, 30], "composit": [3, 6], "end": [3, 6, 12, 14, 15, 17, 18, 19, 20, 24, 27, 28], "exp": 3, "pow": 3, "norm_exp": 3, "vector": [3, 12], "don": [3, 6, 15, 16, 17, 18, 19, 21, 27, 30], "t": [3, 6, 14, 15, 16, 17, 18, 19, 21, 22, 27, 28, 30, 31, 32, 33], "build_cpp_test": 3, "skip": [3, 6, 19, 25], "desir": [3, 20, 32, 33], "test_ptxla": 3, "gtest_filt": 3, "atenxlatensortest": 3, "testab": 3, "correct": [3, 21, 23, 30], "counter": [3, 6, 14, 19], "correctli": [3, 5, 19, 28], "bitwise_left_shift": 3, "pull": [3, 22, 24, 27], "8865": 3, "gt": [3, 4, 11, 17, 20], "erf": 3, "erfc": 3, "erfinv": 3, "3659": 3, "binary_cross_entropi": [3, 22], "backward": [3, 6, 10, 16, 17, 18, 22, 24, 25, 27, 28], "3809": 3, "scalar": [3, 6, 19, 21, 30], "addcdiv": 3, "addcmul": 3, "3768": 3, "neg": 3, "index": [3, 4, 7, 9, 14, 17, 18, 19, 20, 32, 34], "amin": 3, "amax": 3, "3771": 3, "special": [3, 11, 12, 20, 31], "partial": [3, 21, 27, 28, 30], "adaptive_avgpool3d": 3, "3790": 3, "guid": [4, 5, 9, 13, 17, 18, 20, 27, 28, 31], "interact": [4, 17], "start": [4, 5, 16, 17, 18, 19, 20], "colab": [4, 19], "kaggl": 4, "preinstal": [4, 17], "ecosystem": [4, 29], "packag": [4, 12, 13, 18, 20, 22, 24], "date": 4, "list": [4, 6, 10, 14, 20, 22, 23, 26, 31, 32], "readm": [4, 19, 20], "prerequisit": 4, "remot": 4, "quota": 4, "request": [4, 5, 6, 14, 19, 20, 21, 22, 24, 30, 31, 32], "offici": [4, 5, 19], "ssh": [4, 17, 18, 20], "regist": [4, 6, 7, 8, 11, 17, 33], "agent": 4, "alreadi": [4, 9, 12, 14, 19, 20, 21, 24, 27, 30, 33], "befor": [4, 8, 9, 14, 17, 18, 19, 20, 21, 22, 24, 25, 28, 30, 31, 33], "begin": [4, 18, 31], "zone": [4, 17, 18, 20], "tpu_typ": 4, "8": [4, 11, 12, 14, 16, 17, 18, 20, 21, 24, 25, 29, 30, 31, 32], "vm": [4, 17, 18, 19, 20, 24], "assum": [4, 7, 9, 14, 18, 21, 24, 28, 30, 31, 32], "id_ed25519": 4, "ubuntu2204": 4, "base": [4, 8, 14, 16, 17, 19, 20, 21, 23, 27, 30, 31, 32], "metadata": [4, 19], "cat": [4, 22], "pub": 4, "ip": [4, 14, 17, 33, 34], "format": [4, 11, 14, 19, 20, 25, 29], "valu": [4, 6, 10, 12, 14, 15, 17, 19, 20, 21, 23, 26, 30, 31, 34], "networkendpoint": 4, "accessconfig": 4, "externalip": 4, "123": 4, "give": [4, 19, 20, 29, 31, 32], "friendli": 4, "easier": [4, 16, 20, 21, 30], "echo": 4, "host": [4, 14, 17, 18, 19, 20, 22, 27, 33, 34], "n": [4, 14, 24, 29, 32], "hostnam": 4, "test": [4, 5, 7, 9, 12, 15, 17, 23, 24, 27, 34], "v": [4, 9, 10, 11, 17, 21, 23, 30], "palett": 4, "select": [4, 5, 14, 17, 33], "visualstudio": 4, "doc": [4, 9, 10, 14, 16, 17, 18, 21, 28, 30, 31], "__": [4, 17], "just": [4, 9, 16, 17, 18, 21, 24, 27, 30, 33], "titl": [4, 17], "open": [4, 5, 6, 7, 17, 19], "window": 4, "termin": [4, 33], "mkdir": 4, "ptxla": 4, "Then": [4, 5, 11, 20], "ui": 4, "venv": 4, "virtual": [4, 14], "latest": [4, 9, 10], "releas": [4, 7, 8, 9, 10, 17, 18, 19, 20, 25, 27, 28, 29, 31], "pip": [4, 9, 12, 20], "numpi": [4, 9, 11, 14, 20, 32], "f": [4, 9, 11, 14, 18, 24, 27, 29, 33], "googleapi": [4, 9, 20], "libtpu": [4, 7, 17], "wheel": [4, 20, 27], "html": [4, 9, 10, 17, 27], "import": [4, 5, 7, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33], "set_device_typ": 4, "print": [4, 5, 10, 11, 14, 15, 17, 18, 19, 20, 21, 23, 24, 25, 30, 31, 33], "real_devic": 4, "run": [4, 5, 6, 9, 10, 12, 13, 14, 15, 16, 17, 21, 22, 23, 24, 25, 29, 30, 32, 33], "2": [4, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 23, 25, 26, 27, 29, 31, 32, 34], "3": [4, 6, 7, 9, 10, 11, 12, 14, 16, 19, 20, 25, 26, 27, 29, 31, 32], "4": [4, 7, 9, 10, 11, 14, 17, 18, 19, 20, 21, 25, 26, 27, 29, 30, 31, 32], "5": [4, 8, 10, 14, 15, 19, 20, 21, 23, 24, 27, 29, 30, 32], "7": [4, 14, 19, 24, 25, 32], "number": [4, 5, 12, 14, 15, 16, 17, 19, 20, 23, 27, 31, 32], "vari": [4, 17, 21, 28, 30], "That": [4, 5, 10, 21, 23, 30], "now": [4, 5, 8, 11, 12, 16, 17, 18, 20, 21, 30, 31], "realist": 4, "show": [5, 8, 10, 11, 17, 18, 19, 24], "how": [5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 30, 31, 34], "contributor": 5, "xla": [5, 6, 10, 11, 12, 15, 16, 17, 21, 23, 24, 26, 28, 33, 34], "conda": 5, "forg": 5, "300e0ee13c08ef77e88f32204a2e0925c17ce216": 5, "l2c1": 5, "l11c53": 5, "probabl": [5, 21, 30], "interest": [5, 24], "o0": 5, "rel_with_deb_info": 5, "use_custom_debinfo": 5, "file1": 5, "file2": 5, "result": [5, 6, 8, 10, 14, 15, 17, 18, 19, 20, 24, 26, 31], "unoptim": [5, 19], "practic": [5, 17, 21, 28, 30, 32], "ll": [5, 6, 10, 21, 30], "want": [5, 6, 10, 11, 14, 16, 17, 18, 19, 20, 21, 25, 30, 31, 32, 34], "challeng": [5, 11], "becom": [5, 7, 9, 10, 17, 19, 20, 21, 30], "know": [5, 21, 23, 24, 30], "realiz": 5, "structur": [5, 27, 31], "basic": [5, 11, 18, 20, 21, 24, 30], "flow": [5, 19], "identifi": [5, 7, 14, 32, 33], "similar": [5, 6, 17, 20, 24, 26, 29], "src": [5, 31, 33], "linear": [5, 14, 17, 18, 22, 23, 24, 29], "session": 5, "breakpoint": 5, "discov": [5, 33], "addit": [5, 6, 7, 12, 17, 18, 19, 20, 22, 24], "rebuild": 5, "newfil": 5, "readi": [5, 20], "howev": [5, 6, 9, 10, 11, 19, 20, 31], "review": [5, 15, 28], "shortli": 5, "full": [5, 12, 14, 18, 19, 27], "unfortun": 5, "touch": [5, 24, 33], "its": [5, 6, 8, 15, 17, 18, 19, 23, 24, 25, 27, 31, 32], "timestamp": 5, "seem": [5, 24], "reliabl": [5, 17], "use_rocm_kernel_assert": 5, "off": [5, 20], "perform": [5, 6, 8, 9, 11, 12, 14, 16, 18, 22, 23, 24, 25, 27, 29, 31], "has_wmissing_prototyp": 5, "has_werror_missing_prototyp": 5, "util": [5, 9, 11, 13, 14, 18, 19, 24, 27, 28, 29, 32, 33], "scalarop": 5, "emptytensor": 5, "shut": 5, "pack": 5, "publish": 5, "microsoft": 5, "search": [5, 6], "tab": 5, "m": [5, 6, 8, 11, 21, 23, 27, 30, 32], "cpptool": 5, "sampl": [5, 11, 14, 17, 19], "adjust": [5, 18], "match": [5, 6, 11, 14, 18, 19], "interpret": [5, 14, 21, 30], "cppdbg": 5, "program": [5, 9, 10, 11, 12, 14, 19, 20, 21, 25, 30, 31, 32], "home": 5, "miniconda3": 5, "env": [5, 14, 17, 31], "torch310": 5, "bin": 5, "arg": [5, 11, 14, 18, 20, 26, 27], "cwd": 5, "workspacefold": 5, "externalconsol": 5, "fals": [5, 8, 11, 14, 18, 27, 31], "mimod": 5, "setupcommand": 5, "descript": 5, "pretti": [5, 16, 18, 21, 24, 30], "text": [5, 19], "ignorefailur": 5, "disassembli": 5, "flavor": 5, "intel": 5, "prelaunchtask": 5, "activ": [5, 14, 18, 19, 24, 27, 28, 29], "midebuggerpath": 5, "locat": [5, 14], "But": [5, 18, 19, 21, 30], "quirk": 5, "switch": [5, 10, 18, 19, 21, 24, 30], "between": [5, 8, 15, 17, 18, 19, 20, 21, 22, 24, 26, 30, 31], "vadimcn": 5, "yho_google_com": 5, "click": 5, "left": [5, 19], "red": 5, "dot": [5, 11, 19], "lower": [5, 10, 11, 13, 19, 20, 21, 22, 30], "third": 5, "dropdown": 5, "right": [5, 16, 21, 25, 30], "green": 5, "plai": 5, "button": 5, "press": 5, "trigger": [5, 19, 20, 21, 23, 30], "rule": [5, 20, 22], "notic": [5, 20], "fade": 5, "empti": [5, 14], "white": 5, "circl": 5, "librari": [5, 6, 7, 11, 20, 32, 33], "load": [5, 12, 14, 17, 19, 24, 27, 29, 33], "interpretor": 5, "bright": 5, "indic": [5, 14, 19, 20, 21, 30, 32], "einsum": [5, 23], "yellow": 5, "arrow": 5, "collect": [5, 17, 24, 25, 32, 33], "certain": [5, 8, 19, 21, 22, 30], "diagnost": 5, "turn": [5, 19], "cuda": [5, 14, 17, 18, 20, 21, 22, 29, 30, 34], "handl": [5, 7, 16, 19, 21, 27, 28, 30, 31, 32], "trace": [5, 10, 14, 16, 17, 18, 19, 20, 21, 22, 24, 25, 30, 31], "ld_library_path": 5, "cflag": 5, "dhas_torch_show_dispatch_trac": 5, "demonstr": [5, 8, 10, 20, 22, 28, 33], "offer": [6, 11, 28, 29], "implement": [6, 8, 9, 10, 16, 17, 19, 21, 25, 27, 28, 30], "convert": [6, 11, 14, 18, 23, 24], "higher": [6, 10, 19, 33], "level": [6, 10, 19, 20, 25, 29, 33], "represent": [6, 10, 14, 18, 20], "hlo": [6, 10, 14, 18, 19, 20], "beyond": 6, "scope": 6, "forward": [6, 11, 16, 22, 23, 24, 25, 28, 29], "haven": [6, 21, 30], "caus": [6, 14, 16, 17, 18, 19, 20, 21, 22, 30], "signific": [6, 19, 20, 25], "slowdown": [6, 19, 24], "must": [6, 7, 8, 10, 14, 17, 18, 19, 23, 28, 33, 34], "best": [6, 9, 25, 29, 32], "what": [6, 18, 20, 23], "debug": [6, 16, 21, 29, 30, 32], "pt": [6, 17, 18, 19, 20], "profil": [6, 17], "_ctc_loss": [6, 19], "_ctc_loss_backward": [6, 19], "contribut": 6, "definit": [6, 18, 21, 30], "native_funct": 6, "after": [6, 8, 10, 14, 17, 18, 19, 20, 21, 26, 30, 31], "kernel": [6, 10, 11, 13, 21, 29, 30], "aten_fallback": 6, "h": 6, "repo": [6, 18, 19, 20, 24], "sequenc": [6, 10, 14], "explicitli": [6, 18, 19, 20, 21, 22, 30], "compos": 6, "serv": [6, 20], "interfac": [6, 7, 18, 19, 28, 33], "machineri": [6, 11], "registerxla": 6, "registerautogradxla": 6, "entri": [6, 7], "pytorch_xla": 6, "world": [6, 9, 17, 21, 25, 30, 33], "written": [6, 20, 33], "paramet": [6, 14, 17, 18, 19, 22, 23, 24, 28, 31, 33, 34], "wrapper": [6, 18, 24, 27, 28], "inplac": [6, 14, 31], "ir": [6, 14, 19, 20, 21, 23, 30], "insid": [6, 18, 20, 23, 31], "stand": 6, "intermedi": [6, 10, 17, 19, 20], "smaller": [6, 20, 21, 30], "inherit": 6, "dai": 6, "unless": [6, 19, 21, 30], "verifi": 6, "test_oper": 6, "test_aten_xla_tensor": 6, "yield": [6, 18, 19], "break": [6, 20, 21, 30], "grasp": 6, "capabl": 6, "minim": [6, 20], "pr": [6, 19, 27], "vanilla": 6, "lerp": 6, "variant": [6, 21, 22, 30], "lerp_": 6, "scalar_out": 6, "tensor_out": 6, "prototyp": [6, 31], "weight": [6, 11, 14, 19, 28, 29], "lerp_out": 6, "namespac": [6, 19], "wrapper_scalar_lerp": 6, "No": [6, 15, 17, 21, 23, 29, 30], "deviceguard": 6, "omit": [6, 17, 32, 34], "anonym": 6, "wrapper_scalar_lerp_": 6, "wrapper_scalar_lerp__tmp": 6, "_copy_from": 6, "impl": [6, 8, 11], "torch_fn": 6, "automat": [6, 7, 13, 14, 17, 18, 19, 20, 21, 27, 30, 32, 33], "u": [6, 17, 19, 20, 21, 25, 30], "explicit": [6, 22, 27], "place": [6, 8, 14, 20, 22, 31, 33], "interned_str": 6, "symbol": [6, 21, 30], "submit": [6, 19, 20, 22], "team": [7, 25], "direclti": 7, "tf": [7, 19, 21, 30], "close": 7, "expos": [7, 17, 18, 20, 31], "deviceplugin": 7, "short": [7, 19, 21, 30], "pjrtclient": 7, "mirror": 7, "pjrt_api": 7, "straightforward": [7, 14, 20], "detail": [7, 8, 9, 10, 11, 14, 15, 17, 18, 19, 20, 21, 30, 32], "concret": [7, 21, 30], "placehold": 7, "pjrt_library_path": 7, "extra": [7, 24, 28], "multiprocess": [7, 14, 17, 18], "compon": 7, "least": [7, 20], "cpuplugin": 7, "def": [7, 8, 9, 10, 11, 12, 14, 16, 17, 18, 20, 23, 24, 25, 26, 28, 29], "library_path": 7, "o": [7, 17, 24], "join": [7, 14], "dirnam": 7, "__file__": 7, "pjrt_c_api_cpu_plugin": 7, "exmapl": 7, "pyproject": 7, "toml": 7, "torch_xla_cpu_plugin": 7, "With": [7, 9, 15, 17, 21, 25, 30], "initi": [7, 8, 14, 17, 18, 20, 24, 26, 33], "experiment": [7, 9, 10, 12, 13, 15, 16, 17, 18, 23, 24, 25, 26, 28, 31, 33], "state": [7, 10, 14, 27], "stabl": [7, 17, 27], "xla_model": [8, 17, 18, 19, 20, 24, 25, 26, 27, 28, 29, 32], "adopt": [8, 21, 30], "traceabl": [8, 10], "commun": [8, 9, 14, 17, 18, 20, 25, 32], "reimplement": [8, 17], "_c10d_function": 8, "figur": [8, 10, 15, 32], "all_reduc": [8, 14, 22], "processgroupxla": 8, "deriv": 8, "processgroup": 8, "xla_backend": [8, 17, 24, 33], "_create_xla_process_group": 8, "prefix_stor": 8, "rank": [8, 14, 17, 24, 27, 32, 33], "timeout": 8, "assert": [8, 24], "xr": [8, 14, 17, 18, 22, 24, 27, 28, 31, 32, 33], "is_spmd": [8, 14], "spmd": [8, 13, 18, 20, 33], "group": [8, 14, 17, 24, 31], "_register_xla_backend": 8, "dist": [8, 17, 24, 33], "register_backend": 8, "allreduc": 8, "all_reduce_opt": 8, "allgath": 8, "output_tensors_list": 8, "input_tensor": 8, "opt": [8, 18], "none": [8, 9, 11, 14, 19, 28, 31, 32], "_mp_fn": [8, 17, 18], "init_process_group": [8, 17, 24, 33], "init_method": [8, 17, 33], "progress": [8, 20], "instanc": [8, 9, 14, 27, 33], "distributed_c10d": 8, "_exception_logg": 8, "all_gath": [8, 14, 17], "tensor_list": 8, "async_op": 8, "_get_default_group": 8, "remap": 8, "_functional_collect": 8, "all_reduce_inplac": 8, "eventu": 8, "reach": [8, 14], "rewrit": [8, 20, 21, 30, 31], "reduceop": 8, "group_nam": 8, "torch_library_impl": 8, "four": [8, 20], "align": [8, 16], "signatur": 8, "remain": [8, 18, 20, 21, 30, 34], "restrict": 8, "appli": [8, 10, 14, 22, 27, 28, 33], "usag": [8, 14, 19, 20, 21, 27, 28, 30, 33], "test_collective_ops_tpu": 8, "scenario": [8, 25], "sum": [8, 10, 14, 22, 27, 28], "reduct": [8, 14], "aggreg": 8, "all_gather_into_tensor": 8, "gather": [8, 14, 19, 31], "reduce_scatter_tensor": 8, "reduc": [8, 10, 14, 15, 16, 17, 18, 19, 20, 27], "across": [8, 14, 17, 18, 19, 27, 32], "all_to_all_singl": 8, "output_split_s": 8, "input_split_s": 8, "although": [8, 17, 21, 30], "accept": [8, 31], "argument": [8, 12, 14, 20, 22, 23, 25, 27], "limit": [8, 14, 17, 18], "reflect": [8, 32], "compromis": 8, "maintain": 8, "constraint": [8, 17, 19], "alltoal": [8, 14], "rise": 9, "openai": [9, 12], "triton": [9, 13], "popular": 9, "order": [9, 10, 14, 18, 19, 20, 31, 32], "pariti": 9, "continu": [9, 17, 25], "push": 9, "let": [9, 17, 18, 19, 20, 25, 32], "custom_kernel": 9, "jax_import_guard": 9, "pl": [9, 17, 18, 31], "jnp": [9, 11], "add_vectors_kernel": 9, "x_ref": 9, "y_ref": 9, "o_ref": 9, "x": [9, 10, 11, 12, 14, 18, 19, 20, 21, 23, 24, 26, 27, 28, 29, 30, 31, 32], "y": [9, 10, 11, 12, 14, 19, 20, 21, 23, 27, 28, 29, 30, 31, 32], "jit": [9, 11, 12, 25], "add_vector": 9, "arrai": [9, 11, 14, 20, 28, 32], "pallas_cal": 9, "out_shap": 9, "shapedtypestruct": 9, "dtype": [9, 11, 12, 17, 21, 22, 23, 29, 30], "otherwis": [9, 14, 19, 20, 21, 28, 30], "hang": 9, "lock": 9, "q": [9, 11], "randn": [9, 11, 14, 16, 17, 18, 23, 24, 25, 29, 31, 32], "128": [9, 11, 17, 27, 29, 34], "k": [9, 11, 19], "make_kernel_from_palla": 9, "pt_kernel": 9, "lambda": [9, 23, 27], "liner": 9, "flash": [9, 10, 12], "attent": [9, 10, 11, 12], "besid": 9, "op": [9, 10, 11, 13, 14, 16, 19, 20, 21, 22, 30, 31, 32], "suppor": 9, "flash_attent": 9, "paged_attent": 9, "queri": [9, 17], "squeez": 9, "dim": [9, 10, 14], "key_cach": 9, "value_cach": 9, "context_len": 9, "block_tabl": 9, "pages_per_compute_block": 9, "megacore_mod": 9, "vllm": 9, "effect": [9, 14, 23], "memori": [9, 13, 14, 15, 19, 20, 21, 27, 30], "kv": 9, "proper": [9, 32], "jax_nightly_releas": 9, "jaxlib_nightly_releas": 9, "authorit": 9, "dev": [9, 20, 24], "en": [9, 10, 27], "consid": [10, 17, 20], "mani": [10, 14, 17, 19, 20, 21, 23, 30, 34], "homogen": 10, "layer": [10, 15, 16, 23, 27, 28, 31], "llm": [10, 20], "drop": [10, 15, 19], "loop": [10, 16, 18, 19, 20, 21, 23, 28, 30, 33], "bunch": [10, 11], "decod": [10, 16, 23], "subsequ": [10, 20], "significantli": [10, 17, 18, 20], "hand": [10, 18], "lax": 10, "readthedoc": [10, 27], "io": [10, 17, 27], "_autosummari": 10, "Its": [10, 14], "primari": 10, "hood": 10, "sort": [10, 21, 30], "itself": [10, 12, 14, 27], "typic": [10, 14], "transform": [10, 20, 27, 32], "run_decoder_lay": 10, "hidden_st": 10, "decoder_lay": 10, "unrol": 10, "flat": [10, 32], "shown": [10, 17, 21, 30], "decoder_with_scan": 10, "root": [10, 14, 21, 30], "python3": [10, 15, 17, 18, 19, 20, 23, 27], "train_decoder_only_bas": [10, 16, 19], "decoderwithscan": 10, "dimens": [10, 14, 15, 31, 32], "carri": [10, 21, 30, 31], "along": [10, 14, 27, 32], "fn": [10, 14], "callabl": [10, 14, 27], "tupl": [10, 11, 14, 21, 26, 28, 30, 32], "init": [10, 17, 18, 24, 25, 26], "roughli": 10, "equal": [10, 32], "len": [10, 14, 20], "append": [10, 19], "much": [10, 16, 17, 18, 20, 21, 23, 25, 30], "scan_exampl": 10, "scan_example_cumsum": 10, "cumul": [10, 26], "scan_example_pytre": 10, "pytre": 10, "final": [10, 24, 31], "histori": 10, "15": [10, 20], "count": [10, 14, 19], "mean": [10, 14, 17, 18, 19, 20, 21, 24, 28, 30, 31], "0000": 10, "5000": 10, "particular": [10, 20], "palla": [10, 13], "incompat": 10, "nightli": [10, 19, 20, 27, 31], "bound": 10, "compar": [10, 16, 17, 18, 19, 24, 25, 26], "fact": 10, "than": [10, 17, 19, 21, 24, 27, 30], "due": [10, 17, 19, 20, 34], "less": [10, 17, 21, 25, 30], "situat": 10, "anywai": 10, "save": [10, 14, 19, 23, 27, 33], "chip": [10, 16, 17], "hidden": 10, "256": [10, 17], "num": 10, "50": [10, 19, 20, 26], "head": 10, "2048": [10, 17], "step": [10, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 33], "metric": [10, 14, 24], "compiletim": [10, 19], "totalsampl": [10, 19], "accumul": [10, 14], "02m57s694ms418": 10, "595u": 10, "valuer": [10, 19], "02s112ms586": 10, "097u": 10, "rate": [10, 19, 24], "054285": 10, "percentil": [10, 19], "023ms113": 10, "470u": 10, "10": [10, 14, 17, 18, 19, 20, 21, 23, 24, 25, 26, 29, 30, 33], "20": [10, 15, 18, 19, 24, 29], "54s644ms733": 10, "284u": 10, "80": [10, 19], "01m03s028ms571": 10, "841u": 10, "90": [10, 19], "95": [10, 19], "99": [10, 19, 24], "29s996ms941": 10, "409u": 10, "02s529ms591": 10, "388u": 10, "158152": 10, "018ms636": 10, "571u": 10, "11s983ms003": 10, "171u": 10, "18s995ms301": 10, "667u": 10, "maximum": [10, 14, 15, 20, 29], "1m03": 10, "19": [10, 24, 25], "7253": 10, "comment": [10, 21, 30], "accomplish": 11, "exportedprogram": 11, "fx": [11, 25], "exported_program_to_stablehlo": 11, "mlir": 11, "torchvis": [11, 16, 25], "torch_xla2": 11, "tx": 11, "resnet18": [11, 16, 25], "sample_input": 11, "224": [11, 16], "mlir_modul": 11, "store": [11, 12, 14, 19], "feel": [11, 15, 19, 24], "explor": 11, "org": [11, 14, 17, 27], "tutori": [11, 12, 19, 20, 24, 31], "jfunc": 11, "shapeddtypestruct": 11, "float32": [11, 22], "last": [11, 19, 32], "scaled_dot_product_attent": 11, "decompos": 11, "low": [11, 15, 19], "dure": [11, 14, 19, 20, 25, 27, 31], "captur": [11, 14, 19, 20], "downstream": [11, 22], "ml": [11, 32], "crucial": 11, "geneart": 11, "pattern": [11, 19, 21, 25, 30], "prone": 11, "robust": 11, "outlin": [11, 29], "pratic": 11, "scaled_product_attent": 11, "centric": 11, "unittest": 11, "nn": [11, 14, 17, 18, 24, 25, 27, 29, 31], "impl_abstract": 11, "jaten": 11, "jlibrari": 11, "mylib": 11, "sdpa": 11, "compositeexplicitautograd": 11, "_mylib_scaled_dot_product_attent": 11, "product": 11, "transpos": [11, 21, 30], "dropout_p": 11, "is_caus": 11, "_mylib_scaled_dot_product_attention_meta": 11, "empty_lik": [11, 12], "decomposit": 11, "register_torch_composit": 11, "softmax": 11, "register_jax_composit": 11, "_aten_softmax": 11, "_softmax": 11, "static_argnum": 11, "librarytest": 11, "testcas": 11, "manual_se": [11, 14, 17], "default_env": 11, "use_torch_native_for_cpu_tensor": 11, "test_basic_sdpa_librari": 11, "customopexampl": 11, "rand": [11, 21, 30], "32": [11, 14, 19, 20, 32], "64": [11, 16, 25, 27], "module_str": 11, "todo": 11, "produc": [11, 21, 22, 24, 30], "assertin": 11, "__name__": [11, 17, 18, 24], "__main__": [11, 17, 18, 24], "emit": 11, "repres": [11, 14, 17, 21, 30], "region": [11, 14, 16, 19, 22, 31], "th": [11, 32], "high": [12, 15, 20, 24, 29], "deep": [12, 13, 19], "learn": [12, 17], "languag": [12, 23], "empow": 12, "potenti": [12, 14, 17, 19, 28], "given": [12, 14, 19, 20, 21, 23, 24, 27, 30, 32], "add_kernel": 12, "x_ptr": 12, "pointer": 12, "y_ptr": 12, "output_ptr": 12, "n_element": 12, "block_siz": 12, "tl": 12, "constexpr": 12, "element": [12, 14, 21, 28, 30, 31, 32], "01": 12, "l28": 12, "pid": 12, "program_id": 12, "axi": [12, 14, 28, 32], "block_start": 12, "offset": 12, "arang": 12, "mask": [12, 19, 21, 30], "xla_triton": 12, "16": [12, 18, 20, 27, 29, 32], "int64": 12, "grid": 12, "cdiv": 12, "triton_cal": 12, "kwarg": [12, 14, 27, 31], "payload": [12, 14, 17], "regard": [12, 18, 25], "buffer": [12, 14, 23], "_xla_gpu_custom_cal": 12, "dep": 12, "connect": [13, 14, 17, 31], "overview": [13, 32], "eager": [13, 14, 21, 24, 29, 30], "mode": [13, 14, 21, 24, 29, 30, 31, 33], "troubleshoot": 13, "stablehlo": [13, 14], "scan": 13, "scan_lay": 13, "mix": [13, 14, 32], "precis": 13, "advanc": [13, 32], "topic": [13, 32], "distribut": [13, 18, 19, 24, 27, 28, 31, 32], "checkpoint": [13, 17, 20, 27, 32], "distributeddataparallel": [13, 17], "ddp": [13, 17], "torchdynamo": 13, "while_loop": 13, "shard": [13, 14, 33], "quantiz": 13, "recompil": [13, 15, 16, 18, 19, 20], "hardwar": [13, 14, 19, 20, 22], "plugin": [13, 17], "bazel": 13, "int": [14, 17, 21, 23, 30, 31], "device_count": [14, 31], "address": [14, 17, 31, 34], "wait": [14, 19, 20], "pend": [14, 16], "whether": [14, 18, 22], "block": [14, 20, 27, 31], "finish": [14, 20], "full_graph": 14, "num_different_graphs_allow": 14, "lazytensor": [14, 16, 20], "happen": [14, 16, 17, 18, 19, 20, 21, 30], "decid": [14, 19, 21, 23, 30], "funciton": 14, "act": [14, 18], "context": [14, 17, 19, 21, 22, 30], "throw": [14, 18], "exit": [14, 19, 22, 24], "pt_xla_debug": 14, "messag": [14, 19], "dump": [14, 19], "allow": [14, 18, 19, 20, 22, 31, 32, 33], "rais": [14, 19], "exceed": 14, "foo": 14, "sin": [14, 23], "co": 14, "foo2": 14, "compiled_foo2": 14, "seed": 14, "random": [14, 16, 17, 20, 23, 29], "integ": [14, 19, 32], "rng": [14, 17], "device_typ": 14, "local_process_count": 14, "local_device_count": 14, "total": [14, 21, 30, 32], "addressable_device_count": 14, "visibl": [14, 21, 30], "global_device_count": 14, "global_runtime_device_count": [14, 28, 31, 32], "especi": [14, 17, 20, 25, 31], "world_siz": [14, 17, 22, 24, 27, 31], "particip": [14, 17], "job": [14, 20, 25], "global_ordin": [14, 17, 18, 24, 27], "global": [14, 17, 18, 23, 31, 33], "ordin": [14, 18], "thread": [14, 17, 18, 19, 33], "guarante": [14, 23], "predict": 14, "relationship": [14, 18, 19], "worker": [14, 17, 18, 20, 27, 33], "id": [14, 17, 19, 20, 32], "nor": 14, "contigu": [14, 18, 19], "local_ordin": 14, "get_master_ip": 14, "retriev": [14, 18, 21, 25, 30, 31], "discoveri": 14, "use_spmd": [14, 31, 32, 33], "forc": [14, 17, 19, 21, 26, 30], "non": [14, 16, 21, 22, 23, 30, 32], "replic": [14, 31, 32], "spmd_advanc": 14, "md": [14, 17], "initialize_cach": [14, 18], "readonli": [14, 18], "persist": [14, 18, 33], "xla_devic": [14, 17, 18, 19, 20, 22, 24, 25, 26, 29, 32], "devkind": 14, "deprec": 14, "xla_device_hw": 14, "union": 14, "real": [14, 25], "is_master_ordin": 14, "multi": [14, 15, 31, 34], "num_host": 14, "boolean": 14, "reduce_typ": 14, "float": [14, 21, 22, 30], "pin_layout": 14, "One": [14, 15, 20, 27], "xm": [14, 16, 18, 19, 20, 22, 24, 25, 26, 27, 28, 29, 32], "reduce_sum": 14, "reduce_mul": 14, "reduce_and": 14, "reduce_or": 14, "reduce_min": 14, "reduce_max": 14, "replica": [14, 17], "layout": [14, 29, 32], "pine": 14, "prevent": [14, 20, 22, 25, 31], "corrupt": 14, "unpin": 14, "hlomodul": 14, "constrain": [14, 17], "hold": [14, 31], "channel_id": 14, "use_global_device_id": 14, "channel": [14, 29], "replicagroup": 14, "all_to_al": 14, "split_dimens": 14, "concat_dimens": 14, "split_count": 14, "www": 14, "operation_semant": 14, "upon": 14, "split": [14, 32], "concat": 14, "add_step_closur": 14, "closur": 14, "run_async": 14, "report": 14, "consol": 14, "tensorboard": [14, 20], "etc": [14, 16, 19, 21, 30, 31], "intermediari": 14, "inspect": 14, "barrier": [14, 17, 18, 20], "materi": [14, 19, 20, 21, 30, 31], "queu": 14, "though": [14, 18, 24], "advis": 14, "throttl": 14, "event": 14, "asynchron": [14, 31, 33], "wait_device_op": 14, "async": [14, 25], "whose": [14, 15, 32], "optimizer_step": [14, 18, 20, 22, 24, 27], "optimizer_arg": 14, "dict": [14, 23, 27], "gradid": 14, "parallelload": [14, 31], "dataparallel": 14, "loader": [14, 19, 20, 25], "dictionari": 14, "gradient": [14, 18, 22, 27, 33], "file_or_path": 14, "textio": 14, "master_onli": [14, 27], "global_mast": 14, "transfer": [14, 17, 19, 20, 31], "care": [14, 18, 19, 21, 30], "taken": [14, 18, 19, 21, 24, 30, 33], "view": [14, 18, 19], "recreat": [14, 18], "destin": [14, 18], "nest": [14, 27], "control": [14, 15, 18, 19, 31], "obj_to_sav": 14, "path_to_sav": 14, "rendezv": 14, "tag": [14, 17], "byte": 14, "b": [14, 17, 20, 21, 22, 23, 25, 30, 32], "mesh": [14, 17, 28], "server": [14, 17, 20], "xla_rendezv": 14, "sent": [14, 19], "exchang": 14, "posit": 14, "mesh_reduc": 14, "reduce_fn": 14, "toxlatensorarena": 14, "receiv": 14, "copi": [14, 17, 18, 19, 20], "np": [14, 28, 32], "accuraci": [14, 24, 27], "test_accuraci": 14, "set_rng_stat": 14, "get_rng_stat": 14, "get_memory_info": 14, "memoryinfo": 14, "bytes_us": 14, "290816": 14, "bytes_limit": 14, "34088157184": 14, "peak_bytes_us": 14, "500816": 14, "get_stablehlo": 14, "var": [14, 31], "xla_hlo_debug": [14, 19], "get_stablehlo_bytecod": 14, "bytecod": [14, 25], "parallel_load": [14, 17, 18, 19], "mpdeviceload": [14, 18, 20, 31], "dataload": [14, 18, 20, 24, 31, 33], "background": [14, 33], "upload": [14, 20, 31], "per_device_load": [14, 31], "constructor": 14, "train_device_load": 14, "train_load": [14, 18, 31], "xla_multiprocess": 14, "spawn": [14, 17, 18, 20], "nproc": [14, 17], "daemon": 14, "start_method": 14, "moment": 14, "valueerror": 14, "mark_shard": [14, 23, 28, 31, 32], "xlashardedtensor": [14, 33], "partition_spec": [14, 31, 32], "nonetyp": 14, "annot": [14, 31, 32], "partit": [14, 31], "spec": [14, 31], "intern": [14, 17, 18, 19, 21, 30, 31, 34], "spmdpartition": [14, 31], "topologi": [14, 18, 31], "partitionspec": 14, "ax": [14, 31, 32], "mesh_shap": [14, 28, 31, 32], "impact": [14, 17, 19, 21, 24, 30], "num_devic": [14, 28, 31, 32], "device_id": [14, 28, 31, 32], "clear_shard": 14, "clear": 14, "cast": [14, 22], "t1": [14, 18, 19, 32], "get_1d_mesh": 14, "set_global_mesh": 14, "get_global_mesh": 14, "axis_nam": [14, 31], "v4": [14, 16, 17, 18, 20, 25, 31], "ndarrai": 14, "flatten": 14, "reshap": 14, "fill": 14, "row": [14, 32], "major": [14, 32], "global_runtime_device_attribut": [14, 32], "length": [14, 21, 30], "get_xla_supported_devic": 14, "get_logical_mesh": [14, 32], "ordereddict": [14, 31, 32], "hybridmesh": [14, 31], "ici_mesh_shap": [14, 31], "dcn_mesh_shap": [14, 31], "hybrid": 14, "ici": 14, "dcn": [14, 31], "increas": [14, 23], "intens": 14, "mdl": 14, "inner": [14, 27, 31], "outer": [14, 27, 28, 31], "slice": [14, 20, 31, 32], "fsdp": [14, 27, 28, 31, 32], "eager_mod": [14, 16], "wa": [14, 17, 19, 20, 21, 30, 33], "d": [14, 15, 21, 22, 30], "eagerli": [14, 16, 18, 19, 21, 30], "metrics_report": [14, 19], "short_metrics_report": [14, 19], "counter_nam": 14, "metric_nam": 14, "counter_valu": 14, "metric_data": 14, "total_sampl": 14, "retain": 14, "circular": 14, "natur": 15, "in_tensor": 15, "randint": [15, 29], "out_tensor": 15, "nonzero": [15, 19, 20, 21, 30], "word": [15, 21, 23, 30], "25": 15, "further": [15, 20, 24], "categor": 15, "unbound": 15, "alloc": [15, 32], "infinit": [15, 28], "phase": 15, "perceptron": 15, "mlp": 15, "xla_experiment": 15, "masked_select": 15, "masked_scatt": 15, "your_script": [15, 20], "100": [15, 19, 23, 27], "29": [15, 24, 25], "49": [15, 25], "03": 15, "102": 15, "hit": [15, 21, 30], "198": 15, "1953": 15, "motiv": 15, "excess": 15, "half": 15, "try": [15, 19, 20, 21, 30], "test_dynamic_shape_model": 15, "testdynamicshapemodel": 15, "test_backward_pass_with_dynamic_input": 15, "plan": [15, 17], "expand": [15, 25], "rfc": [15, 31, 34], "mark_step": [16, 17, 18, 19, 20, 24], "actual": [16, 20, 21, 24, 30, 31], "drawback": 16, "approach": [16, 21, 24, 27, 30], "often": [16, 19, 21, 23, 30], "confus": 16, "preprocess": [16, 29], "small": [16, 19, 20, 21, 24, 25, 30], "leak": 16, "expens": [16, 19, 21, 30], "hard": [16, 21, 24, 25, 30], "why": [16, 21, 30], "mitig": 16, "ux": 16, "mark": [16, 18], "compiled_model": 16, "awai": 16, "straight": 16, "enter": 16, "reenabl": 16, "perfomr": 16, "recommen": 16, "overhad": 16, "step_fn": 16, "loss_fn": [16, 17, 18, 22, 24, 25], "zero_grad": [16, 17, 18, 22, 24], "logit": [16, 28], "loss": [16, 17, 18, 22, 25, 27, 28], "ask": [16, 19, 21, 30], "refactor": 16, "llama2": 16, "fake": [16, 33], "300": [16, 19], "observ": [16, 17, 24], "147": 16, "65": [16, 19], "45": 16, "perfomran": 16, "tri": [16, 20], "resnet50": [16, 17, 18, 25, 27], "exepct": 16, "meant": 16, "encount": [17, 19, 20], "bug": [17, 19, 24], "r2": [17, 19, 31], "renam": 17, "torchrun": [17, 18, 34], "xpu": 17, "neuron": 17, "xrt_tpu_config": 17, "30": [17, 27], "thousand": 17, "preview": 17, "safe": 17, "section": [17, 18, 19, 20, 31, 32], "broadcast": 17, "broadcast_master_param": 17, "pjrt_backend": 17, "diff": [17, 20], "42": [17, 23], "gradient_as_bucket_view": [17, 24], "mseloss": [17, 24], "sgd": [17, 18, 22, 24, 25], "lr": [17, 18, 24, 25, 27, 28], "001": [17, 24], "confirm": 17, "p": [17, 19, 21, 30], "localservic": 17, "localhost": 17, "51011": 17, "master_addr": 17, "master_port": 17, "12355": [17, 34], "Or": [17, 18, 21, 30], "overhead": [17, 23, 24, 25], "grpc": 17, "torchbench": 17, "35": [17, 19], "tpuvm": [17, 18, 20, 31], "mnist": [17, 18, 19, 22], "test_train_mp_mnist": [17, 24], "fake_data": [17, 19, 24, 34], "alpha": [17, 18], "central2": [17, 20], "git": [17, 19, 20, 27], "depth": [17, 19], "branch": [17, 19, 21, 30], "test_train_mp_imagenet": [17, 19, 24], "batch_siz": [17, 27, 34], "num_epoch": [17, 24, 27], "By": [17, 21, 30], "tpu_process_bound": 17, "tpu_visible_chip": 17, "r1": 17, "13": [17, 18, 24, 26], "docker_imag": 17, "gcr": 17, "privat": 17, "sudo": [17, 20], "rm": 17, "privileg": 17, "net": [17, 20, 22], "gpu_num_devic": 17, "nnode": [17, 34], "num_gpu_devic": 17, "pjrt_distribut": 17, "physic": [17, 31, 32], "12": [17, 19, 25, 27], "number_gpu_vm": [17, 34], "node_rank": [17, 34], "current_node_rank": 17, "nproc_per_nod": [17, 34], "number_local_gpu_devic": 17, "rdzv_endpoint": [17, 34], "internal_ip_address": 17, "multinode_train": 17, "endpoint": [17, 34], "form": [17, 19, 21, 30, 34], "machine_0": 17, "machine_1": 17, "machine_0_internal_ip_address": [17, 34], "ident": 17, "page": 17, "mostli": [17, 27], "interchang": 17, "perspect": [17, 18], "subtl": 17, "importantli": [17, 23], "architectur": [17, 27], "thu": [17, 19], "batch": [17, 18, 19, 20, 31], "latenc": 17, "serial": [17, 18], "deseri": 17, "send": [17, 18, 20, 31], "direct": [17, 19], "independ": [17, 18, 19], "xla_dist": 17, "scp": [17, 18], "sdk": 17, "enhanc": 17, "stabil": [17, 19, 22], "xmp": [17, 18, 20], "substanti": 17, "unreli": 17, "inbound": 17, "could": [17, 20, 21, 30, 31, 32], "failur": 17, "entir": [17, 27], "restart": 17, "impos": 17, "middl": [17, 20, 21, 30], "unwant": 17, "permit": 17, "subset": [17, 32], "old": 17, "alter": 17, "synchron": [17, 18, 20, 31, 33], "all_gather_object": 17, "gloo": [17, 24, 33], "subgroup": 17, "monitor": 17, "altern": [17, 21, 22, 29, 30], "strongli": 17, "_all_gath": 17, "int32": 17, "zeros_lik": 17, "get_world_s": 17, "averag": 17, "task": 17, "175": 17, "chart": 17, "breakdown": 17, "tfrt": 17, "legaci": 17, "streamexecutor": 17, "tpu_legaci": 17, "comparison": [17, 32], "regular": [18, 19, 20, 29], "t0": 18, "matrix": 18, "multipli": [18, 32], "mm": [18, 22], "neural": 18, "l_in": 18, "l_out": 18, "floattensor": 18, "highlight": [18, 20], "nllloss": 18, "momentum": 18, "acquir": 18, "mp_device_load": 18, "three": 18, "multithread": [18, 19], "assign": [18, 20], "own": [18, 27], "onto": 18, "preload": [18, 20], "overlap": [18, 20, 25, 31], "batches_per_execut": 18, "consolid": [18, 27], "all_reduce_gradi": 18, "parent": 18, "talk": 18, "howto": 18, "focu": [18, 21, 30], "train_mnist_xla": 18, "outsid": 18, "infrastructur": 18, "awar": 18, "fakedata": 18, "immedi": [18, 31], "record": [18, 19, 20, 23], "defer": 18, "fuse": [18, 20], "invis": 18, "caller": 18, "insert": [18, 20], "paper": 18, "opaqu": [18, 19], "appear": [18, 19, 20], "unlik": [18, 20], "preserv": [18, 19], "appreci": 18, "accommod": 18, "previous": 18, "state_dict": [18, 27, 33], "footprint": 18, "xser": 18, "stream": 18, "amount": [18, 19, 20, 21, 30], "restor": 18, "load_state_dict": [18, 33], "unavail": [18, 19], "consum": [18, 21, 30], "doesn": [18, 19, 21, 28, 30], "disk": 18, "occur": 18, "your_cache_path": 18, "mount": 18, "mp_fn": 18, "tmp": [18, 19, 27], "xla_cache_": 18, "runnabl": [18, 24, 28], "subject": 19, "peculiar": 19, "detial": 19, "__version__": 19, "cu121": 19, "t2": [19, 32], "200": 19, "rx": 19, "conclud": 19, "diagnos": 19, "extrem": [19, 23], "pt_xla_debug_level": 19, "slip": 19, "analyz": [19, 20], "summari": 19, "frequent": 19, "21": 19, "11": [19, 21, 30], "transferfromdevicetim": 19, "23": 19, "hash": 19, "c74c3b91b855b2b123f833b0d5f86943": 19, "107": 19, "frame": 19, "dk3": 19, "1055": 19, "44": 19, "__next__": 19, "train_loop_fn": 19, "48": [19, 24], "start_train": 19, "73": 19, "548000": 19, "gb": 19, "922460": 19, "alias": [19, 22], "547871": 19, "124478": 19, "028210": 19, "steptrac": 19, "frequenc": 19, "pair": 19, "met": 19, "spent": [19, 20], "destroi": 19, "202": 19, "06m09s401ms746": 19, "001u": 19, "778ms572": 19, "062u": 19, "425201": 19, "001ms32": 19, "778u": 19, "001ms61": 19, "283u": 19, "001ms79": 19, "236u": 19, "001ms110": 19, "973u": 19, "001ms228": 19, "773u": 19, "001ms339": 19, "183u": 19, "001ms434": 19, "305u": 19, "002ms921": 19, "063u": 19, "21s102ms853": 19, "173u": 19, "cachedsynctensor": 19, "395": [19, 24], "area": 19, "rout": 19, "qualifi": 19, "33": [19, 24, 25], "_local_scalar_dens": 19, "epoch": [19, 20, 27], "clear_al": 19, "xla_dynamo_debug": 19, "bottleneck": [19, 20, 23], "notebook": 19, "train_resnet_benchmark": 19, "behav": 19, "evalu": [19, 20, 21, 23, 30], "suggest": 19, "bad": 19, "degrad": [19, 20], "speedup": [19, 25], "constant": [19, 20, 31], "indirect": 19, "solut": [19, 21, 29, 30], "variat": 19, "pad": [19, 20, 21, 30, 32], "fix": [19, 20, 23, 25, 28], "translat": 19, "item": [19, 20], "substitut": 19, "clip_grad_norm": 19, "problemat": 19, "clip_grad_norm_": 19, "dramat": 19, "total_norm": 19, "zero": [19, 27, 33], "param_norm": 19, "grad": 19, "norm": 19, "norm_typ": 19, "add_": 19, "clip_coef": 19, "max_norm": 19, "1e": [19, 25], "mul_": 19, "data_parallel": 19, "dataset": [19, 24, 27], "stride": 19, "reconstruct": 19, "shallow": 19, "ty": 19, "made": [19, 20, 21, 30, 31], "_get_xla_tensors_text": [19, 21, 30], "_get_xla_tensors_hlo": 19, "prior": [19, 33], "degre": 19, "xla_ir_debug": 19, "henc": [19, 25], "respons": [19, 20, 25, 33], "propag": 19, "xla_save_tensors_fil": 19, "realli": [19, 21, 25, 30], "big": [19, 21, 30], "sheet": 19, "xla_save_tensors_fmt": 19, "graphviz": 19, "xla_flag": 19, "xla_dump_to": 19, "dir_nam": 19, "optimz": 19, "xla_metrics_fil": 19, "xla_save_hlo_fil": 19, "offend": 19, "xla_sync_wait": 19, "xla_use_eager_debug_mod": 19, "bypass": 19, "overal": [19, 20], "optimizaiton": 19, "tf_cpp_log_thread_id": 19, "tf_cpp_vmodul": 19, "vlog": 19, "tf_cpp_min_log_level": 19, "warn": 19, "tf_vlog": 19, "xla_dump_hlo_graph": 19, "xla_util": 19, "cc": 19, "save1": 19, "xla_graph_executor": 19, "pjrt_computation_cli": 19, "dir": 19, "pytorch_test_with_slow": 19, "test_torch": 19, "test_put_xla_uint8": 19, "torch_test_devic": 19, "pytorch_test_bas": 19, "brief": 20, "reader": 20, "modif": 20, "fetch": 20, "discuss": [20, 32], "readabl": 20, "opcod": 20, "fed": 20, "attach": [20, 31], "callback": 20, "xla_tensor_z": 20, "cut": [20, 21, 30], "transferfromdevic": 20, "tell": [20, 21, 30], "properti": [20, 21, 30], "illustr": [20, 32], "suppos": 20, "tensors_on_devic": 20, "z": [20, 21, 30], "subgraph": [20, 21, 30], "signal": 20, "far": 20, "suitabl": 20, "trade": [20, 21, 30], "spend": 20, "fusion": 20, "worth": [20, 21, 30], "latter": [20, 27], "runtime_vers": 20, "project_id": 20, "accelerator_typ": 20, "tpu_nam": 20, "your_tpu_nam": 20, "subnetwork": 20, "tpusubnet": 20, "pip3": 20, "cp38": 20, "linux_x86_64": 20, "whl": 20, "apt": 20, "libopenbla": 20, "libgl1": 20, "hypercomput": 20, "recipi": 20, "guidelin": 20, "bar": 20, "rememb": 20, "txt2img": 20, "prompt": 20, "photograph": 20, "astronaut": 20, "ride": 20, "hors": 20, "relat": 20, "precision_scop": 20, "addition": [20, 22, 27], "frozenclipembedd": 20, "simplic": [20, 21, 30], "ddim": 20, "top": 20, "attr": 20, "statement": [20, 21, 30], "stop": 20, "fall": [20, 28], "difficult": 20, "investig": [20, 24], "cover": [20, 31], "huggingfac": 20, "sd": 20, "xl": 20, "cd": [20, 27], "text_to_imag": 20, "inference_tpu_single_devic": 20, "lora": 20, "model_id": 20, "stabilityai": 20, "9": [20, 21, 24, 27, 30], "pipelin": 20, "dpmsolvermultistepschedul": 20, "txt": 20, "invisible_watermark": 20, "safetensor": 20, "agre": 20, "licens": 20, "card": 20, "cli": 20, "_your_copied_token__": 20, "pipe": 20, "hour": 20, "wherea": 20, "likewis": 20, "gpt": 20, "min": 20, "advantag": 20, "mayb": 20, "piec": 20, "__call__": 20, "commit": 20, "caveat": 20, "thumb": 20, "durat": [20, 33], "constantli": 20, "idl": 20, "inference_tpu_": 20, "capture_profil": 20, "gap": 20, "xp": 20, "measur": 20, "portion": 20, "busi": 20, "scroll": 20, "occupi": 20, "displai": 20, "largest": 20, "zoom": 20, "timelin": 20, "period": 20, "examin": 20, "did": 20, "pipe_watermark": 20, "closer": 20, "preced": 20, "proceed": [20, 28], "watermark": 20, "cv2": 20, "pywt": 20, "leav": 20, "broken": 20, "rerun": 20, "scale_model_input": 20, "dynamo": [20, 25, 29], "ran": 20, "my_funct": 20, "preocess": 20, "debug_single_process": 20, "magic": [20, 21, 30], "treat": [20, 32], "xla_no_special_scalar": 20, "hurt": [21, 30], "perf": [21, 30], "pov": [21, 30], "sai": [21, 30], "assur": [21, 30], "gone": [21, 30], "coverag": [21, 30], "aim": [21, 28, 30], "explan": [21, 30], "mainli": [21, 30], "beginn": [21, 30], "propos": [21, 30], "reli": [21, 30], "impract": [21, 30], "assumpt": [21, 30], "ye": [21, 29, 30], "sentenc": [21, 30], "bucket": [21, 30, 33], "kinda": [21, 30], "anti": [21, 30], "frontend": [21, 30], "matter": [21, 30], "workaround": [21, 30], "okai": [21, 30], "teach": [21, 30], "theoret": [21, 30], "obviou": [21, 30], "s64": [21, 30], "inde": [21, 30], "_get_xla_tensor_dimension_s": [21, 30], "commonli": [21, 30, 32], "wrong": [21, 30], "wors": [21, 30], "upper": [21, 30], "nit": [21, 30], "solv": [21, 30], "kept": [21, 30], "earli": [21, 30], "accessor": [21, 30], "2d": [21, 28, 30, 32], "implicitli": [21, 30], "doubl": [21, 30], "overload": [21, 30], "explod": [21, 30], "convers": [21, 30], "cheap": [21, 30], "ve": [21, 30], "hoc": [21, 30], "think": [21, 30], "verison": [21, 30], "bla": [21, 30], "blabla": [21, 30], "proce": [21, 30], "uglier": [21, 30], "win": [21, 30], "pars": [21, 30], "torchscript": [21, 30], "somehow": [21, 30], "merg": [21, 30], "lazili": [21, 30, 31, 33], "properli": [21, 30], "thought": [21, 30], "trivial": [21, 30], "effort": [21, 30, 31], "side": [21, 23, 30], "bandwidth": [21, 30], "automag": [21, 30], "gold": [21, 30], "smart": [21, 30], "trick": [21, 30], "tbh": [21, 30], "longer": [21, 30], "unawar": [21, 30], "hope": [21, 30], "smash": [21, 30], "blocker": [21, 30], "ahead": [21, 30], "nnc": [21, 30], "exactli": [21, 23, 30], "brian": [21, 30], "hirsh": [21, 30], "bdhirsh": [21, 30], "question": [21, 30], "stick": [21, 30], "torch_warn": [21, 30], "yea": [21, 30], "hei": [21, 30], "won": [21, 22, 30], "blaze": [21, 30], "isn": [21, 30, 33], "abil": [21, 24, 30], "devirtu": [21, 30], "sound": [21, 30], "great": [21, 30], "truth": [21, 30], "irvalu": [21, 30], "enforc": [21, 30], "discrep": [21, 30], "followup": [21, 30], "1000": [21, 30], "my": [21, 30, 33], "presenc": [21, 30], "get_dimention_s": [21, 30], "didn": [21, 30], "exponenti": [21, 30], "blowup": [21, 30], "fewer": [21, 30], "opportun": [21, 30], "recogn": [21, 25, 30], "feasibl": [21, 30], "annoi": [21, 30], "wasn": [21, 30], "materiz": [21, 30], "combo": [21, 30], "extend": 22, "datatyp": 22, "float16": 22, "bfloat16": [22, 29], "syncfre": 22, "autocast": 22, "summar": 22, "elig": 22, "suppli": 22, "addmm": 22, "addmm_": 22, "prefer": 22, "float64": 22, "respect": [22, 32], "unlist": 22, "__matmul__": 22, "addbmm": 22, "addmv": 22, "addr": 22, "baddbmm": 22, "bmm": 22, "conv1d": 22, "conv2d": [22, 27], "conv3d": 22, "conv_transpose1d": 22, "conv_transpose2d": 22, "conv_transpose3d": 22, "matmul": 22, "relu": [22, 24], "prelu": 22, "max_pool2d": 22, "batch_norm": 22, "log_softmax": 22, "binary_cross_entropy_with_logit": 22, "prod": 22, "cdist": 22, "chloeski": 22, "invers": 22, "reflection_pad": 22, "replication_pad": 22, "mse_loss": 22, "cosine_embbeding_loss": 22, "nll_loss": 22, "multilabel_margin_loss": 22, "qr": 22, "svd": 22, "triangular_solv": 22, "linalg_svd": 22, "linalg_inv_ex": 22, "widest": 22, "index_copi": 22, "scaler": [22, 29], "gradscal": 22, "_fetch_gradi": 22, "xla_use_f16": 22, "underflow": 22, "imagenet": 22, "elimin": 23, "primer": 23, "exce": 23, "math": 23, "pseudo": 23, "unnecessari": [23, 31], "Such": 23, "decor": 23, "repeatedli": 23, "do_some_math": 23, "simul": 23, "ten": [23, 26], "func": 23, "functional_cal": 23, "mymodul": [23, 31], "__init__": [23, 24, 29], "super": [23, 24, 25], "pure_forward": 23, "param": 23, "cached_forward": 23, "named_paramet": 23, "named_buff": 23, "unit": [23, 24], "testbridge_test_onli": 23, "test_trace_transformer_with_spda_attent": 23, "test_assume_pur": 23, "benchmark_iter": 23, "140": 23, "1342": 23, "24": 23, "1658": 23, "pai": 23, "front": 23, "minimum": [24, 27, 28], "nccl": 24, "new_rank": 24, "ddp_model": 24, "launcher": 24, "demo_fn": 24, "five": 24, "sy": 24, "tempfil": 24, "cleanup": 24, "destroy_process_group": 24, "toymodel": 24, "net1": 24, "1000000": 24, "net2": 24, "demo_bas": 24, "label": 24, "run_demo": 24, "tot": 24, "statist": 24, "median": 24, "90th": 24, "deviat": 24, "cv": 24, "418": 24, "54": 24, "419": 24, "22": 24, "430": 24, "40": 24, "76": 24, "02": 24, "97": 24, "407": 24, "60": 24, "39": 24, "17864": 24, "20108": 24, "96": 24, "24351": 24, "74": 24, "5866": 24, "83": 24, "10701": 24, "11770": 24, "00": 24, "14313": 24, "78": 24, "3102": 24, "92": 24, "41": [24, 25], "round": 24, "heavili": [24, 25], "sens": 24, "amort": 24, "logdir": 24, "converg": 24, "caution": 24, "known": 24, "crash": 24, "unmodifi": 25, "hook": 25, "biggest": [25, 27], "torchfx": 25, "technologi": 25, "a_xla": 25, "b_xla": 25, "compiled_cod": 25, "eval_model": 25, "xla_resnet18": 25, "eval": 25, "dynamo_resnet18": 25, "no_grad": 25, "resent18": 25, "analysi": 25, "bench": 25, "59": 25, "resnext50_32x4d": 25, "91": 25, "alexnet": 25, "28": 25, "mobilenet_v2": 25, "18": 25, "62": 25, "mnasnet1_0": 25, "68": 25, "vgg16": 25, "bert_pytorch": 25, "squeezenet1_1": 25, "timm_vision_transform": 25, "52": 25, "geomean": 25, "04": 25, "train_model": 25, "crossentropyloss": 25, "pred": 25, "train_model_main": 25, "dynamo_train_model": 25, "xla_optim": 25, "weight_decai": 25, "extract": 25, "07": 25, "43": 25, "81": 25, "87": 25, "fwd": 25, "bwd": 25, "e2": 25, "hide": 25, "larger": [25, 27], "wit": 25, "promis": 25, "tradit": 25, "excit": 25, "upcom": [25, 31], "invest": 25, "matur": 25, "stori": 25, "_higher_order_op": 26, "fori_loop": 26, "cond_fn": 26, "body_fn": 26, "bodi": 26, "iteri": 26, "init_v": 26, "functionaltensor": 26, "lvl": 26, "51": 26, "xlafullyshardeddataparallel": 27, "my_modul": [27, 28], "adam": [27, 28], "0001": [27, 28], "leftov": [27, 28], "arxiv": 27, "1910": 27, "02054": 27, "reshard_after_forward": 27, "test_train_mp_mnist_fsdp_with_ckpt": 27, "test_train_mp_imagenet_fsdp": 27, "interleav": 27, "submodul": 27, "fsdpvitmodel": 27, "checkpoint_modul": [27, 28], "3524": 27, "auto_wrap_polici": [27, 28], "size_based_auto_wrap_polici": 27, "polici": [27, 31], "100m": 27, "transformer_auto_wrap_polici": [27, 28], "transformer_layer_cl": [27, 28], "auto_wrapper_cal": 27, "remateri": 27, "resum": 27, "get_shard_metadata": 27, "consolidate_sharded_model_checkpoint": 27, "stitch": 27, "ckpt": 27, "shard_metadata": 27, "ckpt_path": 27, "pth": 27, "consolidate_sharded_ckpt": 27, "ckpt_prefix": 27, "your_sharded_checkpoint_fil": 27, "ckpt_suffix": 27, "_rank": 27, "inspir": 27, "fairscal": 27, "fullyshardeddataparallel": 27, "resort": 27, "train_resnet_fsdp_auto_wrap": 27, "newer": 27, "recurs": [27, 28], "98": 27, "drop_last": 27, "use_nested_fsdp": 27, "use_gradient_checkpoint": 27, "final_ckpt": 27, "75": 27, "download": 27, "1k": 27, "datadir": 27, "test_set_batch_s": 27, "eval_interv": 27, "num_warmup_epoch": 27, "lr_scheduler_divide_every_n_epoch": 27, "lr_scheduler_divisor": 27, "residu": 27, "algorithm": [27, 28], "ronghanghu": 27, "vit_10b_fsdp_exampl": 27, "vit": 27, "fsdpv2": 28, "famou": 28, "enjoi": 28, "tabl": 28, "spmd_fully_sharded_data_parallel": 28, "spmdfullyshardeddataparallel": 28, "autowrap": 28, "decoderlay": 28, "functool": 28, "decoder_only_model": 28, "shard_output": 28, "0th": 28, "children": 28, "fork": 28, "hf": 28, "abstract": [29, 31], "blockwis": 29, "int4": 29, "analog": 29, "classifi": 29, "flexibl": 29, "choos": [29, 33], "docstr": 29, "xla_quantized_matmul": 29, "n_input_featur": 29, "n_output_featur": 29, "w_int": 29, "127": 29, "int8": 29, "matmul_output": 29, "quantized_matmul": 29, "x_xla": 29, "w_int_xla": 29, "scaler_xla": 29, "matmul_output_xla": 29, "w": 29, "f_dynamo": 29, "dynamo_out_xla": 29, "myqlinearforxlabackend": 29, "load_weight": 29, "processed_w": 29, "processed_scal": 29, "stuff": 29, "orig_model": 29, "mymodel": 29, "q_weight": 29, "q_weights_for_xla": 29, "process_for_xla": 29, "q_linear": 29, "xlaquantizedlinear": 29, "in_featur": 29, "out_featur": 29, "load_quantized_weight": 29, "sym": 29, "asym": 29, "w8a16": 29, "w8a8": 29, "w4a8": 29, "gspmd": [31, 32], "proced": 31, "_input_sharding_": 31, "4d": 31, "input_shard": 31, "shardingspec": 31, "input_mesh": 31, "s2": 31, "s3": 31, "s4": 31, "_after": 31, "_the": 31, "forth": 31, "techniqu": 31, "decis": 31, "nice": 31, "arrang": [31, 32], "center": 31, "multislic": 31, "denot": 31, "hardcod": 31, "delai": 31, "subclass": 31, "__torch_dispatch__": 31, "global_tensor": 31, "strictli": 31, "local_shard": 31, "xlashard": 31, "4e8e5511555073ce8b6d1a436bf808c9333dcac6": 31, "xla_sharded_tensor": 31, "l12": 31, "ongo": 31, "distributedtensor": 31, "proof": 31, "concept": [31, 32], "distribute_tensor": 31, "devicemesh": 31, "big_tensor": 31, "100000": 31, "88": 31, "my_dtensor": 31, "stai": 31, "dynamo_mark_shard": 31, "placement": 31, "visualize_tensor_shard": 31, "visualize_shard": 31, "rich": 31, "2x2": 31, "generated_t": 31, "use_color": 31, "style": [31, 32], "tile": 31, "partial_repl": 31, "envvar": 31, "xla_auto_spmd": 31, "_tensor": 31, "distribute_modul": 31, "auto_polici": 31, "device_mesh": 31, "sharded_model": 31, "behvaior": 31, "xla_auto_use_group_shard": 31, "reshard": 31, "xla_auto_spmd_mesh": 31, "unset": 31, "conceptu": 32, "matric": 32, "book": 32, "hint": 32, "strategi": 32, "dimension": 32, "mpi": 32, "necessarili": 32, "512": 32, "3d": 32, "1d": 32, "interconnect": 32, "core_on_chip": 32, "num_cor": 32, "coord": 32, "attribut": 32, "slice_index": 32, "coordin": 32, "divis": 32, "dedic": 33, "planner": 33, "spmdsaveplann": 33, "spmdloadplann": 33, "dist_cp": 33, "distributed_checkpoint": 33, "xc": 33, "storage_writ": 33, "filesystemwrit": 33, "checkpoint_dir": 33, "storage_read": 33, "filesystemread": 33, "all_step": 33, "save_async": 33, "preemption": 33, "detect": 33, "provis": 33, "queuedresourc": 33, "autocheckpoint": 33, "chkpt_on_preempt": 33, "fsspec": 33, "filesystem": 33, "prime_optim": 33, "chkpt_mgr": 33, "tracked_step": 33, "highest": 33, "best_step": 33, "prime": 33, "enumer": 33, "unprim": 33, "destruct": 33, "nvidia": 34, "resnet": 34, "num_gpu_machin": 34, "rank_of_current_machin": 34, "machine_0_ip_address": 34, "training_or_inference_script_using_spmd": 34, "xla_use_spmd": 34, "test_train_spmd_imagenet": 34}, "objects": {"": [[14, 0, 0, "-", "torch_xla"]], "torch_xla": [[14, 1, 1, "", "compile"], [14, 1, 1, "", "device"], [14, 1, 1, "", "device_count"], [14, 1, 1, "", "devices"], [14, 0, 0, "-", "experimental"], [14, 1, 1, "", "manual_seed"], [14, 0, 0, "-", "runtime"], [14, 1, 1, "", "sync"]], "torch_xla.core": [[14, 0, 0, "-", "xla_model"]], "torch_xla.core.xla_model": [[14, 1, 1, "", "add_step_closure"], [14, 1, 1, "", "all_gather"], [14, 1, 1, "", "all_reduce"], [14, 1, 1, "", "all_to_all"], [14, 1, 1, "", "get_memory_info"], [14, 1, 1, "", "get_rng_state"], [14, 1, 1, "", "get_stablehlo"], [14, 1, 1, "", "get_stablehlo_bytecode"], [14, 1, 1, "", "is_master_ordinal"], [14, 1, 1, "", "mesh_reduce"], [14, 1, 1, "", "optimizer_step"], [14, 1, 1, "", "rendezvous"], [14, 1, 1, "", "save"], [14, 1, 1, "", "set_rng_state"], [14, 1, 1, "", "wait_device_ops"], [14, 1, 1, "", "xla_device"], [14, 1, 1, "", "xla_device_hw"]], "torch_xla.debug": [[14, 0, 0, "-", "metrics"]], "torch_xla.debug.metrics": [[14, 1, 1, "", "counter_names"], [14, 1, 1, "", "counter_value"], [14, 1, 1, "", "metric_data"], [14, 1, 1, "", "metric_names"], [14, 1, 1, "", "metrics_report"], [14, 1, 1, "", "short_metrics_report"]], "torch_xla.distributed": [[14, 0, 0, "-", "parallel_loader"], [14, 0, 0, "-", "spmd"], [14, 0, 0, "-", "xla_multiprocessing"]], "torch_xla.distributed.parallel_loader": [[14, 2, 1, "", "MpDeviceLoader"]], "torch_xla.distributed.spmd": [[14, 2, 1, "", "HybridMesh"], [14, 2, 1, "", "Mesh"], [14, 1, 1, "", "clear_sharding"], [14, 1, 1, "", "get_1d_mesh"], [14, 1, 1, "", "get_global_mesh"], [14, 1, 1, "", "mark_sharding"], [14, 1, 1, "", "set_global_mesh"]], "torch_xla.distributed.xla_multiprocessing": [[14, 1, 1, "", "spawn"]], "torch_xla.experimental": [[14, 1, 1, "", "eager_mode"]], "torch_xla.runtime": [[14, 1, 1, "", "addressable_device_count"], [14, 1, 1, "", "device_type"], [14, 1, 1, "", "get_master_ip"], [14, 1, 1, "", "global_device_count"], [14, 1, 1, "", "global_ordinal"], [14, 1, 1, "", "global_runtime_device_count"], [14, 1, 1, "", "initialize_cache"], [14, 1, 1, "", "is_spmd"], [14, 1, 1, "", "local_device_count"], [14, 1, 1, "", "local_ordinal"], [14, 1, 1, "", "local_process_count"], [14, 1, 1, "", "use_spmd"], [14, 1, 1, "", "world_size"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"]}, "titleterms": {"learn": [0, 1, 13], "about": [0, 1, 13], "gpu": [0, 12, 17, 22, 34], "tpu": [1, 4, 17, 18, 20, 22, 27, 31], "bazel": 2, "pytorch": [2, 3, 4, 5, 7, 8, 9, 11, 13, 14, 18, 19, 20, 25, 27, 30, 31, 32], "xla": [2, 3, 4, 7, 8, 9, 13, 14, 18, 19, 20, 22, 25, 27, 29, 30, 31, 32], "depend": [2, 9, 12], "how": [2, 23, 24, 29, 32], "build": [2, 5], "librari": 2, "torch": [2, 8, 11, 17, 31], "plugin": [2, 7], "remot": 2, "cach": [2, 18], "run": [2, 3, 18, 19, 20, 31, 34], "test": [2, 3, 6, 19, 26], "code": [2, 4, 20, 29], "coverag": 2, "languag": 2, "server": 2, "codegen": 3, "migrat": 3, "guid": [3, 6, 10, 32], "befor": [3, 6], "you": [3, 5, 6, 10, 21, 30], "start": [3, 6, 21, 30], "file": [3, 5, 6], "structur": [3, 6], "old": 3, "op": [3, 6, 8, 29], "lower": [3, 6, 8], "step": [3, 4], "1": [3, 20, 21, 30], "identifi": 3, "2": [3, 20, 21, 28, 30], "inspect": 3, "gener": [3, 11], "lazyir": 3, "h": 3, "3": [3, 21, 30], "implement": [3, 7, 20], "miss": 3, "ir": 3, "function": [3, 23], "torch_xla": [3, 14, 21], "csrc": 3, "ops_xla_shape_fn": 3, "cpp": 3, "4": 3, "ops_lower_fn": 3, "5": 3, "cleanup": 3, "verifi": 3, "result": 3, "sampl": 3, "pr": 3, "configur": [4, 5], "develop": 4, "environ": [4, 19], "visual": [4, 5], "studio": 4, "creat": [4, 18], "connect": 4, "your": [4, 5, 9], "set": 4, "up": [4, 23], "workspac": 4, "next": 4, "c": [5, 7], "debug": [5, 14, 19, 31], "why": 5, "would": 5, "need": 5, "thi": [5, 10], "instal": [5, 27], "gdb": 5, "The": [5, 19], "gnu": 5, "project": 5, "debugg": 5, "symbol": 5, "ensur": 5, "i": [5, 21, 30, 32], "built": [5, 9], "vscode": 5, "lldb": 5, "us": [5, 9, 10, 11, 21, 23, 24, 26, 28, 29, 30, 32], "": [5, 21, 30], "A": [5, 19], "realist": 5, "command": 5, "futur": 5, "work": 5, "understand": [6, 19], "oper": [6, 11, 19, 21, 22, 29, 30], "unit": [6, 19], "tip": 6, "custom": [7, 9, 12], "hardwar": 7, "pjrt": [7, 17], "api": [7, 8, 14, 16], "packag": 7, "support": [8, 22, 29], "distribut": [8, 14, 17, 33], "collect": 8, "stack": 8, "non": 8, "dynamo": [8, 19], "case": [8, 21, 26, 30], "descript": 8, "kernel": [9, 12], "via": [9, 12], "palla": 9, "adopt": 9, "abov": 9, "compat": [9, 10], "flashattent": 9, "exampl": [9, 10, 20, 22, 26, 27, 28], "usag": [9, 16, 26], "integr": [9, 25, 31], "pagedattent": 9, "write": 9, "own": 9, "scan": 10, "scan_lay": 10, "when": [10, 21, 30], "should": 10, "limit": [10, 23], "aotautograd": 10, "requir": 10, "overhead": 10, "compil": [10, 16, 18, 19, 31], "time": 10, "experi": 10, "refer": [10, 20], "export": 11, "stablehlo": 11, "extract_jax": 11, "preserv": 11, "high": 11, "level": 11, "composit": 11, "triton": 12, "document": 13, "acceler": 13, "featur": [13, 25, 29], "improv": 13, "workload": 13, "perform": [13, 17, 19, 20], "contribut": 13, "runtim": [14, 17], "xla_model": 14, "spmd": [14, 28, 31, 32, 34], "experiment": [14, 29], "dynam": [15, 21, 30], "shape": [15, 21, 30], "bound": [15, 21, 30], "eager": 16, "mode": [16, 32], "basic": 16, "infer": [16, 20, 25], "train": [16, 17, 25, 27], "benchmark": [16, 19, 23, 24], "tl": 17, "dr": 17, "benefit": 17, "quickstart": 17, "cpu": [17, 18], "pod": [17, 18, 20, 27, 31], "docker": 17, "singl": [17, 18, 20], "node": 17, "multi": [17, 18], "differ": 17, "from": [17, 18, 21, 30], "xrt": 17, "multithread": 17, "v2": 17, "v3": [17, 27], "chang": 17, "xm": 17, "rendezv": 17, "new": 17, "devic": [18, 20, 31, 32], "an": 18, "tensor": [18, 19, 21, 23, 30], "ar": 18, "model": [18, 29], "multipl": [18, 20], "process": [18, 33], "deep": 18, "dive": 18, "lazi": [18, 23], "memori": [18, 26], "layout": 18, "move": 18, "save": 18, "load": [18, 31], "further": [18, 32], "read": [18, 32], "troubleshoot": 19, "saniti": 19, "check": 19, "version": 19, "simpl": [19, 26], "calcul": 19, "resnet": [19, 27], "With": 19, "fake": [19, 24], "data": [19, 24, 27, 28, 31], "tool": [19, 31], "auto": [19, 31], "metric": 19, "analysi": [19, 20], "execut": 19, "get": 19, "report": 19, "clear": 19, "profil": [19, 20], "known": 19, "caveat": 19, "quirk": 19, "more": 19, "variabl": 19, "common": 19, "combin": 19, "reproduc": 19, "ci": 19, "cd": 19, "failur": 19, "overview": 20, "setup": 20, "convert": 20, "stabl": 20, "diffus": 20, "lightn": 20, "hf": 20, "sourc": [21, 30], "recompil": [21, 30], "let": [21, 30], "first": [21, 30], "some": [21, 30], "fact": [21, 30], "constraint": [21, 30], "input": [21, 30], "dataset": [21, 30], "output": [21, 28, 30], "can": [21, 30], "fix": [21, 30], "without": [21, 30], "queri": [21, 30], "its": [21, 30], "real": [21, 24, 30], "dimens": [21, 30], "what": [21, 30, 32], "control": [21, 26, 30], "flow": [21, 30], "conclus": [21, 30], "appendix": [21, 30], "automat": 22, "mix": 22, "precis": 22, "amp": 22, "best": 22, "practic": 22, "assume_pur": 23, "speed": 23, "trace": 23, "background": [23, 24], "motiv": [23, 24], "nn": 23, "modul": [23, 29], "do": 24, "distributeddataparallel": 24, "ddp": 24, "resnet50": 24, "mnist": [24, 27], "disclaim": 24, "torchdynamo": 25, "gap": 25, "take": 25, "awai": 25, "optim": [26, 31, 33], "util": 26, "while_loop": 26, "group": [26, 33], "pure": 26, "python": 26, "while": 26, "loop": 26, "fulli": [27, 28], "shard": [27, 28, 31, 32], "parallel": [27, 28], "script": 27, "imagenet": 27, "clone": 27, "repo": 27, "8": 27, "50": 27, "10": 27, "billion": 27, "paramet": 27, "gradient": 28, "checkpoint": [28, 33], "huggingfac": 28, "llama": 28, "quantiz": 29, "call": 29, "swap": 29, "matrix": 29, "multipli": 29, "advanc": 31, "topic": 31, "awar": 31, "host": 31, "virtual": 31, "hybrid": 31, "mesh": [31, 32], "xlashardedtensor": 31, "dtensor": 31, "activ": 31, "user": 32, "partit": 32, "spec": 32, "which": 32, "hold": 32, "checkpointmanag": 33, "restor": 33, "state": 33}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"Learn about GPUs": [[0, "learn-about-gpus"]], "Learn about TPUs": [[1, "learn-about-tpus"]], "Bazel in Pytorch/XLA": [[2, "bazel-in-pytorch-xla"]], "Bazel dependencies": [[2, "bazel-dependencies"]], "How to build XLA libraries": [[2, "how-to-build-xla-libraries"]], "How to build the Torch/XLA plugin": [[2, "how-to-build-the-torch-xla-plugin"]], "Remote caching": [[2, "remote-caching"]], "Running tests": [[2, "running-tests"]], "Code coverage": [[2, "code-coverage"]], "Language Server": [[2, "language-server"]], "Building PyTorch/XLA": [[2, "building-pytorch-xla"]], "Codegen migration Guide": [[3, "codegen-migration-guide"]], "Before you start": [[3, "before-you-start"], [6, "before-you-start"]], "File structure": [[3, "file-structure"], [6, "file-structure"]], "PyTorch Codegen files": [[3, "pytorch-codegen-files"]], "PyTorch/XLA Codegen files": [[3, "pytorch-xla-codegen-files"]], "PyTorch/XLA Old Op Lowering files": [[3, "pytorch-xla-old-op-lowering-files"]], "Codegen step by step": [[3, "codegen-step-by-step"]], "1. Identify the op": [[3, "identify-the-op"]], "2. Codegen the op and inspect the generated file": [[3, "codegen-the-op-and-inspect-the-generated-file"]], "LazyIr.h": [[3, "lazyir-h"]], "3. Implement the missing IR function": [[3, "implement-the-missing-ir-function"]], "torch_xla/csrc/ops/ops_xla_shape_fn.h": [[3, "torch-xla-csrc-ops-ops-xla-shape-fn-h"]], "torch_xla/csrc/ops/ops_xla_shape_fn.cpp": [[3, "torch-xla-csrc-ops-ops-xla-shape-fn-cpp"]], "4. Implement the lowering function": [[3, "implement-the-lowering-function"]], "torch_xla/csrc/ops/ops_lower_fn.cpp": [[3, "torch-xla-csrc-ops-ops-lower-fn-cpp"]], "5. Cleanup": [[3, "cleanup"]], "Run the test and verify the result": [[3, "run-the-test-and-verify-the-result"]], "Sample PRs": [[3, "sample-prs"]], "Configure a development environment": [[4, "configure-a-development-environment"]], "Visual Studio Code": [[4, "visual-studio-code"]], "Creating and connecting to your TPU": [[4, "creating-and-connecting-to-your-tpu"]], "Setting up a Visual Studio Code workspace with PyTorch/XLA": [[4, "setting-up-a-visual-studio-code-workspace-with-pytorch-xla"]], "Next steps": [[4, "next-steps"]], "C++ Debugging": [[5, "c-debugging"]], "Why would you need this?": [[5, "why-would-you-need-this"]], "Install GDB: The GNU Project Debugger": [[5, "install-gdb-the-gnu-project-debugger"]], "Building PyTorch with Debugging Symbols": [[5, "building-pytorch-with-debugging-symbols"]], "Ensuring your file is built": [[5, "ensuring-your-file-is-built"]], "VSCode Configuration": [[5, "vscode-configuration"]], "LLDB": [[5, "lldb"]], "Using VSCode\u2019s Visual Debugger": [[5, "using-vscode-s-visual-debugger"]], "A realistic build command": [[5, "a-realistic-build-command"]], "Future Work": [[5, "future-work"]], "OP Lowering Guide": [[6, "op-lowering-guide"]], "Understanding the operation": [[6, "understanding-the-operation"]], "Unit Test": [[6, "unit-test"]], "Tips": [[6, "tips"]], "Custom Hardware Plugins": [[7, "custom-hardware-plugins"]], "Implementing a PJRT Plugin": [[7, "implementing-a-pjrt-plugin"]], "PJRT C API Implementation": [[7, "pjrt-c-api-implementation"]], "PyTorch/XLA Plugin Package": [[7, "pytorch-xla-plugin-package"]], "Support of Torch Distributed API in PyTorch/XLA": [[8, "support-of-torch-distributed-api-in-pytorch-xla"]], "Collective ops lowering": [[8, "collective-ops-lowering"]], "Collective ops lowering stack": [[8, "collective-ops-lowering-stack"]], "non-Dynamo case": [[8, "non-dynamo-case"]], "Dynamo case": [[8, "dynamo-case"]], "API description": [[8, "api-description"]], "Custom Kernels via Pallas": [[9, "custom-kernels-via-pallas"]], "Adopt the above kernel to be compatible with PyTorch/XLA": [[9, "adopt-the-above-kernel-to-be-compatible-with-pytorch-xla"]], "Use built-in kernels": [[9, "use-built-in-kernels"]], "FlashAttention": [[9, "id1"]], "Example usage": [[9, "example-usage"], [9, "id3"]], "Integration Example": [[9, "integration-example"], [9, "id4"]], "PagedAttention": [[9, "id2"]], "Dependencies": [[9, "dependencies"], [12, "dependencies"]], "Write your own Pallas kernels": [[9, "write-your-own-pallas-kernels"]], "Guide for using scan and scan_layers": [[10, "guide-for-using-scan-and-scan-layers"]], "When should you use this": [[10, "when-should-you-use-this"]], "scan_layers example": [[10, "scan-layers-example"]], "scan example": [[10, "scan-example"]], "Limitations": [[10, "limitations"], [23, "limitations"]], "AOTAutograd compatibility requirement": [[10, "aotautograd-compatibility-requirement"]], "AOTAutograd overhead": [[10, "aotautograd-overhead"]], "Compile time experiments": [[10, "compile-time-experiments"]], "References": [[10, "references"]], "Torch Export to StableHLO": [[11, "torch-export-to-stablehlo"]], "Using torch.export": [[11, "using-torch-export"]], "Using extract_jax": [[11, "using-extract-jax"]], "Preserving High-Level PyTorch Operations in StableHLO by generating stablehlo.composite": [[11, "preserving-high-level-pytorch-operations-in-stablehlo-by-generating-stablehlo-composite"]], "Custom GPU Kernels via Triton": [[12, "custom-gpu-kernels-via-triton"]], "PyTorch/XLA documentation": [[13, "pytorch-xla-documentation"]], "Learn about Pytorch/XLA": [[13, null]], "Learn about accelerators": [[13, null]], "PyTorch/XLA features": [[13, null]], "Improve Pytorch/XLA workload performance": [[13, null]], "Contribute to Pytorch/XLA": [[13, null]], "PyTorch/XLA API": [[14, "pytorch-xla-api"]], "torch_xla": [[14, "module-torch_xla"]], "runtime": [[14, "module-torch_xla.runtime"]], "xla_model": [[14, "module-torch_xla.core.xla_model"]], "distributed": [[14, "module-torch_xla.distributed.parallel_loader"]], "spmd": [[14, "module-torch_xla.distributed.spmd"]], "experimental": [[14, "module-torch_xla.experimental"]], "debug": [[14, "module-torch_xla.debug.metrics"]], "Dynamic shape": [[15, "dynamic-shape"]], "Bounded dynamic shape": [[15, "bounded-dynamic-shape"]], "Eager Mode + Compile API": [[16, "eager-mode-compile-api"]], "Basic Usage": [[16, "basic-usage"]], "Inference": [[16, "inference"], [25, "inference"]], "Training": [[16, "training"], [25, "training"]], "Benchmark": [[16, "benchmark"]], "PJRT Runtime": [[17, "pjrt-runtime"]], "TL;DR": [[17, "tl-dr"]], "Benefits": [[17, "benefits"]], "Quickstart": [[17, "quickstart"]], "CPU": [[17, "cpu"]], "TPU": [[17, "tpu"]], "Pods": [[17, "pods"]], "Docker": [[17, "docker"]], "GPU": [[17, "gpu"]], "Single-node GPU training": [[17, "single-node-gpu-training"]], "Multi-node GPU training": [[17, "multi-node-gpu-training"]], "Differences from XRT": [[17, "differences-from-xrt"]], "Multithreading on TPU v2/v3": [[17, "id3"]], "Changes to xm.rendezvous": [[17, "changes-to-xm-rendezvous"]], "PJRT and torch.distributed": [[17, "pjrt-and-torch-distributed"]], "Performance": [[17, "performance"]], "New TPU runtime": [[17, "new-tpu-runtime"]], "PyTorch on XLA Devices": [[18, "pytorch-on-xla-devices"]], "Creating an XLA Tensor": [[18, "creating-an-xla-tensor"]], "XLA Tensors are PyTorch Tensors": [[18, "xla-tensors-are-pytorch-tensors"]], "Running Models on XLA Devices": [[18, "running-models-on-xla-devices"]], "Running on a Single XLA Device": [[18, "running-on-a-single-xla-device"]], "Running on Multiple XLA Devices with Multi-processing": [[18, "running-on-multiple-xla-devices-with-multi-processing"]], "Running on TPU Pods": [[18, "running-on-tpu-pods"]], "XLA Tensor Deep Dive": [[18, "id3"]], "XLA Tensors are Lazy": [[18, "xla-tensors-are-lazy"]], "Memory Layout": [[18, "memory-layout"]], "Moving XLA Tensors to and from the CPU": [[18, "moving-xla-tensors-to-and-from-the-cpu"]], "Saving and Loading XLA Tensors": [[18, "saving-and-loading-xla-tensors"]], "Compilation Caching": [[18, "compilation-caching"]], "Further Reading": [[18, "further-reading"], [32, "further-reading"]], "Troubleshoot": [[19, "troubleshoot"]], "Sanity Check": [[19, "sanity-check"]], "Check PyTorch/XLA Version": [[19, "check-pytorch-xla-version"]], "Perform A Simple Calculation": [[19, "perform-a-simple-calculation"]], "Run Resnet With Fake Data": [[19, "run-resnet-with-fake-data"]], "Performance Debugging": [[19, "performance-debugging"]], "PyTorch/XLA Debugging Tool": [[19, "pytorch-xla-debugging-tool"]], "Perform A Auto-Metrics Analysis": [[19, "perform-a-auto-metrics-analysis"]], "Compilation & Execution Analysis": [[19, "compilation-execution-analysis"]], "Get A Metrics Report": [[19, "get-a-metrics-report"]], "Understand The Metrics Report": [[19, "understand-the-metrics-report"]], "Clear The Metrics Report": [[19, "clear-the-metrics-report"]], "PyTorch/XLA + Dynamo Debugging Tool": [[19, "pytorch-xla-dynamo-debugging-tool"]], "Performance Profiling": [[19, "performance-profiling"]], "Simple Benchmarking": [[19, "simple-benchmarking"]], "Known Performance Caveats": [[19, "known-performance-caveats"]], "XLA Tensor Quirks": [[19, "xla-tensor-quirks"]], "More Debugging Tools": [[19, "more-debugging-tools"]], "Debugging Tensor Operations": [[19, "debugging-tensor-operations"]], "Environment Variables": [[19, "environment-variables"]], "Common Debugging Environment Variables Combinations": [[19, "common-debugging-environment-variables-combinations"]], "Reproducing PyTorch/XLA CI/CD unit test failures.": [[19, "reproducing-pytorch-xla-ci-cd-unit-test-failures"]], "Pytorch/XLA overview": [[20, "pytorch-xla-overview"]], "TPU Setup": [[20, "tpu-setup"]], "Reference implementations": [[20, "reference-implementations"]], "Converting code to PyTorch XLA": [[20, "converting-code-to-pytorch-xla"]], "Example 1. Stable Diffusion inference in PyTorch Lightning on a Single TPU Device": [[20, "example-1-stable-diffusion-inference-in-pytorch-lightning-on-a-single-tpu-device"]], "Example 2. HF Stable Diffusion Inference": [[20, "example-2-hf-stable-diffusion-inference"]], "Running on a Single TPU device": [[20, "running-on-a-single-tpu-device"]], "Profiling and performance analysis": [[20, "profiling-and-performance-analysis"]], "Running on Multiple TPU Devices": [[20, "running-on-multiple-tpu-devices"]], "Running on Pods": [[20, "running-on-pods"]], "Source of recompilations in torch_xla": [[21, "source-of-recompilations-in-torch-xla"]], "Let\u2019s first start with some facts/constraints:": [[21, "lets-first-start-with-some-facts-constraints"], [30, "lets-first-start-with-some-facts-constraints"]], "#1. From input dataset.": [[21, "from-input-dataset"], [30, "from-input-dataset"]], "#2. From operator output": [[21, "from-operator-output"], [30, "from-operator-output"]], "2.1 Bounded dynamic shape can fix the case when you use the tensor with dynamic shape as a Tensor, without querying its real dimension.": [[21, "bounded-dynamic-shape-can-fix-the-case-when-you-use-the-tensor-with-dynamic-shape-as-a-tensor-without-querying-its-real-dimension"], [30, "bounded-dynamic-shape-can-fix-the-case-when-you-use-the-tensor-with-dynamic-shape-as-a-tensor-without-querying-its-real-dimension"]], "2.2 what if real dimension is queried on a tensor with dynamic shape?": [[21, "what-if-real-dimension-is-queried-on-a-tensor-with-dynamic-shape"], [30, "what-if-real-dimension-is-queried-on-a-tensor-with-dynamic-shape"]], "#3. From control flow": [[21, "from-control-flow"], [30, "from-control-flow"]], "Conclusion:": [[21, "conclusion"], [30, "conclusion"]], "Appendix:": [[21, "appendix"], [30, "appendix"]], "Automatic Mixed Precision": [[22, "automatic-mixed-precision"]], "AMP for XLA:TPU": [[22, "amp-for-xla-tpu"]], "AMP for XLA:TPU Best Practices": [[22, "amp-for-xla-tpu-best-practices"]], "Supported Operators": [[22, "supported-operators"]], "AMP for XLA:GPU": [[22, "amp-for-xla-gpu"]], "AMP for XLA:GPU Best Practices": [[22, "amp-for-xla-gpu-best-practices"]], "Examples": [[22, "examples"]], "Use @assume_pure to speed up lazy tensor tracing": [[23, "use-assume-pure-to-speed-up-lazy-tensor-tracing"]], "Background and motivation": [[23, "background-and-motivation"]], "How to use @assume_pure": [[23, "how-to-use-assume-pure"]], "Using @assume_pure with a function": [[23, "using-assume-pure-with-a-function"]], "Using @assume_pure with a nn.Module": [[23, "using-assume-pure-with-a-nn-module"]], "Benchmarks": [[23, "benchmarks"]], "How to do DistributedDataParallel(DDP)": [[24, "how-to-do-distributeddataparallel-ddp"]], "Background / Motivation": [[24, "background-motivation"]], "How to use DistributedDataParallel": [[24, "how-to-use-distributeddataparallel"]], "Benchmarking": [[24, "benchmarking"]], "Resnet50 with fake data": [[24, "resnet50-with-fake-data"]], "MNIST with fake data": [[24, "mnist-with-fake-data"]], "MNIST with real data": [[24, "mnist-with-real-data"]], "Disclaimer": [[24, "disclaimer"]], "TorchDynamo integration in PyTorch XLA": [[25, "torchdynamo-integration-in-pytorch-xla"]], "Integration": [[25, "integration"]], "Feature gaps": [[25, "feature-gaps"]], "Take away": [[25, "take-away"]], "Optimize memory utilization using while_loop": [[26, "optimize-memory-utilization-using-while-loop"]], "while_loop": [[26, "while-loop"]], "Usage:": [[26, "usage"]], "simple example with while_loop:": [[26, "simple-example-with-while-loop"]], "Control group test case": [[26, "control-group-test-case"]], "Control group example with pure python while loop": [[26, "control-group-example-with-pure-python-while-loop"]], "Fully Sharded Data Parallel in PyTorch XLA": [[27, "fully-sharded-data-parallel-in-pytorch-xla"]], "Example training scripts on MNIST and ImageNet": [[27, "example-training-scripts-on-mnist-and-imagenet"]], "Installation": [[27, "installation"]], "Clone PyTorch/XLA repo": [[27, "clone-pytorch-xla-repo"]], "Train MNIST on v3-8 TPU": [[27, "train-mnist-on-v3-8-tpu"]], "Train ImageNet with ResNet-50 on v3-8 TPU": [[27, "train-imagenet-with-resnet-50-on-v3-8-tpu"]], "Example training scripts on TPU pod (with 10 billion parameters)": [[27, "example-training-scripts-on-tpu-pod-with-10-billion-parameters"]], "Fully Sharded Data Parallel using SPMD": [[28, "fully-sharded-data-parallel-using-spmd"]], "Sharding output": [[28, "sharding-output"]], "Gradient checkpointing": [[28, "gradient-checkpointing"]], "HuggingFace Llama 2 Example": [[28, "huggingface-llama-2-example"]], "Quantized Operations for XLA (Experimental feature)": [[29, "quantized-operations-for-xla-experimental-feature"]], "How to use:": [[29, "how-to-use"]], "Call XLA quantized op in model code": [[29, "call-xla-quantized-op-in-model-code"]], "Module Swap": [[29, "module-swap"]], "Supported Quantized Operations:": [[29, "supported-quantized-operations"]], "Matrix Multiply": [[29, "matrix-multiply"]], "Source of recompilations in Pytorch/XLA": [[30, "source-of-recompilations-in-pytorch-xla"]], "PyTorch/XLA SPMD advanced topics": [[31, "pytorch-xla-spmd-advanced-topics"]], "Sharding-Aware Host-to-Device Data Loading": [[31, "sharding-aware-host-to-device-data-loading"]], "Virtual Device Optimization": [[31, "virtual-device-optimization"]], "Hybrid Mesh": [[31, "hybrid-mesh"]], "Running SPMD on TPU Pod": [[31, "running-spmd-on-tpu-pod"]], "XLAShardedTensor": [[31, "xlashardedtensor"]], "DTensor Integration": [[31, "dtensor-integration"]], "Activation Sharding for torch.compile": [[31, "activation-sharding-for-torch-compile"]], "SPMD Debugging Tool": [[31, "spmd-debugging-tool"]], "Auto-Sharding": [[31, "auto-sharding"]], "PyTorch/XLA SPMD User Guide": [[32, "pytorch-xla-spmd-user-guide"]], "What is PyTorch/XLA SPMD?": [[32, "what-is-pytorch-xla-spmd"]], "How to use PyTorch/XLA SPMD?": [[32, "how-to-use-pytorch-xla-spmd"]], "SPMD Mode": [[32, "spmd-mode"]], "Mesh": [[32, "mesh"]], "Partition spec": [[32, "partition-spec"]], "Which device holds which shard?": [[32, "which-device-holds-which-shard"]], "Distributed Checkpointing": [[33, "distributed-checkpointing"]], "CheckpointManager": [[33, "checkpointmanager"]], "Restoring Optimizer State": [[33, "restoring-optimizer-state"]], "Process Groups": [[33, "process-groups"]], "Running SPMD on GPU": [[34, "running-spmd-on-gpu"]]}, "indexentries": {"hybridmesh (class in torch_xla.distributed.spmd)": [[14, "torch_xla.distributed.spmd.HybridMesh"]], "mesh (class in torch_xla.distributed.spmd)": [[14, "torch_xla.distributed.spmd.Mesh"]], "mpdeviceloader (class in torch_xla.distributed.parallel_loader)": [[14, "torch_xla.distributed.parallel_loader.MpDeviceLoader"]], "add_step_closure() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.add_step_closure"]], "addressable_device_count() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.addressable_device_count"]], "all_gather() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.all_gather"]], "all_reduce() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.all_reduce"]], "all_to_all() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.all_to_all"]], "clear_sharding() (in module torch_xla.distributed.spmd)": [[14, "torch_xla.distributed.spmd.clear_sharding"]], "compile() (in module torch_xla)": [[14, "torch_xla.compile"]], "counter_names() (in module torch_xla.debug.metrics)": [[14, "torch_xla.debug.metrics.counter_names"]], "counter_value() (in module torch_xla.debug.metrics)": [[14, "torch_xla.debug.metrics.counter_value"]], "device() (in module torch_xla)": [[14, "torch_xla.device"]], "device_count() (in module torch_xla)": [[14, "torch_xla.device_count"]], "device_type() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.device_type"]], "devices() (in module torch_xla)": [[14, "torch_xla.devices"]], "eager_mode() (in module torch_xla.experimental)": [[14, "torch_xla.experimental.eager_mode"]], "get_1d_mesh() (in module torch_xla.distributed.spmd)": [[14, "torch_xla.distributed.spmd.get_1d_mesh"]], "get_global_mesh() (in module torch_xla.distributed.spmd)": [[14, "torch_xla.distributed.spmd.get_global_mesh"]], "get_master_ip() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.get_master_ip"]], "get_memory_info() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.get_memory_info"]], "get_rng_state() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.get_rng_state"]], "get_stablehlo() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.get_stablehlo"]], "get_stablehlo_bytecode() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.get_stablehlo_bytecode"]], "global_device_count() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.global_device_count"]], "global_ordinal() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.global_ordinal"]], "global_runtime_device_count() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.global_runtime_device_count"]], "initialize_cache() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.initialize_cache"]], "is_master_ordinal() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.is_master_ordinal"]], "is_spmd() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.is_spmd"]], "local_device_count() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.local_device_count"]], "local_ordinal() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.local_ordinal"]], "local_process_count() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.local_process_count"]], "manual_seed() (in module torch_xla)": [[14, "torch_xla.manual_seed"]], "mark_sharding() (in module torch_xla.distributed.spmd)": [[14, "torch_xla.distributed.spmd.mark_sharding"]], "mesh_reduce() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.mesh_reduce"]], "metric_data() (in module torch_xla.debug.metrics)": [[14, "torch_xla.debug.metrics.metric_data"]], "metric_names() (in module torch_xla.debug.metrics)": [[14, "torch_xla.debug.metrics.metric_names"]], "metrics_report() (in module torch_xla.debug.metrics)": [[14, "torch_xla.debug.metrics.metrics_report"]], "module": [[14, "module-torch_xla"], [14, "module-torch_xla.core.xla_model"], [14, "module-torch_xla.debug.metrics"], [14, "module-torch_xla.distributed.parallel_loader"], [14, "module-torch_xla.distributed.spmd"], [14, "module-torch_xla.distributed.xla_multiprocessing"], [14, "module-torch_xla.experimental"], [14, "module-torch_xla.runtime"]], "optimizer_step() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.optimizer_step"]], "rendezvous() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.rendezvous"]], "save() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.save"]], "set_global_mesh() (in module torch_xla.distributed.spmd)": [[14, "torch_xla.distributed.spmd.set_global_mesh"]], "set_rng_state() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.set_rng_state"]], "short_metrics_report() (in module torch_xla.debug.metrics)": [[14, "torch_xla.debug.metrics.short_metrics_report"]], "spawn() (in module torch_xla.distributed.xla_multiprocessing)": [[14, "torch_xla.distributed.xla_multiprocessing.spawn"]], "sync() (in module torch_xla)": [[14, "torch_xla.sync"]], "torch_xla": [[14, "module-torch_xla"]], "torch_xla.core.xla_model": [[14, "module-torch_xla.core.xla_model"]], "torch_xla.debug.metrics": [[14, "module-torch_xla.debug.metrics"]], "torch_xla.distributed.parallel_loader": [[14, "module-torch_xla.distributed.parallel_loader"]], "torch_xla.distributed.spmd": [[14, "module-torch_xla.distributed.spmd"]], "torch_xla.distributed.xla_multiprocessing": [[14, "module-torch_xla.distributed.xla_multiprocessing"]], "torch_xla.experimental": [[14, "module-torch_xla.experimental"]], "torch_xla.runtime": [[14, "module-torch_xla.runtime"]], "use_spmd() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.use_spmd"]], "wait_device_ops() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.wait_device_ops"]], "world_size() (in module torch_xla.runtime)": [[14, "torch_xla.runtime.world_size"]], "xla_device() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.xla_device"]], "xla_device_hw() (in module torch_xla.core.xla_model)": [[14, "torch_xla.core.xla_model.xla_device_hw"]]}})