Search.setIndex({"docnames": ["accelerators/gpu", "accelerators/tpu", "contribute/bazel", "contribute/codegen_migration", "contribute/configure-environment", "contribute/cpp_debugger", "contribute/op_lowering", "contribute/plugins", "features/pallas", "features/scan", "features/stablehlo", "features/torch_distributed", "features/triton", "index", "learn/_pjrt", "learn/api-guide", "learn/dynamic_shape", "learn/eager", "learn/pytorch-on-xla-devices", "learn/trace-vs-execution-time", "learn/troubleshoot", "learn/xla-overview", "notes/source_of_recompilation", "perf/amp", "perf/assume_pure", "perf/ddp", "perf/dynamo", "perf/fori_loop", "perf/fsdp_collectives", "perf/fsdp_spmd", "perf/quantized_ops", "perf/recompilation", "perf/spmd_advanced", "perf/spmd_basic", "perf/spmd_distributed_checkpoint", "perf/spmd_gpu", "tutorials/precision_tutorial"], "filenames": ["accelerators/gpu.md", "accelerators/tpu.md", "contribute/bazel.md", "contribute/codegen_migration.md", "contribute/configure-environment.md", "contribute/cpp_debugger.md", "contribute/op_lowering.md", "contribute/plugins.md", "features/pallas.md", "features/scan.md", "features/stablehlo.md", "features/torch_distributed.md", "features/triton.md", "index.rst", "learn/_pjrt.md", "learn/api-guide.rst", "learn/dynamic_shape.md", "learn/eager.md", "learn/pytorch-on-xla-devices.md", "learn/trace-vs-execution-time.md", "learn/troubleshoot.md", "learn/xla-overview.md", "notes/source_of_recompilation.md", "perf/amp.md", "perf/assume_pure.md", "perf/ddp.md", "perf/dynamo.md", "perf/fori_loop.md", "perf/fsdp_collectives.md", "perf/fsdp_spmd.md", "perf/quantized_ops.md", "perf/recompilation.md", "perf/spmd_advanced.md", "perf/spmd_basic.md", "perf/spmd_distributed_checkpoint.md", "perf/spmd_gpu.md", "tutorials/precision_tutorial.ipynb"], "titles": ["Learn about GPUs", "Learn about TPUs", "Building with Bazel", "Codegen Migration Guide", "Configure A Development Environment", "C++ Debugging", "Op Lowering Guide", "Custom Hardware Plugins", "Custom Kernels via Pallas", "Optimizing Repeated Layers with <code class=\"docutils literal notranslate\"><span class=\"pre\">scan</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">scan_layers</span></code>", "Torch Export to StableHLO", "Support for Torch Distributed", "Custom GPU Kernels via Triton", "PyTorch/XLA documentation", "PJRT Runtime", "PyTorch/XLA API", "Dynamic Shapes", "PyTorch/XLA Compile API and it\u2019s interaction with Eager mode.", "PyTorch on XLA Devices", "Tracing Time vs. Execution Time in PyTorch/XLA", "Troubleshooting Basics", "Pytorch/XLA Overview", "Source of recompilations in torch_xla", "Automatic Mixed Precision", "Speed Up Tracing with <code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;assume_pure</span></code>", "Distributed Data Parallel (DDP)", "TorchDynamo Integration", "Optimize Memory Utilization with <code class=\"docutils literal notranslate\"><span class=\"pre\">while_loop</span></code>", "Fully Sharded Data Parallel (FSDP) with One Process Per Accelerator", "Fully Sharded Data Parallel (FSDP) using SPMD", "Quantized Operations", "Troubleshooting recompilations", "SPMD advanced topics", "SPMD User Guide", "Distributed Checkpointing", "Running SPMD on GPU", "Control MXU Floating Point Precision"], "terms": {"For": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 33, 35], "inform": [0, 1, 3, 4, 5, 12, 14, 15, 17, 18, 20, 21, 22, 31, 35, 36], "googl": [0, 1, 8, 14, 18, 36], "cloud": [0, 1, 2, 4, 7, 14, 18, 26, 34], "see": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 26, 28, 31, 36], "machin": [0, 2, 4, 14, 20, 21, 35], "type": [0, 4, 5, 7, 10, 14, 15, 18, 19, 20, 21, 23, 25, 36], "ar": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 28, 30, 31, 32, 33, 34, 36], "custom": [1, 3, 4, 5, 9, 10, 11, 13, 15, 17, 22, 25, 28, 30, 31, 32, 33], "design": [1, 9, 14, 17, 18, 26], "ai": [1, 21], "acceler": [1, 4, 13, 14, 15, 16, 17, 18, 21, 23, 36], "which": [1, 2, 3, 5, 6, 7, 10, 11, 14, 15, 16, 18, 19, 20, 21, 22, 23, 26, 28, 29, 31, 32, 34, 36], "optim": [1, 5, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 25, 26, 28, 29, 31, 36], "train": [1, 8, 9, 15, 16, 17, 18, 19, 20, 21, 23, 24, 32, 34, 35, 36], "infer": [1, 3, 13, 14, 15, 17, 18, 23, 32, 35], "larg": [1, 9, 14, 16, 21, 22, 28, 31, 33], "model": [1, 3, 6, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 31, 32, 33, 34, 35, 36], "thei": [1, 2, 6, 7, 10, 11, 14, 15, 18, 19, 20, 21, 22, 23, 31, 32, 33], "ideal": [1, 2, 3, 22, 26, 31], "varieti": 1, "us": [1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 23, 26, 28, 32, 34, 35, 36], "case": [1, 2, 3, 6, 9, 10, 14, 15, 18, 20, 21, 24, 26, 29, 32], "chatbot": 1, "code": [1, 3, 5, 6, 9, 10, 12, 14, 15, 17, 18, 19, 20, 22, 24, 25, 26, 31, 32], "gener": [1, 5, 6, 14, 15, 17, 18, 20, 21, 22, 31, 36], "media": 1, "content": [1, 15], "synthet": 1, "speech": 1, "vision": [1, 28], "servic": [1, 2, 14], "recommend": [1, 2, 3, 4, 5, 6, 14, 15, 17, 23, 32, 36], "engin": [1, 20], "person": 1, "among": 1, "other": [1, 2, 3, 5, 6, 8, 9, 14, 15, 16, 18, 20, 21, 22, 23, 24, 25, 28, 29, 30, 31, 33], "scale": [1, 10, 13, 14, 15, 23, 24, 26, 33], "cost": [1, 13, 17, 24, 26, 36], "effici": [1, 9, 10, 13, 17, 20, 21, 26, 33], "wide": [1, 6, 22, 31], "rang": [1, 6, 9, 14, 15, 19, 24, 29, 32, 33, 36], "workload": [1, 14, 17, 18, 20, 32, 33], "span": [1, 3, 17], "fine": 1, "tune": [1, 32, 33], "provid": [1, 2, 3, 6, 7, 8, 9, 15, 17, 18, 19, 20, 21, 22, 23, 26, 27, 28, 30, 31, 32, 33, 34, 36], "versatil": 1, "lead": [1, 9, 17, 18, 19, 20, 21, 24], "framework": [1, 22, 30, 31], "includ": [1, 2, 6, 14, 15, 19, 20, 21, 22, 23, 27, 31, 33, 34, 36], "pytorch": [1, 6, 9, 11, 12, 14, 16, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 34, 35], "jax": [1, 7, 8, 9, 10, 14], "tensorflow": [1, 2, 7, 14, 15, 20, 22, 31], "seamlessli": 1, "orchestr": 1, "through": [1, 3, 6, 7, 8, 9, 11, 18, 21, 22, 23, 31, 34, 36], "integr": [1, 12, 13, 17, 30, 33], "kubernet": 1, "gke": 1, "leverag": [1, 12, 35], "dynam": [1, 3, 6, 13, 18, 20, 21, 26], "schedul": [1, 21], "improv": [1, 14, 18, 20, 21, 23, 26, 32, 33], "scalabl": 1, "all": [1, 2, 3, 5, 6, 9, 10, 11, 12, 14, 15, 18, 19, 20, 21, 22, 23, 24, 25, 28, 31, 32, 34], "need": [1, 2, 3, 6, 10, 14, 15, 18, 19, 20, 21, 22, 25, 28, 29, 31, 32, 33, 36], "simultan": [1, 33], "look": [1, 3, 5, 6, 9, 17, 18, 20, 21, 32], "simplest": [1, 33, 36], "wai": [1, 2, 6, 8, 10, 11, 14, 15, 18, 19, 21, 22, 25, 26, 30, 31, 32, 33], "develop": [1, 2, 5, 12, 13, 17, 18, 25, 26, 30, 33], "can": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 23, 24, 25, 26, 28, 29, 30, 32, 33, 34, 35, 36], "also": [1, 2, 3, 5, 6, 7, 10, 11, 12, 14, 15, 18, 20, 21, 22, 24, 26, 28, 29, 30, 31, 32, 33, 36], "vertex": 1, "fulli": [1, 13, 14, 17, 20, 33], "manag": [1, 8, 15, 23, 34], "platform": [1, 15], "more": [1, 2, 3, 4, 5, 6, 8, 10, 12, 14, 15, 17, 18, 21, 22, 24, 31, 32, 33, 35, 36], "introduct": [1, 8], "set": [1, 2, 5, 9, 11, 14, 15, 20, 21, 22, 23, 26, 28, 31, 32, 33, 34, 36], "up": [1, 2, 3, 5, 13, 14, 18, 19, 21, 22, 26, 29, 31, 36], "environ": [1, 2, 5, 13, 14, 16, 18, 21, 25, 32, 33, 34], "resourc": [1, 15, 20], "free": [2, 6, 10, 20, 23, 25, 28], "softwar": [2, 20], "tool": [2, 6, 21, 28, 33, 36], "autom": 2, "openxla": [2, 7, 10, 17, 26, 30], "both": [2, 4, 5, 6, 11, 14, 17, 21, 22, 23, 26, 28, 29, 30, 31, 33, 34], "make": [2, 4, 5, 10, 12, 14, 18, 19, 20, 21, 22, 25, 26, 31, 32, 36], "good": [2, 3, 6, 21, 22, 31, 32], "fit": [2, 3, 21, 28], "well": [2, 3, 7, 14, 15, 21, 22, 31, 32, 33], "extern": [2, 4, 8], "seen": [2, 19, 21, 26], "workspac": [2, 20], "file": [2, 4, 9, 14, 15, 20, 21, 23, 24, 25], "http_archiv": 2, "name": [2, 4, 5, 6, 14, 15, 20, 22, 29, 31, 32, 33], "patch_arg": 2, "l": [2, 36], "p1": 2, "patch_tool": 2, "patch": [2, 20], "openxla_patch": 2, "gpu_nvml": 2, "diff": [2, 14, 21], "gpu_race_condit": 2, "count_down": 2, "strip_prefix": 2, "xla_hash": 2, "url": 2, "http": [2, 3, 4, 8, 9, 10, 12, 14, 15, 20, 21, 28], "github": [2, 3, 4, 5, 6, 9, 12, 14, 15, 20, 21, 25, 28], "com": [2, 3, 4, 8, 9, 12, 14, 15, 20, 21, 28], "archiv": 2, "tar": 2, "gz": 2, "you": [2, 4, 7, 8, 10, 12, 14, 15, 16, 18, 19, 20, 21, 24, 25, 26, 28, 29, 32, 33, 35, 36], "specifi": [2, 5, 10, 11, 15, 17, 18, 19, 21, 28, 32, 33], "revis": 2, "want": [2, 5, 6, 10, 14, 15, 18, 20, 21, 22, 26, 31, 32, 33, 35], "field": 2, "alwai": [2, 14, 18, 20, 22, 31, 33], "determinist": 2, "commit": [2, 21], "aka": 2, "pin": [2, 15], "mai": [2, 3, 5, 7, 9, 14, 18, 20, 21, 22, 23, 24, 31, 32, 33, 36], "ad": [2, 5, 6, 10, 15, 18, 19, 20, 21, 22, 24, 26, 27, 31, 32, 36], "resolv": 2, "prepar": [2, 19], "hermet": 2, "differ": [2, 3, 7, 15, 17, 18, 20, 21, 22, 24, 25, 27, 28, 29, 31, 32, 33, 36], "mechan": [2, 9, 19], "deploi": 2, "becaus": [2, 3, 9, 14, 17, 18, 21, 23, 24, 32, 36], "local": [2, 4, 14, 15, 18, 20, 32], "checkout": [2, 9, 20], "thi": [2, 3, 4, 6, 7, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36], "ha": [2, 3, 4, 5, 6, 8, 9, 10, 14, 15, 18, 19, 21, 22, 31, 32, 33, 36], "built": [2, 4, 33, 36], "from": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 15, 16, 17, 20, 21, 23, 24, 25, 26, 27, 28, 29, 32, 33, 34, 36], "sourc": [2, 3, 5, 6, 7, 9, 13, 14, 15, 20, 31], "instal": [2, 3, 4, 6, 7, 8, 12, 13, 14, 20, 21], "system": [2, 33, 36], "version": [2, 3, 4, 5, 8, 14, 18, 21, 23, 24, 32], "compat": [2, 14, 30, 34], "e": [2, 4, 10, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 28, 30, 31, 32, 33], "g": [2, 4, 5, 10, 11, 14, 15, 16, 17, 19, 20, 21, 22, 24, 30, 31, 32, 33], "codegen": [2, 6, 13], "torchgen": [2, 3], "python": [2, 3, 4, 5, 6, 7, 9, 10, 12, 13, 14, 15, 16, 19, 20, 21, 22, 25, 26, 31, 32], "modul": [2, 8, 9, 10, 15, 18, 20, 25, 28, 29, 32, 36], "should": [2, 3, 4, 6, 7, 12, 14, 15, 18, 19, 20, 21, 22, 23, 27, 28, 31, 32, 33, 34], "The": [2, 3, 4, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 28, 30, 31, 32, 33, 34, 35, 36], "directori": [2, 3, 6, 9], "either": [2, 6, 11, 14, 15, 20, 22, 23, 31], "bzl": 2, "overriden": 2, "command": [2, 3, 4, 9, 14, 18, 20, 21, 25, 28], "line": [2, 3, 5, 10, 15, 17, 18, 20, 21, 22, 28, 31], "override_repositori": 2, "org_tensorflow": 2, "path": [2, 5, 7, 15, 18, 20, 22, 28, 31], "export": [2, 3, 4, 6, 13, 14, 20, 21], "tf_repo": 2, "torch_repo": 2, "pleas": [2, 3, 6, 11, 14, 15, 18, 20, 21, 23, 28, 29, 30, 32, 35, 36], "sure": [2, 5, 18, 19, 20, 36], "overridden": [2, 3], "repositori": [2, 14], "appropri": [2, 18, 21], "been": [2, 5, 6, 14, 15, 18, 21, 22, 31, 32], "use_cuda": [2, 5], "0": [2, 3, 4, 5, 7, 9, 10, 12, 13, 14, 15, 16, 18, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 35, 36], "setup": [2, 3, 5, 7, 10, 18, 25], "py": [2, 3, 4, 5, 6, 9, 11, 12, 14, 16, 17, 18, 20, 21, 24, 25, 28, 35], "bdist_wheel": 2, "expect": [2, 3, 7, 12, 14, 15, 18, 20, 22, 26, 30, 31, 36], "object": [2, 10, 15, 32], "present": [2, 34], "new_local_repositori": 2, "build_fil": 2, "pytorch_local_dir": 2, "header": 2, "directli": [2, 3, 6, 7, 14, 15, 18, 20, 21, 22, 23, 28, 31, 32, 34], "share": [2, 3, 7, 14, 18, 20, 32], "libtorch": 2, "so": [2, 3, 7, 10, 12, 14, 15, 16, 18, 20, 21, 22, 28, 31, 34, 36], "same": [2, 3, 6, 7, 9, 12, 14, 15, 18, 20, 21, 22, 23, 24, 27, 30, 31, 32, 33, 35, 36], "where": [2, 4, 8, 9, 11, 14, 15, 17, 18, 19, 20, 21, 22, 28, 29, 31, 33, 36], "lib": [2, 5, 7], "contain": [2, 3, 6, 7, 9, 10, 12, 14, 15, 20, 21, 22, 24, 31, 33], "work": [2, 3, 9, 10, 11, 14, 15, 16, 18, 19, 20, 21, 22, 24, 26, 30, 31, 32], "s": [2, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14, 15, 16, 18, 19, 20, 21, 23, 24, 25, 26, 30, 32, 34, 36], "requir": [2, 3, 6, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 31, 32, 34, 35, 36], "pass": [2, 6, 9, 10, 12, 14, 15, 17, 19, 21, 23, 24, 32, 33, 36], "isystemextern": 2, "compil": [2, 5, 6, 7, 10, 12, 13, 14, 15, 16, 19, 21, 22, 23, 26, 29, 30, 31, 33, 34], "find": [2, 3, 6, 8, 9, 14, 20, 21, 25, 29], "satisfi": [2, 32], "them": [2, 3, 6, 9, 14, 15, 17, 18, 19, 20, 21, 22, 31, 33, 36], "some": [2, 3, 6, 9, 14, 15, 16, 18, 20, 24, 25, 30, 32, 33, 36], "user": [2, 4, 5, 7, 9, 13, 14, 17, 18, 20, 21, 22, 26, 27, 29, 30, 31, 32, 34], "bring": [2, 3], "pybind11": 2, "embed": [2, 9], "link": [2, 3], "against": [2, 25], "libpython": 2, "instead": [2, 10, 11, 14, 15, 18, 20, 21, 22, 24, 25, 26, 28, 31, 32, 34], "These": [2, 3, 6, 8, 9, 14, 21, 30, 34, 36], "pybind11_emb": 2, "option": [2, 3, 4, 5, 7, 14, 15, 20, 21, 30, 32, 34], "transit": [2, 17, 18], "simpl": [2, 3, 8, 9, 14, 21, 23, 28], "torch_xla": [2, 4, 6, 7, 8, 9, 11, 12, 13, 14, 16, 18, 20, 21, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36], "csrc": [2, 6], "runtim": [2, 3, 4, 7, 13, 18, 20, 25, 28, 32, 33, 34], "configr": 2, "via": [2, 4, 13, 14, 17, 19, 27, 28, 32, 33], "bazelrc": 2, "take": [2, 3, 9, 10, 12, 15, 18, 19, 20, 21, 22, 31, 32], "flag": [2, 3, 5, 10, 15, 16, 23], "config": [2, 3, 4, 10], "remote_cach": 2, "configur": [2, 3, 6, 13, 14, 15, 18, 20, 21, 34], "gcloud": [2, 4, 14, 18, 21], "usual": [2, 3, 5, 6, 18, 20], "faster": [2, 5, 14, 21, 22, 24, 26, 31], "authent": [2, 14], "easi": [2, 9, 14, 18, 22, 31, 36], "express": [2, 24, 33], "complex": [2, 12, 17, 24, 26], "lot": [2, 18, 20, 21, 22, 31], "gain": [2, 14], "have": [2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 17, 18, 20, 21, 22, 24, 25, 26, 28, 29, 31, 32, 34, 36], "singl": [2, 9, 15, 17, 22, 25, 26, 28, 29, 31, 32, 33, 35], "graph": [2, 9, 10, 12, 14, 15, 17, 18, 19, 20, 21, 22, 24, 25, 26, 31, 32], "everyth": [2, 10, 22, 25, 31], "therefor": [2, 18, 20, 21], "separ": [2, 3, 5, 6, 10, 17, 18, 21, 26, 28, 29], "rest": [2, 14, 20, 22, 31], "plu": [2, 19, 25, 27], "whole": [2, 15, 17, 22, 26, 31], "everythin": 2, "els": [2, 10, 18, 20, 22, 31], "enough": [2, 21, 22, 31], "normal": [2, 3, 14, 18, 22, 29, 31, 32], "achiev": [2, 6, 17, 25, 33], "invok": [2, 3, 26, 32], "standard": [2, 19], "c": [2, 3, 6, 13, 14, 20, 22, 23, 24, 31], "bind": 2, "simpli": [2, 9, 14, 17], "_xlac": [2, 12, 18, 20, 22, 31], "client": [2, 7, 14, 15], "togeth": [2, 14, 18, 25, 28, 32, 33], "when": [2, 3, 5, 6, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 26, 28, 32, 33, 34, 36], "chang": [2, 5, 6, 13, 16, 17, 18, 19, 20, 21, 22, 23, 25, 30, 31, 32], "abl": [2, 18, 22, 31, 34, 36], "without": [2, 6, 9, 10, 14, 15, 17, 18, 19, 20, 21, 32, 33, 34, 36], "iter": [2, 9, 15, 16, 17, 18, 19, 20, 21, 26, 32], "cycl": [2, 18], "come": [2, 15, 22, 31], "There": [2, 3, 10, 18, 20, 21, 22, 25, 26, 31, 32], "plenti": 2, "backend": [2, 3, 11, 13, 14, 17, 22, 26, 27, 30, 31, 32, 34, 36], "we": [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 35], "our": [2, 3, 4, 5, 6, 7, 8, 11, 14, 18, 20, 22, 23, 25, 26, 31, 32, 33], "gc": [2, 34], "storag": [2, 4, 8, 18, 20, 21, 28, 34], "under": [2, 3, 6, 9, 14, 15, 17, 18, 25], "disabl": [2, 15, 17, 18, 20, 21], "default": [2, 6, 10, 14, 15, 17, 18, 19, 20, 21, 23, 28, 32, 34, 36], "speed": [2, 5, 13, 15, 21, 22, 26, 31, 36], "increment": [2, 3], "huge": [2, 20, 21, 22, 25, 31], "margin": 2, "almost": 2, "enabl": [2, 5, 9, 12, 15, 16, 17, 18, 20, 21, 23, 25, 30, 32, 33, 34], "ci": [2, 6], "To": [2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 28, 29, 31, 32, 34, 35, 36], "ensur": [2, 9, 15, 18, 22, 24, 29, 31, 32, 34], "credenti": 2, "auth": [2, 14], "applic": [2, 20, 30, 34], "login": [2, 21], "launch": [2, 5, 14, 15, 16, 18, 19, 21, 25, 26, 28], "browser": 2, "gcp": [2, 4, 14], "variou": [2, 12, 17], "individu": [2, 28, 29, 33], "who": [2, 5, 25], "access": [2, 3, 6, 8, 14, 15, 18, 19, 20, 21, 22, 31, 34, 36], "project": [2, 4, 7, 14, 18, 21], "one": [2, 3, 6, 8, 9, 14, 15, 18, 20, 21, 22, 26, 27, 28, 29, 31, 32, 33, 35, 36], "onli": [2, 3, 5, 6, 9, 11, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 26, 27, 31, 33, 34, 36], "google_default_credenti": 2, "token": [2, 17, 21, 30], "out": [2, 6, 9, 10, 14, 15, 18, 20, 21, 23, 26, 32, 36], "box": [2, 6, 32], "log": [2, 20, 21], "permiss": 2, "add": [2, 3, 5, 6, 12, 15, 18, 21, 22, 26, 27, 28, 31], "new": [2, 3, 4, 5, 6, 11, 18, 19, 20, 21, 22, 26, 31, 32], "role": [2, 17], "In": [2, 3, 5, 6, 7, 8, 9, 11, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 26, 31, 32, 33, 34, 36], "account": [2, 21], "kei": [2, 4, 7, 9, 14, 20, 21, 34], "google_credenti": 2, "On": [2, 14, 15, 34], "docker": 2, "network": [2, 14, 15, 18, 20, 23, 32, 33, 36], "cloudbuild": 2, "down": [2, 5, 6, 21, 36], "imag": [2, 14, 21, 22, 25, 28, 31], "do": [2, 3, 5, 6, 10, 14, 15, 16, 18, 20, 21, 22, 23, 24, 25, 28, 30, 31, 32, 36], "doe": [2, 3, 5, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 31, 32, 33], "read": [2, 4, 6, 14, 15, 32], "write": [2, 6, 12, 15, 18, 19, 33], "silo": 2, "each": [2, 3, 5, 6, 11, 12, 14, 15, 18, 19, 20, 21, 22, 24, 26, 28, 29, 31, 32, 33, 34, 36], "uniqu": [2, 18, 21, 22, 24, 31], "benefit": [2, 5, 17, 21, 30, 34], "consist": [2, 11, 14, 19], "remote_default_exec_properti": 2, "some_silo_kei": 2, "bazel_remote_cach": 2, "1": [2, 4, 7, 8, 9, 10, 11, 13, 14, 15, 17, 18, 20, 23, 24, 25, 26, 27, 28, 29, 32, 33, 35, 36], "silo_nam": 2, "your": [2, 3, 7, 9, 10, 14, 18, 19, 20, 21, 22, 24, 25, 29, 31, 32, 33, 34, 36], "tpuvm_mod": 2, "gcloud_service_key_fil": 2, "application_default_credenti": 2, "json": [2, 5], "might": [2, 3, 6, 15, 18, 20, 21, 22, 31], "help": [2, 18, 20, 21, 22, 31], "too": [2, 5, 20, 22, 31], "cannot": [2, 8, 9, 21, 22, 23, 28, 31, 36], "here": [2, 3, 6, 8, 10, 16, 18, 19, 21, 22, 25, 26, 28, 29, 31, 32, 33, 34], "author": [2, 36], "usernam": [2, 5], "behavior": [2, 3, 6, 14, 15, 18, 20, 23, 24], "function": [2, 6, 7, 8, 9, 10, 11, 12, 15, 17, 18, 20, 21, 26, 27, 29, 30, 34, 36], "intend": [2, 17], "first": [2, 3, 4, 9, 10, 12, 14, 15, 16, 19, 20, 21, 25, 32, 33, 34, 35, 36], "time": [2, 3, 4, 5, 13, 14, 15, 16, 20, 21, 22, 24, 26, 27, 31, 32, 36], "slow": [2, 5, 9, 20, 21], "scratch": [2, 3], "veri": [2, 7, 8, 18, 21, 22, 31], "fast": [2, 22, 31], "updat": [2, 3, 5, 10, 11, 18, 19, 21, 22, 23, 31, 32], "onc": [2, 11, 15, 18, 20, 21, 22, 24, 26, 31, 32, 36], "again": [2, 3, 5, 18, 21, 36], "bit": [2, 15, 18, 30], "slower": [2, 17, 20, 21, 25, 36], "per": [2, 13, 14, 15, 17, 18, 20, 23, 25, 26, 30], "until": [2, 15, 18, 19, 21, 34], "next": [2, 5, 15, 19, 20, 21, 22, 30, 31, 32, 36], "quit": 2, "current": [2, 5, 7, 8, 14, 15, 16, 17, 18, 19, 21, 22, 24, 26, 27, 29, 30, 31, 32, 35], "migrat": [2, 13, 14], "futur": [2, 3, 4, 7, 14, 17, 18, 20, 21, 22, 24, 29, 31], "plafrom": 2, "cpp": [2, 5, 6, 20], "main": [2, 4, 10, 11, 12, 14, 17, 32], "Of": 2, "cours": 2, "pjrt": [2, 15, 18, 32], "Not": 2, "environment": 2, "variabl": [2, 4, 5, 14, 16, 21, 22, 31], "miss": [2, 6, 15, 20], "common": [2, 14, 18, 22, 29, 30, 31, 33, 34], "part": [2, 3, 7, 12, 14, 15, 17, 20, 21, 32, 36], "ones": [2, 15, 22, 31], "helper": [2, 3, 15], "script": [2, 3, 4, 8, 14, 18, 19, 20, 21, 23, 25, 35, 36], "run_test": 2, "sh": 2, "r": [2, 21], "xla_client": 2, "pure": [2, 3, 9, 17, 24], "easili": [2, 6, 22, 26, 31], "execut": [2, 5, 12, 13, 14, 15, 17, 18, 21, 22, 23, 24, 25, 26, 31, 32, 33, 35, 36], "parallel": [2, 13, 14, 15, 20, 32, 33], "sinc": [2, 3, 6, 14, 18, 20, 21, 22, 23, 25, 26, 29, 31, 32, 34], "xrt": [2, 15], "port": [2, 14, 35], "gpu": [2, 6, 7, 8, 16, 20, 21, 32, 36], "tpu": [2, 3, 6, 7, 8, 9, 15, 16, 17, 19, 20, 25, 26, 27, 33, 34, 35], "devic": [2, 3, 4, 6, 7, 9, 11, 13, 14, 15, 16, 17, 19, 20, 22, 23, 24, 25, 26, 27, 30, 31, 34, 36], "avail": [2, 14, 15, 18, 20, 21, 22, 28, 31, 35], "reason": [2, 3, 6, 14, 21, 25], "bundl": 2, "target": [2, 14, 17, 18, 21, 22, 23, 26, 31], "sequenti": [2, 15], "calcul": [2, 17, 36], "visual": [2, 32, 33, 36], "lcov": 2, "describ": [2, 3, 4, 5, 10, 15, 18, 21, 23, 25, 33], "document": [2, 3, 4, 6, 7, 10, 14, 18, 23, 24, 25, 30], "editor": 2, "choic": [2, 22, 31], "gutter": 2, "vscode": 2, "power": 2, "like": [2, 3, 4, 5, 6, 8, 9, 10, 14, 15, 17, 18, 19, 20, 21, 22, 23, 28, 31, 32, 36], "clangd": 2, "refer": [2, 3, 6, 8, 11, 12, 14, 15, 16, 18, 28, 30, 32, 33, 35], "autocomplet": 2, "semant": [2, 6, 20, 22, 31], "understand": [2, 10, 17, 19, 21, 22, 31], "underli": [2, 15, 18, 33], "stack": [2, 5, 9, 18, 20, 22, 23, 31, 32], "combin": [2, 6, 9, 15, 22, 24, 31], "studio": 2, "extens": [2, 4, 5, 6, 7], "featur": [2, 5, 8, 10, 14, 16, 20, 25, 30, 32, 33, 34], "assist": 2, "edit": 2, "As": [2, 3, 5, 9, 10, 21, 22, 24, 29, 31], "distutil": 2, "ltc": 3, "lazi": [3, 15, 17, 19, 20, 21, 22, 24, 26, 31, 32], "tensor": [3, 5, 6, 9, 10, 11, 13, 14, 15, 16, 19, 21, 23, 24, 26, 27, 29, 30, 32, 33, 36], "core": [3, 5, 6, 11, 13, 14, 15, 17, 18, 19, 20, 21, 23, 25, 26, 27, 28, 29, 30, 33], "clean": [3, 5, 20, 26], "exist": [3, 14, 15, 18, 20, 26, 32], "stub": 3, "over": [3, 5, 9, 14, 15, 17, 18, 21, 28, 33, 34], "6": [3, 4, 6, 9, 15, 20, 21, 22, 31, 33, 36], "were": [3, 17, 18, 20, 21, 22, 31, 36], "complet": [3, 15, 17, 18, 20], "process": [3, 5, 6, 7, 11, 12, 13, 14, 15, 17, 20, 21, 25, 30], "found": [3, 14, 21, 36], "ref": [3, 4, 14], "oper": [3, 5, 9, 11, 12, 13, 14, 15, 17, 18, 19, 21, 24, 33, 34, 36], "xla_native_funct": [3, 6], "yaml": [3, 6], "replac": [3, 5, 9, 21, 27], "support": [3, 7, 8, 9, 10, 12, 13, 14, 15, 16, 22, 24, 26, 27, 28, 31, 32, 34, 35, 36], "an": [3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 17, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 31, 32, 33, 34, 36], "equival": [3, 36], "full_codegen": 3, "NOT": 3, "introduc": [3, 8, 11, 14, 17, 20, 21, 24, 25, 32], "ani": [3, 5, 8, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 28, 29, 31, 32, 33, 34, 35, 36], "purpos": [3, 6, 9, 17, 30], "info": [3, 5, 15, 20, 22, 31, 33, 36], "about": [3, 4, 13, 14, 15, 17, 18, 21, 22, 31, 33], "dispatch": [3, 5, 6, 19, 34], "exyang": 3, "blog": [3, 24], "post": [3, 15, 20, 24], "follow": [3, 5, 6, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 28, 29, 31, 32, 33, 35], "instruct": [3, 5, 6, 19, 21], "depend": [3, 4, 6, 16, 17, 18, 21, 22, 23, 24, 31, 33], "build": [3, 6, 13, 17, 18, 19, 21, 28, 36], "It": [3, 4, 5, 6, 9, 11, 15, 16, 18, 19, 21, 22, 26, 28, 29, 30, 31, 32, 33, 36], "experi": [3, 5, 6, 14, 17, 25, 34, 36], "workstat": [3, 6], "cpu": [3, 6, 11, 15, 19, 20, 21, 22, 28, 30, 31, 32, 34, 36], "pjrt_devic": [3, 6, 7, 14, 16, 18, 20, 25, 27, 35, 36], "re": [3, 14, 15, 17, 20, 21, 22, 23, 24, 27, 31], "familiar": [3, 13, 18], "issu": [3, 6, 9, 14, 15, 17, 18, 20, 21, 23, 25, 29], "3560": 3, "track": [3, 20, 34], "statu": [3, 20], "put": [3, 6, 18, 20, 25, 36], "alia": [3, 11, 15], "avoid": [3, 18, 20, 21, 23], "duplic": 3, "mention": [3, 6, 22, 26, 31], "below": [3, 6, 10, 11, 14, 18, 21, 22, 23, 31, 34, 35], "live": [3, 6, 15, 22, 31], "folder": [3, 4, 5, 6], "except": [3, 6, 21, 32], "torch": [3, 4, 5, 8, 9, 12, 13, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 36], "shape_infer": 3, "shape": [3, 6, 8, 9, 10, 12, 13, 15, 20, 21, 24, 27, 32, 33, 36], "defin": [3, 5, 6, 8, 10, 12, 15, 19, 21, 23, 27, 29, 32, 33, 36], "input": [3, 6, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 23, 24, 27, 29, 32, 33, 34], "return": [3, 6, 7, 8, 9, 10, 11, 15, 17, 18, 20, 21, 22, 24, 25, 26, 27, 30, 31, 32, 34, 36], "output": [3, 4, 5, 8, 9, 10, 11, 12, 14, 15, 18, 20, 23, 24, 25, 26, 27, 28, 32, 36], "manual": [3, 6, 8, 20, 28], "gen_lazy_tensor": 3, "data": [3, 11, 13, 14, 15, 17, 18, 19, 21, 22, 23, 26, 31, 33, 34], "aten": [3, 5, 6, 10, 20, 22, 31], "specif": [3, 5, 9, 15, 17, 18, 19, 21, 23, 25, 30, 33], "run_gen_lazy_tensor": 3, "dest": 3, "lazy_ir": 3, "class": [3, 7, 9, 10, 11, 15, 18, 24, 25, 28, 30, 33, 34, 36], "genlazyir": 3, "back": [3, 6, 15, 18, 20, 21, 32], "todai": [3, 16], "most": [3, 7, 14, 15, 19, 20, 26], "categori": [3, 29], "goal": [3, 4, 6, 11, 36], "move": [3, 14, 15, 20, 22, 24, 25, 31, 34, 36], "necessari": [3, 15, 20, 23], "call": [3, 5, 6, 10, 11, 12, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 31, 32, 34, 36], "upstream": [3, 11, 16, 24], "api": [3, 6, 10, 14, 18, 22, 25, 26, 28, 30, 31, 32, 34], "xlanativefunct": [3, 6], "column": 3, "declar": [3, 6], "anoth": [3, 16, 18, 20, 21, 22, 31, 36], "wrap": [3, 6, 7, 8, 15, 18, 21, 23, 24, 25, 28, 29, 30, 32], "around": [3, 14, 22, 28, 31, 33], "xlatensor": [3, 6, 15, 32], "construct": [3, 6, 18, 21, 28, 32, 34], "aten_xla_typ": [3, 6], "Will": 3, "method": [3, 10, 14, 15, 19, 23, 29, 32, 34], "map": [3, 6, 11, 15], "node": [3, 6, 11, 12, 15, 20, 22, 31, 35], "remov": [3, 14, 20, 21], "tensor_method": [3, 6], "possibl": [3, 14, 18, 20, 21, 28, 29, 32, 36], "multipl": [3, 11, 15, 17, 19, 22, 25, 26, 30, 31, 33, 36], "few": [3, 18, 20, 21, 22, 25, 31, 34], "simpler": [3, 14], "go": [3, 18, 21, 23, 32], "unari": 3, "binari": [3, 5, 7, 26, 36], "exampl": [3, 4, 5, 6, 7, 10, 11, 14, 15, 16, 17, 18, 20, 22, 24, 25, 26, 29, 30, 31, 32, 33, 34, 35, 36], "characterist": 3, "fallback": [3, 6], "_adaptive_avg_pool3d": 3, "condit": [3, 17, 18, 22, 27, 31], "issupportedadaptivepool": 3, "xlahelp": 3, "i64list": 3, "self": [3, 6, 7, 9, 10, 11, 15, 18, 21, 24, 25, 30, 32], "size": [3, 9, 11, 12, 14, 16, 18, 20, 21, 22, 31, 33, 34, 36], "output_size_list": 3, "pool_dim": 3, "nativ": [3, 5, 6, 14, 17, 20, 23, 25, 32], "call_fallback_fn": 3, "xla_fallback": 3, "aten_op": 3, "output_s": 3, "wip": 3, "evolv": 3, "At": [3, 5, 7, 15], "point": [3, 4, 5, 6, 7, 13, 15, 18, 19, 21, 22, 23, 31], "self_tensor": 3, "static": [3, 16, 17, 22, 31], "bool": [3, 15], "sync_upd": 3, "sys_util": 3, "getenvbool": 3, "xla_tensor_update_sync": 3, "true": [3, 5, 9, 14, 15, 17, 19, 21, 22, 25, 28, 31, 32, 34, 36], "xla_check": 3, "dst_tensor": 3, "updatefromtensor": 3, "sync": [3, 14, 15, 17, 18, 20, 21, 23, 25], "complic": [3, 6, 8, 17], "would": [3, 4, 6, 14, 15, 18, 19, 20, 21, 22, 27, 31, 36], "someth": [3, 9, 21], "ab": [3, 28], "const": [3, 6, 11], "torch_lazy_fn_count": 3, "bridg": [3, 26], "atenfromxlatensor": 3, "getxlatensor": 3, "fail": [3, 5, 15, 18, 20, 34], "explain": [3, 7, 18, 20, 21, 22, 24, 31], "later": [3, 21, 24], "still": [3, 11, 14, 18, 19, 22, 23, 25, 31, 34], "If": [3, 4, 5, 6, 9, 10, 14, 15, 18, 19, 20, 21, 22, 24, 30, 31, 32, 33, 36], "while": [3, 9, 10, 11, 13, 15, 17, 18, 19, 21, 22, 25, 31], "error": [3, 10, 15, 18, 20], "involv": [3, 15, 19, 22, 31, 32], "problem": [3, 22, 31], "yet": [3, 6, 11], "attempt": [3, 34], "unblock": [3, 34], "snippet": [3, 5, 18, 32, 33], "auto": [3, 6, 15, 28, 34], "common_devic": 3, "getxladevic": 3, "torch_internal_assert": 3, "xlatensorptr": 3, "lazy_self": 3, "getxlatensororcreateforwrappednumb": 3, "nodeptr": 3, "reusenod": 3, "getirvalu": 3, "makenod": 3, "cachenod": 3, "creat": [3, 5, 10, 12, 13, 14, 15, 20, 21, 23, 24, 25, 32, 33, 34, 36], "std": [3, 11, 25], "get": [3, 6, 14, 15, 16, 21, 22, 25, 28, 30, 31], "check": [3, 4, 6, 10, 15, 18, 30], "reus": [3, 9, 18, 21, 23, 24], "previou": [3, 5, 14, 18, 19, 21, 22, 31, 33, 36], "creation": [3, 15], "correspond": [3, 6, 11, 15, 21, 23, 28, 32, 33], "cach": [3, 8, 15, 16, 21, 24], "newli": 3, "And": [3, 22, 25, 31, 32], "within": [3, 15, 17, 18, 20, 21, 30, 33, 34], "note": [3, 4, 8, 11, 12, 14, 15, 17, 18, 20, 21, 22, 26, 28, 29, 30, 31, 33], "done": [3, 4, 8, 18, 20, 21, 22, 31, 36], "public": [3, 14], "xlanod": 3, "xlavalu": 3, "opkind": [3, 6], "absoutputshap": 3, "num_output": [3, 22, 31], "mhash": 3, "string": [3, 11, 15, 32, 36], "tostr": 3, "overrid": [3, 15, 23], "stringstream": 3, "ss": 3, "str": [3, 7, 10, 15, 36], "xlaopvector": 3, "loweringcontext": 3, "loctx": 3, "A": [3, 7, 13, 14, 15, 17, 18, 19, 21, 22, 23, 29, 30, 31, 32, 33], "coupl": [3, 18, 20], "thing": [3, 20, 21, 24], "keep": [3, 4, 14, 16, 20, 22, 31, 36], "mind": [3, 14, 20], "clone": [3, 14, 20, 21], "even": [3, 14, 15, 17, 18, 20, 22, 24, 25, 31, 36], "everi": [3, 6, 8, 9, 14, 15, 18, 20, 22, 24, 26, 31, 32, 34], "outputshap": 3, "xla_shap": 3, "overli": 3, "simplifi": 3, "buildxxxop": 3, "slightli": [3, 6, 15], "better": [3, 6, 14, 17, 18, 20, 21, 22, 26, 27, 31], "maximumoutputshap": 3, "lower_for_shape_fn": 3, "absl": 3, "xlaop": [3, 6], "operand": 3, "promot": 3, "max": [3, 22, 31, 34], "second": [3, 9, 10, 12, 14, 16, 17, 20, 21, 25, 33, 35], "inferoutputshap": 3, "comput": [3, 4, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 31, 32, 33], "logic": [3, 9, 15, 22, 27, 31, 32, 33], "two": [3, 5, 7, 14, 15, 18, 19, 20, 21, 22, 31, 32, 33, 36], "xla_input": 3, "getoutputop": 3, "returnop": 3, "buildab": 3, "origin": [3, 21], "genericop": 3, "modifi": [3, 18, 21, 23, 26, 32, 36], "abov": [3, 6, 7, 10, 14, 15, 16, 18, 20, 21, 22, 25, 26, 31, 33], "delet": 3, "sometim": [3, 21, 22, 31], "being": [3, 15, 18, 21, 25, 33, 36], "tensor_op": 3, "cross": [3, 15, 18, 32], "s1": [3, 32], "sub": 3, "mul": [3, 15, 22, 31, 36], "u2": 3, "v3": [3, 18, 25], "u3": 3, "v2": [3, 4, 18], "irnod": 3, "those": [3, 5, 6, 15, 20, 21, 25], "long": [3, 9, 17, 19, 20, 21, 22, 25, 31], "term": [3, 12, 17, 20, 22, 31, 36], "rid": [3, 22, 31], "composit": [3, 6], "end": [3, 6, 12, 14, 15, 16, 18, 20, 21, 25, 28, 29], "exp": 3, "pow": 3, "norm_exp": 3, "vector": [3, 12], "don": [3, 6, 14, 16, 18, 20, 22, 28, 31], "t": [3, 6, 14, 15, 16, 18, 19, 20, 22, 23, 28, 29, 31, 32, 33, 34], "build_cpp_test": 3, "skip": [3, 6, 20, 26], "desir": [3, 21, 33, 34], "test_ptxla": 3, "gtest_filt": 3, "atenxlatensortest": 3, "testab": 3, "correct": [3, 19, 22, 24, 31], "counter": [3, 6, 15, 20], "correctli": [3, 20, 29], "bitwise_left_shift": 3, "pull": [3, 23, 25, 28], "8865": 3, "erf": 3, "erfc": 3, "erfinv": 3, "3659": 3, "binary_cross_entropi": [3, 23], "backward": [3, 6, 9, 14, 17, 18, 23, 25, 26, 28, 29], "3809": 3, "scalar": [3, 6, 15, 20, 22, 31], "addcdiv": 3, "addcmul": 3, "3768": 3, "neg": 3, "index": [3, 4, 7, 8, 14, 15, 18, 20, 21, 33, 35], "amin": 3, "amax": 3, "3771": 3, "special": [3, 10, 12, 21, 32, 36], "partial": [3, 22, 28, 29, 31], "adaptive_avgpool3d": 3, "3790": 3, "guid": [4, 5, 8, 9, 13, 14, 18, 21, 28, 29, 32], "interact": [4, 13, 14], "start": [4, 5, 14, 18, 19, 20, 21], "colab": [4, 20, 36], "kaggl": 4, "preinstal": [4, 14], "ecosystem": [4, 17, 30], "packag": [4, 12, 13, 18, 21, 23, 25, 36], "date": [4, 36], "list": [4, 5, 6, 9, 15, 21, 23, 24, 27, 32, 33], "readm": [4, 20, 21], "prerequisit": [4, 32], "remot": 4, "quota": 4, "request": [4, 5, 6, 15, 20, 21, 22, 23, 25, 31, 32, 33], "offici": [4, 5, 20], "ssh": [4, 14, 18, 21], "regist": [4, 6, 7, 10, 11, 14, 34], "agent": 4, "alreadi": [4, 8, 12, 15, 20, 21, 22, 25, 28, 31, 34], "befor": [4, 5, 8, 11, 14, 15, 18, 19, 20, 21, 22, 23, 25, 26, 29, 31, 32, 34, 36], "begin": [4, 18, 19, 32, 36], "zone": [4, 14, 18, 21], "tpu_typ": 4, "8": [4, 9, 10, 12, 14, 15, 17, 18, 21, 22, 25, 26, 30, 31, 32, 33], "vm": [4, 14, 18, 20, 21, 25], "assum": [4, 7, 8, 15, 18, 19, 22, 25, 29, 31, 32, 33], "id_ed25519": 4, "ubuntu2204": 4, "base": [4, 11, 14, 15, 17, 18, 20, 21, 22, 24, 28, 31, 32, 33, 36], "metadata": [4, 20], "cat": [4, 23], "pub": 4, "ip": [4, 14, 15, 34, 35], "format": [4, 10, 15, 20, 21, 26, 30, 36], "valu": [4, 5, 6, 9, 12, 14, 15, 16, 18, 20, 21, 22, 24, 27, 31, 32, 35, 36], "networkendpoint": 4, "accessconfig": 4, "externalip": 4, "123": 4, "give": [4, 20, 21, 30, 32, 33], "friendli": 4, "easier": [4, 21, 22, 31], "echo": 4, "host": [4, 14, 15, 18, 19, 20, 21, 23, 28, 34, 35], "n": [4, 15, 25, 30, 33], "hostnam": 4, "test": [4, 5, 7, 8, 12, 14, 16, 24, 25, 28, 35, 36], "vs": [4, 9, 13, 14, 22, 31], "palett": 4, "select": [4, 5, 14, 15, 34], "visualstudio": 4, "doc": [4, 8, 9, 14, 15, 18, 22, 31], "__": [4, 14], "just": [4, 8, 14, 18, 19, 22, 25, 28, 31, 34], "titl": [4, 14], "open": [4, 5, 6, 7, 14, 20], "window": 4, "termin": [4, 34], "mkdir": 4, "ptxla": 4, "Then": [4, 5, 10, 21], "ui": 4, "venv": 4, "virtual": [4, 5, 15], "latest": [4, 8, 18], "releas": [4, 7, 8, 11, 14, 17, 18, 20, 21, 26, 28, 29, 30, 32], "pip": [4, 8, 12, 13, 21], "numpi": [4, 8, 10, 15, 21, 33], "f": [4, 8, 10, 15, 18, 25, 28, 30, 34, 36], "googleapi": [4, 8, 21], "libtpu": [4, 7, 14, 36], "wheel": [4, 21, 28], "html": [4, 8, 14, 15, 28], "import": [4, 5, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 20, 21, 23, 24, 25, 26, 27, 28, 29, 30, 32, 33, 34, 36], "set_device_typ": 4, "print": [4, 5, 9, 10, 13, 14, 15, 16, 18, 19, 20, 21, 22, 24, 25, 26, 31, 32, 34, 36], "real_devic": 4, "run": [4, 5, 6, 8, 9, 12, 13, 14, 15, 16, 17, 19, 22, 23, 24, 25, 26, 28, 30, 31, 33, 34, 36], "2": [4, 5, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18, 20, 24, 26, 27, 28, 29, 30, 32, 33, 35, 36], "3": [4, 6, 7, 8, 9, 10, 12, 15, 17, 20, 21, 26, 27, 28, 30, 32, 33, 36], "4": [4, 7, 8, 9, 10, 14, 15, 18, 20, 21, 22, 26, 27, 28, 30, 31, 32, 33, 36], "5": [4, 9, 11, 15, 16, 20, 21, 22, 24, 25, 28, 30, 31, 33], "7": [4, 15, 20, 25, 26, 33, 36], "number": [4, 5, 9, 12, 14, 15, 16, 17, 20, 21, 24, 28, 32, 33], "vari": [4, 14, 17, 22, 29, 31], "That": [4, 9, 22, 24, 31], "now": [4, 10, 11, 12, 14, 18, 21, 22, 31, 32, 36], "realist": 4, "show": [5, 9, 10, 11, 14, 18, 20, 25, 36], "how": [5, 6, 8, 9, 10, 11, 12, 14, 15, 18, 19, 20, 21, 22, 23, 31, 32, 35, 36], "contributor": 5, "xla": [5, 6, 9, 10, 11, 12, 14, 16, 22, 24, 25, 26, 27, 29, 31, 32, 34, 35], "conda": 5, "forg": 5, "probabl": [5, 22, 31], "interest": [5, 25, 36], "o0": 5, "use_custom_debinfo": 5, "file1": 5, "file2": 5, "caus": [5, 6, 14, 15, 17, 18, 20, 21, 22, 23, 31], "prevent": [5, 15, 17, 21, 23, 26, 32], "perform": [5, 6, 8, 10, 11, 12, 13, 15, 18, 23, 24, 25, 26, 28, 30, 32, 36], "geenrat": 5, "meaning": 5, "semicolon": 5, "let": [5, 8, 14, 17, 18, 20, 21, 26], "suggest": [5, 20], "step": [5, 9, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 31, 32, 34], "identifi": [5, 7, 15, 17, 18, 33, 34, 36], "similar": [5, 6, 14, 17, 21, 25, 27, 30], "src": [5, 34], "linear": [5, 14, 15, 18, 23, 24, 25, 30], "breakpoint": 5, "session": 5, "discov": [5, 34], "addit": [5, 6, 7, 12, 14, 18, 20, 21, 23, 25], "rebuild": 5, "newfil": 5, "readi": [5, 21], "howev": [5, 6, 8, 9, 10, 17, 20, 21, 32], "full": [5, 12, 15, 18, 19, 20, 28, 36], "unfortun": 5, "touch": [5, 25, 34], "its": [5, 6, 11, 14, 16, 17, 18, 19, 20, 24, 25, 26, 28, 32, 36], "timestamp": [5, 19], "reliabl": [5, 14], "rebuilt": 5, "wa": [5, 14, 15, 17, 20, 21, 22, 31, 34, 36], "use_rocm_kernel_assert": 5, "off": [5, 15, 21], "has_wmissing_prototyp": 5, "has_werror_missing_prototyp": 5, "util": [5, 8, 10, 13, 15, 17, 18, 20, 25, 28, 29, 30, 33, 34], "scalarop": 5, "emptytensor": 5, "shut": 5, "must": [5, 6, 7, 9, 11, 14, 15, 18, 19, 20, 24, 29, 34, 35], "pack": [5, 36], "publish": 5, "microsoft": 5, "search": [5, 6], "ms": [5, 24], "cpptool": 5, "tab": 5, "sampl": [5, 10, 14, 15, 20], "ll": [5, 6, 9, 22, 31, 36], "adjust": [5, 18], "match": [5, 6, 10, 15, 17, 18, 20], "interpret": [5, 15, 22, 31, 36], "cppdbg": 5, "program": [5, 8, 9, 10, 12, 15, 18, 20, 21, 22, 26, 31, 32, 33], "home": 5, "miniconda3": 5, "env": [5, 14, 15, 32], "torch310": 5, "bin": 5, "arg": [5, 10, 15, 18, 21, 27, 28], "cwd": 5, "workspacefold": 5, "externalconsol": 5, "fals": [5, 10, 11, 15, 18, 19, 28, 32, 36], "mimod": 5, "setupcommand": 5, "descript": 5, "pretti": [5, 18, 22, 25, 31], "text": [5, 20], "ignorefailur": 5, "disassembl": 5, "flavor": 5, "intel": 5, "prelaunchtask": 5, "activ": [5, 9, 15, 18, 20, 25, 28, 29, 30], "midebuggerpath": 5, "locat": [5, 15], "But": [5, 18, 20, 22, 31, 36], "quirk": 5, "switch": [5, 9, 17, 18, 20, 22, 25, 31], "between": [5, 11, 14, 16, 17, 18, 20, 21, 22, 23, 25, 27, 31, 32, 36], "vadimcn": 5, "id": [5, 14, 15, 20, 21, 33], "click": 5, "left": [5, 20], "red": 5, "dot": [5, 10, 20], "displai": [5, 21], "indic": [5, 9, 15, 20, 21, 22, 31, 33], "dropdown": 5, "right": [5, 17, 19, 22, 26, 31], "green": 5, "plai": 5, "button": 5, "rule": [5, 21, 23], "after": [5, 6, 9, 11, 14, 15, 17, 18, 19, 20, 21, 22, 27, 31, 32], "empti": [5, 15], "white": 5, "circl": 5, "load": [5, 12, 14, 15, 20, 25, 28, 30, 34], "librari": [5, 6, 7, 10, 21, 33, 34], "trigger": [5, 17, 20, 21, 22, 24, 31], "einsum": [5, 24], "yellow": 5, "arrow": 5, "collect": [5, 14, 25, 26, 33, 34], "certain": [5, 11, 20, 22, 23, 31, 36], "diagnost": 5, "turn": [5, 20, 36], "cuda": [5, 14, 15, 18, 19, 21, 22, 23, 30, 31, 35], "handl": [5, 7, 19, 20, 22, 28, 29, 31, 32, 33], "trace": [5, 9, 13, 14, 15, 17, 20, 21, 22, 23, 25, 26, 31, 32], "ld_library_path": 5, "cflag": 5, "dhas_torch_show_dispatch_trac": 5, "demonstr": [5, 9, 11, 17, 21, 23, 34, 36], "offer": [6, 10, 15, 17, 29, 30], "implement": [6, 8, 9, 11, 13, 14, 17, 20, 22, 26, 28, 29, 31], "convert": [6, 10, 15, 18, 24, 25, 36], "higher": [6, 9, 20, 34], "level": [6, 9, 15, 20, 21, 26, 30, 34], "represent": [6, 9, 15, 18, 21, 36], "i": [6, 9, 10, 14, 15, 18, 22, 24, 28, 31, 32, 33, 36], "hlo": [6, 9, 15, 18, 20, 21], "beyond": 6, "scope": 6, "forward": [6, 10, 17, 18, 23, 24, 25, 26, 29, 30], "haven": [6, 22, 31], "signific": [6, 17, 19, 20, 21, 26], "slowdown": [6, 20, 25], "best": [6, 8, 17, 26, 30, 33], "what": [6, 18, 21, 24], "debug": [6, 13, 17, 22, 30, 31, 33], "pt": [6, 14, 18, 20, 21], "profil": [6, 14], "_ctc_loss": [6, 20], "_ctc_loss_backward": [6, 20], "contribut": [6, 36], "definit": [6, 18, 22, 31], "native_funct": 6, "kernel": [6, 9, 10, 13, 22, 30, 31], "aten_fallback": 6, "h": [6, 36], "repo": [6, 18, 20, 21, 25], "sequenc": [6, 9, 15], "explicitli": [6, 17, 18, 19, 20, 21, 22, 23, 31], "compos": 6, "serv": [6, 21], "interfac": [6, 7, 18, 20, 34], "machineri": [6, 10], "registerxla": 6, "registerautogradxla": 6, "entri": [6, 7], "pytorch_xla": 6, "world": [6, 8, 14, 22, 26, 31, 34], "written": [6, 21, 34], "paramet": [6, 10, 14, 15, 18, 20, 23, 24, 25, 29, 32, 34, 35], "result": [6, 9, 11, 14, 15, 16, 18, 19, 20, 21, 25, 27, 32, 36], "wrapper": [6, 17, 18, 25, 28, 29], "inplac": [6, 15, 32], "ir": [6, 15, 20, 21, 22, 24, 31], "insid": [6, 18, 21, 24, 32], "stand": 6, "intermedi": [6, 9, 14, 20, 21, 36], "smaller": [6, 21, 22, 31], "inherit": 6, "dai": 6, "unless": [6, 20, 22, 31], "verifi": [6, 13, 15, 36], "test_oper": 6, "test_aten_xla_tensor": 6, "yield": [6, 18, 20, 36], "break": [6, 17, 21, 22, 31, 36], "grasp": 6, "capabl": 6, "minim": [6, 13, 21], "pr": [6, 20, 28], "vanilla": 6, "lerp": 6, "variant": [6, 22, 23, 31], "lerp_": 6, "scalar_out": 6, "tensor_out": 6, "prototyp": [6, 32], "weight": [6, 15, 20, 29, 30], "lerp_out": 6, "namespac": [6, 20], "wrapper_scalar_lerp": 6, "No": [6, 14, 16, 22, 24, 30, 31], "deviceguard": 6, "omit": [6, 14, 33, 35], "anonym": 6, "wrapper_scalar_lerp_": 6, "wrapper_scalar_lerp__tmp": 6, "_copy_from": 6, "m": [6, 10, 11, 22, 28, 31, 33, 36], "impl": [6, 10, 11], "torch_fn": 6, "automat": [6, 7, 13, 14, 15, 18, 20, 21, 22, 28, 31, 33, 34], "explicit": [6, 19, 23, 28], "place": [6, 11, 15, 21, 23, 32, 34, 36], "interned_str": 6, "symbol": [6, 22, 31], "submit": [6, 19, 20, 21, 23], "team": [7, 26], "tf": [7, 20, 22, 31], "close": [7, 17], "expos": [7, 14, 18, 21, 32], "deviceplugin": 7, "short": [7, 20, 22, 31], "pjrtclient": 7, "mirror": 7, "pjrt_api": 7, "straightforward": [7, 15, 21], "detail": [7, 8, 9, 10, 11, 14, 15, 18, 20, 21, 22, 31, 33], "concret": [7, 22, 31], "placehold": 7, "pjrt_library_path": 7, "extra": [7, 25, 29, 36], "multiprocess": [7, 14, 15, 18], "compon": [7, 36], "least": [7, 15, 21], "cpuplugin": 7, "def": [7, 8, 9, 10, 11, 12, 14, 15, 17, 18, 19, 21, 24, 25, 26, 27, 29, 30, 36], "library_path": 7, "os": [7, 14, 18, 25], "join": [7, 15], "dirnam": 7, "__file__": 7, "pjrt_c_api_cpu_plugin": 7, "exmapl": 7, "pyproject": 7, "toml": 7, "torch_xla_cpu_plugin": 7, "With": [7, 8, 14, 16, 22, 26, 31], "initi": [7, 11, 14, 15, 18, 19, 21, 25, 27, 34], "experiment": [7, 8, 9, 12, 13, 14, 16, 17, 24, 25, 26, 27, 29, 30, 32, 34], "state": [7, 9, 15, 19, 28], "becom": [7, 8, 9, 14, 17, 18, 20, 21, 22, 31], "stabl": [7, 14, 28], "rise": 8, "openai": [8, 12], "triton": [8, 13], "popular": 8, "commun": [8, 11, 14, 15, 18, 21, 26, 33], "instanc": [8, 11, 15, 28, 34], "order": [8, 9, 15, 18, 19, 20, 21, 32, 33], "pariti": 8, "continu": [8, 14, 26], "push": 8, "custom_kernel": 8, "jax_import_guard": 8, "pl": [8, 14, 18, 32], "jnp": [8, 10], "add_vectors_kernel": 8, "x_ref": 8, "y_ref": 8, "o_ref": 8, "x": [8, 9, 10, 12, 15, 18, 20, 21, 22, 24, 25, 27, 28, 29, 30, 31, 32, 33, 36], "y": [8, 9, 10, 12, 15, 20, 21, 22, 24, 28, 29, 30, 31, 32, 33, 36], "jit": [8, 10, 12, 18, 26], "add_vector": 8, "arrai": [8, 10, 15, 21, 29, 33], "pallas_cal": 8, "out_shap": 8, "shapedtypestruct": 8, "dtype": [8, 10, 12, 14, 22, 23, 24, 30, 31, 36], "otherwis": [8, 15, 20, 21, 22, 29, 31], "hang": 8, "lock": 8, "q": [8, 10], "randn": [8, 10, 14, 15, 17, 18, 24, 25, 26, 30, 32, 33], "128": [8, 9, 10, 14, 28, 30, 35], "k": [8, 10, 20], "v": [8, 10, 24], "make_kernel_from_palla": 8, "pt_kernel": 8, "lambda": [8, 24, 28], "liner": 8, "flash": [8, 9, 12], "attent": [8, 9, 10, 12], "besid": 8, "op": [8, 9, 10, 13, 15, 17, 19, 20, 21, 22, 23, 31, 32, 33], "suppor": 8, "flash_attent": [8, 24], "paged_attent": 8, "queri": [8, 14], "squeez": 8, "dim": [8, 9, 15], "key_cach": 8, "value_cach": 8, "context_len": 8, "block_tabl": 8, "pages_per_compute_block": 8, "megacore_mod": 8, "none": [8, 10, 11, 15, 20, 29, 32, 33], "vllm": 8, "effect": [8, 15, 24, 36], "memori": [8, 13, 15, 16, 20, 21, 22, 28, 31], "kv": 8, "proper": [8, 33], "jax_nightly_releas": 8, "jaxlib_nightly_releas": 8, "authorit": 8, "dev": [8, 21, 25], "en": [8, 28], "consid": [9, 14, 18, 19, 21], "mani": [9, 14, 15, 20, 21, 22, 24, 31, 35, 36], "homogen": 9, "llm": [9, 21], "drop": [9, 16, 20], "loop": [9, 17, 18, 20, 21, 22, 24, 29, 31, 34], "bunch": [9, 10], "decod": [9, 17, 24], "subsequ": [9, 19, 21], "significantli": [9, 14, 17, 18, 21], "reduc": [9, 11, 14, 15, 16, 18, 19, 20, 21, 28], "hand": [9, 18], "lower": [9, 10, 13, 17, 20, 21, 22, 23, 31], "lax": 9, "Its": [9, 15, 17], "primari": 9, "hood": 9, "itself": [9, 12, 15, 28], "typic": [9, 15, 19], "transform": [9, 19, 21, 28, 33], "run_decoder_lay": 9, "hidden_st": 9, "decoder_lay": 9, "unrol": 9, "flat": [9, 33], "shown": [9, 14, 17, 22, 31], "decoder_with_scan": 9, "root": [9, 15, 22, 31, 36], "python3": [9, 14, 16, 18, 20, 21, 24, 28], "train_decoder_only_bas": [9, 17, 20], "decoderwithscan": 9, "appli": [9, 11, 15, 18, 19, 23, 28, 29, 34], "dimens": [9, 15, 16, 32, 33], "carri": [9, 22, 31, 32], "along": [9, 15, 19, 28, 33], "fn": [9, 15], "callabl": [9, 15, 28], "tupl": [9, 10, 15, 22, 27, 29, 31, 33], "init": [9, 14, 18, 25, 26, 27], "xs": [9, 15, 29, 32, 33], "roughli": [9, 36], "equal": [9, 33, 36], "ys": 9, "len": [9, 15, 21], "append": [9, 20], "scan_exampl": 9, "scan_example_cumsum": 9, "cumul": [9, 19, 27], "sum": [9, 11, 15, 23, 28, 29], "scan_example_pytre": 9, "pytre": 9, "final": [9, 19, 25, 32, 36], "histori": 9, "15": [9, 21, 36], "count": [9, 15, 20], "mean": [9, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 29, 31, 32], "0000": 9, "5000": 9, "figur": [9, 11, 16, 33], "repe": 9, "bound": 9, "compar": [9, 14, 18, 20, 25, 26, 27], "overhead": [9, 14, 17, 19, 24, 25, 26], "especi": [9, 14, 15, 17, 21, 26, 32], "finish": [9, 15, 19, 21], "9m35": 9, "4m59": 9, "hidden": 9, "num": 9, "head": 9, "512": [9, 33], "500": 9, "metric": [9, 15, 25], "is_fn_pur": 9, "is_layer_pur": 9, "final_carri": 9, "init_scan": 9, "xs_scan": 9, "input_data": 9, "traceabl": [9, 11], "particular": [9, 21], "palla": [9, 13], "incompat": 9, "save": [9, 15, 20, 24, 28, 34], "chip": [9, 14, 17], "256": [9, 14], "50": [9, 20, 21, 27], "2048": [9, 14], "compiletim": [9, 20], "totalsampl": [9, 20], "accumul": [9, 15], "02m57s694ms418": 9, "595u": 9, "valuer": [9, 20], "02s112ms586": 9, "097u": 9, "rate": [9, 20, 25], "054285": 9, "percentil": [9, 20], "023ms113": 9, "470u": 9, "10": [9, 14, 15, 18, 20, 21, 22, 24, 25, 26, 27, 30, 31, 34, 36], "20": [9, 16, 18, 20, 25, 30, 36], "54s644ms733": 9, "284u": 9, "80": [9, 20], "01m03s028ms571": 9, "841u": 9, "90": [9, 20], "95": [9, 20], "99": [9, 20, 25], "29s996ms941": 9, "409u": 9, "02s529ms591": 9, "388u": 9, "158152": 9, "018ms636": 9, "571u": 9, "11s983ms003": 9, "171u": 9, "18s995ms301": 9, "667u": 9, "maximum": [9, 15, 16, 21, 30], "1m03": 9, "19": [9, 25, 26, 36], "7253": 9, "comment": [9, 22, 31], "accomplish": 10, "exportedprogram": 10, "fx": [10, 26], "exported_program_to_stablehlo": 10, "mlir": 10, "torchvis": [10, 17, 26], "torchax": 10, "tx": 10, "resnet18": [10, 17, 26], "sample_input": 10, "224": [10, 17], "mlir_modul": 10, "store": [10, 12, 15, 20], "feel": [10, 20, 25], "explor": 10, "org": [10, 14, 15, 28], "tutori": [10, 12, 15, 20, 21, 25, 32, 36], "jfunc": 10, "shapeddtypestruct": 10, "float32": [10, 23, 36], "last": [10, 20, 33, 36], "constant": [10, 20, 21, 32], "convent": 10, "ed": 10, "appear": [10, 18, 20, 21], "paramt": 10, "jfunc_inlin": 10, "scaled_dot_product_attent": 10, "decompos": 10, "low": [10, 16, 20, 36], "dure": [10, 15, 19, 20, 21, 26, 28, 32], "captur": [10, 15, 17, 19, 20, 21], "downstream": [10, 23], "ml": [10, 33, 36], "crucial": [10, 17, 19], "geneart": 10, "pattern": [10, 20, 22, 26, 31], "challeng": 10, "prone": 10, "robust": 10, "outlin": [10, 30], "pratic": 10, "scaled_product_attent": 10, "centric": 10, "unittest": 10, "nn": [10, 14, 15, 18, 25, 26, 28, 30, 32], "impl_abstract": 10, "jaten": 10, "jlibrari": 10, "mylib": 10, "basic": [10, 17, 18, 21, 22, 25, 31], "sdpa": 10, "compositeexplicitautograd": 10, "_mylib_scaled_dot_product_attent": 10, "product": [10, 15, 36], "transpos": [10, 22, 31], "dropout_p": 10, "is_caus": 10, "_mylib_scaled_dot_product_attention_meta": 10, "empty_lik": [10, 12], "decomposit": 10, "register_torch_composit": 10, "softmax": 10, "register_jax_composit": 10, "_aten_softmax": 10, "_softmax": 10, "static_argnum": 10, "librarytest": 10, "testcas": 10, "manual_se": [10, 14, 15], "default_env": 10, "use_torch_native_for_cpu_tensor": 10, "test_basic_sdpa_librari": 10, "customopexampl": 10, "rand": [10, 22, 31, 36], "32": [10, 15, 20, 21, 33], "64": [10, 17, 26, 28], "module_str": 10, "todo": 10, "produc": [10, 19, 22, 23, 25, 31], "assertin": 10, "__name__": [10, 14, 18, 25], "__main__": [10, 14, 18, 25], "emit": 10, "repres": [10, 14, 15, 22, 31, 36], "region": [10, 15, 20, 23, 32], "th": [10, 33], "xla_model": [11, 13, 14, 18, 19, 20, 21, 23, 25, 26, 27, 28, 29, 30, 33], "adopt": [11, 22, 31], "reimplement": [11, 14], "_c10d_function": 11, "all_reduc": [11, 15, 23], "processgroupxla": 11, "deriv": 11, "processgroup": 11, "xla_backend": [11, 14, 25, 34], "_create_xla_process_group": 11, "prefix_stor": 11, "rank": [11, 14, 15, 25, 28, 33, 34], "timeout": 11, "assert": [11, 25, 36], "xr": [11, 14, 15, 18, 23, 25, 28, 29, 32, 33, 34], "is_spmd": [11, 15], "spmd": [11, 13, 18, 21, 24, 34], "group": [11, 14, 15, 25, 32], "_register_xla_backend": 11, "dist": [11, 14, 25, 34], "register_backend": 11, "allreduc": 11, "all_reduce_opt": 11, "allgath": 11, "output_tensors_list": 11, "input_tensor": 11, "opt": [11, 18], "_mp_fn": [11, 14, 18], "init_process_group": [11, 14, 25, 34], "init_method": [11, 14, 34], "progress": [11, 21], "blob": [11, 12, 14, 15], "distributed_c10d": 11, "_exception_logg": 11, "all_gath": [11, 14, 15], "tensor_list": 11, "async_op": 11, "_get_default_group": 11, "remap": 11, "_functional_collect": 11, "all_reduce_inplac": 11, "eventu": 11, "reach": [11, 15, 36], "rewrit": [11, 21, 22, 31, 32], "reduceop": 11, "group_nam": 11, "torch_library_impl": 11, "four": [11, 21], "align": [11, 17], "signatur": 11, "remain": [11, 18, 21, 22, 31, 35], "restrict": 11, "usag": [11, 15, 17, 20, 21, 22, 28, 29, 31, 34], "test_collective_ops_tpu": 11, "scenario": [11, 19, 26], "reduct": [11, 15], "aggreg": 11, "all_gather_into_tensor": 11, "gather": [11, 15, 20, 32], "reduce_scatter_tensor": 11, "across": [11, 13, 14, 15, 17, 18, 20, 28, 29, 33], "all_to_all_singl": 11, "output_split_s": 11, "input_split_s": 11, "although": [11, 14, 22, 31, 36], "accept": [11, 32], "argument": [11, 12, 15, 19, 21, 23, 24, 26, 28], "1s": 11, "limit": [11, 14, 15, 18], "reflect": [11, 19, 33], "compromis": 11, "maintain": [11, 13, 36], "constraint": [11, 14, 20], "alltoal": [11, 15], "high": [12, 13, 15, 16, 21, 25, 30, 36], "deep": [12, 17, 20], "learn": [12, 14, 17, 33, 36], "languag": [12, 24], "empow": 12, "potenti": [12, 14, 15, 18, 20], "given": [12, 15, 20, 21, 22, 24, 25, 28, 31, 33, 36], "add_kernel": 12, "x_ptr": 12, "pointer": 12, "y_ptr": 12, "output_ptr": 12, "n_element": 12, "block_siz": 12, "tl": 12, "constexpr": 12, "element": [12, 15, 22, 29, 31, 32, 33, 36], "01": 12, "l28": 12, "pid": 12, "program_id": 12, "axi": [12, 15, 29, 33], "block_start": 12, "offset": 12, "arang": 12, "mask": [12, 20, 22, 31], "xla_triton": 12, "16": [12, 18, 21, 28, 30, 33], "int64": 12, "grid": 12, "cdiv": 12, "triton_cal": 12, "kwarg": [12, 15, 28, 32], "payload": [12, 14, 15], "regard": [12, 18, 26], "buffer": [12, 15, 24], "_xla_gpu_custom_cal": 12, "dep": 12, "job": [13, 15, 21, 26], "thousand": [13, 14], "mfu": 13, "hardwar": [13, 15, 17, 20, 21, 23], "__version__": [13, 20], "overview": 13, "control": [13, 15, 16, 18, 20, 32], "mxu": 13, "float": [13, 15, 22, 23, 31], "precis": [13, 15], "topic": [13, 33], "checkpoint": [13, 14, 21, 28, 33], "ddp": [13, 14], "shard": [13, 15, 34], "fsdp": [13, 15, 32, 33], "One": [13, 15, 16, 18, 21], "stablehlo": [13, 15], "mix": [13, 15, 33], "torchdynamo": 13, "quantiz": 13, "repeat": 13, "layer": [13, 16, 17, 24, 28, 29, 32], "scan": 13, "scan_lay": 13, "while_loop": 13, "assume_pur": 13, "eager": [13, 15, 19, 22, 25, 30, 31], "mode": [13, 15, 19, 22, 25, 30, 31, 32, 34, 36], "recompil": [13, 16, 17, 18, 20, 21], "bazel": 13, "plugin": [13, 14], "encount": [14, 18, 20, 21], "bug": [14, 20, 25], "tag": [14, 15], "r2": [14, 20, 32], "renam": 14, "torchrun": [14, 18, 35], "xpu": 14, "neuron": [14, 18], "xrt_tpu_config": 14, "impact": [14, 15, 17, 20, 22, 25, 31, 36], "30": [14, 28], "preview": 14, "thread": [14, 15, 18, 20, 34], "safe": 14, "section": [14, 18, 20, 21, 32, 33], "broadcast": 14, "replica": [14, 15], "broadcast_master_param": 14, "random": [14, 15, 17, 21, 24, 30, 36], "global": [14, 15, 18, 24, 32, 34], "rng": [14, 15], "pjrt_backend": 14, "v4": [14, 15, 17, 18, 21, 26, 32], "distributeddataparallel": 14, "parallel_load": [14, 15, 18, 20], "global_ordin": [14, 15, 18, 25, 28], "world_siz": [14, 15, 23, 25, 28, 32], "42": [14, 24], "gradient_as_bucket_view": [14, 25], "loss_fn": [14, 17, 18, 23, 25, 26], "mseloss": [14, 25], "sgd": [14, 18, 23, 25, 26], "lr": [14, 18, 25, 26, 28, 29], "001": [14, 25], "zero_grad": [14, 17, 18, 23, 25], "loss": [14, 17, 18, 23, 26, 28, 29, 36], "confirm": 14, "p": [14, 20, 22, 31, 36], "localservic": 14, "localhost": 14, "51011": 14, "master_addr": 14, "master_port": 14, "12355": [14, 35], "Or": [14, 18, 22, 31], "grpc": 14, "torchbench": 14, "observ": [14, 17, 25], "35": [14, 20], "copi": [14, 15, 18, 20, 21], "worker": [14, 15, 18, 21, 28, 29, 34], "tpuvm": [14, 18, 21, 32], "mnist": [14, 18, 20, 23], "test_train_mp_mnist": [14, 25], "fake_data": [14, 20, 25, 35], "alpha": [14, 18], "central2": [14, 21], "b": [14, 15, 19, 21, 22, 23, 24, 26, 31, 33], "resnet50": [14, 17, 18, 26, 28], "git": [14, 20, 21, 28], "depth": [14, 20], "branch": [14, 20, 22, 31], "test_train_mp_imagenet": [14, 20, 25], "batch_siz": [14, 28, 35], "num_epoch": [14, 25, 28], "By": [14, 15, 22, 31, 36], "tpu_process_bound": 14, "tpu_visible_chip": 14, "r1": 14, "13": [14, 18, 25, 27], "docker_imag": 14, "gcr": 14, "io": [14, 28], "privat": 14, "sudo": [14, 21], "rm": 14, "privileg": 14, "net": [14, 21, 23], "gpu_num_devic": 14, "nnode": [14, 35], "nproc": [14, 15], "num_gpu_devic": 14, "pjrt_distribut": 14, "physic": [14, 32, 33, 36], "12": [14, 20, 26, 28], "number_gpu_vm": [14, 35], "node_rank": [14, 35], "current_node_rank": 14, "nproc_per_nod": [14, 35], "number_local_gpu_devic": 14, "rdzv_endpoint": [14, 35], "internal_ip_address": 14, "multinode_train": 14, "endpoint": [14, 35], "form": [14, 20, 22, 31, 35], "intern": [14, 15, 17, 18, 19, 20, 22, 31, 32, 35, 36], "address": [14, 15, 17, 32, 35], "machine_0": 14, "machine_1": 14, "machine_0_internal_ip_address": [14, 35], "ident": 14, "page": 14, "mostli": [14, 28], "interchang": 14, "perspect": [14, 18], "subtl": 14, "importantli": [14, 24], "architectur": [14, 28], "spawn": [14, 15, 18, 21], "server": [14, 15, 21], "thu": [14, 17, 19, 20], "batch": [14, 18, 20, 21, 32], "latenc": 14, "serial": [14, 18], "deseri": 14, "send": [14, 18, 21, 32], "constrain": [14, 15], "direct": [14, 19, 20], "independ": [14, 17, 18, 20], "plan": 14, "xla_dist": 14, "scp": [14, 18], "sdk": 14, "enhanc": [14, 17], "stabil": [14, 20, 23], "xmp": [14, 18, 21], "substanti": 14, "mesh": [14, 15, 29], "master": [14, 15, 18, 34], "connect": [14, 15, 32], "practic": [14, 17, 22, 29, 31, 33], "unreli": 14, "due": [14, 17, 20, 21, 35, 36], "inbound": 14, "could": [14, 21, 22, 31, 32, 36], "failur": 14, "forc": [14, 15, 20, 22, 27, 31], "entir": [14, 28], "restart": 14, "much": [14, 18, 21, 22, 24, 26, 31], "impos": 14, "transfer": [14, 15, 19, 20, 21, 32], "middl": [14, 21, 22, 31], "unwant": 14, "permit": 14, "subset": [14, 33], "particip": [14, 15], "old": 14, "alter": 14, "synchron": [14, 17, 18, 21, 32, 34], "barrier": [14, 15, 18, 19, 21], "all_gather_object": 14, "gloo": [14, 25, 34], "new_group": 14, "subgroup": 14, "monitor": 14, "context": [14, 15, 17, 20, 22, 23, 31], "altern": [14, 22, 23, 30, 31], "less": [14, 22, 26, 31, 36], "than": [14, 20, 22, 25, 28, 31, 36], "perf": [14, 22, 31], "md": [14, 15], "strongli": 14, "_all_gath": 14, "int": [14, 15, 22, 24, 31, 32, 36], "int32": 14, "zeros_lik": 14, "_": [14, 19, 26, 27], "get_world_s": 14, "averag": 14, "task": [14, 17], "175": 14, "chart": 14, "breakdown": 14, "tfrt": 14, "legaci": 14, "streamexecutor": 14, "tpu_legaci": 14, "happen": [14, 15, 17, 18, 20, 21, 22, 31], "comparison": [14, 33], "device_count": [15, 32], "wait": [15, 19, 20, 21], "reset_scop": 15, "pend": [15, 19], "whether": [15, 18, 23], "block": [15, 19, 21, 28, 32], "reset": 15, "scopecontext": 15, "full_graph": [15, 17], "max_different_graph": 15, "lazytensor": [15, 21], "decid": [15, 20, 22, 24, 31], "funciton": 15, "act": [15, 18], "throw": [15, 18], "exit": [15, 20, 23, 25], "pt_xla_debug": 15, "messag": [15, 18, 20], "dump": [15, 20], "allow": [15, 18, 20, 21, 23, 32, 33, 34, 36], "rais": [15, 20, 36], "exceed": 15, "foo": 15, "sin": [15, 24], "co": 15, "foo2": 15, "compiled_foo2": 15, "seed": 15, "integ": [15, 20, 33], "subpackag": 15, "mp": 15, "etc": [15, 20, 22, 31, 32], "set_mat_mul_precis": [15, 36], "liter": 15, "highest": [15, 34, 36], "mat": [15, 36], "conv": 15, "32bit": 15, "matrix": [15, 18, 19, 36], "convolut": 15, "trade": [15, 21, 22, 31], "accuraci": [15, 25, 28, 36], "fastest": 15, "downcast": 15, "fp32": 15, "bf16": [15, 36], "multipli": [15, 18, 33, 36], "three": [15, 18, 36], "approxim": 15, "14": 15, "slowest": 15, "six": [15, 36], "22": [15, 25], "precision_tutori": 15, "empir": [15, 36], "behav": [15, 20, 36], "get_mat_mul_precis": 15, "device_typ": 15, "local_process_count": 15, "local_device_count": 15, "total": [15, 19, 22, 31, 33, 36], "addressable_device_count": 15, "visibl": [15, 22, 31], "global_device_count": 15, "global_runtime_device_count": [15, 29, 32, 33], "ordin": [15, 18], "guarante": [15, 19, 24], "predict": 15, "relationship": [15, 18, 20], "nor": 15, "contigu": [15, 18, 20], "local_ordin": 15, "get_master_ip": 15, "retriev": [15, 18, 22, 26, 31, 32, 33, 36], "discoveri": 15, "use_spmd": [15, 32, 33, 34], "non": [15, 17, 22, 23, 24, 31, 33], "replic": [15, 32, 33], "spmd_advanc": 15, "initialize_cach": [15, 18], "readonli": [15, 18], "persist": [15, 18, 34], "xla_devic": 15, "devkind": 15, "deprec": 15, "xla_device_hw": 15, "union": 15, "real": [15, 26], "is_master_ordin": 15, "multi": [15, 16, 25, 32, 35], "num_host": 15, "boolean": 15, "reduce_typ": 15, "pin_layout": 15, "xm": [15, 18, 20, 21, 23, 25, 26, 27, 28, 29, 30, 33], "reduce_sum": 15, "reduce_mul": 15, "reduce_and": 15, "reduce_or": 15, "reduce_min": 15, "reduce_max": 15, "layout": [15, 30, 33], "pine": 15, "corrupt": 15, "unpin": 15, "hlomodul": 15, "hold": [15, 32], "channel_id": 15, "use_global_device_id": 15, "channel": [15, 30], "replicagroup": 15, "all_to_al": 15, "split_dimens": 15, "concat_dimens": 15, "split_count": 15, "www": 15, "operation_semant": 15, "upon": 15, "split": [15, 33], "concat": 15, "add_step_closur": 15, "closur": 15, "run_async": 15, "report": 15, "consol": 15, "tensorboard": [15, 21], "intermediari": 15, "inspect": [15, 36], "materi": [15, 19, 20, 21, 22, 31, 32], "queu": 15, "though": [15, 18, 25], "advis": 15, "throttl": 15, "event": 15, "asynchron": [15, 19, 32, 34], "wait_device_op": 15, "async": [15, 26], "whose": [15, 16, 33], "optimizer_step": [15, 18, 19, 21, 23, 25, 28], "optimizer_arg": 15, "dict": [15, 24, 28], "gradid": 15, "parallelload": [15, 32], "dataparallel": 15, "loader": [15, 19, 20, 21, 26], "dictionari": 15, "gradient": [15, 18, 19, 23, 28, 34], "file_or_path": 15, "textio": 15, "master_onli": [15, 28], "global_mast": 15, "care": [15, 18, 20, 22, 31], "taken": [15, 18, 19, 20, 22, 25, 31, 34], "view": [15, 18, 20], "recreat": [15, 18], "destin": [15, 18], "nest": [15, 28], "obj_to_sav": 15, "path_to_sav": 15, "rendezv": 15, "byte": 15, "xla_rendezv": 15, "sent": [15, 19, 20], "exchang": 15, "posit": 15, "mesh_reduc": 15, "reduce_fn": 15, "toxlatensorarena": 15, "receiv": 15, "np": [15, 29, 33], "test_accuraci": 15, "set_rng_stat": 15, "get_rng_stat": 15, "get_memory_info": 15, "memoryinfo": 15, "bytes_us": 15, "290816": 15, "bytes_limit": 15, "34088157184": 15, "peak_bytes_us": 15, "500816": 15, "get_stablehlo": 15, "var": [15, 32], "xla_hlo_debug": [15, 20], "get_stablehlo_bytecod": 15, "bytecod": [15, 26], "mpdeviceload": [15, 18, 21, 32], "dataload": [15, 17, 18, 21, 25, 32, 34], "background": [15, 34], "upload": [15, 21, 32], "per_device_load": [15, 32], "constructor": 15, "train_device_load": 15, "train_load": [15, 18, 32], "xla_multiprocess": 15, "daemon": 15, "start_method": 15, "moment": 15, "valueerror": [15, 36], "mark_shard": [15, 24, 29, 32, 33], "xlashardedtensor": [15, 34], "partition_spec": [15, 32, 33], "nonetyp": 15, "annot": [15, 32], "partit": [15, 32], "spec": [15, 32], "spmdpartition": [15, 32], "topolog": [15, 18, 32], "partitionspec": 15, "ax": [15, 32, 33], "mesh_shap": [15, 29, 32, 33], "num_devic": [15, 29, 32, 33], "device_id": [15, 29, 32, 33], "clear_shard": 15, "clear": [15, 17], "cast": [15, 23], "t1": [15, 18, 20, 33], "get_1d_mesh": 15, "set_global_mesh": 15, "get_global_mesh": 15, "axis_nam": [15, 32], "ndarrai": 15, "flatten": 15, "reshap": 15, "fill": 15, "row": [15, 33], "major": [15, 33], "global_runtime_device_attribut": [15, 33], "length": [15, 22, 31], "get_xla_supported_devic": 15, "get_logical_mesh": [15, 33], "ordereddict": [15, 32, 33], "hybridmesh": [15, 32], "ici_mesh_shap": [15, 32], "dcn_mesh_shap": [15, 32], "hybrid": 15, "ici": 15, "dcn": [15, 32], "increas": [15, 24], "intens": 15, "mdl": 15, "inner": [15, 28, 32], "outer": [15, 28, 29, 32], "slice": [15, 21, 32, 33], "eager_mod": [15, 17], "d": [15, 22, 23, 31], "eagerli": [15, 17, 18, 20, 22, 31], "metrics_report": [15, 20], "short_metrics_report": [15, 20], "counter_nam": 15, "metric_nam": 15, "counter_valu": 15, "metric_data": 15, "total_sampl": 15, "retain": 15, "circular": 15, "in_tensor": 16, "randint": [16, 30], "out_tensor": 16, "nonzero": [16, 20, 21, 22, 31, 36], "word": [16, 22, 24, 31], "25": 16, "further": [16, 21, 25], "categor": 16, "unbound": 16, "alloc": [16, 33], "infinit": [16, 29, 36], "phase": [16, 17], "perceptron": 16, "mlp": 16, "xla_experiment": 16, "masked_select": 16, "masked_scatt": 16, "your_script": [16, 21], "100": [16, 20, 24, 28], "29": [16, 25, 26], "49": [16, 26], "03": 16, "102": 16, "hit": [16, 22, 31], "198": 16, "1953": 16, "motiv": 16, "excess": 16, "half": [16, 36], "try": [16, 20, 21, 22, 31], "ds": 16, "test_dynamic_shape_model": 16, "testdynamicshapemodel": 16, "test_backward_pass_with_dynamic_input": 16, "record": [17, 18, 19, 20, 21, 24], "defer": [17, 18, 19], "approach": [17, 18, 19, 22, 25, 28, 31, 36], "usabl": 17, "ambigu": 17, "struggl": 17, "distinguish": 17, "whenev": 17, "preprocess": [17, 30], "expens": [17, 20, 22, 31], "difficulti": 17, "opaqu": [17, 18, 20], "natur": 17, "shift": 17, "priorit": 17, "preserv": [17, 18, 20], "immedi": [17, 18, 19, 32], "flexibl": [17, 30], "decor": [17, 24], "mark": 17, "boundari": 17, "feedback": 17, "outsid": [17, 18], "leak": 17, "catch": [17, 18], "accident": 17, "compiled_model": 17, "awai": [17, 19], "summar": [17, 23], "temporarili": 17, "resum": [17, 28], "abstract": [17, 30, 32], "balanc": 17, "distinct": [17, 19], "workflow": [17, 18], "advantag": [17, 18, 21], "enclos": 17, "step_fn": 17, "logit": [17, 29], "aim": [17, 22, 31], "quantifi": 17, "conduct": 17, "llama2": 17, "fake": [17, 34], "300": [17, 20], "measur": [17, 21], "clearli": 17, "illustr": [17, 21], "147": 17, "65": [17, 20], "tradit": [17, 26], "45": 17, "li": 17, "throughput": 17, "regular": [18, 20, 21, 30], "t0": 18, "mm": [18, 23, 36], "neural": [18, 36], "l_in": 18, "l_out": 18, "floattensor": 18, "highlight": [18, 21], "nllloss": 18, "momentum": 18, "acquir": 18, "distribut": [18, 20, 24, 28, 29, 32, 33], "mp_device_load": 18, "multithread": [18, 20], "assign": [18, 19, 21], "own": [18, 28], "onto": 18, "preload": [18, 21], "overlap": [18, 21, 26, 32], "batches_per_execut": 18, "consolid": [18, 28], "all_reduce_gradi": 18, "parent": 18, "talk": 18, "howto": 18, "focu": [18, 22, 31], "train_mnist_xla": 18, "infrastructur": 18, "awar": 18, "fakedata": 18, "fuse": [18, 21], "invis": 18, "caller": 18, "insert": [18, 21], "paper": 18, "unlik": [18, 21], "appreci": 18, "accommod": 18, "previous": 18, "state_dict": [18, 28, 34], "footprint": 18, "xser": 18, "stream": 18, "amount": [18, 20, 21, 22, 31], "restor": 18, "load_state_dict": [18, 34], "unavail": [18, 20], "aw": 18, "occur": [18, 36], "evalu": [18, 20, 21, 22, 24, 31], "fix": [18, 20, 21, 24, 26, 29], "incorrectli": 18, "solut": [18, 20, 22, 30, 31, 36], "feed": 18, "testmodel": 18, "__init__": [18, 24, 25, 30], "super": [18, 24, 25], "pre": 18, "determin": 18, "warn": [18, 20, 36], "pt_xla_debug_level": [18, 20], "_set_allow_execut": 18, "earli": [18, 22, 31], "relat": [18, 21], "troubleshoot": 18, "consum": [18, 22, 31], "doesn": [18, 19, 20, 22, 29, 31], "disk": 18, "your_cache_path": 18, "mount": 18, "mp_fn": 18, "tmp": [18, 20, 28], "xla_cache_": 18, "runnabl": [18, 25, 29], "essenti": [19, 36], "emploi": 19, "primarili": 19, "side": [19, 22, 24, 31], "period": [19, 21], "spend": [19, 21], "durat": [19, 21, 34], "conceptu": [19, 33, 36], "start_tim": 19, "perf_count": 19, "matmul": [19, 23, 36], "incorrect": 19, "end_tim": 19, "elapsed_tim": 19, "predominantli": 19, "took": 19, "actual": [19, 21, 22, 25, 31, 32], "devid": 19, "exemplifi": 19, "warm": 19, "translat": [19, 20], "isol": 19, "steadi": 19, "benchmark": 19, "isn": [19, 22, 31, 34], "exclud": 19, "sever": 19, "item": [19, 20, 21, 36], "condition": 19, "often": [19, 20, 22, 24, 31], "unlazi": 19, "structur": [19, 28, 32], "run_model": 19, "start_loop_tim": 19, "num_step": 19, "FOR": 19, "end_loop_tim": 19, "elapsed_loop_tim": 19, "spent": [19, 20, 21], "largli": 19, "proce": [19, 22, 31], "inclus": 19, "lag": 19, "behind": 19, "run_model_step": 19, "subject": 20, "peculiar": 20, "detial": 20, "cu121": 20, "t2": [20, 33], "200": 20, "nightli": [20, 21, 28, 32], "rx": 20, "conclud": 20, "diagnos": 20, "extrem": [20, 24], "slip": 20, "analyz": [20, 21], "summari": 20, "frequent": 20, "21": 20, "11": [20, 22, 31], "transferfromdevicetim": 20, "23": [20, 36], "hash": 20, "c74c3b91b855b2b123f833b0d5f86943": 20, "107": 20, "frame": 20, "dk3": 20, "1055": 20, "44": 20, "__next__": 20, "train_loop_fn": 20, "48": [20, 25], "start_train": 20, "73": 20, "548000": 20, "gb": 20, "922460": 20, "alias": [20, 23], "547871": 20, "124478": 20, "028210": 20, "cal": 20, "steptrac": 20, "tri": [20, 21], "mark_step": 20, "frequenc": 20, "pair": 20, "met": 20, "destroi": 20, "202": 20, "06m09s401ms746": 20, "001u": 20, "778ms572": 20, "062u": 20, "425201": 20, "001ms32": 20, "778u": 20, "001ms61": 20, "283u": 20, "001ms79": 20, "236u": 20, "001ms110": 20, "973u": 20, "001ms228": 20, "773u": 20, "001ms339": 20, "183u": 20, "001ms434": 20, "305u": 20, "002ms921": 20, "063u": 20, "21s102ms853": 20, "173u": 20, "cachedsynctensor": 20, "395": [20, 25], "area": 20, "rout": 20, "qualifi": 20, "33": [20, 25, 26], "_local_scalar_dens": 20, "epoch": [20, 21, 28], "clear_al": 20, "xla_dynamo_debug": 20, "bottleneck": [20, 21, 24], "notebook": [20, 36], "train_resnet_benchmark": 20, "bad": 20, "degrad": [20, 21], "speedup": [20, 26], "indirect": 20, "variat": 20, "pad": [20, 21, 22, 31, 33], "ask": [20, 22, 31], "substitut": 20, "flow": 20, "clip_grad_norm": 20, "problemat": 20, "clip_grad_norm_": 20, "dramat": 20, "total_norm": 20, "zero": [20, 28, 34], "param_norm": 20, "grad": 20, "norm": [20, 36], "norm_typ": 20, "add_": 20, "clip_coef": 20, "max_norm": 20, "1e": [20, 26], "mul_": 20, "data_parallel": 20, "dataset": [20, 25, 28], "small": [20, 21, 22, 25, 26, 31], "stride": 20, "reconstruct": 20, "shallow": 20, "ty": 20, "made": [20, 21, 22, 31], "_get_xla_tensors_text": [20, 22, 31], "_get_xla_tensors_hlo": 20, "prior": [20, 34], "degre": 20, "xla_ir_debug": 20, "henc": [20, 26], "respons": [20, 21, 26, 34], "propag": 20, "xla_save_tensors_fil": 20, "realli": [20, 22, 31], "big": [20, 22, 31, 36], "sheet": 20, "xla_save_tensors_fmt": 20, "graphviz": 20, "xla_flag": 20, "xla_dump_to": 20, "dir_nam": 20, "unoptim": 20, "optimz": 20, "xla_metrics_fil": 20, "xla_save_hlo_fil": 20, "offend": 20, "xla_sync_wait": 20, "xla_use_eager_debug_mod": 20, "bypass": 20, "overal": [20, 21], "optimizaiton": 20, "tf_cpp_log_thread_id": 20, "tf_cpp_vmodul": 20, "vlog": 20, "tf_cpp_min_log_level": 20, "tf_vlog": 20, "xla_dump_hlo_graph": 20, "xla_util": 20, "save1": 20, "xla_graph_executor": 20, "pjrt_computation_cli": 20, "dir": 20, "pytorch_test_with_slow": 20, "test_torch": 20, "test_put_xla_uint8": 20, "torch_test_devic": 20, "pytorch_test_bas": 20, "brief": 21, "reader": 21, "modif": 21, "fetch": 21, "discuss": 21, "readabl": 21, "opcod": 21, "fed": 21, "attach": [21, 32], "callback": 21, "xla_tensor_z": 21, "cut": [21, 22, 31], "transferfromdevic": 21, "tell": [21, 22, 31], "properti": [21, 22, 31], "suppos": 21, "tensors_on_devic": 21, "z": [21, 22, 31, 36], "subgraph": [21, 22, 31], "signal": 21, "far": 21, "suitabl": 21, "fusion": 21, "worth": [21, 22, 31], "latter": [21, 28], "runtime_vers": 21, "project_id": 21, "accelerator_typ": 21, "tpu_nam": 21, "your_tpu_nam": 21, "subnetwork": 21, "tpusubnet": 21, "pip3": 21, "cp38": 21, "linux_x86_64": 21, "whl": 21, "apt": 21, "libopenbla": 21, "libgl1": 21, "hypercomput": 21, "recipi": 21, "guidelin": 21, "bar": 21, "rememb": 21, "txt2img": 21, "prompt": 21, "photograph": 21, "astronaut": 21, "ride": 21, "hors": 21, "precision_scop": 21, "addition": [21, 23, 28], "frozenclipembedd": 21, "simplic": [21, 22, 31], "ddim": 21, "top": 21, "attr": 21, "statement": [21, 22, 31], "stop": 21, "fall": [21, 29], "difficult": 21, "investig": [21, 25, 36], "cover": [21, 32], "huggingfac": 21, "sd": 21, "xl": 21, "cd": [21, 28], "text_to_imag": 21, "inference_tpu_single_devic": 21, "lora": 21, "model_id": 21, "stabilityai": 21, "9": [21, 22, 25, 28, 31, 36], "pipelin": 21, "dpmsolvermultistepschedul": 21, "txt": 21, "invisible_watermark": 21, "safetensor": 21, "agre": 21, "licens": 21, "card": 21, "cli": 21, "_your_copied_token__": 21, "pipe": 21, "hour": 21, "wherea": 21, "likewis": 21, "gpt": 21, "min": 21, "mayb": 21, "notic": [21, 36], "piec": 21, "__call__": 21, "caveat": 21, "thumb": 21, "constantli": 21, "idl": 21, "inference_tpu_": 21, "capture_profil": 21, "gap": 21, "xp": 21, "u": 21, "portion": 21, "busi": 21, "scroll": 21, "occupi": 21, "largest": 21, "zoom": 21, "timelin": 21, "examin": 21, "did": 21, "pipe_watermark": 21, "closer": 21, "preced": 21, "proceed": [21, 29], "watermark": 21, "cv2": 21, "pywt": 21, "leav": 21, "broken": 21, "rerun": 21, "scale_model_input": 21, "dynamo": [21, 26, 30], "ran": 21, "my_funct": 21, "preocess": 21, "debug_single_process": 21, "magic": [21, 22, 31], "treat": [21, 33], "xla_no_special_scalar": 21, "hurt": [22, 31], "hard": [22, 25, 26, 31], "pov": [22, 31], "sai": [22, 31], "assur": [22, 31], "gone": [22, 31], "coverag": [22, 31], "explan": [22, 31], "mainli": [22, 31], "beginn": [22, 31], "propos": [22, 31], "reli": [22, 31], "impract": [22, 31], "assumpt": [22, 31], "ye": [22, 30, 31], "sentenc": [22, 31], "bucket": [22, 31, 34], "kinda": [22, 31], "anti": [22, 31], "frontend": [22, 31], "matter": [22, 31], "workaround": [22, 31], "okai": [22, 31], "teach": [22, 31], "theoret": [22, 31], "sort": [22, 31], "obviou": [22, 31], "s64": [22, 31], "inde": [22, 31], "_get_xla_tensor_dimension_s": [22, 31], "commonli": [22, 31], "wrong": [22, 31], "wors": [22, 31], "know": [22, 24, 25, 31], "upper": [22, 31], "nit": [22, 31], "solv": [22, 31], "kept": [22, 31], "accessor": [22, 31], "2d": [22, 29, 31, 33], "implicitli": [22, 31], "doubl": [22, 31, 36], "overload": [22, 31], "IS": [22, 31], "explod": [22, 31], "convers": [22, 31], "cheap": [22, 31], "ve": [22, 31], "hoc": [22, 31], "think": [22, 31], "verison": [22, 31], "bla": [22, 31], "blabla": [22, 31], "uglier": [22, 31], "win": [22, 31], "pars": [22, 31], "torchscript": [22, 31], "somehow": [22, 31], "merg": [22, 31], "lazili": [22, 31, 32, 34], "properli": [22, 31], "thought": [22, 31], "trivial": [22, 31], "effort": [22, 31, 32], "why": [22, 31], "bandwidth": [22, 31], "automag": [22, 31], "gold": [22, 31], "smart": [22, 31], "trick": [22, 31], "tbh": [22, 31], "longer": [22, 31], "unawar": [22, 31], "hope": [22, 31], "smash": [22, 31], "blocker": [22, 31], "ahead": [22, 31], "nnc": [22, 31], "exactli": [22, 24, 31], "brian": [22, 31], "hirsh": [22, 31], "bdhirsh": [22, 31], "question": [22, 31], "Is": [22, 31], "stick": [22, 31], "torch_warn": [22, 31], "yea": [22, 31], "hei": [22, 31], "won": [22, 23, 31], "blaze": [22, 31], "abil": [22, 25, 31], "devirtu": [22, 31], "sound": [22, 31], "great": [22, 31], "truth": [22, 31], "irvalu": [22, 31], "enforc": [22, 31], "discrep": [22, 31], "followup": [22, 31], "1000": [22, 31], "my": [22, 31, 34], "presenc": [22, 31], "get_dimention_s": [22, 31], "didn": [22, 31], "exponenti": [22, 31], "blowup": [22, 31], "fewer": [22, 31], "opportun": [22, 31], "recogn": [22, 26, 31], "feasibl": [22, 31], "annoi": [22, 31], "wasn": [22, 31], "materiz": [22, 31], "combo": [22, 31], "extend": [23, 36], "datatyp": 23, "float16": 23, "bfloat16": [23, 30], "syncfre": 23, "autocast": 23, "es": 23, "elig": 23, "suppli": 23, "addmm": 23, "addmm_": 23, "prefer": 23, "float64": 23, "respect": [23, 33], "unlist": 23, "__matmul__": 23, "addbmm": 23, "addmv": 23, "addr": 23, "baddbmm": 23, "bmm": 23, "conv1d": 23, "conv2d": [23, 28], "conv3d": 23, "conv_transpose1d": 23, "conv_transpose2d": 23, "conv_transpose3d": 23, "relu": [23, 25], "prelu": 23, "max_pool2d": 23, "batch_norm": 23, "log_softmax": 23, "binary_cross_entropy_with_logit": 23, "prod": 23, "cdist": 23, "chloeski": 23, "invers": 23, "reflection_pad": 23, "replication_pad": 23, "mse_loss": 23, "cosine_embbeding_loss": 23, "nll_loss": 23, "multilabel_margin_loss": 23, "qr": 23, "svd": 23, "triangular_solv": 23, "linalg_svd": 23, "linalg_inv_ex": 23, "widest": 23, "index_copi": 23, "scaler": [23, 30], "gradscal": 23, "_fetch_gradi": 23, "xla_use_f16": 23, "underflow": 23, "imagenet": 23, "elimin": 24, "primer": 24, "exce": 24, "math": 24, "pseudo": 24, "unnecessari": [24, 32], "Such": 24, "repeatedli": 24, "do_some_math": 24, "simul": 24, "ten": [24, 27], "func": 24, "functional_cal": 24, "mymodul": [24, 32], "pure_forward": 24, "param": 24, "cached_forward": 24, "named_paramet": 24, "named_buff": 24, "unit": [24, 25, 36], "testbridge_test_onli": 24, "test_trace_transformer_with_spda_attent": 24, "test_assume_pur": 24, "benchmark_iter": 24, "140": 24, "1342": 24, "24": 24, "1658": 24, "pai": 24, "front": 24, "recurs": [24, 28, 29], "minimum": [25, 28, 29, 36], "nccl": 25, "new_rank": 25, "ddp_model": 25, "launcher": 25, "demo_fn": 25, "five": 25, "sy": 25, "tempfil": 25, "cleanup": 25, "destroy_process_group": 25, "toymodel": 25, "net1": 25, "1000000": 25, "net2": 25, "demo_bas": 25, "label": 25, "run_demo": 25, "tot": 25, "statist": 25, "median": 25, "90th": 25, "deviat": 25, "cv": 25, "418": 25, "54": 25, "419": 25, "430": 25, "40": 25, "76": 25, "02": [25, 36], "97": 25, "407": 25, "60": 25, "39": 25, "seem": 25, "17864": 25, "20108": 25, "96": 25, "24351": 25, "74": 25, "5866": 25, "83": [25, 36], "10701": 25, "11770": 25, "00": 25, "14313": 25, "78": 25, "3102": 25, "92": 25, "41": [25, 26], "round": [25, 36], "heavili": 25, "sens": 25, "amort": 25, "logdir": 25, "o": 25, "converg": 25, "caution": 25, "known": 25, "crash": 25, "unmodifi": 26, "hook": 26, "biggest": [26, 28], "torchfx": 26, "technolog": 26, "a_xla": 26, "b_xla": 26, "compiled_cod": 26, "eval_model": 26, "xla_resnet18": 26, "eval": 26, "dynamo_resnet18": 26, "no_grad": 26, "resnet": [26, 35], "18": 26, "analysi": 26, "bench": 26, "59": 26, "resnext50_32x4d": 26, "91": 26, "alexnet": 26, "28": 26, "mobilenet_v2": 26, "62": 26, "mnasnet1_0": 26, "68": 26, "vgg16": 26, "bert_pytorch": 26, "squeezenet1_1": 26, "timm_vision_transform": 26, "52": 26, "geomean": 26, "04": 26, "train_model": 26, "crossentropyloss": 26, "pred": 26, "train_model_main": 26, "dynamo_train_model": 26, "xla_optim": 26, "weight_decai": 26, "extract": 26, "07": 26, "43": 26, "81": 26, "87": 26, "fwd": 26, "bwd": 26, "e2": 26, "hide": 26, "larger": [26, 28], "wit": 26, "promis": 26, "expand": 26, "excit": 26, "upcom": [26, 32], "invest": 26, "_higher_order_op": 27, "fori_loop": 27, "cond_fn": 27, "body_fn": 27, "bodi": 27, "iteri": 27, "init_v": 27, "functionaltensor": 27, "lvl": 27, "51": 27, "xlafullyshardeddataparallel": 28, "my_modul": [28, 29], "adam": [28, 29], "0001": [28, 29], "leftov": [28, 29], "arxiv": 28, "1910": 28, "02054": 28, "reshard_after_forward": 28, "test_train_mp_mnist_fsdp_with_ckpt": 28, "test_train_mp_imagenet_fsdp": 28, "interleav": 28, "submodul": 28, "fsdpvitmodel": 28, "checkpoint_modul": [28, 29], "3524": 28, "auto_wrap_polici": [28, 29], "size_based_auto_wrap_polici": 28, "polici": [28, 32], "100m": 28, "transformer_auto_wrap_polici": [28, 29], "transformer_layer_cl": [28, 29], "auto_wrapper_cal": 28, "remateri": 28, "get_shard_metadata": 28, "consolidate_sharded_model_checkpoint": 28, "stitch": 28, "ckpt": 28, "shard_metadata": 28, "ckpt_path": 28, "pth": 28, "consolidate_sharded_ckpt": 28, "ckpt_prefix": 28, "your_sharded_checkpoint_fil": 28, "ckpt_suffix": 28, "_rank": 28, "inspir": 28, "fairscal": 28, "fullyshardeddataparallel": 28, "readthedoc": 28, "resort": 28, "train_resnet_fsdp_auto_wrap": 28, "newer": [28, 36], "98": 28, "drop_last": 28, "use_nested_fsdp": 28, "use_gradient_checkpoint": 28, "final_ckpt": 28, "75": 28, "download": 28, "1k": 28, "datadir": 28, "test_set_batch_s": 28, "eval_interv": 28, "num_warmup_epoch": 28, "lr_scheduler_divide_every_n_epoch": 28, "lr_scheduler_divisor": 28, "residu": 28, "algorithm": [28, 29, 36], "ronghanghu": 28, "vit_10b_fsdp_exampl": 28, "vit": 28, "review": 29, "spmd_fully_sharded_data_parallel": 29, "spmdfullyshardeddataparallel": 29, "fsdpv2": 29, "autowrap": 29, "decoderlay": 29, "functool": 29, "decoder_only_model": 29, "shard_output": 29, "0th": 29, "children": 29, "blockwis": 30, "int4": 30, "analog": 30, "classifi": 30, "choos": [30, 34], "docstr": 30, "xla_quantized_matmul": 30, "n_input_featur": 30, "n_output_featur": 30, "w_int": 30, "127": 30, "int8": 30, "matmul_output": 30, "quantized_matmul": 30, "x_xla": 30, "w_int_xla": 30, "scaler_xla": 30, "matmul_output_xla": 30, "w": 30, "f_dynamo": 30, "dynamo_out_xla": 30, "myqlinearforxlabackend": 30, "load_weight": 30, "processed_w": 30, "processed_scal": 30, "stuff": 30, "orig_model": 30, "mymodel": 30, "q_weight": 30, "q_weights_for_xla": 30, "process_for_xla": 30, "q_linear": 30, "xlaquantizedlinear": 30, "in_featur": 30, "out_featur": 30, "load_quantized_weight": 30, "sym": 30, "asym": 30, "w8a16": 30, "w8a8": 30, "w4a8": 30, "input_shard": 32, "4d": 32, "shardingspec": 32, "input_mesh": 32, "s2": 32, "s3": 32, "s4": 32, "_after": 32, "_the": 32, "forth": 32, "techniqu": 32, "decis": 32, "nice": 32, "arrang": [32, 33], "center": 32, "multislic": 32, "denot": 32, "hardcod": 32, "rfc": [32, 35], "delai": 32, "subclass": 32, "__torch_dispatch__": 32, "global_tensor": 32, "strictli": 32, "local_shard": 32, "xlashard": 32, "ongo": 32, "distributedtensor": 32, "proof": 32, "concept": [32, 33], "distribute_tensor": 32, "init_device_mesh": 32, "big_tensor": 32, "100000": 32, "88": 32, "my_dtensor": 32, "stai": 32, "dynamo_mark_shard": 32, "placement": 32, "visualize_tensor_shard": 32, "visualize_shard": 32, "rich": 32, "2x2": 32, "generated_t": 32, "use_color": 32, "style": [32, 33], "tile": 32, "partial_repl": 32, "envvar": 32, "xla_auto_spmd": 32, "distribute_modul": 32, "auto_polici": 32, "device_mesh": 32, "sharded_model": 32, "behvaior": 32, "xla_auto_use_group_shard": 32, "reshard": 32, "xla_auto_spmd_mesh": 32, "unset": 32, "matric": [33, 36], "book": 33, "hint": 33, "strategi": 33, "dimension": 33, "mpi": 33, "necessarili": 33, "3d": 33, "1d": 33, "interconnect": 33, "core_on_chip": 33, "num_cor": 33, "coord": 33, "attribut": 33, "slice_index": 33, "coordin": 33, "divis": 33, "advanc": 33, "dedic": 34, "planner": 34, "spmdsaveplann": 34, "spmdloadplann": 34, "dist_cp": 34, "distributed_checkpoint": 34, "xc": 34, "storage_writ": 34, "filesystemwrit": 34, "checkpoint_dir": 34, "storage_read": 34, "filesystemread": 34, "all_step": 34, "save_async": 34, "preemption": 34, "detect": 34, "provis": 34, "queuedresourc": 34, "autocheckpoint": 34, "chkpt_on_preempt": 34, "fsspec": 34, "filesystem": 34, "prime_optim": 34, "chkpt_mgr": 34, "gs": 34, "tracked_step": 34, "best_step": 34, "prime": 34, "enumer": [34, 36], "unprim": 34, "destruct": 34, "nvidia": [35, 36], "num_gpu_machin": 35, "rank_of_current_machin": 35, "machine_0_ip_address": 35, "training_or_inference_script_using_spmd": 35, "xla_use_spmd": 35, "test_train_spmd_imagenet": 35, "yaoshiang": 36, "ho": 36, "2025": 36, "05": 36, "silicon": 36, "research": 36, "inexpens": 36, "tradeoff": 36, "v100": 36, "tensorcor": 36, "numer": 36, "tf32": 36, "mantissa": 36, "intuit": 36, "imagin": 36, "digit": 36, "decim": 36, "111": 36, "222": 36, "84": 36, "021642": 36, "twice": 36, "72": 36, "011": 36, "022": 36, "compris": 36, "fourth": 36, "ignor": 36, "000242": 36, "littl": 36, "rel": 36, "2002": 36, "1012": 36, "0214": 36, "tripl": 36, "idea": 36, "medium": 36, "nine": 36, "hh": 36, "hm": 36, "mh": 36, "hl": 36, "lh": 36, "lm": 36, "room": 36, "varianc": 36, "minor": 36, "valid": 36, "set_printopt": 36, "sci_mod": 36, "linewidth": 36, "240": 36, "epsilon": 36, "ep": 36, "finfo": 36, "0078125": 36, "00000000000000000000": 36, "00781250000000000000": 36, "vice": 36, "versa": 36, "encourag": 36, "rather": 36, "struct": 36, "binary_fraction_to_fp32": 36, "bstr": 36, "0b1": 36, "invalid": 36, "fraction_bit": 36, "fp32_to_binary_fract": 36, "fp32_float": 36, "x_byte": 36, "endian": 36, "ieee": 36, "754": 36, "as_int": 36, "unpack": 36, "uint32": 36, "sign": 36, "31": 36, "expon": 36, "0xff": 36, "0x7fffff": 36, "0b": 36, "08b": 36, "023b": 36, "get_rand_matrix": 36, "diagon": 36, "1024": 36, "999": 36, "ey": 36, "rand_": 36, "bf16_ep": 36, "one_plus_half_ep": 36, "00390625": 36, "8th": 36, "lost": 36, "reconfirm": 36, "ones_bf16": 36, "01111111": 36, "00000001000000000000000": 36, "00000000000000000000000": 36, "wise": 36, "z_ref": 36, "00000010000000010000000": 36, "0078277587890625": 36, "saw": 36, "01110000101000111101100": 36, "440000057220459": 36, "01110000101000111101101": 36, "4400001764297485": 36}, "objects": {"": [[15, 0, 0, "-", "torch_xla"]], "torch_xla": [[15, 0, 0, "-", "backends"], [15, 1, 1, "", "compile"], [15, 1, 1, "", "device"], [15, 1, 1, "", "device_count"], [15, 1, 1, "", "devices"], [15, 0, 0, "-", "experimental"], [15, 1, 1, "", "manual_seed"], [15, 0, 0, "-", "runtime"], [15, 1, 1, "", "sync"]], "torch_xla.backends": [[15, 1, 1, "", "get_mat_mul_precision"], [15, 1, 1, "", "set_mat_mul_precision"]], "torch_xla.core": [[15, 0, 0, "-", "xla_model"]], "torch_xla.core.xla_model": [[15, 1, 1, "", "add_step_closure"], [15, 1, 1, "", "all_gather"], [15, 1, 1, "", "all_reduce"], [15, 1, 1, "", "all_to_all"], [15, 1, 1, "", "get_memory_info"], [15, 1, 1, "", "get_rng_state"], [15, 1, 1, "", "get_stablehlo"], [15, 1, 1, "", "get_stablehlo_bytecode"], [15, 1, 1, "", "is_master_ordinal"], [15, 1, 1, "", "mesh_reduce"], [15, 1, 1, "", "optimizer_step"], [15, 1, 1, "", "rendezvous"], [15, 1, 1, "", "save"], [15, 1, 1, "", "set_rng_state"], [15, 1, 1, "", "wait_device_ops"], [15, 1, 1, "", "xla_device"], [15, 1, 1, "", "xla_device_hw"]], "torch_xla.debug": [[15, 0, 0, "-", "metrics"]], "torch_xla.debug.metrics": [[15, 1, 1, "", "counter_names"], [15, 1, 1, "", "counter_value"], [15, 1, 1, "", "metric_data"], [15, 1, 1, "", "metric_names"], [15, 1, 1, "", "metrics_report"], [15, 1, 1, "", "short_metrics_report"]], "torch_xla.distributed": [[15, 0, 0, "-", "parallel_loader"], [15, 0, 0, "-", "spmd"], [15, 0, 0, "-", "xla_multiprocessing"]], "torch_xla.distributed.parallel_loader": [[15, 2, 1, "", "MpDeviceLoader"]], "torch_xla.distributed.spmd": [[15, 2, 1, "", "HybridMesh"], [15, 2, 1, "", "Mesh"], [15, 1, 1, "", "clear_sharding"], [15, 1, 1, "", "get_1d_mesh"], [15, 1, 1, "", "get_global_mesh"], [15, 1, 1, "", "mark_sharding"], [15, 1, 1, "", "set_global_mesh"]], "torch_xla.distributed.xla_multiprocessing": [[15, 1, 1, "", "spawn"]], "torch_xla.experimental": [[15, 1, 1, "", "eager_mode"]], "torch_xla.runtime": [[15, 1, 1, "", "addressable_device_count"], [15, 1, 1, "", "device_type"], [15, 1, 1, "", "get_master_ip"], [15, 1, 1, "", "global_device_count"], [15, 1, 1, "", "global_ordinal"], [15, 1, 1, "", "global_runtime_device_count"], [15, 1, 1, "", "initialize_cache"], [15, 1, 1, "", "is_spmd"], [15, 1, 1, "", "local_device_count"], [15, 1, 1, "", "local_ordinal"], [15, 1, 1, "", "local_process_count"], [15, 1, 1, "", "use_spmd"], [15, 1, 1, "", "world_size"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"]}, "titleterms": {"learn": [0, 1, 13], "about": [0, 1], "gpu": [0, 12, 13, 14, 23, 35], "tpu": [1, 4, 13, 14, 18, 21, 23, 28, 32, 36], "build": [2, 5], "bazel": 2, "depend": [2, 8, 12], "how": [2, 17, 24, 25, 30, 33], "xla": [2, 3, 4, 7, 8, 13, 15, 17, 18, 19, 20, 21, 23, 28, 30, 33, 36], "librari": 2, "torch": [2, 10, 11, 14, 17, 32], "plugin": [2, 7], "remot": 2, "cach": [2, 9, 18], "run": [2, 3, 18, 20, 21, 32, 35], "test": [2, 3, 6, 20, 27], "code": [2, 4, 21, 30], "coverag": 2, "languag": 2, "server": 2, "pytorch": [2, 3, 4, 5, 7, 8, 10, 13, 15, 17, 18, 19, 20, 21, 28, 33, 36], "codegen": 3, "migrat": 3, "guid": [3, 6, 33], "befor": [3, 6], "you": [3, 5, 6, 9, 22, 31], "start": [3, 6, 13, 22, 31], "file": [3, 5, 6], "structur": [3, 6], "old": 3, "op": [3, 6, 11, 30], "lower": [3, 6, 11, 36], "step": [3, 4], "1": [3, 21, 22, 31], "identifi": 3, "2": [3, 21, 22, 31], "inspect": 3, "gener": [3, 10], "lazyir": 3, "h": 3, "3": [3, 22, 31], "implement": [3, 7, 21], "miss": 3, "ir": 3, "function": [3, 24], "torch_xla": [3, 15, 17, 19, 22], "csrc": 3, "ops_xla_shape_fn": 3, "cpp": 3, "4": 3, "ops_lower_fn": 3, "5": 3, "cleanup": 3, "verifi": [3, 5], "result": 3, "sampl": 3, "pr": 3, "configur": [4, 5], "A": [4, 5, 20], "develop": 4, "environ": [4, 20], "visual": 4, "studio": 4, "creat": [4, 18], "connect": 4, "your": [4, 5, 8], "set": 4, "up": [4, 24], "workspac": 4, "next": 4, "c": [5, 7], "debug": [5, 15, 18, 20, 32], "why": 5, "would": 5, "need": 5, "thi": [5, 9], "instal": [5, 28], "gdb": 5, "The": [5, 20], "gnu": 5, "project": 5, "debugg": 5, "symbol": 5, "built": [5, 8], "vscode": 5, "lldb": 5, "realist": 5, "command": 5, "futur": 5, "work": [5, 17], "understand": [6, 20], "oper": [6, 10, 20, 22, 23, 30, 31], "unit": [6, 20], "tip": 6, "custom": [7, 8, 12], "hardwar": [7, 36], "pjrt": [7, 14], "api": [7, 11, 13, 15, 17], "packag": 7, "kernel": [8, 12], "via": [8, 12], "palla": 8, "adopt": 8, "abov": 8, "compat": [8, 9], "us": [8, 9, 10, 22, 24, 25, 29, 30, 31, 33], "flashattent": 8, "exampl": [8, 9, 21, 23, 27, 28], "usag": [8, 27], "integr": [8, 26, 32], "pagedattent": 8, "write": 8, "own": 8, "optim": [9, 27, 32, 34], "repeat": 9, "layer": 9, "scan": 9, "scan_lay": 9, "when": [9, 22, 31], "should": 9, "limit": [9, 24], "aotautograd": 9, "requir": 9, "compil": [9, 17, 18, 20, 32], "time": [9, 18, 19], "experi": 9, "refer": [9, 13, 21], "export": 10, "stablehlo": 10, "extract_jax": 10, "inlin": 10, "some": [10, 22, 31], "weight": 10, "preserv": 10, "high": 10, "level": 10, "composit": 10, "support": [11, 23, 30], "distribut": [11, 13, 14, 15, 25, 34], "collect": 11, "stack": 11, "non": 11, "dynamo": [11, 20], "case": [11, 19, 22, 27, 31, 36], "descript": 11, "triton": 12, "document": 13, "get": [13, 20, 36], "tutori": 13, "basic": [13, 20], "train": [13, 14, 26, 28], "advanc": [13, 32], "techniqu": 13, "troubleshoot": [13, 20, 31], "contribut": 13, "runtim": [14, 15], "tl": 14, "dr": 14, "benefit": 14, "quickstart": 14, "cpu": [14, 18], "pod": [14, 18, 21, 28, 32], "docker": 14, "singl": [14, 18, 21], "node": 14, "multi": [14, 18], "differ": 14, "from": [14, 18, 22, 31], "xrt": 14, "multithread": 14, "v2": 14, "v3": [14, 28], "chang": 14, "xm": 14, "rendezv": 14, "perform": [14, 17, 19, 20, 21], "new": 14, "backend": 15, "xla_model": 15, "spmd": [15, 29, 32, 33, 35], "experiment": 15, "dynam": [16, 22, 31], "shape": [16, 22, 31], "bound": [16, 22, 31], "s": [17, 22, 31], "interact": 17, "eager": 17, "mode": [17, 33], "overview": [17, 21], "challeng": 17, "lazytensor": 17, "vs": [17, 19], "benchmark": [17, 20, 24, 25], "devic": [18, 21, 32, 33], "an": 18, "tensor": [18, 20, 22, 31], "ar": 18, "model": [18, 30], "multipl": [18, 21], "process": [18, 28, 34], "deep": 18, "dive": 18, "lazi": 18, "memori": [18, 27], "layout": 18, "move": 18, "save": 18, "load": [18, 32], "unexpect": 18, "materi": 18, "dure": 18, "aot": 18, "ahead": 18, "trace": [18, 19, 24], "flag": 18, "recommend": 18, "further": [18, 33], "read": [18, 33], "execut": [19, 20], "illustr": 19, "common": [19, 20], "pitfal": 19, "measur": 19, "onli": 19, "end": 19, "trigger": 19, "ensur": 19, "complet": 19, "studi": 19, "correctli": 19, "profil": [19, 20, 21], "loop": [19, 27], "sync": 19, "saniti": 20, "check": 20, "version": 20, "simpl": [20, 27], "calcul": 20, "resnet": [20, 28], "With": 20, "fake": [20, 25], "data": [20, 25, 28, 29, 32], "tool": [20, 32], "auto": [20, 32], "metric": 20, "analysi": [20, 21], "report": 20, "clear": 20, "known": 20, "caveat": 20, "quirk": 20, "more": 20, "variabl": 20, "combin": 20, "reproduc": 20, "ci": 20, "cd": 20, "failur": 20, "setup": 21, "convert": 21, "stabl": 21, "diffus": 21, "infer": [21, 26], "lightn": 21, "hf": 21, "sourc": 22, "recompil": [22, 31], "let": [22, 31], "first": [22, 31], "fact": [22, 31], "constraint": [22, 31], "input": [22, 31], "dataset": [22, 31], "output": [22, 29, 31], "can": [22, 31], "fix": [22, 31], "without": [22, 31], "queri": [22, 31], "its": [22, 31], "real": [22, 25, 31], "dimens": [22, 31], "what": [22, 31, 33], "control": [22, 27, 31, 36], "flow": [22, 31], "conclus": [22, 31, 36], "appendix": [22, 31], "automat": 23, "mix": 23, "precis": [23, 36], "amp": 23, "best": 23, "practic": 23, "speed": 24, "assume_pur": 24, "background": [24, 25], "motiv": [24, 25], "nn": 24, "modul": [24, 30], "parallel": [25, 28, 29], "ddp": 25, "distributeddataparallel": 25, "resnet50": 25, "mnist": [25, 28], "disclaim": 25, "torchdynamo": 26, "featur": 26, "gap": 26, "take": 26, "awai": 26, "util": 27, "while_loop": 27, "group": [27, 34], "pure": 27, "python": 27, "while": 27, "fulli": [28, 29], "shard": [28, 29, 32, 33], "fsdp": [28, 29], "One": 28, "per": 28, "acceler": 28, "script": 28, "imagenet": 28, "clone": 28, "repo": 28, "8": 28, "50": 28, "10": 28, "billion": 28, "paramet": 28, "gradient": 29, "checkpoint": [29, 34], "quantiz": 30, "call": 30, "swap": 30, "matrix": 30, "multipli": 30, "topic": 32, "awar": 32, "host": 32, "virtual": 32, "hybrid": 32, "mesh": [32, 33], "xlashardedtensor": 32, "dtensor": 32, "activ": 32, "user": 33, "partit": 33, "spec": 33, "which": 33, "hold": 33, "checkpointmanag": 34, "restor": 34, "state": 34, "mxu": 36, "float": 36, "point": 36, "introduct": 36, "higher": 36, "math": 36, "prepar": 36, "readi": 36, "look": 36, "directli": 36, "bit": 36, "examin": 36, "number": 36, "fp32": 36, "bfloat16": 36, "edg": 36}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})