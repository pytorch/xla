Search.setIndex({"docnames": ["accelerators/gpu", "accelerators/tpu", "contribute/bazel", "contribute/codegen_migration", "contribute/configure-environment", "contribute/cpp_debugger", "contribute/op_lowering", "contribute/plugins", "features/pallas", "features/scan", "features/stablehlo", "features/torch_distributed", "index", "learn/_pjrt", "learn/api-guide", "learn/dynamic_shape", "learn/eager", "learn/pytorch-on-xla-devices", "learn/trace-vs-execution-time", "learn/troubleshoot", "learn/xla-advanced", "learn/xla-examples", "learn/xla-overview", "learn/xla-profiling", "notes/source_of_recompilation", "perf/amp", "perf/assume_pure", "perf/ddp", "perf/dynamo", "perf/fori_loop", "perf/fsdp_collectives", "perf/fsdp_spmd", "perf/quantized_ops", "perf/recompilation", "perf/spmd_advanced", "perf/spmd_basic", "perf/spmd_distributed_checkpoint", "perf/spmd_gpu", "tutorials/precision_tutorial"], "filenames": ["accelerators/gpu.md", "accelerators/tpu.md", "contribute/bazel.md", "contribute/codegen_migration.md", "contribute/configure-environment.md", "contribute/cpp_debugger.md", "contribute/op_lowering.md", "contribute/plugins.md", "features/pallas.md", "features/scan.md", "features/stablehlo.md", "features/torch_distributed.md", "index.rst", "learn/_pjrt.md", "learn/api-guide.rst", "learn/dynamic_shape.md", "learn/eager.md", "learn/pytorch-on-xla-devices.md", "learn/trace-vs-execution-time.md", "learn/troubleshoot.md", "learn/xla-advanced.md", "learn/xla-examples.md", "learn/xla-overview.md", "learn/xla-profiling.md", "notes/source_of_recompilation.md", "perf/amp.md", "perf/assume_pure.md", "perf/ddp.md", "perf/dynamo.md", "perf/fori_loop.md", "perf/fsdp_collectives.md", "perf/fsdp_spmd.md", "perf/quantized_ops.md", "perf/recompilation.md", "perf/spmd_advanced.md", "perf/spmd_basic.md", "perf/spmd_distributed_checkpoint.md", "perf/spmd_gpu.md", "tutorials/precision_tutorial.ipynb"], "titles": ["Learn about GPUs", "Learn about TPUs", "Building with Bazel", "Codegen Migration Guide", "Configure A Development Environment", "C++ Debugging", "Op Lowering Guide", "Custom Hardware Plugins", "Custom Kernels via Pallas", "Optimizing Repeated Layers with <code class=\"docutils literal notranslate\"><span class=\"pre\">scan</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">scan_layers</span></code>", "Torch Export to StableHLO", "Support for Torch Distributed", "PyTorch/XLA documentation", "PJRT Runtime", "PyTorch/XLA API", "Dynamic Shapes", "PyTorch/XLA Compile API and it\u2019s interaction with Eager mode.", "PyTorch on XLA Devices", "Tracing Time vs. Execution Time in PyTorch/XLA", "Troubleshooting Basics", "Advanced Topics in PyTorch XLA", "Converting code to PyTorch XLA", "Pytorch/XLA Overview", "Profiling and performance analysis", "Source of recompilations in torch_xla", "Automatic Mixed Precision", "Speed Up Tracing with <code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;assume_pure</span></code>", "Distributed Data Parallel (DDP)", "TorchDynamo Integration", "Optimize Memory Utilization with <code class=\"docutils literal notranslate\"><span class=\"pre\">while_loop</span></code>", "Fully Sharded Data Parallel (FSDP) with One Process Per Accelerator", "Fully Sharded Data Parallel (FSDP) using SPMD", "Quantized Operations", "Troubleshooting recompilations", "SPMD advanced topics", "SPMD User Guide", "Distributed Checkpointing", "Running SPMD on GPU", "Control MXU Floating Point Precision"], "terms": {"For": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 32, 33, 34, 35, 37], "inform": [0, 1, 3, 4, 5, 13, 14, 16, 17, 19, 23, 24, 33, 37, 38], "googl": [0, 1, 8, 13, 17, 22, 38], "cloud": [0, 1, 2, 4, 7, 13, 17, 22, 28, 36], "see": [0, 1, 2, 3, 4, 5, 6, 7, 9, 10, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 26, 28, 30, 33, 38], "machin": [0, 2, 4, 13, 19, 20, 22, 23, 37], "type": [0, 4, 5, 7, 10, 13, 14, 17, 18, 19, 22, 25, 27, 38], "ar": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 32, 33, 34, 35, 36, 38], "custom": [1, 3, 4, 5, 9, 10, 11, 12, 14, 16, 22, 24, 27, 30, 32, 33, 34, 35], "design": [1, 9, 13, 16, 17, 22, 28], "ai": [1, 21, 22], "acceler": [1, 4, 12, 13, 14, 15, 16, 17, 21, 22, 25, 38], "which": [1, 2, 3, 5, 6, 7, 10, 11, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 31, 33, 34, 36, 38], "optim": [1, 5, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 30, 31, 33, 38], "train": [1, 8, 9, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 25, 26, 34, 36, 37, 38], "infer": [1, 3, 12, 14, 16, 17, 22, 23, 25, 34, 37], "larg": [1, 9, 13, 15, 20, 21, 22, 23, 24, 30, 33, 35], "model": [1, 3, 6, 9, 10, 12, 13, 14, 15, 16, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 33, 34, 35, 36, 37, 38], "thei": [1, 2, 6, 7, 10, 11, 13, 14, 17, 18, 19, 20, 24, 25, 33, 34, 35], "ideal": [1, 2, 3, 24, 28, 33], "varieti": 1, "us": [1, 2, 3, 4, 5, 6, 7, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 23, 25, 28, 30, 34, 36, 37, 38], "case": [1, 2, 3, 6, 9, 10, 13, 14, 17, 19, 20, 21, 22, 23, 26, 28, 31, 34], "chatbot": [1, 22], "code": [1, 3, 5, 6, 9, 10, 12, 13, 14, 16, 17, 18, 19, 20, 22, 23, 24, 26, 27, 28, 33, 34], "gener": [1, 5, 6, 13, 14, 16, 17, 19, 20, 21, 22, 24, 33, 38], "media": [1, 22], "content": [1, 14, 22], "synthet": 1, "speech": 1, "vision": [1, 22, 30], "servic": [1, 2, 13, 22], "recommend": [1, 2, 3, 4, 5, 6, 13, 14, 16, 22, 34, 38], "engin": [1, 19, 22], "person": 1, "among": 1, "other": [1, 2, 3, 5, 6, 8, 9, 13, 14, 15, 17, 19, 21, 22, 24, 25, 26, 27, 30, 31, 32, 33, 35], "scale": [1, 10, 12, 13, 14, 22, 25, 26, 28, 35], "cost": [1, 12, 16, 22, 26, 28, 38], "effici": [1, 9, 10, 12, 16, 19, 22, 28, 35], "wide": [1, 6, 22, 24, 33], "rang": [1, 6, 9, 13, 14, 18, 22, 26, 31, 34, 35, 38], "workload": [1, 13, 16, 17, 19, 22, 34, 35], "span": [1, 3, 16], "fine": 1, "tune": [1, 34, 35], "provid": [1, 2, 3, 6, 7, 8, 9, 14, 16, 17, 18, 19, 21, 22, 24, 25, 28, 29, 30, 32, 33, 34, 35, 36, 38], "versatil": [1, 22], "lead": [1, 9, 16, 17, 18, 19, 21, 22, 23, 26], "framework": [1, 22, 24, 32, 33], "includ": [1, 2, 6, 13, 14, 18, 19, 22, 24, 25, 29, 33, 35, 36, 38], "pytorch": [1, 6, 9, 11, 13, 15, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34, 36, 37], "jax": [1, 7, 8, 9, 10, 13, 22], "tensorflow": [1, 2, 7, 13, 14, 19, 22, 24, 33], "seamlessli": [1, 22], "orchestr": 1, "through": [1, 3, 6, 7, 8, 9, 11, 17, 20, 22, 24, 25, 33, 36, 38], "integr": [1, 12, 16, 32, 35], "kubernet": 1, "gke": 1, "leverag": [1, 22, 37], "dynam": [1, 3, 6, 12, 17, 19, 20, 28], "schedul": [1, 21, 23], "improv": [1, 13, 17, 19, 20, 21, 22, 23, 25, 28, 34, 35], "scalabl": [1, 22], "all": [1, 2, 3, 5, 6, 9, 10, 11, 13, 14, 17, 18, 19, 20, 21, 22, 24, 26, 27, 30, 33, 34, 36], "need": [1, 2, 3, 6, 10, 13, 14, 17, 18, 19, 20, 21, 22, 24, 27, 30, 31, 33, 34, 35, 38], "simultan": [1, 35], "look": [1, 3, 5, 6, 9, 16, 17, 19, 21, 23, 34], "simplest": [1, 35, 38], "wai": [1, 2, 6, 8, 10, 11, 13, 14, 17, 18, 23, 24, 27, 28, 32, 33, 34, 35], "develop": [1, 2, 5, 12, 16, 17, 22, 27, 28, 32, 35], "can": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 25, 26, 27, 28, 30, 31, 32, 34, 35, 36, 37, 38], "also": [1, 2, 3, 5, 6, 7, 10, 11, 13, 14, 17, 19, 20, 21, 22, 23, 24, 26, 28, 30, 31, 32, 33, 34, 35, 38], "vertex": 1, "fulli": [1, 12, 13, 16, 19, 35], "manag": [1, 8, 14, 25, 36], "platform": [1, 14], "more": [1, 2, 3, 4, 5, 6, 8, 10, 13, 14, 16, 17, 21, 22, 24, 26, 33, 34, 35, 37, 38], "introduct": [1, 8], "set": [1, 2, 5, 9, 11, 13, 14, 19, 20, 21, 24, 28, 30, 33, 34, 35, 36, 38], "up": [1, 2, 3, 5, 12, 13, 17, 18, 21, 22, 23, 24, 28, 31, 33, 38], "environ": [1, 2, 5, 12, 13, 15, 17, 20, 27, 34, 35, 36], "resourc": [1, 14, 19], "free": [2, 6, 10, 19, 25, 27, 30], "softwar": [2, 19], "tool": [2, 6, 23, 30, 35, 38], "autom": 2, "openxla": [2, 7, 10, 16, 22, 28, 32], "both": [2, 4, 5, 6, 11, 13, 16, 21, 24, 25, 28, 30, 31, 32, 33, 35, 36], "make": [2, 4, 5, 10, 13, 17, 18, 19, 20, 21, 22, 23, 24, 27, 28, 33, 34, 38], "good": [2, 3, 6, 23, 24, 33, 34], "fit": [2, 3, 23, 30], "well": [2, 3, 7, 13, 14, 21, 23, 24, 33, 34, 35], "extern": [2, 4, 8], "seen": [2, 18, 20, 28], "workspac": [2, 19], "file": [2, 4, 9, 13, 14, 19, 21, 23, 25, 26, 27], "http_archiv": 2, "name": [2, 4, 5, 6, 13, 14, 19, 24, 31, 33, 34, 35], "patch_arg": 2, "l": [2, 38], "p1": 2, "patch_tool": 2, "patch": [2, 19], "openxla_patch": 2, "gpu_nvml": 2, "diff": [2, 13, 21], "gpu_race_condit": 2, "count_down": 2, "strip_prefix": 2, "xla_hash": 2, "url": 2, "http": [2, 3, 4, 8, 9, 10, 13, 14, 19, 21, 22, 30], "github": [2, 3, 4, 5, 6, 9, 13, 14, 19, 21, 27, 30], "com": [2, 3, 4, 8, 9, 13, 14, 19, 21, 22, 30], "archiv": 2, "tar": 2, "gz": 2, "you": [2, 4, 7, 8, 10, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 26, 27, 28, 30, 31, 34, 35, 37, 38], "specifi": [2, 5, 10, 11, 14, 16, 17, 18, 22, 30, 34, 35], "revis": 2, "want": [2, 5, 6, 10, 14, 17, 19, 21, 24, 28, 33, 34, 35, 37], "field": 2, "alwai": [2, 13, 17, 19, 24, 33, 35], "determinist": 2, "commit": [2, 21], "aka": 2, "pin": [2, 14], "mai": [2, 3, 5, 7, 9, 13, 17, 19, 20, 21, 23, 24, 25, 26, 33, 34, 35, 38], "ad": [2, 5, 6, 10, 14, 17, 18, 19, 20, 21, 23, 24, 26, 28, 29, 33, 34, 38], "resolv": 2, "prepar": [2, 18], "hermet": 2, "differ": [2, 3, 7, 14, 16, 17, 19, 21, 23, 24, 26, 27, 29, 30, 31, 33, 34, 35, 38], "mechan": [2, 9, 18], "deploi": 2, "becaus": [2, 3, 9, 13, 16, 17, 20, 21, 23, 25, 26, 34, 38], "local": [2, 4, 13, 14, 17, 19, 34], "checkout": [2, 9, 19], "thi": [2, 3, 4, 6, 7, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 33, 34, 35, 36, 37, 38], "ha": [2, 3, 4, 5, 6, 8, 9, 10, 13, 14, 17, 18, 20, 21, 23, 24, 33, 34, 35, 38], "built": [2, 4, 35, 38], "from": [2, 3, 4, 5, 6, 8, 9, 10, 11, 14, 15, 16, 19, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 34, 35, 36, 38], "sourc": [2, 3, 5, 6, 7, 9, 12, 13, 14, 19, 22, 33], "instal": [2, 3, 4, 6, 7, 8, 12, 13, 19, 21, 22], "system": [2, 22, 35, 38], "version": [2, 3, 4, 5, 8, 13, 17, 21, 22, 23, 25, 26, 34], "compat": [2, 13, 22, 32, 36], "e": [2, 4, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 26, 30, 32, 33, 34, 35], "g": [2, 4, 5, 10, 11, 13, 14, 15, 16, 18, 19, 20, 22, 24, 26, 32, 33, 34, 35], "codegen": [2, 6, 12], "torchgen": [2, 3], "python": [2, 3, 4, 5, 6, 7, 9, 10, 12, 13, 14, 15, 18, 19, 20, 21, 22, 23, 24, 27, 28, 33, 34], "modul": [2, 8, 9, 10, 14, 17, 19, 27, 30, 31, 34, 38], "should": [2, 3, 4, 6, 7, 13, 14, 17, 18, 19, 23, 24, 25, 29, 30, 33, 34, 35, 36], "The": [2, 3, 4, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 26, 27, 28, 30, 32, 33, 34, 35, 36, 37, 38], "directori": [2, 3, 6, 9], "either": [2, 6, 11, 13, 14, 19, 24, 25, 33], "bzl": 2, "overriden": 2, "command": [2, 3, 4, 9, 13, 17, 19, 21, 22, 27, 30], "line": [2, 3, 5, 10, 14, 16, 17, 19, 21, 24, 30, 33], "override_repositori": 2, "org_tensorflow": 2, "path": [2, 5, 7, 14, 17, 19, 22, 24, 30, 33], "export": [2, 3, 4, 6, 12, 13, 19, 22], "tf_repo": 2, "torch_repo": 2, "pleas": [2, 3, 6, 11, 13, 14, 17, 19, 25, 30, 31, 32, 34, 37, 38], "sure": [2, 5, 17, 18, 19, 38], "overridden": [2, 3], "repositori": [2, 13], "appropri": [2, 17, 23], "been": [2, 5, 6, 13, 14, 17, 20, 21, 24, 33, 34], "use_cuda": [2, 5], "0": [2, 3, 4, 5, 7, 9, 10, 12, 13, 14, 15, 17, 19, 20, 21, 22, 24, 26, 27, 28, 29, 30, 31, 33, 34, 35, 37, 38], "setup": [2, 3, 5, 7, 10, 17, 27], "py": [2, 3, 4, 5, 6, 9, 11, 13, 15, 16, 17, 19, 21, 23, 26, 27, 30, 37], "bdist_wheel": 2, "expect": [2, 3, 7, 13, 14, 17, 19, 24, 28, 32, 33, 38], "object": [2, 10, 14, 34], "present": [2, 36], "new_local_repositori": 2, "build_fil": 2, "pytorch_local_dir": 2, "header": 2, "directli": [2, 3, 6, 7, 13, 14, 17, 19, 21, 22, 24, 25, 30, 33, 34, 36], "share": [2, 3, 7, 13, 17, 19, 34], "libtorch": 2, "so": [2, 3, 7, 10, 13, 14, 15, 17, 19, 20, 21, 22, 24, 30, 33, 36, 38], "same": [2, 3, 6, 7, 9, 13, 14, 17, 19, 20, 22, 23, 24, 25, 26, 29, 32, 33, 34, 35, 37, 38], "where": [2, 4, 8, 9, 11, 13, 14, 16, 17, 18, 19, 23, 24, 30, 31, 33, 35, 38], "lib": [2, 5, 7], "contain": [2, 3, 6, 7, 9, 10, 13, 14, 19, 21, 23, 24, 26, 33, 35], "work": [2, 3, 9, 10, 11, 13, 14, 15, 17, 18, 19, 24, 26, 28, 32, 33, 34], "s": [2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 25, 26, 27, 28, 32, 34, 36, 38], "requir": [2, 3, 6, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 24, 33, 34, 36, 37, 38], "pass": [2, 6, 9, 10, 13, 14, 16, 18, 20, 21, 25, 26, 34, 35, 38], "isystemextern": 2, "compil": [2, 5, 6, 7, 10, 12, 13, 14, 15, 18, 21, 22, 23, 24, 28, 31, 32, 33, 35, 36], "find": [2, 3, 6, 8, 9, 13, 19, 21, 23, 27, 31], "satisfi": [2, 34], "them": [2, 3, 6, 9, 13, 14, 16, 17, 18, 19, 20, 21, 24, 33, 35, 38], "some": [2, 3, 6, 9, 13, 14, 15, 17, 19, 26, 27, 32, 34, 35, 38], "user": [2, 4, 5, 7, 9, 12, 13, 16, 17, 19, 20, 24, 28, 29, 31, 32, 33, 34, 36], "bring": [2, 3], "pybind11": 2, "embed": [2, 9], "link": [2, 3], "against": [2, 27], "libpython": 2, "instead": [2, 10, 11, 13, 14, 17, 19, 21, 22, 24, 26, 27, 28, 30, 33, 34, 36], "These": [2, 3, 6, 8, 9, 13, 20, 21, 32, 36, 38], "pybind11_emb": 2, "option": [2, 3, 4, 5, 7, 13, 14, 19, 32, 34, 36], "transit": [2, 16, 17, 22], "simpl": [2, 3, 8, 9, 13, 20, 25, 30], "torch_xla": [2, 4, 6, 7, 8, 9, 11, 12, 13, 15, 17, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 38], "csrc": [2, 6], "runtim": [2, 3, 4, 7, 12, 17, 19, 27, 30, 34, 35, 36], "configr": 2, "via": [2, 4, 12, 13, 16, 18, 22, 29, 30, 34, 35], "bazelrc": 2, "take": [2, 3, 9, 10, 14, 17, 18, 19, 21, 22, 23, 24, 33, 34], "flag": [2, 3, 5, 10, 14, 15], "config": [2, 3, 4, 10], "remote_cach": 2, "configur": [2, 3, 6, 12, 13, 14, 17, 19, 21, 36], "gcloud": [2, 4, 13, 17, 21, 22], "usual": [2, 3, 5, 6, 17, 19], "faster": [2, 5, 13, 20, 21, 24, 26, 28, 33], "authent": [2, 13], "easi": [2, 9, 13, 17, 24, 33, 38], "express": [2, 26, 35], "complex": [2, 16, 26, 28], "lot": [2, 17, 19, 20, 24, 33], "gain": [2, 13], "have": [2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 19, 20, 21, 22, 23, 24, 26, 27, 28, 30, 31, 33, 34, 36, 38], "singl": [2, 9, 13, 14, 16, 20, 22, 23, 24, 27, 28, 30, 31, 33, 34, 35, 37], "graph": [2, 9, 10, 13, 14, 16, 17, 18, 19, 21, 22, 23, 24, 26, 27, 28, 33, 34], "everyth": [2, 10, 24, 27, 33], "therefor": [2, 17, 19, 21, 23], "separ": [2, 3, 5, 6, 10, 16, 17, 20, 28, 30, 31], "rest": [2, 19, 24, 33], "plu": [2, 18, 27, 29], "whole": [2, 14, 16, 24, 28, 33], "everythin": 2, "els": [2, 10, 17, 19, 24, 33], "enough": [2, 23, 24, 33], "normal": [2, 3, 13, 17, 24, 31, 33, 34], "achiev": [2, 6, 16, 27, 35], "invok": [2, 3, 28, 34], "standard": [2, 18], "c": [2, 3, 6, 12, 13, 19, 24, 25, 26, 33], "bind": 2, "simpli": [2, 9, 16], "_xlac": [2, 17, 19, 24, 33], "client": [2, 7, 13, 14], "togeth": [2, 13, 17, 27, 30, 34, 35], "when": [2, 3, 5, 6, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 28, 30, 34, 35, 36, 38], "chang": [2, 5, 6, 12, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 32, 33, 34], "abl": [2, 17, 24, 33, 36, 38], "without": [2, 6, 9, 10, 13, 14, 16, 17, 18, 19, 20, 21, 23, 34, 35, 36, 38], "iter": [2, 9, 14, 15, 16, 17, 18, 19, 20, 28, 34], "cycl": [2, 17], "come": [2, 14, 24, 33], "There": [2, 3, 10, 17, 19, 23, 24, 27, 28, 33, 34], "plenti": 2, "backend": [2, 3, 11, 12, 13, 16, 22, 24, 28, 29, 32, 33, 34, 36, 38], "we": [2, 3, 4, 5, 6, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 26, 27, 28, 29, 30, 31, 33, 34, 37], "our": [2, 3, 4, 5, 6, 7, 8, 11, 13, 17, 19, 22, 24, 25, 27, 28, 33, 34, 35], "gc": [2, 36], "storag": [2, 4, 8, 17, 19, 22, 30, 36], "under": [2, 3, 6, 9, 13, 14, 16, 17, 27], "disabl": [2, 14, 16, 17, 19, 20, 21], "default": [2, 6, 10, 13, 14, 16, 17, 18, 19, 21, 25, 30, 34, 36, 38], "speed": [2, 5, 12, 14, 21, 22, 24, 28, 33, 38], "increment": [2, 3], "huge": [2, 19, 21, 24, 27, 33], "margin": 2, "almost": 2, "enabl": [2, 5, 9, 14, 15, 16, 17, 19, 20, 22, 23, 25, 27, 32, 34, 35, 36], "ci": [2, 6], "To": [2, 3, 4, 5, 6, 7, 8, 9, 13, 14, 15, 16, 17, 18, 19, 21, 23, 24, 30, 31, 33, 34, 36, 37, 38], "ensur": [2, 9, 14, 17, 24, 26, 31, 33, 34, 36], "credenti": 2, "auth": [2, 13], "applic": [2, 19, 22, 32, 36], "login": [2, 21], "launch": [2, 5, 13, 14, 15, 17, 18, 21, 27, 28, 30], "browser": 2, "gcp": [2, 4, 13], "variou": [2, 16, 22], "individu": [2, 30, 31, 35], "who": [2, 5, 27], "access": [2, 3, 6, 8, 13, 14, 17, 18, 19, 20, 21, 24, 33, 36, 38], "project": [2, 4, 7, 13, 17, 22], "one": [2, 3, 6, 8, 9, 13, 14, 17, 19, 20, 21, 23, 24, 28, 29, 30, 31, 33, 34, 35, 37, 38], "onli": [2, 3, 5, 6, 9, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 33, 35, 36, 38], "google_default_credenti": 2, "token": [2, 16, 21, 32], "out": [2, 6, 9, 10, 13, 14, 17, 19, 21, 25, 28, 34, 38], "box": [2, 6, 34], "log": [2, 19, 20, 21], "permiss": 2, "add": [2, 3, 5, 6, 14, 17, 20, 21, 23, 24, 28, 29, 30, 33], "new": [2, 3, 4, 5, 6, 11, 17, 18, 19, 20, 21, 24, 28, 33, 34], "role": [2, 16], "In": [2, 3, 5, 6, 7, 8, 9, 11, 13, 14, 15, 17, 18, 19, 20, 21, 24, 25, 26, 28, 33, 34, 35, 36, 38], "account": [2, 21], "kei": [2, 4, 7, 9, 13, 19, 20, 22, 36], "google_credenti": 2, "On": [2, 13, 14, 36], "docker": 2, "network": [2, 13, 14, 17, 19, 25, 34, 35, 38], "cloudbuild": 2, "down": [2, 5, 6, 21, 38], "imag": [2, 13, 22, 24, 27, 30, 33], "do": [2, 3, 5, 6, 10, 13, 14, 15, 17, 19, 20, 21, 23, 24, 25, 26, 27, 30, 32, 33, 34, 38], "doe": [2, 3, 5, 13, 14, 15, 17, 18, 19, 20, 23, 24, 26, 33, 34, 35], "read": [2, 4, 6, 13, 14, 34], "write": [2, 6, 14, 17, 18, 35], "silo": 2, "each": [2, 3, 5, 6, 11, 13, 14, 17, 18, 19, 20, 21, 24, 26, 28, 30, 31, 33, 34, 35, 36, 38], "uniqu": [2, 17, 21, 24, 26, 33], "benefit": [2, 5, 16, 22, 32, 36], "consist": [2, 11, 13, 18], "remote_default_exec_properti": 2, "some_silo_kei": 2, "bazel_remote_cach": 2, "1": [2, 4, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 19, 20, 23, 26, 27, 28, 29, 30, 31, 34, 35, 37, 38], "silo_nam": 2, "your": [2, 3, 7, 9, 10, 13, 17, 18, 19, 20, 21, 22, 24, 26, 27, 31, 33, 34, 35, 36, 38], "tpuvm_mod": 2, "gcloud_service_key_fil": 2, "application_default_credenti": 2, "json": [2, 5], "might": [2, 3, 6, 14, 17, 19, 20, 21, 23, 24, 33], "help": [2, 17, 19, 20, 22, 23, 24, 33], "too": [2, 5, 19, 24, 33], "cannot": [2, 8, 9, 23, 24, 25, 30, 33, 38], "here": [2, 3, 6, 8, 10, 15, 17, 18, 20, 21, 24, 27, 28, 30, 31, 33, 34, 35, 36], "author": [2, 38], "usernam": [2, 5], "behavior": [2, 3, 6, 13, 14, 17, 19, 26], "function": [2, 6, 7, 8, 9, 10, 11, 14, 16, 17, 19, 21, 23, 28, 29, 31, 32, 36, 38], "intend": [2, 16], "first": [2, 3, 4, 9, 10, 14, 15, 18, 19, 20, 21, 23, 27, 34, 35, 36, 37, 38], "time": [2, 3, 4, 5, 12, 13, 14, 15, 19, 20, 21, 23, 24, 26, 28, 29, 33, 34, 38], "slow": [2, 5, 9, 19, 21], "scratch": [2, 3], "veri": [2, 7, 8, 17, 20, 21, 24, 33], "fast": [2, 24, 33], "updat": [2, 3, 5, 10, 11, 17, 18, 21, 22, 24, 33, 34], "onc": [2, 11, 14, 17, 19, 20, 21, 24, 26, 28, 33, 34, 38], "again": [2, 3, 5, 17, 20, 38], "bit": [2, 14, 17, 32], "slower": [2, 16, 19, 20, 27, 38], "per": [2, 12, 13, 14, 16, 17, 19, 27, 28, 32], "until": [2, 14, 17, 18, 20, 36], "next": [2, 5, 14, 18, 19, 20, 21, 24, 32, 33, 34, 38], "quit": 2, "current": [2, 5, 7, 8, 14, 15, 16, 17, 18, 23, 24, 26, 28, 29, 31, 32, 33, 34, 37], "migrat": [2, 12, 13], "futur": [2, 3, 4, 7, 13, 16, 17, 19, 23, 24, 26, 31, 33], "plafrom": 2, "cpp": [2, 5, 6, 19], "main": [2, 4, 10, 11, 13, 16, 34], "Of": 2, "cours": 2, "pjrt": [2, 14, 17, 22, 34], "Not": 2, "environment": 2, "variabl": [2, 4, 5, 13, 15, 20, 24, 33], "miss": [2, 6, 14, 19], "common": [2, 13, 17, 24, 31, 32, 33, 35, 36], "part": [2, 3, 7, 13, 14, 16, 19, 20, 23, 34, 38], "ones": [2, 14, 24, 33], "helper": [2, 3, 14], "script": [2, 3, 4, 8, 13, 17, 18, 19, 21, 23, 25, 27, 37, 38], "run_test": 2, "sh": 2, "r": [2, 21], "xla_client": 2, "pure": [2, 3, 9, 16, 26], "easili": [2, 6, 24, 28, 33], "execut": [2, 5, 12, 13, 14, 16, 17, 21, 22, 23, 24, 25, 26, 27, 28, 33, 34, 35, 37, 38], "parallel": [2, 12, 13, 14, 19, 20, 22, 34, 35], "sinc": [2, 3, 6, 13, 17, 19, 23, 24, 25, 27, 28, 31, 33, 34, 36], "xrt": [2, 14], "port": [2, 37], "gpu": [2, 6, 7, 8, 13, 15, 19, 21, 22, 25, 34, 38], "tpu": [2, 3, 6, 7, 8, 9, 14, 15, 16, 18, 19, 23, 27, 28, 29, 35, 36, 37], "devic": [2, 3, 4, 6, 7, 9, 11, 12, 13, 14, 15, 16, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 32, 33, 36, 38], "avail": [2, 13, 14, 17, 19, 20, 21, 24, 30, 33, 37], "reason": [2, 3, 6, 13, 21, 27], "bundl": 2, "target": [2, 13, 16, 17, 23, 24, 25, 28, 33], "sequenti": [2, 14], "calcul": [2, 16, 38], "visual": [2, 34, 35, 38], "lcov": 2, "describ": [2, 3, 4, 5, 10, 14, 17, 21, 23, 25, 27, 35], "document": [2, 3, 4, 6, 7, 10, 13, 17, 25, 26, 27, 32], "editor": 2, "choic": [2, 24, 33], "gutter": 2, "vscode": 2, "power": 2, "like": [2, 3, 4, 5, 6, 8, 9, 10, 13, 14, 16, 17, 18, 19, 20, 22, 24, 25, 30, 33, 34, 38], "clangd": 2, "refer": [2, 3, 6, 8, 11, 13, 14, 15, 17, 22, 30, 32, 34, 35, 37], "autocomplet": 2, "semant": [2, 6, 19, 24, 33], "understand": [2, 10, 16, 18, 21, 23, 24, 33], "underli": [2, 14, 17, 35], "stack": [2, 5, 9, 17, 19, 24, 25, 33, 34], "combin": [2, 6, 9, 14, 24, 26, 33], "studio": 2, "extens": [2, 4, 5, 6, 7], "featur": [2, 5, 8, 10, 13, 15, 19, 22, 27, 32, 34, 35, 36], "assist": 2, "edit": 2, "As": [2, 3, 5, 9, 10, 20, 21, 23, 24, 26, 31, 33], "distutil": 2, "ltc": 3, "lazi": [3, 14, 16, 18, 19, 22, 24, 26, 28, 33, 34], "tensor": [3, 5, 6, 9, 10, 11, 12, 13, 14, 15, 18, 20, 21, 22, 23, 25, 26, 28, 29, 31, 32, 34, 35, 38], "core": [3, 5, 6, 11, 12, 13, 14, 16, 17, 18, 19, 21, 22, 23, 25, 27, 28, 29, 30, 31, 32, 35], "clean": [3, 5, 19, 28], "exist": [3, 13, 14, 17, 19, 22, 28, 34], "stub": 3, "over": [3, 5, 9, 13, 14, 16, 17, 20, 21, 30, 35, 36], "6": [3, 4, 6, 9, 14, 19, 21, 24, 33, 35, 38], "were": [3, 16, 17, 19, 20, 21, 23, 24, 33, 38], "complet": [3, 14, 16, 17, 19], "process": [3, 5, 6, 7, 11, 12, 13, 14, 16, 19, 21, 22, 23, 27, 32], "found": [3, 13, 21, 38], "ref": [3, 4, 13], "oper": [3, 5, 9, 11, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 26, 35, 36, 38], "xla_native_funct": [3, 6], "yaml": [3, 6], "replac": [3, 5, 9, 21, 29], "support": [3, 7, 8, 9, 10, 12, 13, 14, 15, 22, 24, 26, 28, 29, 30, 33, 34, 36, 37, 38], "an": [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 30, 31, 33, 34, 35, 36, 38], "equival": [3, 38], "full_codegen": 3, "NOT": 3, "introduc": [3, 8, 11, 13, 16, 19, 20, 23, 26, 27, 34], "ani": [3, 5, 8, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 26, 27, 30, 31, 33, 34, 35, 36, 37, 38], "purpos": [3, 6, 9, 16, 32], "info": [3, 5, 14, 19, 24, 33, 35, 38], "about": [3, 4, 12, 13, 14, 16, 17, 21, 22, 24, 33, 35], "dispatch": [3, 5, 6, 18, 36], "exyang": 3, "blog": [3, 26], "post": [3, 14, 19, 26], "follow": [3, 5, 6, 8, 9, 10, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 27, 30, 31, 33, 34, 35, 37], "instruct": [3, 5, 6, 18, 20, 21], "depend": [3, 4, 6, 15, 16, 17, 21, 24, 25, 26, 33, 35], "build": [3, 6, 12, 16, 17, 18, 21, 23, 30, 38], "It": [3, 4, 5, 6, 9, 11, 14, 15, 17, 18, 20, 21, 22, 23, 24, 28, 30, 31, 32, 33, 34, 35, 38], "experi": [3, 5, 6, 13, 16, 22, 27, 36, 38], "workstat": [3, 6], "cpu": [3, 6, 11, 14, 18, 19, 20, 21, 23, 24, 30, 32, 33, 34, 36, 38], "pjrt_devic": [3, 6, 7, 13, 15, 17, 19, 27, 29, 37, 38], "re": [3, 13, 14, 16, 19, 23, 24, 25, 26, 29, 33], "familiar": [3, 12, 17, 22], "issu": [3, 6, 9, 13, 14, 16, 17, 19, 21, 23, 25, 27, 31], "3560": 3, "track": [3, 19, 36], "statu": [3, 19], "put": [3, 6, 17, 19, 27, 38], "alia": [3, 11, 14], "avoid": [3, 17, 19, 20, 21, 23, 25], "duplic": 3, "mention": [3, 6, 24, 28, 33], "below": [3, 6, 10, 11, 13, 17, 21, 24, 25, 33, 36, 37], "live": [3, 6, 14, 24, 33], "folder": [3, 4, 5, 6], "except": [3, 6, 20, 22, 23, 34], "torch": [3, 4, 5, 8, 9, 12, 14, 15, 17, 18, 19, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 38], "shape_infer": 3, "shape": [3, 6, 8, 9, 10, 12, 14, 19, 20, 22, 26, 29, 34, 35, 38], "defin": [3, 5, 6, 8, 10, 14, 18, 21, 25, 29, 31, 34, 35, 38], "input": [3, 6, 9, 10, 11, 13, 14, 15, 16, 17, 19, 20, 22, 25, 26, 29, 31, 34, 35, 36], "return": [3, 6, 7, 8, 9, 10, 11, 14, 16, 17, 19, 21, 24, 26, 27, 28, 29, 32, 33, 34, 36, 38], "output": [3, 4, 5, 8, 9, 10, 11, 13, 14, 17, 19, 25, 26, 27, 28, 29, 30, 34, 38], "manual": [3, 6, 8, 19, 30], "gen_lazy_tensor": 3, "data": [3, 11, 12, 13, 14, 16, 17, 18, 21, 22, 24, 25, 28, 33, 35, 36], "aten": [3, 5, 6, 10, 19, 24, 33], "specif": [3, 5, 9, 14, 16, 17, 18, 20, 21, 22, 23, 27, 32, 35], "run_gen_lazy_tensor": 3, "dest": 3, "lazy_ir": 3, "class": [3, 7, 9, 10, 11, 14, 17, 26, 27, 30, 32, 35, 36, 38], "genlazyir": 3, "back": [3, 6, 14, 17, 19, 21, 34], "todai": [3, 15], "most": [3, 7, 13, 14, 18, 19, 28], "categori": [3, 31], "goal": [3, 4, 6, 11, 38], "move": [3, 13, 14, 19, 24, 26, 27, 33, 36, 38], "necessari": [3, 14, 19, 21, 25], "call": [3, 5, 6, 10, 11, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 26, 28, 29, 30, 33, 34, 36, 38], "upstream": [3, 11, 15, 26], "api": [3, 6, 10, 13, 17, 22, 24, 27, 28, 30, 32, 33, 34, 36], "xlanativefunct": [3, 6], "column": 3, "declar": [3, 6], "anoth": [3, 15, 17, 19, 21, 24, 33, 38], "wrap": [3, 6, 7, 8, 14, 17, 20, 21, 23, 25, 26, 27, 30, 31, 32, 34], "around": [3, 13, 24, 30, 33, 35], "xlatensor": [3, 6, 14, 34], "construct": [3, 6, 17, 20, 30, 34, 36], "aten_xla_typ": [3, 6], "Will": 3, "method": [3, 10, 13, 14, 18, 25, 31, 34, 36], "map": [3, 6, 11, 14], "node": [3, 6, 11, 13, 14, 19, 24, 33, 37], "remov": [3, 13, 19, 21], "tensor_method": [3, 6], "possibl": [3, 13, 17, 19, 22, 23, 30, 31, 34, 38], "multipl": [3, 11, 14, 16, 18, 20, 24, 27, 28, 32, 33, 35, 38], "few": [3, 17, 19, 21, 24, 27, 33, 36], "simpler": [3, 13], "go": [3, 17, 21, 25, 34], "unari": 3, "binari": [3, 5, 7, 22, 28, 38], "exampl": [3, 4, 5, 6, 7, 10, 11, 13, 14, 15, 16, 17, 19, 20, 22, 23, 24, 26, 27, 28, 31, 32, 33, 34, 35, 36, 37, 38], "characterist": 3, "fallback": [3, 6], "_adaptive_avg_pool3d": 3, "condit": [3, 16, 17, 24, 29, 33], "issupportedadaptivepool": 3, "xlahelp": 3, "i64list": 3, "self": [3, 6, 7, 9, 10, 11, 14, 17, 21, 26, 27, 32, 34], "size": [3, 9, 11, 13, 15, 17, 19, 20, 21, 23, 24, 33, 35, 36, 38], "output_size_list": 3, "pool_dim": 3, "nativ": [3, 5, 6, 13, 16, 19, 25, 27, 34], "call_fallback_fn": 3, "xla_fallback": 3, "aten_op": 3, "output_s": 3, "wip": 3, "evolv": 3, "At": [3, 5, 7, 14, 22], "point": [3, 4, 5, 6, 7, 12, 14, 17, 18, 22, 23, 24, 25, 33], "self_tensor": 3, "static": [3, 15, 16, 24, 33], "bool": [3, 14], "sync_upd": 3, "sys_util": 3, "getenvbool": 3, "xla_tensor_update_sync": 3, "true": [3, 5, 9, 13, 14, 16, 18, 20, 21, 24, 27, 30, 33, 34, 36, 38], "xla_check": 3, "dst_tensor": 3, "updatefromtensor": 3, "sync": [3, 13, 14, 16, 17, 19, 20, 21, 22, 23, 25, 27], "complic": [3, 6, 8, 16], "would": [3, 4, 6, 13, 14, 17, 18, 19, 21, 24, 29, 33, 38], "someth": [3, 9, 21, 23], "ab": [3, 30], "const": [3, 6, 11], "torch_lazy_fn_count": 3, "bridg": [3, 22, 28], "atenfromxlatensor": 3, "getxlatensor": 3, "fail": [3, 5, 14, 17, 19, 36], "explain": [3, 7, 17, 19, 20, 21, 24, 26, 33], "later": [3, 20, 23, 26], "still": [3, 11, 13, 17, 18, 24, 25, 27, 33, 36], "If": [3, 4, 5, 6, 9, 10, 13, 14, 17, 18, 19, 20, 21, 22, 23, 24, 26, 32, 33, 34, 35, 38], "while": [3, 9, 10, 11, 12, 14, 16, 17, 18, 20, 22, 24, 27, 33], "error": [3, 10, 14, 17, 19], "involv": [3, 14, 18, 24, 33, 34], "problem": [3, 24, 33], "yet": [3, 6, 11], "attempt": [3, 36], "unblock": [3, 36], "snippet": [3, 5, 17, 34, 35], "auto": [3, 6, 14, 30, 36], "common_devic": 3, "getxladevic": 3, "torch_internal_assert": 3, "xlatensorptr": 3, "lazy_self": 3, "getxlatensororcreateforwrappednumb": 3, "nodeptr": 3, "reusenod": 3, "getirvalu": 3, "makenod": 3, "cachenod": 3, "creat": [3, 5, 10, 12, 13, 14, 19, 20, 21, 22, 25, 26, 27, 34, 35, 36, 38], "std": [3, 11, 27], "get": [3, 6, 13, 14, 15, 21, 22, 24, 27, 30, 32, 33], "check": [3, 4, 6, 10, 14, 17, 32], "reus": [3, 9, 17, 20, 21, 22, 26], "previou": [3, 5, 13, 17, 18, 21, 24, 33, 35, 38], "creation": [3, 14], "correspond": [3, 6, 11, 14, 20, 25, 30, 34, 35], "cach": [3, 8, 14, 15, 22, 26], "newli": 3, "And": [3, 24, 27, 33, 34], "within": [3, 14, 16, 17, 19, 23, 32, 35, 36], "note": [3, 4, 8, 11, 13, 14, 16, 17, 19, 20, 21, 23, 24, 28, 30, 31, 32, 33, 35], "done": [3, 4, 8, 17, 19, 20, 21, 23, 24, 33, 38], "public": [3, 13], "xlanod": 3, "xlavalu": 3, "opkind": [3, 6], "absoutputshap": 3, "num_output": [3, 24, 33], "mhash": 3, "string": [3, 11, 14, 34, 38], "tostr": 3, "overrid": [3, 14], "stringstream": 3, "ss": 3, "str": [3, 7, 10, 14, 38], "xlaopvector": 3, "loweringcontext": 3, "loctx": 3, "A": [3, 7, 12, 13, 14, 16, 17, 18, 20, 24, 25, 31, 32, 33, 34, 35], "coupl": [3, 17, 19], "thing": [3, 19, 23, 26], "keep": [3, 4, 13, 15, 19, 24, 33, 38], "mind": [3, 13, 19], "clone": [3, 13, 19, 21], "even": [3, 13, 14, 16, 17, 19, 24, 26, 27, 33, 38], "everi": [3, 6, 8, 9, 13, 14, 17, 19, 24, 26, 28, 33, 34, 36], "outputshap": 3, "xla_shap": 3, "overli": 3, "simplifi": 3, "buildxxxop": 3, "slightli": [3, 6, 14], "better": [3, 6, 13, 16, 17, 19, 21, 23, 24, 28, 29, 33], "maximumoutputshap": 3, "lower_for_shape_fn": 3, "absl": 3, "xlaop": [3, 6], "operand": 3, "promot": 3, "max": [3, 24, 33, 36], "second": [3, 9, 10, 15, 16, 19, 21, 27, 35, 37], "inferoutputshap": 3, "comput": [3, 4, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 33, 34, 35], "logic": [3, 9, 14, 24, 29, 33, 34, 35], "two": [3, 5, 7, 13, 14, 17, 18, 19, 20, 21, 23, 24, 33, 34, 35, 38], "xla_input": 3, "getoutputop": 3, "returnop": 3, "buildab": 3, "origin": [3, 21], "genericop": 3, "modifi": [3, 17, 21, 25, 28, 34, 38], "abov": [3, 6, 7, 10, 14, 15, 17, 19, 20, 21, 23, 24, 27, 28, 33, 35], "delet": 3, "sometim": [3, 20, 22, 24, 33], "being": [3, 14, 17, 20, 27, 35, 38], "tensor_op": 3, "cross": [3, 14, 17, 34], "s1": [3, 34], "sub": 3, "mul": [3, 14, 24, 33, 38], "u2": 3, "v3": [3, 17, 27], "u3": 3, "v2": [3, 4, 17], "irnod": 3, "those": [3, 5, 6, 14, 19, 23, 27], "long": [3, 9, 16, 18, 19, 20, 21, 23, 24, 27, 33], "term": [3, 16, 19, 24, 33, 38], "rid": [3, 24, 33], "composit": [3, 6], "end": [3, 6, 13, 14, 15, 17, 19, 20, 21, 27, 30, 31], "exp": 3, "pow": 3, "norm_exp": 3, "vector": 3, "don": [3, 6, 13, 15, 17, 19, 24, 30, 33], "t": [3, 6, 13, 14, 15, 17, 18, 19, 24, 25, 30, 31, 33, 34, 35, 36], "build_cpp_test": 3, "skip": [3, 6, 19, 28], "desir": [3, 21, 35, 36], "test_ptxla": 3, "gtest_filt": 3, "atenxlatensortest": 3, "testab": 3, "correct": [3, 18, 24, 26, 33], "counter": [3, 6, 14, 19], "correctli": [3, 19, 31], "bitwise_left_shift": 3, "pull": [3, 25, 27, 30], "8865": 3, "erf": 3, "erfc": 3, "erfinv": 3, "3659": 3, "binary_cross_entropi": [3, 25], "backward": [3, 6, 9, 13, 16, 17, 25, 27, 28, 30, 31], "3809": 3, "scalar": [3, 6, 14, 19, 24, 33], "addcdiv": 3, "addcmul": 3, "3768": 3, "neg": 3, "index": [3, 4, 7, 8, 13, 14, 17, 19, 21, 35, 37], "amin": 3, "amax": 3, "3771": 3, "special": [3, 10, 20, 34, 38], "partial": [3, 24, 30, 31, 33], "adaptive_avgpool3d": 3, "3790": 3, "guid": [4, 5, 8, 9, 12, 13, 17, 20, 22, 23, 30, 31, 34], "interact": [4, 12, 13], "start": [4, 5, 13, 17, 18, 19, 21, 23], "colab": [4, 19, 38], "kaggl": 4, "preinstal": [4, 13], "ecosystem": [4, 16, 22, 32], "packag": [4, 12, 17, 22, 25, 27, 38], "date": [4, 38], "list": [4, 5, 6, 9, 14, 21, 25, 26, 29, 34, 35], "readm": [4, 19, 21], "prerequisit": [4, 34], "remot": 4, "quota": 4, "request": [4, 5, 6, 14, 19, 21, 24, 25, 27, 33, 34, 35], "offici": [4, 5, 19], "ssh": [4, 13, 17, 21, 22], "regist": [4, 6, 7, 10, 11, 13, 36], "agent": 4, "alreadi": [4, 8, 14, 19, 23, 24, 27, 30, 33, 36], "befor": [4, 5, 8, 11, 13, 14, 17, 18, 19, 20, 23, 24, 25, 27, 28, 31, 33, 34, 36, 38], "begin": [4, 17, 18, 34, 38], "zone": [4, 13, 17, 21, 22], "tpu_typ": 4, "8": [4, 9, 10, 13, 14, 16, 17, 20, 21, 22, 23, 24, 27, 28, 32, 33, 34, 35], "vm": [4, 13, 17, 19, 21, 22, 27], "assum": [4, 7, 8, 14, 17, 18, 24, 27, 31, 33, 34, 35], "id_ed25519": 4, "ubuntu2204": 4, "base": [4, 11, 13, 14, 16, 17, 19, 21, 22, 24, 26, 30, 33, 34, 35, 38], "metadata": [4, 19], "cat": [4, 25], "pub": 4, "ip": [4, 13, 14, 36, 37], "format": [4, 10, 14, 19, 22, 28, 32, 38], "valu": [4, 5, 6, 9, 13, 14, 15, 17, 19, 20, 21, 24, 26, 29, 33, 34, 37, 38], "networkendpoint": 4, "accessconfig": 4, "externalip": 4, "123": 4, "give": [4, 19, 23, 32, 34, 35], "friendli": 4, "easier": [4, 21, 24, 33], "echo": 4, "host": [4, 13, 14, 17, 18, 19, 20, 21, 22, 23, 25, 30, 36, 37], "n": [4, 14, 27, 32, 35], "hostnam": 4, "test": [4, 5, 7, 8, 13, 15, 26, 27, 30, 37, 38], "vs": [4, 9, 12, 13, 24, 33], "palett": 4, "select": [4, 5, 13, 14, 36], "visualstudio": 4, "doc": [4, 8, 9, 13, 14, 17, 24, 33], "__": [4, 13], "just": [4, 8, 13, 17, 18, 24, 27, 30, 33, 36], "titl": [4, 13], "open": [4, 5, 6, 7, 13, 19, 22], "window": 4, "termin": [4, 36], "mkdir": 4, "ptxla": 4, "Then": [4, 5, 10, 21], "ui": 4, "venv": 4, "virtual": [4, 5, 14], "latest": [4, 8, 17], "releas": [4, 7, 8, 11, 13, 16, 17, 19, 22, 28, 30, 31, 32, 34], "pip": [4, 8, 12, 21], "numpi": [4, 8, 10, 14, 23, 35], "f": [4, 8, 10, 14, 17, 27, 30, 32, 36, 38], "googleapi": [4, 8, 22], "libtpu": [4, 7, 13, 38], "wheel": [4, 22, 30], "html": [4, 8, 13, 14, 30], "import": [4, 5, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 21, 25, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36, 38], "set_device_typ": 4, "print": [4, 5, 9, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 24, 26, 27, 28, 33, 34, 36, 38], "real_devic": 4, "run": [4, 5, 6, 8, 9, 12, 13, 14, 15, 16, 18, 20, 22, 23, 24, 25, 26, 27, 28, 30, 32, 33, 35, 36, 38], "2": [4, 5, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 19, 22, 23, 26, 28, 29, 30, 31, 32, 34, 35, 37, 38], "3": [4, 6, 7, 8, 9, 10, 14, 16, 19, 20, 21, 28, 29, 30, 32, 34, 35, 38], "4": [4, 7, 8, 9, 10, 13, 14, 17, 19, 21, 24, 28, 29, 30, 32, 33, 34, 35, 38], "5": [4, 9, 11, 14, 15, 19, 21, 24, 26, 27, 30, 32, 33, 35], "7": [4, 14, 19, 27, 28, 35, 38], "number": [4, 5, 9, 13, 14, 15, 16, 19, 20, 21, 26, 30, 34, 35], "vari": [4, 13, 16, 24, 31, 33], "That": [4, 9, 24, 26, 33], "now": [4, 10, 11, 13, 17, 20, 21, 23, 24, 33, 34, 38], "realist": 4, "show": [5, 9, 10, 11, 13, 17, 19, 27, 38], "how": [5, 6, 8, 9, 10, 11, 14, 17, 18, 19, 21, 22, 23, 24, 25, 33, 34, 37, 38], "contributor": 5, "xla": [5, 6, 9, 10, 11, 13, 15, 23, 24, 26, 27, 28, 29, 31, 33, 34, 36, 37], "conda": 5, "forg": 5, "probabl": [5, 24, 33], "interest": [5, 27, 38], "o0": 5, "use_custom_debinfo": 5, "file1": 5, "file2": 5, "caus": [5, 6, 13, 14, 16, 17, 19, 23, 24, 33], "prevent": [5, 14, 16, 21, 28, 34], "perform": [5, 6, 8, 10, 11, 12, 14, 17, 20, 21, 22, 25, 26, 27, 28, 30, 32, 34, 38], "meaning": 5, "semicolon": 5, "let": [5, 8, 13, 16, 17, 19, 21, 23, 28], "suggest": [5, 19], "step": [5, 9, 13, 14, 16, 17, 18, 19, 21, 23, 24, 26, 27, 28, 30, 31, 33, 34, 36], "identifi": [5, 7, 14, 16, 17, 35, 36, 38], "similar": [5, 6, 13, 16, 21, 22, 23, 27, 29, 32], "src": [5, 36], "linear": [5, 13, 14, 17, 22, 25, 26, 27, 32], "breakpoint": 5, "session": 5, "discov": [5, 36], "addit": [5, 6, 7, 13, 17, 19, 20, 21, 23, 25, 27], "rebuild": 5, "newfil": 5, "readi": [5, 21], "howev": [5, 6, 8, 9, 10, 16, 19, 20, 21, 23, 34], "full": [5, 14, 17, 18, 19, 30, 38], "unfortun": 5, "touch": [5, 27, 36], "its": [5, 6, 11, 13, 15, 16, 17, 18, 19, 22, 26, 27, 28, 30, 34, 38], "timestamp": [5, 18], "reliabl": [5, 13], "rebuilt": 5, "wa": [5, 13, 14, 16, 19, 23, 24, 33, 36, 38], "use_rocm_kernel_assert": 5, "off": [5, 14, 20], "has_wmissing_prototyp": 5, "has_werror_missing_prototyp": 5, "util": [5, 8, 10, 12, 14, 16, 17, 19, 27, 30, 31, 32, 35, 36], "scalarop": 5, "emptytensor": 5, "shut": 5, "must": [5, 6, 7, 9, 11, 13, 14, 17, 18, 19, 26, 31, 36, 37], "pack": [5, 38], "publish": 5, "microsoft": 5, "search": [5, 6], "ms": [5, 26], "cpptool": 5, "tab": 5, "sampl": [5, 10, 13, 14, 19], "ll": [5, 6, 9, 24, 33, 38], "adjust": [5, 17], "match": [5, 6, 10, 14, 16, 17, 19], "interpret": [5, 14, 24, 33, 38], "cppdbg": 5, "program": [5, 8, 9, 10, 14, 17, 19, 20, 24, 28, 33, 34, 35], "home": 5, "miniconda3": 5, "env": [5, 13, 14, 34], "torch310": 5, "bin": 5, "arg": [5, 10, 14, 17, 21, 29, 30], "cwd": 5, "workspacefold": 5, "externalconsol": 5, "fals": [5, 10, 11, 14, 17, 18, 30, 34, 38], "mimod": 5, "setupcommand": 5, "descript": 5, "pretti": [5, 17, 24, 27, 33], "text": [5, 19], "ignorefailur": 5, "disassembl": 5, "flavor": 5, "intel": 5, "prelaunchtask": 5, "activ": [5, 9, 14, 17, 19, 27, 30, 31, 32], "midebuggerpath": 5, "locat": [5, 14], "But": [5, 17, 19, 24, 33, 38], "quirk": 5, "switch": [5, 9, 16, 17, 19, 24, 27, 33], "between": [5, 11, 13, 15, 16, 17, 19, 20, 22, 23, 24, 25, 27, 29, 33, 34, 38], "vadimcn": 5, "id": [5, 13, 14, 19, 22, 35], "click": 5, "left": [5, 19], "red": 5, "dot": [5, 10, 19], "displai": [5, 23], "indic": [5, 9, 14, 19, 23, 24, 33, 35], "dropdown": 5, "right": [5, 16, 18, 24, 28, 33], "green": 5, "plai": 5, "button": 5, "rule": [5, 23, 25], "after": [5, 6, 9, 11, 13, 14, 16, 17, 18, 19, 21, 24, 29, 33, 34], "empti": [5, 14], "white": 5, "circl": 5, "load": [5, 13, 14, 19, 22, 27, 30, 32, 36], "librari": [5, 6, 7, 10, 21, 22, 23, 35, 36], "trigger": [5, 16, 19, 20, 21, 24, 26, 33], "einsum": [5, 26], "yellow": 5, "arrow": 5, "collect": [5, 13, 27, 28, 35, 36], "certain": [5, 11, 19, 24, 25, 33, 38], "diagnost": 5, "turn": [5, 19, 38], "cuda": [5, 13, 14, 17, 18, 21, 24, 32, 33, 37], "handl": [5, 7, 18, 19, 24, 30, 31, 33, 34, 35], "trace": [5, 9, 12, 13, 14, 16, 19, 20, 22, 23, 24, 25, 27, 28, 33, 34], "ld_library_path": 5, "cflag": 5, "dhas_torch_show_dispatch_trac": 5, "demonstr": [5, 9, 11, 16, 23, 25, 36, 38], "offer": [6, 10, 14, 16, 22, 31, 32], "implement": [6, 8, 9, 11, 12, 13, 16, 19, 24, 28, 30, 31, 33], "convert": [6, 10, 12, 14, 17, 22, 23, 26, 27, 38], "higher": [6, 9, 19, 36], "level": [6, 9, 14, 19, 22, 23, 28, 32, 36], "represent": [6, 9, 14, 17, 22, 38], "i": [6, 9, 10, 13, 14, 17, 24, 26, 30, 33, 34, 35, 38], "hlo": [6, 9, 14, 17, 19, 20, 22], "beyond": 6, "scope": 6, "forward": [6, 10, 16, 17, 25, 26, 27, 28, 31, 32], "haven": [6, 24, 33], "signific": [6, 16, 18, 19, 20, 21, 22, 23, 28], "slowdown": [6, 19, 27], "best": [6, 8, 16, 28, 32, 35], "what": [6, 17, 20, 21, 26], "debug": [6, 12, 16, 24, 32, 33, 35], "pt": [6, 13, 17, 19, 22], "profil": [6, 12, 13, 21, 22], "_ctc_loss": [6, 19], "_ctc_loss_backward": [6, 19], "contribut": [6, 38], "definit": [6, 17, 24, 33], "native_funct": 6, "kernel": [6, 9, 10, 12, 24, 32, 33], "aten_fallback": 6, "h": [6, 38], "repo": [6, 17, 19, 21, 27], "sequenc": [6, 9, 14], "explicitli": [6, 16, 17, 18, 19, 20, 24, 25, 33], "compos": 6, "serv": [6, 21], "interfac": [6, 7, 17, 19, 36], "machineri": [6, 10], "registerxla": 6, "registerautogradxla": 6, "entri": [6, 7], "pytorch_xla": 6, "world": [6, 8, 13, 24, 28, 33, 36], "written": [6, 21, 36], "paramet": [6, 10, 13, 14, 17, 19, 25, 26, 27, 31, 34, 36, 37], "result": [6, 9, 11, 13, 14, 15, 17, 18, 19, 20, 21, 22, 27, 29, 34, 38], "wrapper": [6, 16, 17, 27, 30, 31], "inplac": [6, 14, 34], "ir": [6, 14, 19, 20, 22, 24, 26, 33], "insid": [6, 17, 20, 21, 23, 26, 34], "stand": 6, "intermedi": [6, 9, 13, 19, 20, 22, 38], "smaller": [6, 20, 21, 23, 24, 33], "inherit": 6, "dai": 6, "unless": [6, 19, 24, 33], "verifi": [6, 12, 14, 38], "test_oper": 6, "test_aten_xla_tensor": 6, "yield": [6, 17, 19, 38], "break": [6, 16, 20, 21, 24, 33, 38], "grasp": 6, "capabl": [6, 22], "minim": [6, 12, 22, 23], "pr": [6, 19, 30], "vanilla": 6, "lerp": 6, "variant": [6, 24, 25, 33], "lerp_": 6, "scalar_out": 6, "tensor_out": 6, "prototyp": [6, 34], "weight": [6, 14, 19, 31, 32], "lerp_out": 6, "namespac": [6, 19], "wrapper_scalar_lerp": 6, "No": [6, 13, 15, 24, 26, 32, 33], "deviceguard": 6, "omit": [6, 35, 37], "anonym": 6, "wrapper_scalar_lerp_": 6, "wrapper_scalar_lerp__tmp": 6, "_copy_from": 6, "m": [6, 10, 11, 24, 30, 33, 35, 38], "impl": [6, 10, 11], "torch_fn": 6, "automat": [6, 7, 12, 13, 14, 17, 19, 20, 24, 30, 33, 35, 36], "explicit": [6, 18, 22, 25, 30], "place": [6, 11, 14, 21, 23, 25, 34, 36, 38], "interned_str": 6, "symbol": [6, 24, 33], "submit": [6, 18, 19, 20, 25], "team": [7, 28], "tf": [7, 19, 24, 33], "close": [7, 16], "expos": [7, 13, 17, 20, 34], "deviceplugin": 7, "short": [7, 19, 24, 33], "pjrtclient": 7, "mirror": 7, "pjrt_api": 7, "straightforward": [7, 14, 23], "detail": [7, 8, 9, 10, 11, 13, 14, 17, 19, 24, 33, 35], "concret": [7, 24, 33], "placehold": 7, "pjrt_library_path": 7, "extra": [7, 27, 31, 38], "multiprocess": [7, 13, 14, 17], "compon": [7, 38], "least": [7, 14, 23], "cpuplugin": 7, "def": [7, 8, 9, 10, 11, 13, 14, 16, 17, 18, 21, 26, 27, 28, 29, 31, 32, 38], "library_path": 7, "os": [7, 13, 17, 27], "join": [7, 14], "dirnam": 7, "__file__": 7, "pjrt_c_api_cpu_plugin": 7, "exmapl": 7, "pyproject": 7, "toml": 7, "torch_xla_cpu_plugin": 7, "With": [7, 8, 13, 15, 24, 28, 33], "initi": [7, 11, 13, 14, 17, 18, 21, 27, 29, 36], "experiment": [7, 8, 9, 12, 13, 15, 16, 26, 27, 28, 29, 31, 32, 34, 36], "state": [7, 9, 14, 18, 30], "becom": [7, 8, 9, 13, 16, 17, 19, 21, 24, 33], "stabl": [7, 13, 22, 23, 30], "rise": 8, "openai": 8, "triton": 8, "popular": 8, "commun": [8, 11, 13, 14, 17, 20, 21, 23, 28, 35], "instanc": [8, 11, 14, 30, 36], "order": [8, 9, 14, 17, 18, 19, 21, 23, 34, 35], "pariti": 8, "continu": [8, 13, 22, 28], "push": 8, "custom_kernel": 8, "jax_import_guard": 8, "pl": [8, 13, 17, 34], "jnp": [8, 10], "add_vectors_kernel": 8, "x_ref": 8, "y_ref": 8, "o_ref": 8, "x": [8, 9, 10, 14, 17, 19, 20, 24, 26, 27, 29, 30, 31, 32, 33, 34, 35, 38], "y": [8, 9, 10, 14, 19, 20, 22, 24, 26, 30, 31, 32, 33, 34, 35, 38], "jit": [8, 10, 17, 28], "add_vector": 8, "arrai": [8, 10, 14, 23, 31, 35], "pallas_cal": 8, "out_shap": 8, "shapedtypestruct": 8, "dtype": [8, 10, 13, 24, 25, 26, 32, 33, 38], "otherwis": [8, 14, 19, 20, 22, 23, 24, 31, 33], "hang": 8, "lock": 8, "q": [8, 10], "randn": [8, 10, 13, 14, 16, 17, 26, 27, 28, 32, 34, 35], "128": [8, 9, 10, 13, 30, 32, 37], "k": [8, 10, 19], "v": [8, 10, 26], "make_kernel_from_palla": 8, "pt_kernel": 8, "lambda": [8, 26, 30], "liner": 8, "flash": [8, 9], "attent": [8, 9, 10], "besid": 8, "op": [8, 9, 10, 12, 14, 16, 18, 19, 20, 24, 25, 33, 34, 35], "suppor": 8, "flash_attent": [8, 26], "paged_attent": 8, "queri": [8, 13], "squeez": 8, "dim": [8, 9, 14], "key_cach": 8, "value_cach": 8, "context_len": 8, "block_tabl": 8, "pages_per_compute_block": 8, "megacore_mod": 8, "none": [8, 10, 11, 14, 19, 31, 34, 35], "vllm": 8, "effect": [8, 14, 26, 38], "memori": [8, 12, 14, 15, 19, 22, 23, 24, 30, 33], "kv": 8, "proper": [8, 35], "jax_nightly_releas": 8, "jaxlib_nightly_releas": 8, "authorit": 8, "dev": [8, 22, 27], "en": [8, 30], "consid": [9, 13, 17, 18, 20, 21], "mani": [9, 13, 14, 19, 21, 22, 23, 24, 26, 33, 37, 38], "homogen": 9, "llm": [9, 21], "drop": [9, 15, 19], "loop": [9, 16, 17, 19, 20, 21, 22, 23, 24, 26, 31, 33, 36], "bunch": [9, 10], "decod": [9, 16, 26], "subsequ": [9, 18, 21, 22], "significantli": [9, 13, 16, 17, 21, 22], "reduc": [9, 11, 13, 14, 15, 17, 18, 19, 20, 21, 23, 30], "hand": [9, 17], "lower": [9, 10, 12, 16, 19, 22, 24, 25, 33], "lax": 9, "Its": [9, 14, 16], "primari": [9, 22], "hood": 9, "itself": [9, 14, 22, 30], "typic": [9, 14, 18, 22], "transform": [9, 18, 21, 30, 35], "run_decoder_lay": 9, "hidden_st": 9, "decoder_lay": 9, "unrol": 9, "flat": [9, 35], "shown": [9, 13, 16, 24, 33], "decoder_with_scan": 9, "root": [9, 14, 24, 33, 38], "python3": [9, 13, 15, 17, 19, 21, 26, 30], "train_decoder_only_bas": [9, 16, 19], "decoderwithscan": 9, "appli": [9, 11, 14, 17, 18, 25, 30, 31, 36], "dimens": [9, 14, 15, 34, 35], "carri": [9, 24, 33, 34], "along": [9, 14, 18, 30, 35], "fn": [9, 14], "callabl": [9, 14, 30], "tupl": [9, 10, 14, 24, 29, 31, 33, 35], "init": [9, 13, 17, 27, 28, 29], "xs": [9, 14, 31, 34, 35], "roughli": [9, 38], "equal": [9, 35, 38], "ys": 9, "len": [9, 14, 20], "append": [9, 19], "scan_exampl": 9, "scan_example_cumsum": 9, "cumul": [9, 18, 29], "sum": [9, 11, 14, 30, 31], "scan_example_pytre": 9, "pytre": 9, "final": [9, 18, 27, 34, 38], "histori": 9, "15": [9, 21, 38], "count": [9, 14, 19], "mean": [9, 13, 14, 15, 16, 17, 18, 19, 20, 23, 24, 27, 31, 33, 34], "0000": 9, "5000": 9, "figur": [9, 11, 15, 35], "repe": 9, "bound": 9, "compar": [9, 13, 17, 19, 27, 28, 29], "overhead": [9, 13, 16, 18, 26, 27, 28], "especi": [9, 13, 14, 16, 21, 22, 28, 34], "finish": [9, 14, 18, 23], "9m35": 9, "4m59": 9, "hidden": 9, "num": 9, "head": 9, "512": [9, 35], "500": 9, "metric": [9, 14, 27], "is_fn_pur": 9, "is_layer_pur": 9, "final_carri": 9, "init_scan": 9, "xs_scan": 9, "input_data": 9, "traceabl": [9, 11], "particular": [9, 21, 23], "palla": [9, 12], "incompat": 9, "save": [9, 14, 19, 22, 26, 30, 36], "chip": [9, 13, 16], "256": [9, 13], "50": [9, 19, 21, 29], "2048": [9, 13], "compiletim": [9, 19], "totalsampl": [9, 19], "accumul": [9, 14, 22], "02m57s694ms418": 9, "595u": 9, "valuer": [9, 19], "02s112ms586": 9, "097u": 9, "rate": [9, 19, 27], "054285": 9, "percentil": [9, 19], "023ms113": 9, "470u": 9, "10": [9, 13, 14, 17, 19, 21, 24, 26, 27, 28, 29, 32, 33, 36, 38], "20": [9, 15, 17, 19, 27, 32, 38], "54s644ms733": 9, "284u": 9, "80": [9, 19], "01m03s028ms571": 9, "841u": 9, "90": [9, 19], "95": [9, 19], "99": [9, 19, 27], "29s996ms941": 9, "409u": 9, "02s529ms591": 9, "388u": 9, "158152": 9, "018ms636": 9, "571u": 9, "11s983ms003": 9, "171u": 9, "18s995ms301": 9, "667u": 9, "maximum": [9, 14, 15, 23, 32], "1m03": 9, "19": [9, 27, 28, 38], "7253": 9, "comment": [9, 24, 33], "accomplish": 10, "exportedprogram": 10, "fx": [10, 28], "exported_program_to_stablehlo": 10, "mlir": 10, "torchvis": [10, 16, 28], "torchax": 10, "tx": 10, "resnet18": [10, 16, 28], "sample_input": 10, "224": [10, 16], "mlir_modul": 10, "store": [10, 14, 19], "feel": [10, 19, 27], "explor": [10, 22], "org": [10, 13, 14, 30], "tutori": [10, 14, 19, 21, 27, 34, 38], "jfunc": 10, "shapeddtypestruct": 10, "float32": [10, 25, 38], "last": [10, 19, 35, 38], "constant": [10, 19, 20, 34], "convent": 10, "ed": 10, "appear": [10, 17, 19, 23], "paramt": 10, "jfunc_inlin": 10, "scaled_dot_product_attent": 10, "decompos": 10, "low": [10, 15, 19, 38], "dure": [10, 14, 18, 19, 20, 23, 28, 30, 34], "captur": [10, 14, 16, 18, 19, 20, 21, 23], "downstream": [10, 25], "ml": [10, 35, 38], "crucial": [10, 16, 18], "geneart": 10, "pattern": [10, 19, 24, 28, 33], "challeng": 10, "prone": 10, "robust": 10, "outlin": [10, 32], "pratic": 10, "scaled_product_attent": 10, "centric": 10, "unittest": 10, "nn": [10, 13, 14, 17, 27, 28, 30, 32, 34], "impl_abstract": 10, "jaten": 10, "jlibrari": 10, "mylib": 10, "basic": [10, 16, 17, 24, 27, 33], "sdpa": 10, "compositeexplicitautograd": 10, "_mylib_scaled_dot_product_attent": 10, "product": [10, 14, 38], "transpos": [10, 24, 33], "dropout_p": 10, "is_caus": 10, "_mylib_scaled_dot_product_attention_meta": 10, "empty_lik": 10, "decomposit": 10, "register_torch_composit": 10, "softmax": 10, "register_jax_composit": 10, "_aten_softmax": 10, "_softmax": 10, "static_argnum": 10, "librarytest": 10, "testcas": 10, "manual_se": [10, 13, 14], "default_env": 10, "use_torch_native_for_cpu_tensor": 10, "test_basic_sdpa_librari": 10, "customopexampl": 10, "rand": [10, 24, 33, 38], "32": [10, 14, 19, 22, 23, 35], "64": [10, 16, 28, 30], "module_str": 10, "todo": 10, "produc": [10, 18, 24, 25, 27, 33], "assertin": 10, "__name__": [10, 13, 17, 27], "__main__": [10, 13, 17, 27], "emit": 10, "repres": [10, 13, 14, 24, 33, 38], "region": [10, 14, 19, 25, 34], "th": [10, 35], "xla_model": [11, 12, 13, 17, 18, 19, 21, 25, 27, 28, 29, 30, 31, 32, 35], "adopt": [11, 24, 33], "reimplement": [11, 13], "_c10d_function": 11, "all_reduc": [11, 14], "processgroupxla": 11, "deriv": 11, "processgroup": 11, "xla_backend": [11, 13, 27, 36], "_create_xla_process_group": 11, "prefix_stor": 11, "rank": [11, 13, 14, 27, 30, 35, 36], "timeout": 11, "assert": [11, 27, 38], "xr": [11, 13, 14, 17, 27, 30, 31, 34, 35, 36], "is_spmd": [11, 14], "spmd": [11, 12, 17, 20, 26, 36], "group": [11, 13, 14, 27, 34], "_register_xla_backend": 11, "dist": [11, 13, 27, 36], "register_backend": 11, "allreduc": 11, "all_reduce_opt": 11, "allgath": 11, "output_tensors_list": 11, "input_tensor": 11, "opt": [11, 17], "_mp_fn": [11, 13, 17], "init_process_group": [11, 13, 27, 36], "init_method": [11, 13, 36], "progress": [11, 21], "blob": [11, 13, 14], "distributed_c10d": 11, "_exception_logg": 11, "all_gath": [11, 13, 14], "tensor_list": 11, "async_op": 11, "_get_default_group": 11, "remap": 11, "_functional_collect": 11, "all_reduce_inplac": 11, "eventu": 11, "reach": [11, 14, 38], "rewrit": [11, 23, 24, 33, 34], "reduceop": 11, "group_nam": 11, "torch_library_impl": 11, "four": [11, 20], "align": [11, 16], "signatur": 11, "remain": [11, 17, 21, 24, 33, 37], "restrict": 11, "usag": [11, 14, 16, 19, 23, 24, 30, 31, 33, 36], "test_collective_ops_tpu": 11, "scenario": [11, 18, 22, 28], "reduct": [11, 14], "aggreg": 11, "all_gather_into_tensor": 11, "gather": [11, 14, 19, 34], "reduce_scatter_tensor": 11, "across": [11, 12, 13, 14, 16, 17, 19, 30, 31, 35], "all_to_all_singl": 11, "output_split_s": 11, "input_split_s": 11, "although": [11, 13, 24, 33, 38], "accept": [11, 34], "argument": [11, 14, 18, 21, 25, 26, 28, 30], "1s": 11, "limit": [11, 13, 14, 17], "reflect": [11, 18, 35], "compromis": 11, "maintain": [11, 12, 38], "constraint": [11, 13, 19], "alltoal": [11, 14], "high": [12, 14, 15, 22, 27, 32, 38], "job": [12, 14, 20, 28], "thousand": [12, 13], "mfu": 12, "hardwar": [12, 14, 16, 19, 21, 25], "__version__": [12, 19], "overview": 12, "analysi": [12, 21, 28], "topic": [12, 22, 35], "control": [12, 14, 15, 17, 19, 34], "mxu": 12, "float": [12, 14, 24, 25, 33], "precis": [12, 14], "checkpoint": [12, 13, 20, 22, 30, 35], "ddp": [12, 13], "shard": [12, 14, 36], "fsdp": [12, 14, 34, 35], "One": [12, 14, 15, 17, 20], "stablehlo": [12, 14], "mix": [12, 14, 35], "torchdynamo": 12, "quantiz": 12, "repeat": [12, 22], "layer": [12, 15, 16, 26, 30, 31, 34], "scan": 12, "scan_lay": 12, "while_loop": 12, "assume_pur": 12, "eager": [12, 14, 18, 24, 27, 32, 33], "mode": [12, 14, 18, 24, 27, 32, 33, 34, 36, 38], "recompil": [12, 15, 16, 17, 19, 20], "bazel": 12, "plugin": [12, 13, 22], "encount": [13, 17, 19], "bug": [13, 19, 27], "tag": [13, 14], "r2": [13, 19, 34], "renam": 13, "torchrun": [13, 17, 37], "xpu": 13, "neuron": [13, 17], "xrt_tpu_config": 13, "impact": [13, 14, 16, 19, 24, 27, 33, 38], "30": [13, 30], "preview": 13, "thread": [13, 14, 17, 19, 36], "safe": 13, "section": [13, 17, 19, 21, 23, 34, 35], "broadcast": 13, "replica": [13, 14], "broadcast_master_param": 13, "random": [13, 14, 16, 20, 26, 32, 38], "global": [13, 14, 17, 26, 34, 36], "rng": [13, 14], "pjrt_backend": 13, "v4": [13, 14, 16, 17, 20, 21, 22, 23, 28, 34], "distributeddataparallel": 13, "parallel_load": [13, 14, 17, 19], "global_ordin": [13, 14, 17, 27, 30], "world_siz": [13, 14, 27, 30, 34], "42": [13, 26], "gradient_as_bucket_view": [13, 27], "loss_fn": [13, 16, 17, 25, 27, 28], "mseloss": [13, 27], "sgd": [13, 17, 25, 27, 28], "lr": [13, 17, 27, 28, 30, 31], "001": [13, 27], "zero_grad": [13, 16, 17, 25, 27], "loss": [13, 16, 17, 25, 28, 30, 31, 38], "confirm": 13, "p": [13, 19, 24, 33, 38], "localservic": 13, "localhost": 13, "51011": 13, "master_addr": 13, "master_port": 13, "12355": [13, 37], "Or": [13, 17, 24, 33], "grpc": 13, "torchbench": 13, "observ": [13, 16, 27], "35": [13, 19], "copi": [13, 14, 17, 19, 21], "worker": [13, 14, 17, 21, 22, 30, 31, 36], "tpuvm": [13, 17, 22, 34], "learn": [13, 16, 22, 35, 38], "mnist": [13, 17, 19, 25], "test_train_mp_mnist": [13, 27], "fake_data": [13, 19, 27, 37], "alpha": [13, 17], "central2": [13, 22], "b": [13, 14, 18, 22, 24, 25, 26, 28, 33, 35], "resnet50": [13, 16, 17, 28, 30], "git": [13, 19, 21, 30], "depth": [13, 19], "branch": [13, 19, 24, 33], "test_train_mp_imagenet": [13, 19, 27], "batch_siz": [13, 30, 37], "num_epoch": [13, 27, 30], "By": [13, 14, 21, 24, 33, 38], "tpu_process_bound": 13, "tpu_visible_chip": 13, "r1": 13, "13": [13, 17, 27, 29], "docker_imag": 13, "gcr": 13, "io": [13, 30], "privat": 13, "sudo": [13, 22], "rm": 13, "privileg": 13, "net": [13, 23, 25], "mostli": [13, 30], "interchang": 13, "perspect": [13, 17], "subtl": 13, "importantli": [13, 26], "architectur": [13, 30], "spawn": [13, 14, 17, 21], "server": [13, 14, 23], "thu": [13, 16, 18, 19], "batch": [13, 17, 19, 20, 21, 23, 34], "latenc": 13, "serial": [13, 17], "deseri": 13, "send": [13, 17, 20, 21, 34], "constrain": [13, 14], "direct": [13, 18, 19], "independ": [13, 16, 17, 19], "plan": 13, "xla_dist": 13, "scp": [13, 17], "sdk": 13, "enhanc": [13, 16], "stabil": [13, 19, 25], "xmp": [13, 17, 21], "ident": 13, "substanti": 13, "mesh": [13, 14, 31], "master": [13, 14, 17, 36], "connect": [13, 14, 34], "practic": [13, 16, 24, 31, 33, 35], "unreli": 13, "due": [13, 16, 19, 20, 23, 37, 38], "inbound": 13, "could": [13, 20, 24, 33, 34, 38], "failur": 13, "forc": [13, 14, 19, 24, 29, 33], "entir": [13, 30], "restart": 13, "much": [13, 17, 20, 21, 23, 24, 26, 28, 33], "impos": 13, "payload": [13, 14], "transfer": [13, 14, 18, 19, 23, 34], "middl": [13, 23, 24, 33], "unwant": 13, "permit": 13, "subset": [13, 35], "particip": [13, 14], "old": 13, "alter": 13, "synchron": [13, 16, 17, 22, 34, 36], "barrier": [13, 14, 17, 18, 21], "all_gather_object": 13, "gloo": [13, 27, 36], "new_group": 13, "subgroup": 13, "monitor": 13, "context": [13, 14, 16, 19, 24, 25, 33], "altern": [13, 22, 24, 25, 32, 33], "less": [13, 24, 28, 33, 38], "than": [13, 19, 24, 27, 30, 33, 38], "perf": [13, 24, 33], "md": [13, 14], "strongli": 13, "_all_gath": 13, "int": [13, 14, 24, 26, 33, 34, 38], "int32": 13, "zeros_lik": 13, "_": [13, 18, 28, 29], "get_world_s": 13, "pjrt_distribut": 13, "averag": 13, "task": [13, 16], "175": 13, "chart": 13, "breakdown": 13, "tfrt": 13, "legaci": 13, "streamexecutor": 13, "tpu_legaci": 13, "happen": [13, 14, 16, 17, 19, 20, 21, 23, 24, 33], "comparison": [13, 35], "given": [14, 19, 20, 24, 26, 27, 30, 33, 35, 38], "device_count": [14, 34], "address": [14, 16, 34, 37], "wait": [14, 18, 19, 23], "reset_scop": 14, "pend": [14, 18], "whether": [14, 17, 25], "block": [14, 18, 30, 34], "reset": 14, "scopecontext": 14, "full_graph": [14, 16], "max_different_graph": 14, "lazytensor": [14, 20, 22], "decid": [14, 19, 24, 26, 33], "funciton": 14, "act": [14, 17, 22], "throw": [14, 17], "exit": [14, 19, 25, 27], "pt_xla_debug": 14, "messag": [14, 17, 19], "dump": [14, 19], "allow": [14, 17, 19, 21, 22, 23, 25, 34, 35, 36, 38], "rais": [14, 19, 38], "exceed": 14, "foo": 14, "sin": [14, 26], "co": 14, "foo2": 14, "compiled_foo2": 14, "seed": 14, "integ": [14, 19, 35], "subpackag": 14, "mp": 14, "etc": [14, 19, 24, 33, 34], "set_mat_mul_precis": [14, 38], "liter": 14, "highest": [14, 36, 38], "mat": [14, 38], "conv": 14, "32bit": 14, "matrix": [14, 17, 18, 38], "convolut": 14, "trade": [14, 20, 24, 33], "accuraci": [14, 27, 30, 38], "fastest": 14, "downcast": 14, "fp32": 14, "bf16": [14, 38], "multipli": [14, 17, 35, 38], "three": [14, 17, 38], "approxim": 14, "14": 14, "slowest": 14, "six": [14, 38], "22": [14, 27], "precision_tutori": 14, "empir": [14, 38], "behav": [14, 19, 38], "get_mat_mul_precis": 14, "device_typ": 14, "local_process_count": 14, "local_device_count": 14, "total": [14, 18, 24, 33, 35, 38], "addressable_device_count": 14, "visibl": [14, 24, 33], "global_device_count": 14, "global_runtime_device_count": [14, 31, 34, 35], "ordin": [14, 17], "guarante": [14, 18, 26], "predict": 14, "relationship": [14, 17, 19], "nor": 14, "contigu": [14, 17, 19], "local_ordin": 14, "get_master_ip": 14, "retriev": [14, 17, 24, 28, 33, 34, 35, 38], "discoveri": 14, "use_spmd": [14, 34, 35, 36], "non": [14, 16, 24, 25, 26, 33, 35], "replic": [14, 34, 35], "spmd_advanc": 14, "initialize_cach": [14, 17], "readonli": [14, 17], "persist": [14, 17, 36], "xla_devic": 14, "devkind": 14, "deprec": 14, "xla_device_hw": 14, "union": 14, "real": [14, 28], "is_master_ordin": 14, "multi": [14, 15, 27, 34, 37], "num_host": 14, "boolean": 14, "reduce_typ": 14, "pin_layout": 14, "xm": [14, 17, 19, 21, 25, 27, 28, 29, 30, 31, 32, 35], "reduce_sum": 14, "reduce_mul": 14, "reduce_and": 14, "reduce_or": 14, "reduce_min": 14, "reduce_max": 14, "layout": [14, 22, 32, 35], "pine": 14, "potenti": [14, 17, 19], "corrupt": 14, "unpin": 14, "hlomodul": 14, "hold": [14, 34], "channel_id": 14, "use_global_device_id": 14, "channel": [14, 32], "replicagroup": 14, "all_to_al": 14, "split_dimens": 14, "concat_dimens": 14, "split_count": 14, "www": 14, "operation_semant": 14, "upon": 14, "split": [14, 35], "concat": 14, "add_step_closur": 14, "closur": 14, "run_async": 14, "report": 14, "consol": 14, "tensorboard": [14, 23], "intermediari": 14, "inspect": [14, 38], "materi": [14, 18, 19, 20, 24, 33, 34], "queu": 14, "though": [14, 17, 27], "advis": 14, "throttl": 14, "event": 14, "asynchron": [14, 18, 34, 36], "wait_device_op": 14, "async": [14, 28], "whose": [14, 15, 35], "optimizer_step": [14, 17, 18, 20, 25, 27, 30], "optimizer_arg": 14, "dict": [14, 26, 30], "gradid": 14, "parallelload": [14, 34], "dataparallel": 14, "loader": [14, 18, 19, 21, 28], "dictionari": 14, "gradient": [14, 17, 18, 25, 30, 36], "file_or_path": 14, "textio": 14, "master_onli": [14, 30], "global_mast": 14, "care": [14, 17, 19, 24, 33], "taken": [14, 17, 18, 19, 24, 27, 33, 36], "view": [14, 17, 19], "recreat": [14, 17], "destin": [14, 17], "nest": [14, 30], "obj_to_sav": 14, "path_to_sav": 14, "rendezv": 14, "byte": 14, "xla_rendezv": 14, "sent": [14, 18, 19], "exchang": 14, "posit": 14, "mesh_reduc": 14, "reduce_fn": 14, "toxlatensorarena": 14, "receiv": 14, "np": [14, 31, 35], "test_accuraci": 14, "set_rng_stat": 14, "get_rng_stat": 14, "get_memory_info": 14, "memoryinfo": 14, "bytes_us": 14, "290816": 14, "bytes_limit": 14, "34088157184": 14, "peak_bytes_us": 14, "500816": 14, "get_stablehlo": 14, "var": [14, 34], "xla_hlo_debug": [14, 19], "get_stablehlo_bytecod": 14, "bytecod": [14, 28], "mpdeviceload": [14, 17, 20, 21, 34], "kwarg": [14, 30, 34], "dataload": [14, 16, 17, 27, 34, 36], "background": [14, 36], "upload": [14, 23, 34], "per_device_load": [14, 34], "constructor": 14, "train_device_load": 14, "train_load": [14, 17, 34], "xla_multiprocess": 14, "nproc": 14, "daemon": 14, "start_method": 14, "moment": 14, "valueerror": [14, 38], "mark_shard": [14, 26, 31, 34, 35], "xlashardedtensor": [14, 36], "partition_spec": [14, 34, 35], "nonetyp": 14, "annot": [14, 34], "partit": [14, 34], "spec": [14, 34], "intern": [14, 16, 17, 18, 19, 24, 33, 34, 37, 38], "spmdpartition": [14, 34], "topolog": [14, 17, 34], "partitionspec": 14, "ax": [14, 34, 35], "element": [14, 24, 31, 33, 34, 35, 38], "axi": [14, 31, 35], "mesh_shap": [14, 31, 34, 35], "num_devic": [14, 31, 34, 35], "device_id": [14, 31, 34, 35], "clear_shard": 14, "clear": [14, 16], "cast": [14, 25], "t1": [14, 17, 19, 35], "get_1d_mesh": 14, "set_global_mesh": 14, "get_global_mesh": 14, "axis_nam": [14, 34], "ndarrai": 14, "flatten": 14, "reshap": 14, "fill": 14, "row": [14, 35], "major": [14, 22, 35], "global_runtime_device_attribut": [14, 35], "length": [14, 24, 33], "get_xla_supported_devic": 14, "get_logical_mesh": [14, 35], "ordereddict": [14, 34, 35], "hybridmesh": [14, 34], "ici_mesh_shap": [14, 34], "dcn_mesh_shap": [14, 34], "hybrid": 14, "ici": 14, "dcn": [14, 34], "increas": [14, 26], "intens": 14, "mdl": 14, "inner": [14, 30, 34], "outer": [14, 30, 31, 34], "slice": [14, 20, 21, 34, 35], "eager_mod": [14, 16], "d": [14, 24, 25, 33], "eagerli": [14, 16, 17, 19, 24, 33], "metrics_report": [14, 19], "short_metrics_report": [14, 19], "counter_nam": 14, "metric_nam": 14, "counter_valu": 14, "metric_data": 14, "total_sampl": 14, "retain": 14, "circular": 14, "buffer": [14, 26], "in_tensor": 15, "randint": [15, 32], "out_tensor": 15, "nonzero": [15, 19, 21, 23, 24, 33, 38], "word": [15, 24, 26, 33], "25": 15, "further": [15, 20, 21, 23, 27], "categor": 15, "unbound": 15, "alloc": [15, 35], "infinit": [15, 31, 38], "phase": [15, 16], "perceptron": 15, "mlp": 15, "xla_experiment": 15, "masked_select": 15, "masked_scatt": 15, "your_script": [15, 21], "100": [15, 19, 26, 30], "29": [15, 27, 28], "49": [15, 28], "03": 15, "102": 15, "hit": [15, 24, 33], "198": 15, "1953": 15, "motiv": 15, "excess": 15, "half": [15, 38], "try": [15, 19, 21, 23, 24, 33], "ds": 15, "test_dynamic_shape_model": 15, "testdynamicshapemodel": 15, "test_backward_pass_with_dynamic_input": 15, "deep": [16, 19], "record": [16, 17, 18, 19, 22, 26], "defer": [16, 17, 18], "approach": [16, 17, 18, 24, 27, 30, 33, 38], "usabl": 16, "ambigu": 16, "struggl": 16, "distinguish": 16, "whenev": 16, "preprocess": [16, 32], "expens": [16, 19, 24, 33], "difficulti": 16, "opaqu": [16, 17, 19], "natur": 16, "shift": 16, "priorit": 16, "preserv": [16, 17, 19], "immedi": [16, 17, 18, 22, 34], "flexibl": [16, 32], "decor": [16, 26], "mark": 16, "boundari": 16, "feedback": 16, "outsid": [16, 17], "leak": 16, "catch": [16, 17], "accident": 16, "compiled_model": 16, "awai": [16, 18], "summar": [16, 25], "temporarili": 16, "resum": [16, 30], "abstract": [16, 32, 34], "balanc": 16, "distinct": [16, 18], "workflow": [16, 17, 22], "advantag": [16, 17, 21, 22], "enclos": 16, "step_fn": 16, "logit": [16, 31], "aim": [16, 22, 24, 33], "quantifi": 16, "conduct": 16, "llama2": 16, "fake": [16, 36], "300": [16, 19], "measur": [16, 23], "clearli": 16, "illustr": [16, 20, 21, 23], "147": 16, "65": [16, 19], "tradit": [16, 28], "45": 16, "li": 16, "throughput": 16, "regular": [17, 19, 32], "t0": 17, "mm": [17, 25, 38], "neural": [17, 38], "l_in": 17, "l_out": 17, "floattensor": 17, "highlight": [17, 20], "nllloss": 17, "momentum": 17, "acquir": 17, "distribut": [17, 19, 22, 26, 30, 31, 34, 35], "mp_device_load": 17, "multithread": [17, 19], "assign": [17, 18, 21], "own": [17, 30], "onto": [17, 20], "preload": [17, 20], "overlap": [17, 23, 28, 34], "batches_per_execut": 17, "consolid": [17, 30], "all_reduce_gradi": 17, "parent": 17, "talk": 17, "howto": 17, "focu": [17, 22, 24, 33], "train_mnist_xla": 17, "16": [17, 22, 30, 32, 35], "infrastructur": 17, "awar": 17, "regard": [17, 28], "fakedata": 17, "fuse": [17, 20], "invis": 17, "caller": 17, "insert": [17, 23], "paper": 17, "unlik": [17, 20], "appreci": 17, "accommod": 17, "previous": 17, "state_dict": [17, 30, 36], "footprint": 17, "xser": 17, "stream": 17, "amount": [17, 19, 20, 24, 33], "restor": 17, "load_state_dict": [17, 36], "unavail": [17, 19], "aw": 17, "occur": [17, 38], "evalu": [17, 19, 20, 21, 22, 24, 26, 33], "fix": [17, 19, 20, 23, 26, 28, 31], "incorrectli": 17, "solut": [17, 19, 24, 32, 33, 38], "feed": 17, "testmodel": 17, "__init__": [17, 26, 27, 32], "super": [17, 26, 27], "pre": 17, "determin": 17, "warn": [17, 19, 38], "pt_xla_debug_level": [17, 19], "_set_allow_execut": 17, "earli": [17, 24, 33], "relat": [17, 21], "troubleshoot": 17, "consum": [17, 24, 33], "doesn": [17, 18, 19, 24, 31, 33], "disk": 17, "your_cache_path": 17, "mount": 17, "mp_fn": 17, "tmp": [17, 19, 30], "xla_cache_": 17, "runnabl": [17, 27, 31], "essenti": [18, 38], "emploi": 18, "primarili": 18, "side": [18, 24, 26, 33], "period": [18, 23], "spend": [18, 20], "durat": [18, 23, 36], "conceptu": [18, 35, 38], "start_tim": 18, "perf_count": 18, "matmul": [18, 25, 38], "incorrect": 18, "end_tim": 18, "elapsed_tim": 18, "predominantli": 18, "took": 18, "actual": [18, 21, 22, 24, 27, 33, 34], "devid": 18, "exemplifi": 18, "warm": 18, "translat": [18, 19], "isol": 18, "steadi": 18, "benchmark": 18, "isn": [18, 24, 33, 36], "exclud": 18, "sever": 18, "item": [18, 19, 21, 23, 38], "condition": 18, "often": [18, 19, 22, 24, 26, 33], "unlazi": 18, "structur": [18, 30, 34], "run_model": 18, "start_loop_tim": 18, "num_step": 18, "FOR": 18, "end_loop_tim": 18, "elapsed_loop_tim": 18, "spent": [18, 19], "largli": 18, "proce": [18, 24, 33], "inclus": 18, "lag": 18, "behind": 18, "run_model_step": 18, "subject": 19, "peculiar": 19, "detial": 19, "cu121": 19, "t2": [19, 35], "200": 19, "nightli": [19, 22, 30, 34], "rx": 19, "conclud": 19, "diagnos": 19, "extrem": [19, 26], "slip": 19, "analyz": [19, 23], "summari": 19, "frequent": 19, "21": 19, "11": [19, 24, 33], "transferfromdevicetim": 19, "23": [19, 38], "12": [19, 28, 30], "hash": 19, "c74c3b91b855b2b123f833b0d5f86943": 19, "107": 19, "frame": 19, "dk3": 19, "1055": 19, "44": 19, "__next__": 19, "train_loop_fn": 19, "48": [19, 27], "start_train": 19, "73": 19, "548000": 19, "gb": 19, "922460": 19, "alias": [19, 25], "547871": 19, "124478": 19, "028210": 19, "cal": 19, "steptrac": 19, "tri": [19, 21], "mark_step": 19, "frequenc": 19, "pair": 19, "met": 19, "destroi": 19, "202": 19, "06m09s401ms746": 19, "001u": 19, "778ms572": 19, "062u": 19, "425201": 19, "001ms32": 19, "778u": 19, "001ms61": 19, "283u": 19, "001ms79": 19, "236u": 19, "001ms110": 19, "973u": 19, "001ms228": 19, "773u": 19, "001ms339": 19, "183u": 19, "001ms434": 19, "305u": 19, "002ms921": 19, "063u": 19, "21s102ms853": 19, "173u": 19, "cachedsynctensor": 19, "395": [19, 27], "area": 19, "rout": 19, "qualifi": 19, "33": [19, 27, 28], "_local_scalar_dens": 19, "epoch": [19, 21, 30], "clear_al": 19, "xla_dynamo_debug": 19, "bottleneck": [19, 20, 21, 23, 26], "notebook": [19, 38], "train_resnet_benchmark": 19, "bad": 19, "degrad": [19, 21], "speedup": [19, 28], "indirect": 19, "mask": [19, 24, 33], "variat": 19, "pad": [19, 20, 24, 33, 35], "ask": [19, 24, 33], "substitut": 19, "flow": 19, "clip_grad_norm": 19, "problemat": 19, "clip_grad_norm_": 19, "dramat": 19, "total_norm": 19, "zero": [19, 30, 36], "param_norm": 19, "grad": 19, "norm": [19, 38], "norm_typ": 19, "add_": 19, "clip_coef": 19, "max_norm": 19, "1e": [19, 28], "mul_": 19, "data_parallel": 19, "dataset": [19, 27, 30], "small": [19, 20, 23, 24, 27, 28, 33], "stride": 19, "reconstruct": 19, "shallow": 19, "ty": 19, "made": [19, 21, 23, 24, 33], "_get_xla_tensors_text": [19, 24, 33], "_get_xla_tensors_hlo": 19, "prior": [19, 36], "degre": 19, "xla_ir_debug": 19, "henc": [19, 28], "respons": [19, 20, 28, 36], "propag": 19, "xla_save_tensors_fil": 19, "realli": [19, 24, 33], "big": [19, 24, 33, 38], "sheet": 19, "xla_save_tensors_fmt": 19, "graphviz": 19, "xla_flag": 19, "xla_dump_to": 19, "dir_nam": 19, "unoptim": 19, "optimz": 19, "xla_metrics_fil": 19, "xla_save_hlo_fil": 19, "offend": 19, "xla_sync_wait": 19, "xla_use_eager_debug_mod": 19, "bypass": 19, "overal": [19, 23], "optimizaiton": 19, "tf_cpp_log_thread_id": 19, "tf_cpp_vmodul": 19, "vlog": 19, "form": [19, 24, 33, 37], "tf_cpp_min_log_level": 19, "tf_vlog": 19, "xla_dump_hlo_graph": 19, "xla_util": 19, "save1": 19, "xla_graph_executor": 19, "pjrt_computation_cli": 19, "dir": 19, "pytorch_test_with_slow": 19, "test_torch": 19, "test_put_xla_uint8": 19, "torch_test_devic": 19, "pytorch_test_bas": 19, "fed": 20, "pod": [20, 22], "attach": [20, 34], "callback": [20, 21], "xla_tensor_z": 20, "cut": [20, 24, 33], "transferfromdevic": [20, 23], "tell": [20, 24, 33], "properti": [20, 24, 33], "suppos": 20, "tensors_on_devic": 20, "z": [20, 24, 33, 38], "subgraph": [20, 24, 33], "signal": 20, "far": 20, "fusion": [20, 22], "worth": [20, 24, 33], "magic": [20, 24, 33], "treat": [20, 35], "xla_no_special_scalar": 20, "guidelin": 21, "rememb": 21, "txt2img": 21, "prompt": 21, "photograph": 21, "astronaut": 21, "ride": 21, "hors": 21, "modif": [21, 22], "ldm": 21, "ddim": 21, "precision_scop": 21, "addition": [21, 25, 30], "frozenclipembedd": 21, "simplic": [21, 24, 33], "top": 21, "attr": 21, "statement": [21, 24, 33], "bar": 21, "stop": 21, "fall": [21, 31], "difficult": 21, "discuss": 21, "investig": [21, 23, 27, 38], "cover": [21, 34], "huggingfac": 21, "sd": 21, "xl": [21, 23], "cd": [21, 30], "text_to_imag": 21, "inference_tpu_single_devic": 21, "lora": 21, "model_id": 21, "stabilityai": 21, "9": [21, 24, 27, 30, 33, 38], "pipelin": [21, 23], "dpmsolvermultistepschedul": 21, "txt": 21, "invisible_watermark": 21, "safetensor": 21, "agre": 21, "licens": 21, "card": 21, "cli": 21, "_your_copied_token__": 21, "pipe": 21, "hour": 21, "wherea": 21, "likewis": 21, "gpt": 21, "min": 21, "mayb": 21, "notic": [21, 38], "piec": 21, "__call__": 21, "caveat": [21, 23], "unnecessari": [21, 26, 34], "communit": 21, "my_funct": 21, "debug_single_process": 21, "tpu_nam": [21, 22], "hypercomput": 21, "recip": 21, "algebra": 22, "research": [22, 38], "massiv": 22, "inferenc": 22, "frontend": [22, 24, 33], "readabl": 22, "opcod": 22, "seri": 22, "highli": 22, "tailor": 22, "deeper": 22, "dive": 22, "deliv": 22, "tackl": 22, "ambiti": 22, "know": [22, 24, 26, 27, 33], "love": 22, "smooth": 22, "minor": [22, 38], "compel": 22, "price": 22, "ratio": 22, "focus": 22, "theoret": [22, 24, 33], "v5": 22, "v6": 22, "nvidia": [22, 37, 38], "runtime_vers": 22, "project_id": 22, "accelerator_typ": 22, "your_tpu_nam": 22, "subnetwork": 22, "tpusubnet": 22, "pip3": 22, "cp38": 22, "linux_x86_64": 22, "whl": 22, "apt": 22, "libopenbla": 22, "libgl1": 22, "diffus": [22, 23], "advanc": [22, 35], "concept": [22, 34, 35], "thumb": 23, "constantli": 23, "idl": 23, "inference_tpu_": 23, "capture_profil": 23, "gap": 23, "xp": 23, "u": 23, "portion": 23, "busi": 23, "scroll": 23, "occupi": 23, "latter": [23, 30], "largest": 23, "zoom": 23, "timelin": 23, "examin": 23, "did": 23, "pipe_watermark": 23, "closer": 23, "preced": 23, "proceed": [23, 31], "watermark": 23, "cv2": 23, "pywt": 23, "leav": 23, "broken": 23, "rerun": 23, "scale_model_input": 23, "dynamo": [23, 28, 32], "hurt": [24, 33], "hard": [24, 27, 28, 33], "pov": [24, 33], "sai": [24, 33], "assur": [24, 33], "gone": [24, 33], "coverag": [24, 33], "explan": [24, 33], "mainli": [24, 33], "beginn": [24, 33], "propos": [24, 33], "reli": [24, 33], "impract": [24, 33], "assumpt": [24, 33], "ye": [24, 32, 33], "sentenc": [24, 33], "bucket": [24, 33, 36], "kinda": [24, 33], "anti": [24, 33], "matter": [24, 33], "workaround": [24, 33], "okai": [24, 33], "teach": [24, 33], "sort": [24, 33], "obviou": [24, 33], "s64": [24, 33], "inde": [24, 33], "_get_xla_tensor_dimension_s": [24, 33], "commonli": [24, 33], "wrong": [24, 33], "wors": [24, 33], "upper": [24, 33], "nit": [24, 33], "solv": [24, 33], "kept": [24, 33], "accessor": [24, 33], "2d": [24, 31, 33, 35], "implicitli": [24, 33], "doubl": [24, 33, 38], "overload": [24, 33], "IS": [24, 33], "explod": [24, 33], "convers": [24, 33], "cheap": [24, 33], "ve": [24, 33], "hoc": [24, 33], "think": [24, 33], "verison": [24, 33], "bla": [24, 33], "blabla": [24, 33], "uglier": [24, 33], "win": [24, 33], "pars": [24, 33], "torchscript": [24, 33], "somehow": [24, 33], "merg": [24, 33], "lazili": [24, 33, 34, 36], "properli": [24, 33], "thought": [24, 33], "trivial": [24, 33], "effort": [24, 33, 34], "why": [24, 33], "bandwidth": [24, 33], "automag": [24, 33], "gold": [24, 33], "smart": [24, 33], "trick": [24, 33], "tbh": [24, 33], "longer": [24, 33], "unawar": [24, 33], "hope": [24, 33], "smash": [24, 33], "blocker": [24, 33], "ahead": [24, 33], "nnc": [24, 33], "exactli": [24, 26, 33], "brian": [24, 33], "hirsh": [24, 33], "bdhirsh": [24, 33], "question": [24, 33], "Is": [24, 33], "stick": [24, 33], "torch_warn": [24, 33], "yea": [24, 33], "hei": [24, 33], "won": [24, 25, 33], "blaze": [24, 33], "abil": [24, 27, 33], "devirtu": [24, 33], "sound": [24, 33], "great": [24, 33], "truth": [24, 33], "irvalu": [24, 33], "enforc": [24, 33], "discrep": [24, 33], "followup": [24, 33], "1000": [24, 33], "my": [24, 33, 36], "presenc": [24, 33], "get_dimention_s": [24, 33], "didn": [24, 33], "exponenti": [24, 33], "blowup": [24, 33], "fewer": [24, 33], "opportun": [24, 33], "recogn": [24, 28, 33], "feasibl": [24, 33], "annoi": [24, 33], "wasn": [24, 33], "materiz": [24, 33], "combo": [24, 33], "extend": [25, 38], "datatyp": 25, "float16": 25, "bfloat16": [25, 32], "syncfre": 25, "autocast": 25, "es": 25, "elig": 25, "suppli": 25, "addmm": 25, "addmm_": 25, "prefer": 25, "float64": 25, "respect": [25, 35], "unlist": 25, "__matmul__": 25, "addbmm": 25, "addmv": 25, "addr": 25, "baddbmm": 25, "bmm": 25, "conv1d": 25, "conv2d": [25, 30], "conv3d": 25, "conv_transpose1d": 25, "conv_transpose2d": 25, "conv_transpose3d": 25, "relu": [25, 27], "prelu": 25, "max_pool2d": 25, "batch_norm": 25, "log_softmax": 25, "binary_cross_entropy_with_logit": 25, "prod": 25, "cdist": 25, "chloeski": 25, "invers": 25, "reflection_pad": 25, "replication_pad": 25, "mse_loss": 25, "cosine_embbeding_loss": 25, "nll_loss": 25, "multilabel_margin_loss": 25, "qr": 25, "svd": 25, "triangular_solv": 25, "linalg_svd": 25, "linalg_inv_ex": 25, "widest": 25, "index_copi": 25, "imagenet": 25, "elimin": 26, "primer": 26, "exce": 26, "math": 26, "pseudo": 26, "Such": 26, "repeatedli": 26, "do_some_math": 26, "simul": 26, "ten": [26, 29], "func": 26, "functional_cal": 26, "mymodul": [26, 34], "pure_forward": 26, "param": 26, "cached_forward": 26, "named_paramet": 26, "named_buff": 26, "unit": [26, 27, 38], "languag": 26, "testbridge_test_onli": 26, "test_trace_transformer_with_spda_attent": 26, "test_assume_pur": 26, "benchmark_iter": 26, "140": 26, "1342": 26, "24": 26, "1658": 26, "pai": 26, "front": 26, "recurs": [26, 30, 31], "minimum": [27, 30, 31, 38], "nccl": 27, "new_rank": 27, "ddp_model": 27, "launcher": 27, "demo_fn": 27, "five": 27, "sy": 27, "tempfil": 27, "cleanup": 27, "destroy_process_group": 27, "toymodel": 27, "net1": 27, "1000000": 27, "net2": 27, "demo_bas": 27, "label": 27, "run_demo": 27, "tot": 27, "statist": 27, "median": 27, "90th": 27, "deviat": 27, "cv": 27, "418": 27, "54": 27, "419": 27, "430": 27, "40": 27, "76": 27, "02": [27, 38], "97": 27, "407": 27, "60": 27, "39": 27, "seem": 27, "17864": 27, "20108": 27, "96": 27, "24351": 27, "74": 27, "5866": 27, "83": [27, 38], "10701": 27, "11770": 27, "00": 27, "14313": 27, "78": 27, "3102": 27, "92": 27, "41": [27, 28], "round": [27, 38], "heavili": 27, "sens": 27, "amort": 27, "logdir": 27, "o": 27, "converg": 27, "caution": 27, "known": 27, "crash": 27, "unmodifi": 28, "hook": 28, "biggest": [28, 30], "torchfx": 28, "technolog": 28, "a_xla": 28, "b_xla": 28, "compiled_cod": 28, "eval_model": 28, "xla_resnet18": 28, "eval": 28, "dynamo_resnet18": 28, "no_grad": 28, "resnet": [28, 37], "18": 28, "bench": 28, "59": 28, "resnext50_32x4d": 28, "91": 28, "alexnet": 28, "28": 28, "mobilenet_v2": 28, "62": 28, "mnasnet1_0": 28, "68": 28, "vgg16": 28, "bert_pytorch": 28, "squeezenet1_1": 28, "timm_vision_transform": 28, "52": 28, "geomean": 28, "04": 28, "train_model": 28, "crossentropyloss": 28, "pred": 28, "train_model_main": 28, "dynamo_train_model": 28, "xla_optim": 28, "weight_decai": 28, "extract": 28, "07": 28, "43": 28, "81": 28, "87": 28, "fwd": 28, "bwd": 28, "e2": 28, "hide": 28, "larger": [28, 30], "wit": 28, "promis": 28, "expand": 28, "excit": 28, "upcom": [28, 34], "invest": 28, "_higher_order_op": 29, "fori_loop": 29, "cond_fn": 29, "body_fn": 29, "bodi": 29, "iteri": 29, "init_v": 29, "functionaltensor": 29, "lvl": 29, "51": 29, "xlafullyshardeddataparallel": 30, "my_modul": [30, 31], "adam": [30, 31], "0001": [30, 31], "leftov": [30, 31], "arxiv": 30, "1910": 30, "02054": 30, "reshard_after_forward": 30, "test_train_mp_mnist_fsdp_with_ckpt": 30, "test_train_mp_imagenet_fsdp": 30, "interleav": 30, "submodul": 30, "fsdpvitmodel": 30, "checkpoint_modul": [30, 31], "3524": 30, "auto_wrap_polici": [30, 31], "size_based_auto_wrap_polici": 30, "polici": [30, 34], "100m": 30, "transformer_auto_wrap_polici": [30, 31], "transformer_layer_cl": [30, 31], "auto_wrapper_cal": 30, "remateri": 30, "get_shard_metadata": 30, "consolidate_sharded_model_checkpoint": 30, "stitch": 30, "ckpt": 30, "shard_metadata": 30, "ckpt_path": 30, "pth": 30, "consolidate_sharded_ckpt": 30, "ckpt_prefix": 30, "your_sharded_checkpoint_fil": 30, "ckpt_suffix": 30, "_rank": 30, "inspir": 30, "fairscal": 30, "fullyshardeddataparallel": 30, "readthedoc": 30, "resort": 30, "train_resnet_fsdp_auto_wrap": 30, "newer": [30, 38], "98": 30, "drop_last": 30, "use_nested_fsdp": 30, "use_gradient_checkpoint": 30, "final_ckpt": 30, "75": 30, "download": 30, "1k": 30, "datadir": 30, "test_set_batch_s": 30, "eval_interv": 30, "num_warmup_epoch": 30, "lr_scheduler_divide_every_n_epoch": 30, "lr_scheduler_divisor": 30, "residu": 30, "algorithm": [30, 31, 38], "ronghanghu": 30, "vit_10b_fsdp_exampl": 30, "vit": 30, "review": 31, "spmd_fully_sharded_data_parallel": 31, "spmdfullyshardeddataparallel": 31, "fsdpv2": 31, "autowrap": 31, "decoderlay": 31, "functool": 31, "decoder_only_model": 31, "shard_output": 31, "0th": 31, "children": 31, "blockwis": 32, "int4": 32, "analog": 32, "classifi": 32, "choos": [32, 36], "docstr": 32, "xla_quantized_matmul": 32, "n_input_featur": 32, "n_output_featur": 32, "w_int": 32, "127": 32, "int8": 32, "scaler": 32, "matmul_output": 32, "quantized_matmul": 32, "x_xla": 32, "w_int_xla": 32, "scaler_xla": 32, "matmul_output_xla": 32, "w": 32, "f_dynamo": 32, "dynamo_out_xla": 32, "myqlinearforxlabackend": 32, "load_weight": 32, "processed_w": 32, "processed_scal": 32, "stuff": 32, "orig_model": 32, "mymodel": 32, "q_weight": 32, "q_weights_for_xla": 32, "process_for_xla": 32, "q_linear": 32, "xlaquantizedlinear": 32, "in_featur": 32, "out_featur": 32, "load_quantized_weight": 32, "sym": 32, "asym": 32, "w8a16": 32, "w8a8": 32, "w4a8": 32, "input_shard": 34, "4d": 34, "shardingspec": 34, "input_mesh": 34, "s2": 34, "s3": 34, "s4": 34, "_after": 34, "_the": 34, "forth": 34, "techniqu": 34, "physic": [34, 35, 38], "decis": 34, "nice": 34, "arrang": [34, 35], "center": 34, "multislic": 34, "denot": 34, "hardcod": 34, "rfc": [34, 37], "delai": 34, "subclass": 34, "__torch_dispatch__": 34, "global_tensor": 34, "strictli": 34, "local_shard": 34, "xlashard": 34, "ongo": 34, "distributedtensor": 34, "proof": 34, "distribute_tensor": 34, "init_device_mesh": 34, "big_tensor": 34, "100000": 34, "88": 34, "my_dtensor": 34, "stai": 34, "dynamo_mark_shard": 34, "placement": 34, "visualize_tensor_shard": 34, "visualize_shard": 34, "rich": 34, "2x2": 34, "generated_t": 34, "use_color": 34, "style": [34, 35], "tile": 34, "partial_repl": 34, "envvar": 34, "xla_auto_spmd": 34, "distribute_modul": 34, "auto_polici": 34, "device_mesh": 34, "sharded_model": 34, "behvaior": 34, "xla_auto_use_group_shard": 34, "reshard": 34, "xla_auto_spmd_mesh": 34, "unset": 34, "matric": [35, 38], "book": 35, "hint": 35, "strategi": 35, "dimension": 35, "mpi": 35, "necessarili": 35, "3d": 35, "1d": 35, "interconnect": 35, "core_on_chip": 35, "num_cor": 35, "coord": 35, "attribut": 35, "slice_index": 35, "coordin": 35, "divis": 35, "dedic": 36, "planner": 36, "spmdsaveplann": 36, "spmdloadplann": 36, "dist_cp": 36, "distributed_checkpoint": 36, "xc": 36, "storage_writ": 36, "filesystemwrit": 36, "checkpoint_dir": 36, "storage_read": 36, "filesystemread": 36, "all_step": 36, "save_async": 36, "preemption": 36, "detect": 36, "provis": 36, "queuedresourc": 36, "autocheckpoint": 36, "chkpt_on_preempt": 36, "fsspec": 36, "filesystem": 36, "prime_optim": 36, "chkpt_mgr": 36, "gs": 36, "tracked_step": 36, "best_step": 36, "prime": 36, "enumer": [36, 38], "unprim": 36, "destruct": 36, "nnode": 37, "num_gpu_machin": 37, "node_rank": 37, "rank_of_current_machin": 37, "nproc_per_nod": 37, "rdzv_endpoint": 37, "machine_0_ip_address": 37, "training_or_inference_script_using_spmd": 37, "number_gpu_vm": 37, "endpoint": 37, "xla_use_spmd": 37, "machine_0_internal_ip_address": 37, "test_train_spmd_imagenet": 37, "yaoshiang": 38, "ho": 38, "2025": 38, "05": 38, "silicon": 38, "inexpens": 38, "tradeoff": 38, "v100": 38, "tensorcor": 38, "numer": 38, "tf32": 38, "mantissa": 38, "intuit": 38, "imagin": 38, "digit": 38, "decim": 38, "111": 38, "222": 38, "84": 38, "021642": 38, "twice": 38, "72": 38, "011": 38, "022": 38, "compris": 38, "fourth": 38, "ignor": 38, "000242": 38, "littl": 38, "rel": 38, "2002": 38, "1012": 38, "0214": 38, "tripl": 38, "idea": 38, "medium": 38, "nine": 38, "hh": 38, "hm": 38, "mh": 38, "hl": 38, "lh": 38, "lm": 38, "room": 38, "varianc": 38, "valid": 38, "set_printopt": 38, "sci_mod": 38, "linewidth": 38, "240": 38, "epsilon": 38, "ep": 38, "finfo": 38, "0078125": 38, "00000000000000000000": 38, "00781250000000000000": 38, "vice": 38, "versa": 38, "encourag": 38, "rather": 38, "struct": 38, "binary_fraction_to_fp32": 38, "bstr": 38, "0b1": 38, "invalid": 38, "fraction_bit": 38, "fp32_to_binary_fract": 38, "fp32_float": 38, "x_byte": 38, "endian": 38, "ieee": 38, "754": 38, "as_int": 38, "unpack": 38, "uint32": 38, "sign": 38, "31": 38, "expon": 38, "0xff": 38, "0x7fffff": 38, "0b": 38, "08b": 38, "023b": 38, "get_rand_matrix": 38, "diagon": 38, "1024": 38, "999": 38, "ey": 38, "rand_": 38, "bf16_ep": 38, "one_plus_half_ep": 38, "00390625": 38, "8th": 38, "lost": 38, "reconfirm": 38, "ones_bf16": 38, "01111111": 38, "00000001000000000000000": 38, "00000000000000000000000": 38, "wise": 38, "z_ref": 38, "00000010000000010000000": 38, "0078277587890625": 38, "saw": 38, "01110000101000111101100": 38, "440000057220459": 38, "01110000101000111101101": 38, "4400001764297485": 38}, "objects": {"": [[14, 0, 0, "-", "torch_xla"]], "torch_xla": [[14, 0, 0, "-", "backends"], [14, 1, 1, "", "compile"], [14, 1, 1, "", "device"], [14, 1, 1, "", "device_count"], [14, 1, 1, "", "devices"], [14, 0, 0, "-", "experimental"], [14, 1, 1, "", "manual_seed"], [14, 0, 0, "-", "runtime"], [14, 1, 1, "", "sync"]], "torch_xla.backends": [[14, 1, 1, "", "get_mat_mul_precision"], [14, 1, 1, "", "set_mat_mul_precision"]], "torch_xla.core": [[14, 0, 0, "-", "xla_model"]], "torch_xla.core.xla_model": [[14, 1, 1, "", "add_step_closure"], [14, 1, 1, "", "all_gather"], [14, 1, 1, "", "all_reduce"], [14, 1, 1, "", "all_to_all"], [14, 1, 1, "", "get_memory_info"], [14, 1, 1, "", "get_rng_state"], [14, 1, 1, "", "get_stablehlo"], [14, 1, 1, "", "get_stablehlo_bytecode"], [14, 1, 1, "", "is_master_ordinal"], [14, 1, 1, "", "mesh_reduce"], [14, 1, 1, "", "optimizer_step"], [14, 1, 1, "", "rendezvous"], [14, 1, 1, "", "save"], [14, 1, 1, "", "set_rng_state"], [14, 1, 1, "", "wait_device_ops"], [14, 1, 1, "", "xla_device"], [14, 1, 1, "", "xla_device_hw"]], "torch_xla.debug": [[14, 0, 0, "-", "metrics"]], "torch_xla.debug.metrics": [[14, 1, 1, "", "counter_names"], [14, 1, 1, "", "counter_value"], [14, 1, 1, "", "metric_data"], [14, 1, 1, "", "metric_names"], [14, 1, 1, "", "metrics_report"], [14, 1, 1, "", "short_metrics_report"]], "torch_xla.distributed": [[14, 0, 0, "-", "parallel_loader"], [14, 0, 0, "-", "spmd"], [14, 0, 0, "-", "xla_multiprocessing"]], "torch_xla.distributed.parallel_loader": [[14, 2, 1, "", "MpDeviceLoader"]], "torch_xla.distributed.spmd": [[14, 2, 1, "", "HybridMesh"], [14, 2, 1, "", "Mesh"], [14, 1, 1, "", "clear_sharding"], [14, 1, 1, "", "get_1d_mesh"], [14, 1, 1, "", "get_global_mesh"], [14, 1, 1, "", "mark_sharding"], [14, 1, 1, "", "set_global_mesh"]], "torch_xla.distributed.xla_multiprocessing": [[14, 1, 1, "", "spawn"]], "torch_xla.experimental": [[14, 1, 1, "", "eager_mode"]], "torch_xla.runtime": [[14, 1, 1, "", "addressable_device_count"], [14, 1, 1, "", "device_type"], [14, 1, 1, "", "get_master_ip"], [14, 1, 1, "", "global_device_count"], [14, 1, 1, "", "global_ordinal"], [14, 1, 1, "", "global_runtime_device_count"], [14, 1, 1, "", "initialize_cache"], [14, 1, 1, "", "is_spmd"], [14, 1, 1, "", "local_device_count"], [14, 1, 1, "", "local_ordinal"], [14, 1, 1, "", "local_process_count"], [14, 1, 1, "", "use_spmd"], [14, 1, 1, "", "world_size"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"]}, "titleterms": {"learn": [0, 1, 12], "about": [0, 1], "gpu": [0, 12, 37], "tpu": [1, 4, 12, 13, 17, 21, 22, 25, 30, 34, 38], "build": [2, 5], "bazel": 2, "depend": [2, 8], "how": [2, 16, 26, 27, 32, 35], "xla": [2, 3, 4, 7, 8, 12, 14, 16, 17, 18, 19, 20, 21, 22, 25, 30, 32, 35, 38], "librari": 2, "torch": [2, 10, 11, 13, 16, 34], "plugin": [2, 7], "remot": 2, "cach": [2, 9, 17, 20], "run": [2, 3, 17, 19, 21, 34, 37], "test": [2, 3, 6, 19, 29], "code": [2, 4, 21, 32], "coverag": 2, "languag": 2, "server": 2, "pytorch": [2, 3, 4, 5, 7, 8, 10, 12, 14, 16, 17, 18, 19, 20, 21, 22, 30, 35, 38], "codegen": 3, "migrat": 3, "guid": [3, 6, 35], "befor": [3, 6], "you": [3, 5, 6, 9, 24, 33], "start": [3, 6, 12, 24, 33], "file": [3, 5, 6], "structur": [3, 6], "old": 3, "op": [3, 6, 11, 32], "lower": [3, 6, 11, 38], "step": [3, 4, 22], "1": [3, 21, 24, 33], "identifi": 3, "2": [3, 21, 24, 33], "inspect": 3, "gener": [3, 10], "lazyir": 3, "h": 3, "3": [3, 24, 33], "implement": [3, 7, 21], "miss": 3, "ir": 3, "function": [3, 26], "torch_xla": [3, 14, 16, 18, 24], "csrc": 3, "ops_xla_shape_fn": 3, "cpp": 3, "4": 3, "ops_lower_fn": 3, "5": 3, "cleanup": 3, "verifi": [3, 5], "result": 3, "sampl": 3, "pr": 3, "configur": [4, 5], "A": [4, 5, 19], "develop": 4, "environ": [4, 19], "visual": 4, "studio": 4, "creat": [4, 17], "connect": 4, "your": [4, 5, 8], "set": 4, "up": [4, 26], "workspac": 4, "next": [4, 22], "c": [5, 7], "debug": [5, 14, 17, 19, 34], "why": [5, 22], "would": 5, "need": 5, "thi": [5, 9], "instal": [5, 30], "gdb": 5, "The": [5, 19], "gnu": 5, "project": 5, "debugg": 5, "symbol": 5, "built": [5, 8], "vscode": 5, "lldb": 5, "realist": 5, "command": 5, "futur": 5, "work": [5, 16], "understand": [6, 19], "oper": [6, 10, 19, 24, 25, 32, 33], "unit": [6, 19], "tip": 6, "custom": [7, 8], "hardwar": [7, 22, 38], "pjrt": [7, 13], "api": [7, 11, 12, 14, 16], "packag": 7, "kernel": 8, "via": 8, "palla": 8, "adopt": 8, "abov": 8, "compat": [8, 9], "us": [8, 9, 10, 22, 24, 26, 27, 31, 32, 33, 35], "flashattent": 8, "exampl": [8, 9, 21, 25, 29, 30], "usag": [8, 29], "integr": [8, 28, 34], "pagedattent": 8, "write": 8, "own": 8, "optim": [9, 29, 34, 36], "repeat": 9, "layer": 9, "scan": 9, "scan_lay": 9, "when": [9, 24, 33], "should": 9, "limit": [9, 26], "aotautograd": 9, "requir": 9, "compil": [9, 16, 17, 19, 20, 34], "time": [9, 17, 18], "experi": 9, "refer": [9, 12, 21], "export": 10, "stablehlo": 10, "extract_jax": 10, "inlin": 10, "some": [10, 24, 33], "weight": 10, "preserv": 10, "high": 10, "level": 10, "composit": 10, "support": [11, 25, 32], "distribut": [11, 12, 13, 14, 27, 36], "collect": 11, "stack": 11, "non": 11, "dynamo": [11, 19], "case": [11, 18, 24, 29, 33, 38], "descript": 11, "document": 12, "get": [12, 19, 38], "tutori": 12, "basic": [12, 19], "train": [12, 28, 30], "advanc": [12, 20, 34], "techniqu": 12, "troubleshoot": [12, 19, 33], "contribut": 12, "runtim": [13, 14], "tl": 13, "dr": 13, "benefit": 13, "quickstart": 13, "cpu": [13, 17], "pod": [13, 17, 21, 30, 34], "docker": 13, "differ": 13, "from": [13, 17, 24, 33], "xrt": 13, "multithread": 13, "v2": 13, "v3": [13, 30], "chang": 13, "xm": 13, "rendezv": 13, "perform": [13, 16, 18, 19, 23], "new": 13, "backend": 14, "xla_model": 14, "spmd": [14, 31, 34, 35, 37], "experiment": 14, "dynam": [15, 24, 33], "shape": [15, 24, 33], "bound": [15, 24, 33], "s": [16, 24, 33], "interact": 16, "eager": 16, "mode": [16, 35], "overview": [16, 22], "challeng": 16, "lazytensor": 16, "vs": [16, 18], "benchmark": [16, 19, 26, 27], "devic": [17, 21, 34, 35], "an": 17, "tensor": [17, 19, 24, 33], "ar": 17, "model": [17, 32], "singl": [17, 21], "multipl": [17, 21], "multi": 17, "process": [17, 30, 36], "deep": 17, "dive": 17, "lazi": 17, "memori": [17, 29], "layout": 17, "move": 17, "save": 17, "load": [17, 20, 34], "unexpect": 17, "materi": 17, "dure": 17, "aot": 17, "ahead": 17, "trace": [17, 18, 26], "flag": 17, "recommend": 17, "further": [17, 35], "read": [17, 35], "execut": [18, 19, 20], "illustr": 18, "common": [18, 19], "pitfal": 18, "measur": 18, "onli": 18, "end": 18, "trigger": 18, "ensur": 18, "complet": 18, "studi": 18, "correctli": 18, "profil": [18, 19, 23], "loop": [18, 29], "sync": 18, "saniti": 19, "check": 19, "version": 19, "simpl": [19, 29], "calcul": 19, "resnet": [19, 30], "With": 19, "fake": [19, 27], "data": [19, 20, 27, 30, 31, 34], "tool": [19, 34], "auto": [19, 34], "metric": 19, "analysi": [19, 23], "report": 19, "clear": 19, "known": 19, "caveat": 19, "quirk": 19, "more": 19, "variabl": 19, "combin": 19, "reproduc": 19, "ci": 19, "cd": 19, "failur": 19, "topic": [20, 34], "synchron": 20, "block": 20, "barrier": 20, "graph": 20, "convert": 21, "stabl": 21, "diffus": 21, "infer": [21, 28], "lightn": 21, "hf": 21, "target": 22, "setup": 22, "sourc": 24, "recompil": [24, 33], "let": [24, 33], "first": [24, 33], "fact": [24, 33], "constraint": [24, 33], "input": [24, 33], "dataset": [24, 33], "output": [24, 31, 33], "can": [24, 33], "fix": [24, 33], "without": [24, 33], "queri": [24, 33], "its": [24, 33], "real": [24, 27, 33], "dimens": [24, 33], "what": [24, 33, 35], "control": [24, 29, 33, 38], "flow": [24, 33], "conclus": [24, 33, 38], "appendix": [24, 33], "automat": 25, "mix": 25, "precis": [25, 38], "amp": 25, "best": 25, "practic": 25, "speed": 26, "assume_pur": 26, "background": [26, 27], "motiv": [26, 27], "nn": 26, "modul": [26, 32], "parallel": [27, 30, 31], "ddp": 27, "distributeddataparallel": 27, "resnet50": 27, "mnist": [27, 30], "disclaim": 27, "torchdynamo": 28, "featur": 28, "gap": 28, "take": 28, "awai": 28, "util": 29, "while_loop": 29, "group": [29, 36], "pure": 29, "python": 29, "while": 29, "fulli": [30, 31], "shard": [30, 31, 34, 35], "fsdp": [30, 31], "One": 30, "per": 30, "acceler": 30, "script": 30, "imagenet": 30, "clone": 30, "repo": 30, "8": 30, "50": 30, "10": 30, "billion": 30, "paramet": 30, "gradient": 31, "checkpoint": [31, 36], "quantiz": 32, "call": 32, "swap": 32, "matrix": 32, "multipli": 32, "awar": 34, "host": 34, "virtual": 34, "hybrid": 34, "mesh": [34, 35], "xlashardedtensor": 34, "dtensor": 34, "activ": 34, "user": 35, "partit": 35, "spec": 35, "which": 35, "hold": 35, "checkpointmanag": 36, "restor": 36, "state": 36, "mxu": 38, "float": 38, "point": 38, "introduct": 38, "higher": 38, "math": 38, "prepar": 38, "readi": 38, "look": 38, "directli": 38, "bit": 38, "examin": 38, "number": 38, "fp32": 38, "bfloat16": 38, "edg": 38}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})