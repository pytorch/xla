Search.setIndex({"docnames": ["accelerators/tpu", "contribute/bazel", "contribute/codegen_migration", "contribute/configure-environment", "contribute/cpp_debugger", "contribute/op_lowering", "contribute/plugins", "features/pallas", "features/scan", "features/stablehlo", "features/torch_distributed", "index", "learn/_pjrt", "learn/api-guide", "learn/dynamic_shape", "learn/eager", "learn/migration-to-xla-on-tpus", "learn/pytorch-on-xla-devices", "learn/trace-vs-execution-time", "learn/troubleshoot", "learn/xla-advanced", "learn/xla-examples", "learn/xla-overview", "learn/xla-profiling", "learn/xla-quickstart", "notes/source_of_recompilation", "perf/amp", "perf/assume_pure", "perf/ddp", "perf/dynamo", "perf/fori_loop", "perf/fsdp_collectives", "perf/fsdp_spmd", "perf/quantized_ops", "perf/recompilation", "perf/spmd_advanced", "perf/spmd_basic", "perf/spmd_distributed_checkpoint", "tutorials/precision_tutorial"], "filenames": ["accelerators/tpu.md", "contribute/bazel.md", "contribute/codegen_migration.md", "contribute/configure-environment.md", "contribute/cpp_debugger.md", "contribute/op_lowering.md", "contribute/plugins.md", "features/pallas.md", "features/scan.md", "features/stablehlo.md", "features/torch_distributed.md", "index.rst", "learn/_pjrt.md", "learn/api-guide.rst", "learn/dynamic_shape.md", "learn/eager.md", "learn/migration-to-xla-on-tpus.md", "learn/pytorch-on-xla-devices.md", "learn/trace-vs-execution-time.md", "learn/troubleshoot.md", "learn/xla-advanced.md", "learn/xla-examples.md", "learn/xla-overview.md", "learn/xla-profiling.md", "learn/xla-quickstart.md", "notes/source_of_recompilation.md", "perf/amp.md", "perf/assume_pure.md", "perf/ddp.md", "perf/dynamo.md", "perf/fori_loop.md", "perf/fsdp_collectives.md", "perf/fsdp_spmd.md", "perf/quantized_ops.md", "perf/recompilation.md", "perf/spmd_advanced.md", "perf/spmd_basic.md", "perf/spmd_distributed_checkpoint.md", "tutorials/precision_tutorial.ipynb"], "titles": ["Learn about TPUs", "Building with Bazel", "Codegen Migration Guide", "Configure A Development Environment", "C++ Debugging", "Op Lowering Guide", "Custom Hardware Plugins", "Custom Kernels via Pallas", "Optimizing Repeated Layers with <code class=\"docutils literal notranslate\"><span class=\"pre\">scan</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">scan_layers</span></code>", "Torch Export to StableHLO", "Support for Torch Distributed", "PyTorch/XLA documentation", "PJRT Runtime", "PyTorch/XLA API", "Dynamic Shapes", "PyTorch/XLA Compile API and it\u2019s interaction with Eager mode.", "Migrating from PyTorch on GPUs to PyTorch/XLA on TPUs", "PyTorch on XLA Devices", "Tracing Time vs. Execution Time in PyTorch/XLA", "Troubleshooting Basics", "Advanced Topics in PyTorch XLA", "Converting code to PyTorch XLA", "Pytorch/XLA Overview", "Profiling and performance analysis", "Quickstart: Your First PyTorch/XLA Model", "Source of recompilations in torch_xla", "Automatic Mixed Precision", "Speed Up Tracing with <code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;assume_pure</span></code>", "Distributed Data Parallel (DDP)", "TorchDynamo Integration", "Optimize Memory Utilization with <code class=\"docutils literal notranslate\"><span class=\"pre\">while_loop</span></code>", "Fully Sharded Data Parallel (FSDP) with One Process Per Accelerator", "Fully Sharded Data Parallel (FSDP) using SPMD", "Quantized Operations", "Troubleshooting recompilations", "SPMD advanced topics", "SPMD User Guide", "Distributed Checkpointing", "Control MXU Floating Point Precision"], "terms": {"googl": [0, 7, 12, 16, 17, 22, 38], "cloud": [0, 1, 3, 6, 12, 16, 17, 22, 29, 37], "ar": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 33, 34, 35, 36, 37, 38], "custom": [0, 2, 3, 4, 8, 9, 10, 11, 13, 15, 22, 25, 28, 31, 33, 34, 35, 36], "design": [0, 8, 12, 15, 17, 22, 29], "ai": [0, 21, 22], "acceler": [0, 3, 11, 12, 13, 14, 15, 17, 21, 22, 24, 26, 38], "which": [0, 1, 2, 4, 5, 6, 9, 10, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 29, 31, 32, 34, 35, 37, 38], "optim": [0, 4, 11, 12, 13, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 29, 31, 32, 34, 38], "train": [0, 7, 8, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 26, 27, 35, 37, 38], "infer": [0, 2, 11, 13, 15, 17, 22, 23, 26, 35], "larg": [0, 8, 12, 14, 20, 21, 22, 23, 25, 31, 34, 36], "model": [0, 2, 5, 8, 9, 11, 12, 13, 14, 15, 16, 18, 19, 21, 22, 23, 25, 26, 27, 28, 29, 31, 32, 34, 35, 36, 37, 38], "thei": [0, 1, 5, 6, 9, 10, 12, 13, 16, 17, 18, 19, 20, 24, 25, 26, 34, 35, 36], "ideal": [0, 1, 2, 25, 29, 34], "varieti": 0, "us": [0, 1, 2, 3, 4, 5, 6, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 23, 24, 26, 29, 31, 35, 37, 38], "case": [0, 1, 2, 5, 8, 9, 12, 13, 17, 19, 20, 21, 22, 23, 27, 29, 32, 35], "chatbot": [0, 22], "code": [0, 2, 4, 5, 8, 9, 12, 13, 15, 17, 18, 19, 20, 22, 23, 24, 25, 27, 28, 29, 34, 35], "gener": [0, 4, 5, 12, 13, 15, 17, 19, 20, 21, 22, 25, 34, 38], "media": [0, 22], "content": [0, 13, 22], "synthet": 0, "speech": 0, "vision": [0, 22, 31], "servic": [0, 1, 12, 22], "recommend": [0, 1, 2, 3, 4, 5, 12, 13, 15, 16, 22, 35, 38], "engin": [0, 19, 22], "person": 0, "among": 0, "other": [0, 1, 2, 4, 5, 7, 8, 12, 13, 14, 17, 19, 21, 22, 25, 26, 27, 28, 31, 32, 33, 34, 36], "scale": [0, 9, 11, 12, 13, 16, 22, 24, 26, 27, 29, 36], "cost": [0, 11, 15, 22, 27, 29, 38], "effici": [0, 8, 9, 11, 15, 16, 19, 22, 29, 36], "wide": [0, 5, 22, 25, 34], "rang": [0, 5, 8, 12, 13, 16, 18, 22, 24, 27, 32, 35, 36, 38], "workload": [0, 12, 15, 17, 19, 22, 35, 36], "span": [0, 2, 15], "fine": 0, "tune": [0, 35, 36], "provid": [0, 1, 2, 5, 6, 7, 8, 13, 15, 16, 17, 18, 19, 21, 22, 24, 25, 26, 29, 30, 31, 33, 34, 35, 36, 37, 38], "versatil": [0, 22], "lead": [0, 8, 15, 17, 18, 19, 21, 22, 23, 27], "framework": [0, 22, 25, 33, 34], "includ": [0, 1, 5, 12, 13, 16, 18, 19, 22, 24, 25, 26, 30, 34, 36, 37, 38], "pytorch": [0, 5, 8, 10, 12, 14, 23, 25, 26, 27, 28, 29, 30, 32, 33, 34, 35, 37], "jax": [0, 6, 7, 8, 9, 12, 22], "tensorflow": [0, 1, 6, 12, 13, 19, 22, 25, 34], "seamlessli": [0, 22], "orchestr": 0, "through": [0, 2, 5, 6, 7, 8, 10, 17, 20, 22, 24, 25, 26, 34, 37, 38], "integr": [0, 11, 15, 33, 36], "kubernet": 0, "gke": 0, "leverag": [0, 22], "dynam": [0, 2, 5, 11, 17, 19, 20, 29], "schedul": [0, 21, 23], "improv": [0, 12, 16, 17, 19, 20, 21, 22, 23, 26, 29, 35, 36], "scalabl": [0, 22], "all": [0, 1, 2, 4, 5, 8, 9, 10, 12, 13, 16, 17, 18, 19, 20, 21, 22, 25, 27, 28, 31, 34, 35, 37], "need": [0, 1, 2, 5, 9, 12, 13, 16, 17, 18, 19, 20, 21, 22, 24, 25, 28, 31, 32, 34, 35, 36, 38], "simultan": [0, 36], "look": [0, 2, 4, 5, 8, 15, 17, 19, 21, 23, 35], "simplest": [0, 36, 38], "wai": [0, 1, 5, 7, 9, 10, 12, 13, 16, 17, 18, 23, 25, 28, 29, 33, 34, 35, 36], "develop": [0, 1, 11, 15, 16, 17, 22, 28, 29, 33, 36], "can": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 26, 27, 28, 29, 31, 32, 33, 35, 36, 37, 38], "also": [0, 1, 2, 4, 5, 6, 9, 10, 12, 13, 16, 17, 19, 20, 21, 22, 23, 24, 25, 27, 29, 31, 32, 33, 34, 35, 36, 38], "vertex": 0, "fulli": [0, 11, 12, 15, 19, 36], "manag": [0, 7, 13, 16, 24, 26, 37], "platform": [0, 13], "For": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36], "more": [0, 1, 2, 3, 4, 5, 7, 9, 12, 13, 15, 16, 17, 21, 22, 24, 25, 27, 34, 35, 36, 38], "inform": [0, 2, 3, 4, 12, 13, 15, 16, 17, 19, 23, 25, 34, 38], "see": [0, 1, 2, 3, 4, 5, 6, 8, 9, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 27, 29, 31, 34, 38], "introduct": [0, 7], "set": [0, 1, 4, 8, 10, 12, 13, 16, 19, 20, 21, 24, 25, 29, 31, 34, 35, 36, 37, 38], "up": [0, 1, 2, 4, 11, 12, 17, 18, 21, 22, 23, 24, 25, 29, 32, 34, 38], "environ": [0, 1, 4, 11, 12, 14, 16, 17, 20, 24, 28, 35, 36, 37], "resourc": [0, 13, 19], "free": [1, 5, 9, 16, 19, 26, 28, 31], "softwar": [1, 19], "tool": [1, 5, 16, 23, 31, 36, 38], "autom": 1, "openxla": [1, 6, 9, 15, 22, 29, 33], "both": [1, 3, 4, 5, 10, 12, 15, 21, 25, 29, 31, 32, 33, 34, 36, 37], "make": [1, 3, 4, 9, 12, 16, 17, 18, 19, 20, 21, 22, 23, 25, 28, 29, 34, 35, 38], "good": [1, 2, 5, 16, 23, 25, 34, 35], "fit": [1, 2, 23, 31], "well": [1, 2, 6, 12, 13, 21, 23, 25, 34, 35, 36], "extern": [1, 3, 7], "seen": [1, 18, 20, 29], "workspac": [1, 19], "file": [1, 3, 8, 12, 13, 19, 21, 23, 26, 27, 28], "http_archiv": 1, "name": [1, 3, 4, 5, 12, 13, 19, 24, 25, 32, 34, 35, 36], "patch_arg": 1, "l": [1, 38], "p1": 1, "patch_tool": 1, "patch": [1, 19], "openxla_patch": 1, "no_fortifi": 1, "diff": [1, 12, 21], "strip_prefix": 1, "xla_hash": 1, "url": 1, "http": [1, 2, 3, 7, 8, 9, 12, 13, 19, 21, 22, 31], "github": [1, 2, 3, 4, 5, 8, 12, 13, 19, 21, 28, 31], "com": [1, 2, 3, 7, 8, 12, 13, 19, 21, 22, 31], "archiv": 1, "tar": 1, "gz": 1, "you": [1, 3, 6, 7, 9, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27, 28, 29, 31, 32, 35, 36, 38], "specifi": [1, 4, 9, 10, 13, 15, 17, 18, 22, 31, 35, 36], "revis": 1, "want": [1, 4, 5, 9, 13, 16, 17, 19, 21, 25, 29, 34, 35, 36], "field": 1, "alwai": [1, 12, 17, 19, 25, 34, 36], "determinist": 1, "commit": [1, 21], "aka": 1, "pin": [1, 13], "mai": [1, 2, 4, 6, 8, 12, 13, 17, 19, 20, 21, 23, 25, 26, 27, 34, 35, 36, 38], "ad": [1, 4, 5, 9, 13, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 29, 30, 34, 35, 38], "resolv": 1, "prepar": [1, 18], "hermet": 1, "differ": [1, 2, 6, 13, 15, 17, 19, 21, 23, 25, 27, 28, 30, 31, 32, 34, 35, 36, 38], "mechan": [1, 8, 18], "deploi": 1, "becaus": [1, 2, 8, 12, 15, 17, 20, 21, 23, 26, 27, 35, 38], "local": [1, 3, 12, 13, 16, 17, 19, 35], "checkout": [1, 8, 19], "thi": [1, 2, 3, 5, 6, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34, 35, 36, 37, 38], "ha": [1, 2, 3, 4, 5, 7, 8, 9, 12, 13, 16, 17, 18, 20, 21, 23, 25, 34, 35, 36, 38], "built": [1, 3, 24, 36, 38], "from": [1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 13, 14, 15, 19, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 35, 36, 37, 38], "sourc": [1, 2, 4, 5, 6, 8, 11, 12, 13, 19, 22, 34], "instal": [1, 2, 3, 5, 6, 7, 11, 12, 19, 21, 22, 24], "system": [1, 16, 22, 36, 38], "version": [1, 2, 3, 4, 7, 12, 17, 21, 22, 23, 26, 27, 35], "compat": [1, 12, 22, 33, 37], "e": [1, 3, 4, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 27, 31, 33, 34, 35, 36], "g": [1, 3, 4, 9, 10, 12, 13, 14, 15, 16, 18, 19, 20, 22, 24, 25, 27, 33, 34, 35, 36], "codegen": [1, 5, 11], "torchgen": [1, 2], "python": [1, 2, 3, 4, 5, 6, 8, 9, 11, 12, 13, 14, 16, 18, 19, 20, 21, 22, 23, 24, 25, 28, 29, 34, 35], "modul": [1, 7, 8, 9, 13, 16, 17, 19, 24, 28, 31, 32, 35, 38], "should": [1, 2, 3, 5, 6, 12, 13, 16, 17, 18, 19, 23, 24, 25, 26, 30, 31, 34, 35, 36, 37], "The": [1, 2, 3, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 25, 27, 28, 29, 31, 33, 34, 35, 36, 37, 38], "directori": [1, 2, 5, 8, 24], "either": [1, 5, 10, 12, 13, 19, 25, 26, 34], "bzl": 1, "overriden": 1, "command": [1, 2, 3, 8, 12, 17, 19, 21, 22, 28, 31], "line": [1, 2, 4, 9, 13, 15, 17, 19, 21, 24, 25, 31, 34], "override_repositori": 1, "org_tensorflow": 1, "path": [1, 4, 6, 13, 17, 19, 22, 25, 31, 34], "export": [1, 2, 3, 5, 11, 12, 16, 19, 22], "tf_repo": 1, "torch_repo": 1, "pleas": [1, 2, 5, 10, 12, 13, 17, 19, 24, 26, 31, 32, 33, 35, 38], "sure": [1, 4, 17, 18, 19, 38], "overridden": [1, 2], "repositori": [1, 12], "appropri": [1, 17, 23], "been": [1, 4, 5, 12, 13, 17, 20, 21, 25, 34, 35], "use_cuda": [1, 4], "0": [1, 2, 3, 4, 6, 8, 9, 11, 12, 13, 14, 16, 17, 19, 20, 21, 22, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35, 36, 38], "setup": [1, 2, 4, 6, 9, 16, 17, 24, 28], "py": [1, 2, 3, 4, 5, 8, 10, 12, 14, 15, 16, 17, 19, 21, 23, 24, 27, 28, 31], "bdist_wheel": 1, "expect": [1, 2, 6, 12, 13, 17, 19, 25, 29, 33, 34, 38], "object": [1, 9, 13, 24, 35], "present": [1, 37], "new_local_repositori": 1, "build_fil": 1, "pytorch_local_dir": 1, "header": 1, "directli": [1, 2, 5, 6, 12, 13, 16, 17, 19, 21, 22, 25, 26, 31, 34, 35, 37], "share": [1, 2, 6, 12, 16, 17, 19, 35], "libtorch": 1, "so": [1, 2, 6, 9, 12, 13, 14, 16, 17, 19, 20, 21, 22, 25, 31, 34, 37, 38], "same": [1, 2, 5, 6, 8, 12, 13, 16, 17, 19, 20, 22, 23, 25, 26, 27, 30, 33, 34, 35, 36, 38], "where": [1, 3, 7, 8, 10, 12, 13, 15, 16, 17, 18, 19, 23, 25, 31, 32, 34, 36, 38], "lib": [1, 4, 6], "contain": [1, 2, 5, 6, 8, 9, 12, 13, 19, 21, 23, 25, 27, 34, 36], "work": [1, 2, 8, 9, 10, 12, 13, 14, 16, 17, 18, 19, 25, 27, 29, 33, 34, 35], "s": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 21, 22, 23, 24, 26, 27, 28, 29, 33, 35, 37, 38], "requir": [1, 2, 5, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 24, 25, 34, 35, 37, 38], "pass": [1, 5, 8, 9, 12, 13, 15, 16, 18, 20, 21, 26, 27, 35, 36, 38], "isystemextern": 1, "compil": [1, 4, 5, 6, 9, 11, 12, 13, 14, 16, 18, 21, 22, 23, 24, 25, 29, 32, 33, 34, 36, 37], "find": [1, 2, 5, 7, 8, 12, 19, 21, 23, 28, 32], "satisfi": [1, 35], "them": [1, 2, 5, 8, 12, 13, 15, 16, 17, 18, 19, 20, 21, 25, 34, 36, 38], "some": [1, 2, 5, 8, 12, 13, 14, 16, 17, 19, 27, 28, 33, 35, 36, 38], "user": [1, 3, 4, 6, 8, 11, 12, 15, 16, 17, 19, 20, 25, 29, 30, 32, 33, 34, 35, 37], "bring": [1, 2], "pybind11": 1, "embed": [1, 8], "link": [1, 2], "against": [1, 28], "libpython": 1, "instead": [1, 9, 10, 12, 13, 17, 19, 21, 22, 25, 27, 28, 29, 31, 34, 35, 37], "These": [1, 2, 5, 7, 8, 12, 16, 20, 21, 24, 33, 37, 38], "pybind11_emb": 1, "option": [1, 2, 3, 4, 6, 12, 13, 16, 19, 33, 35, 37], "transit": [1, 15, 16, 17, 22], "simpl": [1, 2, 7, 8, 12, 20, 24, 26, 31], "torch_xla": [1, 3, 5, 6, 7, 8, 10, 11, 12, 14, 16, 17, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38], "csrc": [1, 5], "runtim": [1, 2, 3, 6, 11, 16, 17, 19, 28, 31, 35, 36, 37], "configr": 1, "via": [1, 3, 11, 12, 15, 16, 18, 22, 30, 31, 35, 36], "bazelrc": 1, "take": [1, 2, 8, 9, 13, 17, 18, 19, 21, 22, 23, 25, 34, 35], "flag": [1, 2, 4, 9, 13, 14], "config": [1, 2, 3, 9], "remote_cach": 1, "configur": [1, 2, 5, 11, 12, 13, 16, 17, 19, 21, 24, 37], "gcloud": [1, 3, 12, 17, 21, 22], "usual": [1, 2, 4, 5, 16, 17, 19], "faster": [1, 4, 12, 16, 20, 21, 25, 27, 29, 34], "authent": [1, 12], "easi": [1, 8, 12, 17, 25, 34, 38], "express": [1, 27, 36], "complex": [1, 15, 16, 27, 29], "lot": [1, 17, 19, 20, 25, 34], "gain": [1, 12], "have": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 31, 32, 34, 35, 37, 38], "singl": [1, 8, 12, 13, 15, 16, 20, 22, 23, 24, 25, 28, 29, 31, 32, 34, 35, 36], "graph": [1, 8, 9, 12, 13, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 27, 28, 29, 34, 35], "everyth": [1, 9, 25, 28, 34], "therefor": [1, 17, 19, 21, 23], "separ": [1, 2, 4, 5, 9, 15, 16, 17, 20, 24, 29, 31, 32], "rest": [1, 19, 25, 34], "plu": [1, 18, 28, 30], "whole": [1, 13, 15, 25, 29, 34], "everythin": 1, "els": [1, 9, 16, 17, 19, 25, 34], "enough": [1, 23, 25, 34], "normal": [1, 2, 12, 16, 17, 24, 25, 32, 34, 35], "achiev": [1, 5, 15, 28, 36], "invok": [1, 2, 29, 35], "standard": [1, 16, 18, 24], "c": [1, 2, 5, 11, 12, 16, 19, 25, 26, 27, 34], "bind": 1, "simpli": [1, 8, 15], "_xlac": [1, 17, 19, 25, 34], "client": [1, 6, 12, 13], "togeth": [1, 12, 17, 28, 31, 35, 36], "when": [1, 2, 4, 5, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 29, 31, 35, 36, 37, 38], "chang": [1, 4, 5, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 28, 33, 34, 35], "abl": [1, 17, 25, 34, 37, 38], "without": [1, 5, 8, 9, 12, 13, 15, 17, 18, 19, 20, 21, 23, 35, 36, 37, 38], "iter": [1, 8, 13, 14, 15, 16, 17, 18, 19, 20, 24, 29, 35], "cycl": [1, 17], "come": [1, 13, 24, 25, 34], "There": [1, 2, 9, 17, 19, 23, 25, 28, 29, 34, 35], "plenti": 1, "backend": [1, 2, 10, 11, 12, 15, 16, 22, 24, 25, 29, 30, 33, 34, 35, 37, 38], "we": [1, 2, 3, 4, 5, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27, 28, 29, 30, 31, 32, 34, 35], "our": [1, 2, 3, 4, 5, 6, 7, 10, 12, 16, 17, 19, 22, 24, 25, 26, 28, 29, 34, 35, 36], "gc": [1, 37], "storag": [1, 3, 7, 17, 19, 22, 31, 37], "under": [1, 2, 5, 8, 12, 13, 15, 17, 28], "disabl": [1, 13, 15, 17, 19, 20, 21], "default": [1, 5, 9, 12, 13, 15, 16, 17, 18, 19, 21, 26, 31, 35, 37, 38], "speed": [1, 4, 11, 13, 21, 22, 25, 29, 34, 38], "increment": [1, 2], "huge": [1, 19, 21, 25, 28, 34], "margin": 1, "almost": 1, "enabl": [1, 4, 8, 13, 14, 15, 16, 17, 19, 20, 22, 23, 26, 28, 33, 35, 36, 37], "ci": [1, 5], "To": [1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 14, 15, 16, 17, 18, 19, 21, 23, 24, 25, 31, 32, 34, 35, 37, 38], "machin": [1, 3, 12, 19, 20, 22, 23], "ensur": [1, 8, 13, 16, 17, 24, 25, 27, 32, 34, 35, 37], "credenti": 1, "auth": [1, 12], "applic": [1, 19, 22, 33, 37], "login": [1, 21], "launch": [1, 4, 12, 13, 14, 16, 17, 18, 21, 28, 29, 31], "browser": 1, "gcp": [1, 3, 12], "variou": [1, 15, 22], "individu": [1, 31, 32, 36], "who": [1, 4, 16, 28], "access": [1, 2, 5, 7, 12, 13, 16, 17, 18, 19, 20, 21, 25, 34, 37, 38], "project": [1, 3, 6, 12, 17, 22], "one": [1, 2, 5, 7, 8, 12, 13, 16, 17, 19, 20, 21, 23, 25, 29, 30, 31, 32, 34, 35, 36, 38], "onli": [1, 2, 4, 5, 8, 10, 11, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 34, 36, 37, 38], "google_default_credenti": 1, "token": [1, 15, 21, 33], "out": [1, 5, 8, 9, 12, 13, 17, 19, 21, 24, 26, 29, 35, 38], "box": [1, 5, 35], "log": [1, 16, 19, 20, 21], "permiss": 1, "add": [1, 2, 4, 5, 13, 17, 20, 21, 23, 25, 29, 30, 31, 34], "new": [1, 2, 3, 4, 5, 10, 16, 17, 18, 19, 20, 21, 25, 29, 34, 35], "role": [1, 15], "In": [1, 2, 4, 5, 6, 7, 8, 10, 12, 13, 14, 16, 17, 18, 19, 20, 21, 24, 25, 26, 27, 29, 34, 35, 36, 37, 38], "account": [1, 21], "kei": [1, 3, 6, 8, 12, 13, 19, 20, 22, 37], "google_credenti": 1, "On": [1, 12, 13, 37], "docker": 1, "network": [1, 12, 13, 17, 19, 24, 26, 35, 36, 38], "cloudbuild": 1, "down": [1, 4, 5, 21, 24, 38], "imag": [1, 12, 22, 24, 25, 28, 31, 34], "do": [1, 2, 4, 5, 9, 12, 13, 14, 16, 17, 19, 20, 21, 23, 25, 26, 27, 28, 31, 33, 34, 35, 38], "doe": [1, 2, 4, 12, 13, 14, 17, 18, 19, 20, 23, 25, 27, 34, 35, 36], "read": [1, 3, 5, 12, 13, 16, 35], "write": [1, 5, 13, 17, 18, 36], "silo": 1, "each": [1, 2, 4, 5, 10, 12, 13, 16, 17, 18, 19, 20, 21, 25, 27, 29, 31, 32, 34, 35, 36, 37, 38], "uniqu": [1, 16, 17, 21, 25, 27, 34], "benefit": [1, 4, 15, 22, 33, 37], "consist": [1, 10, 12, 16, 18], "remote_default_exec_properti": 1, "some_silo_kei": 1, "bazel_remote_cach": 1, "1": [1, 3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 19, 20, 23, 24, 27, 28, 29, 30, 31, 32, 35, 36, 38], "silo_nam": 1, "your": [1, 2, 6, 8, 9, 11, 12, 16, 17, 18, 19, 20, 21, 22, 25, 27, 28, 32, 34, 35, 36, 37, 38], "tpuvm_mod": 1, "gcloud_service_key_fil": 1, "application_default_credenti": 1, "json": [1, 4], "might": [1, 2, 5, 13, 16, 17, 19, 20, 21, 23, 25, 34], "help": [1, 16, 17, 19, 20, 22, 23, 25, 34], "too": [1, 4, 19, 25, 34], "cannot": [1, 7, 8, 23, 25, 26, 31, 34, 38], "here": [1, 2, 5, 7, 9, 14, 16, 17, 18, 20, 21, 25, 28, 29, 31, 32, 34, 35, 36, 37], "author": [1, 38], "usernam": [1, 4], "behavior": [1, 2, 5, 12, 13, 17, 19, 27], "function": [1, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 19, 21, 23, 24, 29, 30, 32, 33, 37, 38], "intend": [1, 15], "first": [1, 2, 3, 8, 9, 11, 13, 14, 16, 18, 19, 20, 21, 23, 28, 35, 36, 37, 38], "time": [1, 2, 3, 4, 11, 12, 13, 14, 19, 20, 21, 23, 25, 27, 29, 30, 34, 35, 38], "slow": [1, 4, 8, 16, 19, 21], "scratch": [1, 2], "veri": [1, 6, 7, 17, 20, 21, 25, 34], "fast": [1, 25, 34], "updat": [1, 2, 4, 9, 10, 16, 17, 18, 21, 22, 25, 34, 35], "onc": [1, 10, 13, 16, 17, 19, 20, 21, 24, 25, 27, 29, 34, 35, 38], "again": [1, 2, 4, 17, 20, 38], "bit": [1, 13, 17, 33], "slower": [1, 15, 19, 20, 28, 38], "per": [1, 11, 12, 13, 15, 16, 17, 19, 24, 28, 29, 33], "until": [1, 13, 17, 18, 20, 24, 37], "next": [1, 4, 13, 18, 19, 20, 21, 25, 33, 34, 35, 38], "quit": 1, "current": [1, 4, 6, 7, 13, 14, 15, 16, 17, 18, 23, 24, 25, 27, 29, 30, 32, 33, 34, 35], "migrat": [1, 11, 12, 24], "futur": [1, 2, 3, 6, 12, 15, 17, 19, 23, 25, 27, 32, 34], "plafrom": 1, "cpp": [1, 4, 5, 19], "main": [1, 3, 9, 10, 12, 15, 16, 35], "Of": 1, "cours": 1, "pjrt": [1, 13, 17, 22, 35], "Not": 1, "environment": 1, "variabl": [1, 3, 4, 12, 14, 20, 24, 25, 34], "miss": [1, 5, 13, 19], "common": [1, 12, 16, 17, 24, 25, 32, 33, 34, 36, 37], "part": [1, 2, 6, 12, 13, 15, 19, 20, 23, 35, 38], "ones": [1, 13, 25, 34], "helper": [1, 2, 13], "script": [1, 2, 3, 7, 12, 16, 17, 18, 19, 21, 23, 26, 28, 38], "run_test": 1, "sh": 1, "r": [1, 21], "xla_client": 1, "pure": [1, 2, 8, 15, 27], "easili": [1, 5, 25, 29, 34], "execut": [1, 4, 11, 12, 13, 15, 17, 21, 22, 23, 24, 25, 26, 27, 28, 29, 34, 35, 36, 38], "parallel": [1, 11, 12, 13, 16, 19, 20, 22, 35, 36], "sinc": [1, 2, 5, 12, 16, 17, 19, 23, 25, 26, 28, 29, 32, 34, 35, 37], "xrt": [1, 13], "port": 1, "tpu": [1, 2, 5, 6, 7, 8, 13, 14, 15, 18, 19, 23, 24, 28, 29, 30, 36, 37], "devic": [1, 2, 3, 5, 6, 8, 10, 11, 12, 13, 14, 15, 18, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29, 30, 33, 34, 37, 38], "avail": [1, 12, 13, 16, 17, 19, 20, 21, 24, 25, 31, 34], "reason": [1, 2, 5, 12, 21, 28], "bundl": 1, "target": [1, 12, 15, 16, 17, 23, 24, 25, 26, 29, 34], "sequenti": [1, 13], "calcul": [1, 15, 16, 38], "visual": [1, 35, 36, 38], "lcov": 1, "describ": [1, 2, 3, 4, 9, 13, 17, 21, 23, 26, 28, 36], "document": [1, 2, 3, 5, 6, 9, 12, 17, 26, 27, 28, 33], "editor": 1, "choic": [1, 25, 34], "gutter": 1, "vscode": 1, "power": [1, 24], "like": [1, 2, 3, 4, 5, 7, 8, 9, 12, 13, 15, 16, 17, 18, 19, 20, 22, 24, 25, 26, 31, 34, 35, 38], "clangd": 1, "refer": [1, 2, 5, 7, 10, 12, 13, 14, 16, 17, 22, 31, 33, 35, 36], "autocomplet": 1, "semant": [1, 5, 19, 25, 34], "understand": [1, 9, 15, 18, 21, 23, 25, 34], "underli": [1, 13, 16, 17, 36], "stack": [1, 4, 8, 17, 19, 25, 26, 34, 35], "combin": [1, 5, 8, 13, 25, 27, 34], "studio": 1, "extens": [1, 3, 4, 5, 6, 16], "featur": [1, 4, 7, 9, 12, 14, 19, 22, 28, 33, 35, 36, 37], "assist": 1, "edit": 1, "As": [1, 2, 4, 8, 9, 20, 21, 23, 25, 27, 32, 34], "distutil": 1, "ltc": 2, "lazi": [2, 13, 15, 18, 19, 22, 24, 25, 27, 29, 34, 35], "tensor": [2, 4, 5, 8, 9, 10, 11, 12, 13, 14, 16, 18, 20, 21, 22, 23, 24, 26, 27, 29, 30, 32, 33, 35, 36, 38], "core": [2, 4, 5, 10, 11, 12, 13, 15, 17, 18, 19, 21, 22, 23, 24, 26, 28, 29, 30, 31, 32, 33, 36], "clean": [2, 4, 19, 29], "exist": [2, 12, 13, 17, 19, 22, 29, 35], "stub": 2, "over": [2, 4, 8, 12, 13, 15, 16, 17, 20, 21, 31, 36, 37], "6": [2, 3, 5, 8, 13, 16, 19, 21, 25, 34, 36, 38], "were": [2, 15, 17, 19, 20, 21, 23, 25, 34, 38], "complet": [2, 13, 15, 16, 17, 19, 24], "process": [2, 4, 5, 6, 10, 11, 12, 13, 15, 16, 19, 21, 22, 23, 24, 28, 33], "found": [2, 12, 21, 38], "ref": [2, 3, 12], "oper": [2, 4, 8, 10, 11, 12, 13, 15, 16, 17, 18, 20, 21, 22, 23, 24, 27, 36, 37, 38], "xla_native_funct": [2, 5], "yaml": [2, 5], "replac": [2, 4, 8, 16, 21, 24, 30], "support": [2, 6, 7, 8, 9, 11, 12, 13, 14, 16, 22, 25, 27, 29, 30, 31, 34, 35, 37, 38], "an": [2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 31, 32, 34, 35, 36, 37, 38], "equival": [2, 38], "full_codegen": 2, "NOT": 2, "introduc": [2, 7, 10, 12, 15, 19, 20, 23, 27, 28, 35], "ani": [2, 4, 7, 12, 13, 14, 15, 17, 19, 21, 22, 23, 25, 27, 28, 31, 32, 34, 35, 36, 37, 38], "purpos": [2, 5, 8, 15, 33], "info": [2, 4, 13, 19, 25, 34, 36, 38], "about": [2, 3, 11, 12, 13, 15, 16, 17, 21, 22, 25, 34, 36], "dispatch": [2, 4, 5, 16, 18, 37], "exyang": 2, "blog": [2, 27], "post": [2, 13, 19, 27], "follow": [2, 4, 5, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 25, 28, 31, 32, 34, 35, 36], "instruct": [2, 4, 5, 18, 20, 21], "depend": [2, 3, 5, 14, 15, 17, 21, 25, 26, 27, 34, 36], "build": [2, 5, 11, 15, 16, 17, 18, 21, 23, 24, 31, 38], "It": [2, 3, 4, 5, 8, 10, 13, 14, 16, 17, 18, 20, 21, 22, 23, 24, 25, 29, 31, 32, 33, 34, 35, 36, 38], "experi": [2, 4, 5, 12, 15, 16, 22, 28, 37, 38], "workstat": [2, 5], "cpu": [2, 5, 10, 13, 16, 18, 19, 20, 21, 23, 25, 31, 33, 34, 35, 37, 38], "pjrt_devic": [2, 5, 6, 12, 14, 16, 17, 19, 24, 28, 30, 38], "re": [2, 12, 13, 15, 16, 19, 23, 24, 25, 26, 27, 30, 34], "familiar": [2, 11, 16, 17, 22, 24], "issu": [2, 5, 8, 12, 13, 15, 17, 19, 21, 23, 26, 28, 32], "3560": 2, "track": [2, 19, 37], "statu": [2, 19], "put": [2, 5, 17, 19, 28, 38], "alia": [2, 10, 13, 24], "avoid": [2, 16, 17, 19, 20, 21, 23, 26], "duplic": 2, "mention": [2, 5, 25, 29, 34], "below": [2, 5, 9, 10, 12, 16, 17, 21, 25, 26, 34, 37], "live": [2, 5, 13, 25, 34], "folder": [2, 3, 4, 5], "except": [2, 5, 20, 22, 23, 35], "torch": [2, 3, 4, 7, 8, 11, 13, 14, 16, 17, 18, 19, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 36, 37, 38], "shape_infer": 2, "shape": [2, 5, 7, 8, 9, 11, 13, 16, 19, 20, 22, 27, 30, 35, 36, 38], "defin": [2, 4, 5, 7, 9, 13, 16, 18, 21, 24, 26, 30, 32, 35, 36, 38], "input": [2, 5, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 22, 24, 26, 27, 30, 32, 35, 36, 37], "return": [2, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 19, 21, 24, 25, 27, 28, 29, 30, 33, 34, 35, 37, 38], "output": [2, 3, 4, 7, 8, 9, 10, 12, 13, 16, 17, 19, 24, 26, 27, 28, 29, 30, 31, 35, 38], "manual": [2, 5, 7, 19, 31], "gen_lazy_tensor": 2, "data": [2, 10, 11, 12, 13, 15, 17, 18, 21, 22, 24, 25, 26, 29, 34, 36, 37], "aten": [2, 4, 5, 9, 16, 19, 25, 34], "specif": [2, 4, 8, 13, 15, 16, 17, 18, 20, 21, 22, 23, 28, 33, 36], "run_gen_lazy_tensor": 2, "dest": 2, "lazy_ir": 2, "class": [2, 6, 8, 9, 10, 13, 16, 17, 24, 27, 28, 31, 33, 36, 37, 38], "genlazyir": 2, "back": [2, 5, 13, 16, 17, 19, 21, 35], "todai": [2, 14], "most": [2, 6, 12, 13, 16, 18, 19, 29], "categori": [2, 32], "goal": [2, 3, 5, 10, 38], "move": [2, 12, 13, 16, 19, 24, 25, 27, 28, 34, 37, 38], "necessari": [2, 13, 16, 19, 21, 24, 26], "call": [2, 4, 5, 9, 10, 12, 13, 14, 15, 16, 17, 19, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 34, 35, 37, 38], "upstream": [2, 10, 14, 27], "api": [2, 5, 9, 12, 17, 22, 25, 28, 29, 31, 33, 34, 35, 37], "xlanativefunct": [2, 5], "column": 2, "declar": [2, 5], "anoth": [2, 14, 17, 19, 21, 25, 34, 38], "wrap": [2, 5, 6, 7, 13, 16, 17, 20, 21, 23, 26, 27, 28, 31, 32, 33, 35], "around": [2, 12, 25, 31, 34, 36], "xlatensor": [2, 5, 13, 35], "construct": [2, 5, 17, 20, 31, 35, 37], "aten_xla_typ": [2, 5], "Will": 2, "method": [2, 9, 12, 13, 18, 26, 32, 35, 37], "map": [2, 5, 10, 13], "node": [2, 5, 10, 12, 13, 19, 25, 34], "remov": [2, 12, 19, 21], "tensor_method": [2, 5], "possibl": [2, 12, 17, 19, 22, 23, 31, 32, 35, 38], "multipl": [2, 10, 13, 15, 16, 18, 20, 24, 25, 28, 29, 33, 34, 36, 38], "few": [2, 17, 19, 21, 24, 25, 28, 34, 37], "simpler": [2, 12], "go": [2, 17, 21, 26, 35], "unari": 2, "binari": [2, 4, 6, 22, 29, 38], "exampl": [2, 3, 4, 5, 6, 9, 10, 12, 13, 14, 15, 17, 19, 20, 22, 23, 25, 27, 28, 29, 32, 33, 34, 35, 36, 37, 38], "characterist": 2, "fallback": [2, 5], "_adaptive_avg_pool3d": 2, "condit": [2, 15, 16, 17, 25, 30, 34], "issupportedadaptivepool": 2, "xlahelp": 2, "i64list": 2, "self": [2, 5, 6, 8, 9, 10, 13, 16, 17, 21, 24, 27, 28, 33, 35], "size": [2, 8, 10, 12, 14, 16, 17, 19, 20, 21, 23, 25, 34, 36, 37, 38], "output_size_list": 2, "pool_dim": 2, "nativ": [2, 4, 5, 12, 15, 16, 19, 26, 28, 35], "call_fallback_fn": 2, "xla_fallback": 2, "aten_op": 2, "output_s": 2, "wip": 2, "evolv": 2, "At": [2, 4, 6, 13, 22], "point": [2, 3, 4, 5, 6, 11, 13, 16, 17, 18, 22, 23, 25, 26, 34], "self_tensor": 2, "static": [2, 14, 15, 16, 25, 34], "bool": [2, 13], "sync_upd": 2, "sys_util": 2, "getenvbool": 2, "xla_tensor_update_sync": 2, "true": [2, 4, 8, 12, 13, 15, 16, 18, 20, 21, 24, 25, 28, 31, 34, 35, 37, 38], "xla_check": 2, "dst_tensor": 2, "updatefromtensor": 2, "sync": [2, 12, 13, 15, 16, 17, 19, 20, 21, 22, 23, 24, 26, 28], "complic": [2, 5, 7, 15], "would": [2, 3, 5, 12, 13, 17, 18, 19, 21, 25, 30, 34, 38], "someth": [2, 8, 21, 23], "ab": [2, 31], "const": [2, 5, 10], "torch_lazy_fn_count": 2, "bridg": [2, 22, 29], "atenfromxlatensor": 2, "getxlatensor": 2, "fail": [2, 4, 13, 17, 19, 37], "explain": [2, 6, 17, 19, 20, 21, 25, 27, 34], "later": [2, 20, 23, 24, 27], "still": [2, 10, 12, 17, 18, 25, 26, 28, 34, 37], "If": [2, 3, 4, 5, 8, 9, 12, 13, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 33, 34, 35, 36, 38], "while": [2, 8, 9, 10, 11, 13, 15, 16, 17, 18, 20, 22, 25, 28, 34], "error": [2, 9, 13, 17, 19], "involv": [2, 13, 18, 25, 34, 35], "problem": [2, 25, 34], "yet": [2, 5, 10, 16], "attempt": [2, 37], "unblock": [2, 37], "snippet": [2, 4, 16, 17, 35, 36], "auto": [2, 5, 13, 31, 37], "common_devic": 2, "getxladevic": 2, "torch_internal_assert": 2, "xlatensorptr": 2, "lazy_self": 2, "getxlatensororcreateforwrappednumb": 2, "nodeptr": 2, "reusenod": 2, "getirvalu": 2, "makenod": 2, "cachenod": 2, "creat": [2, 4, 9, 11, 12, 13, 16, 19, 20, 21, 22, 24, 26, 27, 28, 35, 36, 37, 38], "std": [2, 10, 28], "get": [2, 5, 12, 13, 14, 16, 21, 22, 24, 25, 28, 31, 33, 34], "check": [2, 3, 5, 9, 13, 16, 17, 24, 33], "reus": [2, 8, 17, 20, 21, 22, 27], "previou": [2, 4, 12, 17, 18, 21, 25, 34, 36, 38], "creation": [2, 13], "correspond": [2, 5, 10, 13, 20, 26, 31, 35, 36], "cach": [2, 7, 13, 14, 22, 27], "newli": 2, "And": [2, 25, 28, 34, 35], "within": [2, 13, 15, 16, 17, 19, 23, 33, 36, 37], "note": [2, 3, 7, 10, 12, 13, 15, 16, 17, 19, 20, 21, 23, 25, 29, 31, 32, 33, 34, 36], "done": [2, 3, 7, 16, 17, 19, 20, 21, 23, 25, 34, 38], "public": [2, 12], "xlanod": 2, "xlavalu": 2, "opkind": [2, 5], "absoutputshap": 2, "num_output": [2, 25, 34], "mhash": 2, "string": [2, 10, 13, 35, 38], "tostr": 2, "overrid": [2, 13], "stringstream": 2, "ss": 2, "str": [2, 6, 9, 13, 38], "xlaopvector": 2, "loweringcontext": 2, "loctx": 2, "A": [2, 6, 11, 12, 13, 15, 16, 17, 18, 20, 25, 26, 32, 33, 34, 35, 36], "coupl": [2, 17, 19], "thing": [2, 19, 23, 27], "keep": [2, 3, 12, 14, 19, 25, 34, 38], "mind": [2, 12, 16, 19], "clone": [2, 12, 19, 21], "even": [2, 12, 13, 15, 17, 19, 25, 27, 28, 34, 38], "everi": [2, 5, 7, 8, 12, 13, 16, 17, 19, 25, 27, 29, 34, 35, 37], "outputshap": 2, "xla_shap": 2, "overli": 2, "simplifi": 2, "buildxxxop": 2, "slightli": [2, 5, 13], "better": [2, 5, 12, 15, 16, 17, 19, 21, 23, 25, 29, 30, 34], "maximumoutputshap": 2, "lower_for_shape_fn": 2, "absl": 2, "xlaop": [2, 5], "operand": 2, "promot": 2, "max": [2, 25, 34, 37], "second": [2, 8, 9, 14, 15, 19, 21, 28, 36], "inferoutputshap": 2, "comput": [2, 3, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 34, 35, 36], "logic": [2, 8, 13, 16, 24, 25, 30, 34, 35, 36], "two": [2, 4, 6, 12, 13, 17, 18, 19, 20, 21, 23, 25, 34, 35, 36, 38], "xla_input": 2, "getoutputop": 2, "returnop": 2, "buildab": 2, "origin": [2, 21], "genericop": 2, "modifi": [2, 17, 21, 24, 26, 29, 35, 38], "abov": [2, 5, 6, 9, 13, 14, 17, 19, 20, 21, 23, 24, 25, 28, 29, 34, 36], "delet": 2, "sometim": [2, 20, 22, 25, 34], "being": [2, 13, 17, 20, 24, 28, 36, 38], "tensor_op": 2, "cross": [2, 13, 17, 35], "s1": [2, 35], "sub": 2, "mul": [2, 13, 25, 34, 38], "u2": 2, "v3": [2, 16, 17, 28], "u3": 2, "v2": [2, 3, 17], "irnod": 2, "those": [2, 4, 5, 13, 19, 23, 28], "long": [2, 8, 15, 18, 19, 20, 21, 23, 25, 28, 34], "term": [2, 15, 19, 25, 34, 38], "rid": [2, 25, 34], "composit": [2, 5], "end": [2, 5, 12, 13, 14, 17, 19, 20, 21, 24, 28, 31, 32], "exp": 2, "pow": 2, "norm_exp": 2, "vector": 2, "don": [2, 5, 12, 14, 17, 19, 25, 31, 34], "t": [2, 5, 12, 13, 14, 16, 17, 18, 19, 25, 26, 31, 32, 34, 35, 36, 37], "build_cpp_test": 2, "skip": [2, 5, 19, 29], "desir": [2, 21, 36, 37], "test_ptxla": 2, "gtest_filt": 2, "atenxlatensortest": 2, "testab": 2, "correct": [2, 16, 18, 25, 27, 34], "counter": [2, 5, 13, 19], "correctli": [2, 19, 32], "bitwise_left_shift": 2, "pull": [2, 26, 28, 31], "8865": 2, "erf": 2, "erfc": 2, "erfinv": 2, "3659": 2, "binary_cross_entropi": [2, 26], "backward": [2, 5, 8, 12, 15, 16, 17, 24, 26, 28, 29, 31, 32], "3809": 2, "scalar": [2, 5, 13, 19, 25, 34], "addcdiv": 2, "addcmul": 2, "3768": 2, "neg": 2, "index": [2, 3, 6, 7, 12, 13, 16, 17, 19, 21, 24, 36], "amin": 2, "amax": 2, "3771": 2, "special": [2, 9, 20, 35, 38], "partial": [2, 25, 31, 32, 34], "adaptive_avgpool3d": 2, "3790": 2, "guid": [3, 4, 7, 8, 11, 12, 16, 17, 20, 22, 23, 24, 31, 32, 35], "interact": [3, 11, 12], "start": [3, 4, 12, 16, 17, 18, 19, 21, 23, 24], "colab": [3, 19, 38], "kaggl": 3, "preinstal": [3, 12], "ecosystem": [3, 15, 22, 33], "packag": [3, 11, 17, 22, 26, 28, 38], "date": [3, 38], "list": [3, 4, 5, 8, 13, 21, 26, 27, 30, 35, 36], "readm": [3, 19, 21], "prerequisit": [3, 35], "remot": 3, "quota": 3, "request": [3, 4, 5, 13, 19, 21, 25, 26, 28, 34, 35, 36], "offici": [3, 4, 19], "ssh": [3, 12, 17, 21, 22], "regist": [3, 5, 6, 9, 10, 12, 37], "agent": 3, "alreadi": [3, 7, 13, 16, 19, 23, 24, 25, 28, 31, 34, 37], "befor": [3, 4, 7, 10, 12, 13, 16, 17, 18, 19, 20, 23, 24, 25, 26, 28, 29, 32, 34, 35, 37, 38], "begin": [3, 17, 18, 35, 38], "zone": [3, 12, 17, 21, 22], "tpu_typ": 3, "8": [3, 8, 9, 12, 13, 15, 16, 17, 20, 21, 22, 23, 25, 28, 29, 33, 34, 35, 36], "vm": [3, 12, 17, 19, 21, 22, 28], "assum": [3, 6, 7, 13, 17, 18, 25, 28, 32, 34, 35, 36], "id_ed25519": 3, "type": [3, 4, 6, 9, 12, 13, 17, 18, 19, 22, 26, 28, 38], "ubuntu2204": 3, "base": [3, 10, 12, 13, 15, 17, 19, 21, 22, 25, 27, 31, 34, 35, 36, 38], "metadata": [3, 19], "cat": [3, 26], "pub": 3, "ip": [3, 12, 13, 37], "format": [3, 9, 13, 19, 22, 29, 33, 38], "valu": [3, 4, 5, 8, 12, 13, 14, 16, 17, 19, 20, 21, 24, 25, 27, 30, 34, 35, 38], "networkendpoint": 3, "accessconfig": 3, "externalip": 3, "123": 3, "give": [3, 19, 23, 33, 35, 36], "friendli": 3, "easier": [3, 21, 25, 34], "echo": 3, "host": [3, 12, 13, 16, 17, 18, 19, 20, 21, 22, 23, 26, 31, 37], "n": [3, 13, 16, 28, 33, 36], "hostnam": 3, "test": [3, 4, 6, 7, 12, 14, 27, 28, 31, 38], "vs": [3, 8, 11, 12, 25, 34], "palett": 3, "select": [3, 4, 12, 13, 24, 37], "visualstudio": 3, "doc": [3, 7, 8, 12, 13, 16, 17, 25, 34], "__": [3, 12], "just": [3, 7, 12, 17, 18, 24, 25, 28, 31, 34, 37], "titl": [3, 12], "open": [3, 4, 5, 6, 12, 19, 22], "window": 3, "termin": [3, 24, 37], "mkdir": [3, 24], "ptxla": 3, "Then": [3, 4, 9, 16, 21], "ui": 3, "venv": 3, "virtual": [3, 4, 13], "latest": [3, 7, 17], "releas": [3, 6, 7, 10, 12, 15, 17, 19, 22, 29, 31, 32, 33, 35], "pip": [3, 4, 7, 11, 21, 24], "numpi": [3, 7, 9, 13, 23, 36], "f": [3, 7, 9, 13, 16, 17, 24, 28, 31, 33, 37, 38], "googleapi": [3, 7, 22], "libtpu": [3, 6, 12, 38], "wheel": [3, 22, 31], "html": [3, 7, 12, 13, 31], "import": [3, 4, 6, 7, 8, 9, 11, 12, 13, 14, 15, 17, 19, 20, 21, 24, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38], "set_device_typ": 3, "print": [3, 4, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 24, 25, 27, 28, 29, 34, 35, 37, 38], "real_devic": 3, "run": [3, 4, 5, 7, 8, 12, 13, 14, 15, 16, 18, 20, 22, 23, 25, 26, 27, 28, 29, 31, 33, 34, 36, 37, 38], "2": [3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19, 22, 23, 24, 27, 29, 30, 31, 32, 33, 35, 36, 38], "3": [3, 5, 6, 7, 8, 9, 13, 15, 16, 19, 20, 21, 24, 29, 30, 31, 33, 35, 36, 38], "4": [3, 6, 7, 8, 9, 12, 13, 16, 17, 19, 21, 24, 25, 29, 30, 31, 33, 34, 35, 36, 38], "5": [3, 8, 10, 13, 14, 16, 19, 21, 24, 25, 27, 28, 31, 33, 34, 36], "7": [3, 13, 16, 19, 24, 28, 29, 36, 38], "number": [3, 4, 8, 12, 13, 14, 15, 16, 19, 20, 21, 27, 31, 35, 36], "vari": [3, 12, 15, 25, 32, 34], "That": [3, 8, 25, 27, 34], "now": [3, 9, 10, 12, 17, 20, 21, 23, 25, 34, 35, 38], "realist": 3, "show": [4, 8, 9, 10, 12, 17, 19, 28, 38], "how": [4, 5, 7, 8, 9, 10, 13, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 34, 35, 38], "contributor": 4, "xla": [4, 5, 8, 9, 10, 12, 14, 23, 25, 27, 28, 29, 30, 32, 34, 35, 37], "conda": 4, "forg": 4, "probabl": [4, 25, 34], "interest": [4, 28, 38], "o0": 4, "use_custom_debinfo": 4, "file1": 4, "file2": 4, "caus": [4, 5, 12, 13, 15, 16, 17, 19, 23, 25, 34], "prevent": [4, 13, 15, 21, 29, 35], "perform": [4, 5, 7, 9, 10, 11, 13, 17, 20, 21, 22, 24, 26, 27, 28, 29, 31, 33, 35, 38], "meaning": 4, "semicolon": 4, "let": [4, 7, 12, 15, 16, 17, 19, 21, 23, 24, 29], "suggest": [4, 19], "step": [4, 8, 12, 13, 15, 16, 17, 18, 19, 21, 23, 25, 27, 28, 29, 31, 32, 34, 35, 37], "identifi": [4, 6, 13, 15, 17, 36, 37, 38], "similar": [4, 5, 12, 15, 16, 21, 22, 23, 28, 30, 33], "src": [4, 37], "linear": [4, 12, 13, 16, 17, 22, 24, 26, 27, 28, 33], "m": [4, 5, 9, 10, 25, 31, 34, 36, 38], "isol": [4, 18], "v": [4, 7, 9, 16, 27], "breakpoint": 4, "session": 4, "discov": [4, 37], "addit": [4, 5, 6, 12, 17, 19, 20, 21, 23, 26, 28], "rebuild": 4, "newfil": 4, "readi": [4, 21], "howev": [4, 5, 7, 8, 9, 15, 19, 20, 21, 23, 35], "full": [4, 13, 17, 18, 19, 31, 38], "unfortun": 4, "touch": [4, 28, 37], "its": [4, 5, 10, 12, 14, 15, 16, 17, 18, 19, 22, 27, 28, 29, 31, 35, 38], "timestamp": [4, 18], "reliabl": [4, 12], "rebuilt": 4, "wa": [4, 12, 13, 15, 19, 23, 25, 34, 37, 38], "use_rocm_kernel_assert": 4, "off": [4, 13, 20], "has_wmissing_prototyp": 4, "has_werror_missing_prototyp": 4, "util": [4, 7, 9, 11, 13, 15, 16, 17, 19, 24, 28, 31, 32, 33, 36, 37], "scalarop": 4, "emptytensor": 4, "shut": 4, "must": [4, 5, 6, 8, 10, 12, 13, 17, 18, 19, 27, 32, 37], "pack": [4, 38], "publish": 4, "microsoft": 4, "search": [4, 5], "ms": [4, 27], "cpptool": 4, "tab": 4, "sampl": [4, 9, 12, 13, 19], "ll": [4, 5, 8, 16, 24, 25, 34, 38], "adjust": [4, 16, 17, 24], "match": [4, 5, 9, 13, 15, 17, 19], "interpret": [4, 13, 25, 34, 38], "cppdbg": 4, "program": [4, 7, 8, 9, 13, 17, 19, 20, 25, 29, 34, 35, 36], "home": 4, "miniconda3": 4, "env": [4, 12, 13, 35], "torch310": 4, "bin": 4, "arg": [4, 9, 13, 16, 17, 21, 30, 31], "cwd": 4, "workspacefold": 4, "externalconsol": 4, "fals": [4, 9, 10, 13, 16, 17, 18, 31, 35, 38], "mimod": 4, "setupcommand": 4, "descript": 4, "pretti": [4, 17, 25, 28, 34], "text": [4, 19], "ignorefailur": 4, "disassembl": 4, "flavor": 4, "intel": 4, "prelaunchtask": 4, "activ": [4, 8, 13, 17, 19, 28, 31, 32, 33], "midebuggerpath": 4, "locat": [4, 13], "But": [4, 17, 19, 25, 34, 38], "quirk": 4, "switch": [4, 8, 15, 17, 19, 25, 28, 34], "between": [4, 10, 12, 14, 15, 16, 17, 19, 20, 22, 23, 25, 26, 28, 30, 34, 35, 38], "vadimcn": 4, "id": [4, 12, 13, 19, 22, 36], "click": 4, "left": [4, 19], "red": 4, "dot": [4, 9, 19], "displai": [4, 23], "indic": [4, 8, 13, 19, 23, 24, 25, 34, 36], "dropdown": 4, "right": [4, 15, 18, 25, 29, 34], "green": 4, "plai": 4, "button": 4, "rule": [4, 23, 26], "after": [4, 5, 8, 10, 12, 13, 15, 16, 17, 18, 19, 21, 24, 25, 30, 34, 35], "empti": [4, 13], "white": 4, "circl": 4, "load": [4, 12, 13, 19, 22, 24, 28, 31, 33, 37], "librari": [4, 5, 6, 9, 21, 22, 23, 36, 37], "trigger": [4, 15, 16, 19, 20, 21, 24, 25, 27, 34], "einsum": [4, 27], "yellow": 4, "arrow": 4, "collect": [4, 12, 28, 29, 36, 37], "certain": [4, 10, 16, 19, 25, 26, 34, 38], "diagnost": 4, "turn": [4, 19, 38], "cuda": [4, 13, 16, 17, 18, 21, 24, 25, 33, 34], "handl": [4, 6, 18, 19, 24, 25, 31, 32, 34, 35, 36], "trace": [4, 8, 11, 12, 13, 15, 19, 20, 22, 23, 25, 26, 28, 29, 34, 35], "ld_library_path": 4, "cflag": 4, "dhas_torch_show_dispatch_trac": 4, "demonstr": [4, 8, 10, 15, 23, 26, 37, 38], "offer": [5, 9, 13, 15, 16, 22, 32, 33], "implement": [5, 7, 8, 10, 11, 12, 15, 19, 25, 29, 31, 32, 34], "gpu": [5, 7, 11, 14, 19, 21, 22, 24, 38], "convert": [5, 9, 13, 17, 22, 23, 27, 28, 38], "higher": [5, 8, 19, 37], "level": [5, 8, 13, 19, 22, 23, 24, 29, 33, 37], "represent": [5, 8, 13, 17, 22, 38], "i": [5, 8, 9, 12, 13, 17, 25, 27, 31, 34, 35, 36, 38], "hlo": [5, 8, 13, 17, 19, 20, 22], "beyond": 5, "scope": 5, "forward": [5, 9, 13, 15, 16, 17, 24, 26, 27, 28, 29, 32, 33], "haven": [5, 25, 34], "signific": [5, 15, 16, 18, 19, 20, 21, 22, 23, 29], "slowdown": [5, 16, 19, 28], "best": [5, 7, 15, 16, 29, 33, 36], "what": [5, 17, 20, 21, 27], "debug": [5, 11, 15, 16, 25, 33, 34, 36], "pt": [5, 12, 16, 17, 19, 22], "profil": [5, 12, 16, 21, 22], "_ctc_loss": [5, 19], "_ctc_loss_backward": [5, 19], "contribut": [5, 38], "definit": [5, 16, 17, 24, 25, 34], "native_funct": 5, "kernel": [5, 8, 9, 11, 25, 33, 34], "aten_fallback": 5, "h": [5, 16, 38], "repo": [5, 17, 19, 21, 28], "sequenc": [5, 8, 13], "explicitli": [5, 15, 16, 17, 18, 19, 20, 24, 25, 26, 34], "compos": [5, 16, 24], "serv": [5, 21], "interfac": [5, 6, 17, 19, 37], "machineri": [5, 9], "registerxla": 5, "registerautogradxla": 5, "entri": [5, 6, 16], "pytorch_xla": 5, "world": [5, 7, 12, 25, 29, 34, 37], "written": [5, 21, 37], "paramet": [5, 9, 12, 13, 16, 17, 19, 24, 26, 27, 28, 32, 35, 37], "result": [5, 8, 10, 12, 13, 14, 17, 18, 19, 20, 21, 22, 28, 30, 35, 38], "wrapper": [5, 15, 17, 28, 31, 32], "inplac": [5, 13, 35], "ir": [5, 13, 19, 20, 22, 25, 27, 34], "insid": [5, 16, 17, 20, 21, 23, 27, 35], "stand": 5, "intermedi": [5, 8, 12, 19, 20, 22, 38], "smaller": [5, 20, 21, 23, 25, 34], "inherit": 5, "dai": 5, "unless": [5, 19, 25, 34], "verifi": [5, 11, 13, 38], "test_oper": 5, "test_aten_xla_tensor": 5, "yield": [5, 17, 19, 38], "break": [5, 15, 20, 21, 24, 25, 34, 38], "grasp": 5, "capabl": [5, 22], "minim": [5, 11, 22, 23, 24], "pr": [5, 19, 31], "vanilla": 5, "lerp": 5, "variant": [5, 25, 26, 34], "lerp_": 5, "scalar_out": 5, "tensor_out": 5, "prototyp": [5, 35], "weight": [5, 13, 19, 32, 33], "lerp_out": 5, "namespac": [5, 19], "wrapper_scalar_lerp": 5, "No": [5, 12, 14, 16, 25, 27, 33, 34], "deviceguard": 5, "omit": [5, 36], "anonym": 5, "wrapper_scalar_lerp_": 5, "wrapper_scalar_lerp__tmp": 5, "_copy_from": 5, "impl": [5, 9, 10], "torch_fn": 5, "automat": [5, 6, 11, 12, 13, 17, 19, 20, 24, 25, 31, 34, 36, 37], "explicit": [5, 18, 22, 26, 31], "place": [5, 10, 13, 21, 23, 26, 35, 37, 38], "interned_str": 5, "symbol": [5, 25, 34], "submit": [5, 18, 19, 20, 26], "team": [6, 29], "tf": [6, 19, 25, 34], "close": [6, 15], "expos": [6, 12, 17, 20, 35], "deviceplugin": 6, "short": [6, 19, 25, 34], "pjrtclient": 6, "mirror": 6, "pjrt_api": 6, "straightforward": [6, 13, 23], "detail": [6, 7, 8, 9, 10, 12, 13, 17, 19, 24, 25, 34, 36], "concret": [6, 25, 34], "placehold": 6, "pjrt_library_path": 6, "extra": [6, 28, 32, 38], "multiprocess": [6, 12, 13, 17], "compon": [6, 38], "least": [6, 13, 23], "cpuplugin": 6, "def": [6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 18, 21, 24, 27, 28, 29, 30, 32, 33, 38], "library_path": 6, "os": [6, 12, 17, 28], "join": [6, 13], "dirnam": 6, "__file__": 6, "pjrt_c_api_cpu_plugin": 6, "exmapl": 6, "pyproject": 6, "toml": 6, "torch_xla_cpu_plugin": 6, "With": [6, 7, 12, 14, 25, 29, 34], "initi": [6, 10, 12, 13, 16, 17, 18, 21, 24, 28, 30, 37], "experiment": [6, 7, 8, 11, 12, 14, 15, 27, 28, 29, 30, 32, 33, 35, 37], "state": [6, 8, 13, 16, 18, 31], "becom": [6, 7, 8, 12, 15, 17, 19, 21, 25, 34], "stabl": [6, 12, 22, 23, 31], "rise": 7, "openai": 7, "triton": 7, "popular": 7, "commun": [7, 10, 12, 13, 17, 20, 21, 23, 29, 36], "instanc": [7, 10, 13, 31, 37], "order": [7, 8, 13, 17, 18, 19, 21, 23, 35, 36], "pariti": 7, "continu": [7, 12, 22, 29], "push": 7, "custom_kernel": 7, "jax_import_guard": 7, "pl": [7, 12, 16, 17, 35], "jnp": [7, 9], "add_vectors_kernel": 7, "x_ref": 7, "y_ref": 7, "o_ref": 7, "x": [7, 8, 9, 13, 16, 17, 19, 20, 24, 25, 27, 28, 30, 31, 32, 33, 34, 35, 36, 38], "y": [7, 8, 9, 13, 19, 20, 22, 25, 27, 31, 32, 33, 34, 35, 36, 38], "jit": [7, 9, 17, 29], "add_vector": 7, "arrai": [7, 9, 13, 23, 32, 36], "pallas_cal": 7, "out_shap": 7, "shapedtypestruct": 7, "dtype": [7, 9, 12, 25, 26, 27, 33, 34, 38], "otherwis": [7, 13, 19, 20, 22, 23, 25, 32, 34], "hang": 7, "lock": 7, "q": [7, 9], "randn": [7, 9, 12, 13, 15, 17, 27, 28, 29, 33, 35, 36], "128": [7, 8, 9, 12, 16, 24, 31, 33], "k": [7, 9, 16, 19], "make_kernel_from_palla": 7, "pt_kernel": 7, "lambda": [7, 27, 31], "liner": 7, "flash": [7, 8], "attent": [7, 8, 9], "besid": 7, "op": [7, 8, 9, 11, 13, 15, 16, 18, 19, 20, 25, 26, 34, 35, 36], "suppor": 7, "flash_attent": [7, 27], "paged_attent": 7, "queri": [7, 12], "squeez": 7, "dim": [7, 8, 13, 16, 24], "key_cach": 7, "value_cach": 7, "context_len": 7, "block_tabl": 7, "pages_per_compute_block": 7, "megacore_mod": 7, "none": [7, 9, 10, 13, 19, 32, 35, 36], "vllm": 7, "effect": [7, 13, 16, 27, 38], "memori": [7, 11, 13, 14, 19, 22, 23, 25, 31, 34], "kv": 7, "proper": [7, 36], "jax_nightly_releas": 7, "jaxlib_nightly_releas": 7, "authorit": 7, "dev": [7, 22, 28], "en": [7, 31], "consid": [8, 12, 16, 17, 18, 20, 21], "mani": [8, 12, 13, 19, 21, 22, 23, 25, 27, 34, 38], "homogen": 8, "llm": [8, 21], "drop": [8, 14, 19], "loop": [8, 15, 16, 17, 19, 20, 21, 22, 23, 25, 27, 32, 34, 37], "bunch": [8, 9], "decod": [8, 15, 27], "subsequ": [8, 16, 18, 21, 22], "significantli": [8, 12, 15, 17, 21, 22], "reduc": [8, 10, 12, 13, 14, 16, 17, 18, 19, 20, 21, 23, 31], "hand": [8, 17], "lower": [8, 9, 11, 15, 16, 19, 22, 25, 26, 34], "lax": 8, "Its": [8, 13, 15], "primari": [8, 22], "hood": 8, "itself": [8, 13, 22, 31], "typic": [8, 13, 16, 18, 22, 24], "transform": [8, 18, 21, 24, 31, 36], "run_decoder_lay": 8, "hidden_st": 8, "decoder_lay": 8, "unrol": 8, "flat": [8, 36], "shown": [8, 12, 15, 25, 34], "decoder_with_scan": 8, "root": [8, 13, 25, 34, 38], "python3": [8, 12, 14, 17, 19, 21, 27, 31], "train_decoder_only_bas": [8, 15, 19], "decoderwithscan": 8, "appli": [8, 10, 13, 16, 17, 18, 26, 31, 32, 37], "dimens": [8, 13, 14, 35, 36], "carri": [8, 25, 34, 35], "along": [8, 13, 18, 31, 36], "fn": [8, 13], "callabl": [8, 13, 31], "tupl": [8, 9, 13, 25, 30, 32, 34, 36], "init": [8, 12, 17, 28, 29, 30], "xs": [8, 13, 32, 35, 36], "roughli": [8, 38], "equal": [8, 36, 38], "ys": 8, "len": [8, 13, 16, 20, 24], "append": [8, 19], "scan_exampl": 8, "scan_example_cumsum": 8, "cumul": [8, 18, 30], "sum": [8, 10, 13, 31, 32], "scan_example_pytre": 8, "pytre": 8, "final": [8, 18, 28, 35, 38], "histori": 8, "15": [8, 21, 38], "count": [8, 13, 19], "mean": [8, 12, 13, 14, 15, 17, 18, 19, 20, 23, 25, 28, 32, 34, 35], "0000": 8, "5000": 8, "figur": [8, 10, 14, 36], "repe": 8, "bound": 8, "compar": [8, 12, 17, 19, 28, 29, 30], "overhead": [8, 12, 15, 18, 27, 28, 29], "especi": [8, 12, 13, 15, 16, 21, 22, 29, 35], "finish": [8, 13, 16, 18, 23, 24], "9m35": 8, "4m59": 8, "hidden": 8, "num": 8, "head": 8, "512": [8, 36], "500": 8, "metric": [8, 13, 16, 28], "is_fn_pur": 8, "is_layer_pur": 8, "final_carri": 8, "init_scan": 8, "xs_scan": 8, "input_data": 8, "traceabl": [8, 10], "particular": [8, 21, 23], "palla": [8, 11], "incompat": 8, "save": [8, 13, 16, 19, 22, 24, 27, 31, 37], "chip": [8, 12, 15, 16], "256": [8, 12], "50": [8, 16, 19, 21, 30], "2048": [8, 12], "compiletim": [8, 19], "totalsampl": [8, 19], "accumul": [8, 13, 22, 24], "02m57s694ms418": 8, "595u": 8, "valuer": [8, 19], "02s112ms586": 8, "097u": 8, "rate": [8, 19, 28], "054285": 8, "percentil": [8, 19], "023ms113": 8, "470u": 8, "10": [8, 12, 13, 16, 17, 19, 21, 24, 25, 27, 28, 29, 30, 33, 34, 37, 38], "20": [8, 14, 17, 19, 28, 33, 38], "54s644ms733": 8, "284u": 8, "80": [8, 19], "01m03s028ms571": 8, "841u": 8, "90": [8, 19], "95": [8, 19], "99": [8, 19, 28], "29s996ms941": 8, "409u": 8, "02s529ms591": 8, "388u": 8, "158152": 8, "018ms636": 8, "571u": 8, "11s983ms003": 8, "171u": 8, "18s995ms301": 8, "667u": 8, "maximum": [8, 13, 14, 16, 23, 33], "1m03": 8, "19": [8, 28, 29, 38], "7253": 8, "comment": [8, 25, 34], "accomplish": 9, "exportedprogram": 9, "fx": [9, 29], "exported_program_to_stablehlo": 9, "mlir": 9, "torchvis": [9, 15, 16, 24, 29], "torchax": 9, "tx": 9, "resnet18": [9, 15, 29], "sample_input": 9, "224": [9, 15], "mlir_modul": 9, "store": [9, 13, 19, 24], "feel": [9, 19, 28], "explor": [9, 22, 24], "org": [9, 12, 13, 31], "tutori": [9, 13, 19, 21, 28, 35, 38], "jfunc": 9, "shapeddtypestruct": 9, "float32": [9, 16, 26, 38], "last": [9, 19, 36, 38], "constant": [9, 19, 20, 35], "convent": 9, "ed": 9, "appear": [9, 17, 19, 23], "paramt": 9, "jfunc_inlin": 9, "scaled_dot_product_attent": 9, "decompos": 9, "low": [9, 14, 19, 38], "dure": [9, 13, 18, 19, 20, 23, 29, 31, 35], "captur": [9, 13, 15, 18, 19, 20, 21, 23], "downstream": [9, 26], "ml": [9, 36, 38], "crucial": [9, 15, 16, 18, 24], "geneart": 9, "pattern": [9, 19, 25, 29, 34], "challeng": 9, "prone": 9, "robust": 9, "outlin": [9, 33], "pratic": 9, "scaled_product_attent": 9, "centric": 9, "unittest": 9, "nn": [9, 12, 13, 16, 17, 24, 28, 29, 31, 33, 35], "impl_abstract": 9, "jaten": 9, "jlibrari": 9, "mylib": 9, "basic": [9, 15, 16, 17, 24, 25, 28, 34], "sdpa": 9, "compositeexplicitautograd": 9, "_mylib_scaled_dot_product_attent": 9, "product": [9, 13, 38], "transpos": [9, 25, 34], "dropout_p": 9, "is_caus": 9, "_mylib_scaled_dot_product_attention_meta": 9, "empty_lik": 9, "decomposit": 9, "register_torch_composit": 9, "softmax": 9, "register_jax_composit": 9, "_aten_softmax": 9, "_softmax": 9, "static_argnum": 9, "librarytest": 9, "testcas": 9, "manual_se": [9, 12, 13, 16], "default_env": 9, "use_torch_native_for_cpu_tensor": 9, "test_basic_sdpa_librari": 9, "customopexampl": 9, "rand": [9, 25, 34, 38], "32": [9, 13, 16, 19, 22, 23, 24, 36], "64": [9, 15, 16, 24, 29, 31], "module_str": 9, "todo": 9, "produc": [9, 16, 18, 25, 26, 28, 34], "assertin": 9, "__name__": [9, 12, 16, 17, 24, 28], "__main__": [9, 12, 16, 17, 24, 28], "emit": 9, "repres": [9, 12, 13, 25, 34, 38], "region": [9, 13, 19, 26, 35], "th": [9, 36], "xla_model": [10, 11, 12, 16, 17, 18, 19, 21, 24, 26, 28, 29, 30, 31, 32, 33, 36], "adopt": [10, 25, 34], "reimplement": [10, 12], "_c10d_function": 10, "all_reduc": [10, 13], "processgroupxla": 10, "deriv": 10, "processgroup": 10, "xla_backend": [10, 12, 28, 37], "_create_xla_process_group": 10, "prefix_stor": 10, "rank": [10, 12, 13, 28, 31, 36, 37], "timeout": 10, "assert": [10, 28, 38], "xr": [10, 12, 13, 16, 17, 28, 31, 32, 35, 36, 37], "is_spmd": [10, 13], "spmd": [10, 11, 16, 17, 20, 27, 37], "group": [10, 12, 13, 28, 35], "_register_xla_backend": 10, "dist": [10, 12, 28, 37], "register_backend": 10, "allreduc": 10, "all_reduce_opt": 10, "allgath": 10, "output_tensors_list": 10, "input_tensor": 10, "opt": [10, 17], "_mp_fn": [10, 12, 16, 17], "init_process_group": [10, 12, 28, 37], "init_method": [10, 12, 37], "progress": [10, 21, 24], "blob": [10, 12, 13], "distributed_c10d": 10, "_exception_logg": 10, "all_gath": [10, 12, 13], "tensor_list": 10, "async_op": 10, "_get_default_group": 10, "remap": 10, "_functional_collect": 10, "all_reduce_inplac": 10, "eventu": 10, "reach": [10, 13, 38], "rewrit": [10, 23, 25, 34, 35], "reduceop": 10, "group_nam": 10, "torch_library_impl": 10, "four": [10, 20], "align": [10, 15], "signatur": 10, "remain": [10, 17, 21, 24, 25, 34], "restrict": 10, "usag": [10, 13, 15, 19, 23, 25, 31, 32, 34, 37], "test_collective_ops_tpu": 10, "scenario": [10, 16, 18, 22, 24, 29], "reduct": [10, 13, 16], "aggreg": 10, "all_gather_into_tensor": 10, "gather": [10, 13, 19, 35], "reduce_scatter_tensor": 10, "across": [10, 11, 12, 13, 15, 16, 17, 19, 31, 32, 36], "all_to_all_singl": 10, "output_split_s": 10, "input_split_s": 10, "although": [10, 12, 25, 34, 38], "accept": [10, 35], "argument": [10, 13, 16, 18, 21, 26, 27, 29, 31], "1s": 10, "limit": [10, 12, 13, 17], "reflect": [10, 18, 36], "compromis": 10, "maintain": [10, 11, 38], "constraint": [10, 12, 19], "alltoal": [10, 13], "high": [11, 13, 14, 22, 28, 33, 38], "job": [11, 13, 20, 29], "thousand": [11, 12], "mfu": 11, "hardwar": [11, 13, 15, 16, 19, 21, 26], "__version__": [11, 19], "overview": 11, "quickstart": 11, "control": [11, 13, 14, 16, 17, 19, 35], "mxu": 11, "float": [11, 13, 25, 26, 34], "precis": [11, 13], "topic": [11, 22, 36], "checkpoint": [11, 12, 16, 20, 22, 31, 36], "ddp": [11, 12, 16], "shard": [11, 13, 16, 37], "fsdp": [11, 13, 16, 35, 36], "One": [11, 13, 14, 17, 20], "stablehlo": [11, 13], "mix": [11, 13, 36], "torchdynamo": 11, "quantiz": 11, "repeat": [11, 22], "layer": [11, 14, 15, 24, 27, 31, 32, 35], "scan": 11, "scan_lay": 11, "while_loop": 11, "assume_pur": 11, "eager": [11, 13, 16, 18, 25, 28, 33, 34], "mode": [11, 13, 18, 25, 28, 33, 34, 35, 37, 38], "recompil": [11, 14, 15, 16, 17, 19, 20], "bazel": 11, "plugin": [11, 12, 22], "encount": [12, 16, 17, 19], "bug": [12, 19, 28], "tag": [12, 13], "r2": [12, 19, 35], "renam": 12, "torchrun": [12, 17], "xpu": 12, "neuron": [12, 17], "xrt_tpu_config": 12, "impact": [12, 13, 15, 19, 25, 28, 34, 38], "30": [12, 31], "preview": 12, "thread": [12, 13, 17, 19, 37], "safe": 12, "section": [12, 17, 19, 21, 23, 24, 35, 36], "broadcast": 12, "replica": [12, 13], "broadcast_master_param": 12, "random": [12, 13, 15, 20, 27, 33, 38], "global": [12, 13, 16, 17, 24, 27, 35, 37], "rng": [12, 13], "pjrt_backend": 12, "v4": [12, 13, 15, 17, 20, 21, 22, 23, 29, 35], "distributeddataparallel": [12, 16], "parallel_load": [12, 13, 16, 17, 19], "global_ordin": [12, 13, 16, 17, 28, 31], "world_siz": [12, 13, 16, 28, 31, 35], "42": [12, 16, 27], "gradient_as_bucket_view": [12, 28], "loss_fn": [12, 15, 16, 17, 24, 26, 28, 29], "mseloss": [12, 28], "sgd": [12, 16, 17, 24, 26, 28, 29], "lr": [12, 16, 17, 24, 28, 29, 31, 32], "001": [12, 28], "zero_grad": [12, 15, 16, 17, 24, 26, 28], "loss": [12, 15, 16, 17, 24, 26, 29, 31, 32, 38], "confirm": 12, "p": [12, 19, 25, 34, 38], "localservic": 12, "localhost": 12, "51011": 12, "master_addr": 12, "master_port": 12, "12355": 12, "Or": [12, 16, 17, 25, 34], "grpc": 12, "torchbench": 12, "observ": [12, 15, 28], "35": [12, 19], "copi": [12, 13, 17, 19, 21], "worker": [12, 13, 17, 21, 22, 31, 32, 37], "tpuvm": [12, 17, 22, 35], "learn": [12, 15, 22, 24, 36, 38], "mnist": [12, 16, 17, 19, 26], "test_train_mp_mnist": [12, 28], "fake_data": [12, 19, 28], "alpha": [12, 17], "central2": [12, 22], "b": [12, 13, 16, 18, 22, 25, 26, 27, 29, 34, 36], "resnet50": [12, 15, 17, 29, 31], "git": [12, 19, 21, 31], "depth": [12, 19], "branch": [12, 19, 25, 34], "test_train_mp_imagenet": [12, 19, 28], "batch_siz": [12, 16, 24, 31], "num_epoch": [12, 28, 31], "By": [12, 13, 21, 24, 25, 34, 38], "tpu_process_bound": 12, "tpu_visible_chip": 12, "r1": 12, "13": [12, 17, 28, 30], "docker_imag": 12, "gcr": 12, "io": [12, 31], "privat": 12, "sudo": [12, 22], "rm": 12, "privileg": 12, "net": [12, 16, 23, 26], "mostli": [12, 31], "interchang": 12, "perspect": [12, 17], "subtl": 12, "importantli": [12, 27], "architectur": [12, 16, 31], "spawn": [12, 13, 16, 17, 21], "server": [12, 13, 23], "thu": [12, 15, 18, 19], "batch": [12, 16, 17, 19, 20, 21, 23, 35], "latenc": 12, "serial": [12, 17], "deseri": 12, "send": [12, 17, 20, 21, 35], "constrain": [12, 13], "direct": [12, 18, 19], "independ": [12, 15, 17, 19], "plan": 12, "xla_dist": 12, "scp": [12, 17], "sdk": 12, "enhanc": [12, 15], "stabil": [12, 16, 19, 26], "xmp": [12, 17, 21], "ident": 12, "substanti": 12, "mesh": [12, 13, 32], "master": [12, 13, 16, 17, 37], "connect": [12, 13, 35], "practic": [12, 15, 16, 25, 32, 34, 36], "unreli": 12, "due": [12, 15, 19, 20, 23, 38], "inbound": 12, "could": [12, 20, 25, 34, 35, 38], "failur": 12, "forc": [12, 13, 19, 25, 30, 34], "entir": [12, 31], "restart": 12, "much": [12, 16, 17, 20, 21, 23, 25, 27, 29, 34], "impos": 12, "payload": [12, 13], "transfer": [12, 13, 16, 18, 19, 23, 35], "middl": [12, 23, 25, 34], "unwant": 12, "permit": 12, "subset": [12, 36], "particip": [12, 13], "old": [12, 16], "alter": 12, "synchron": [12, 15, 17, 22, 24, 35, 37], "barrier": [12, 13, 16, 17, 18, 21], "all_gather_object": 12, "gloo": [12, 28, 37], "new_group": 12, "subgroup": 12, "monitor": 12, "context": [12, 13, 15, 16, 19, 25, 26, 34], "altern": [12, 22, 25, 26, 33, 34], "less": [12, 16, 25, 29, 34, 38], "than": [12, 19, 25, 28, 31, 34, 38], "perf": [12, 16, 25, 34], "md": [12, 13, 16], "strongli": 12, "_all_gath": 12, "int": [12, 13, 25, 27, 34, 35, 38], "int32": 12, "zeros_lik": 12, "_": [12, 16, 18, 29, 30], "get_world_s": 12, "pjrt_distribut": 12, "averag": [12, 16], "task": [12, 15], "175": 12, "chart": 12, "breakdown": 12, "tfrt": 12, "legaci": 12, "streamexecutor": 12, "tpu_legaci": 12, "happen": [12, 13, 15, 17, 19, 20, 21, 23, 25, 34], "comparison": [12, 36], "given": [13, 19, 20, 25, 27, 28, 31, 34, 36, 38], "device_count": [13, 35], "address": [13, 15, 35], "wait": [13, 16, 18, 19, 23], "reset_scop": 13, "pend": [13, 18], "whether": [13, 17, 26], "block": [13, 18, 31, 35], "reset": 13, "scopecontext": 13, "full_graph": [13, 15], "max_different_graph": 13, "custom_compile_opt": 13, "dict": [13, 16, 27, 31], "lazytensor": [13, 20, 22], "decid": [13, 19, 25, 27, 34], "funciton": 13, "act": [13, 16, 17, 22], "throw": [13, 17], "exit": [13, 16, 19, 26, 28], "pt_xla_debug": 13, "messag": [13, 17, 19], "dump": [13, 19], "allow": [13, 17, 19, 21, 22, 23, 24, 26, 35, 36, 37, 38], "rais": [13, 19, 38], "exceed": 13, "compileopt": 13, "env_option_overrid": 13, "intern": [13, 15, 16, 17, 18, 19, 25, 34, 35, 38], "stringifi": 13, "clear": [13, 15], "previous": [13, 17], "foo": 13, "sin": [13, 27], "co": 13, "foo2": 13, "compiled_foo2": 13, "seed": [13, 16], "integ": [13, 19, 36], "subpackag": 13, "mp": 13, "etc": [13, 16, 19, 25, 34, 35], "set_mat_mul_precis": [13, 38], "liter": 13, "highest": [13, 37, 38], "mat": [13, 38], "conv": 13, "32bit": 13, "matrix": [13, 17, 18, 38], "convolut": [13, 24], "trade": [13, 20, 25, 34], "accuraci": [13, 28, 31, 38], "fastest": 13, "downcast": 13, "fp32": 13, "bf16": [13, 16, 38], "multipli": [13, 17, 36, 38], "three": [13, 17, 38], "approxim": 13, "14": 13, "slowest": 13, "six": [13, 38], "22": [13, 28], "precision_tutori": 13, "empir": [13, 38], "behav": [13, 19, 38], "get_mat_mul_precis": 13, "device_typ": 13, "local_process_count": 13, "local_device_count": 13, "total": [13, 18, 25, 34, 36, 38], "addressable_device_count": 13, "visibl": [13, 25, 34], "global_device_count": 13, "global_runtime_device_count": [13, 32, 35, 36], "ordin": [13, 16, 17], "guarante": [13, 18, 27], "predict": 13, "relationship": [13, 17, 19], "nor": 13, "contigu": [13, 17, 19], "local_ordin": 13, "get_master_ip": 13, "retriev": [13, 17, 25, 29, 34, 35, 36, 38], "discoveri": 13, "use_spmd": [13, 35, 36, 37], "non": [13, 15, 16, 25, 26, 27, 34, 36], "replic": [13, 35, 36], "spmd_advanc": 13, "initialize_cach": [13, 17], "readonli": [13, 17], "persist": [13, 17, 37], "xla_devic": [13, 24], "devkind": 13, "deprec": 13, "xla_device_hw": [13, 16], "union": 13, "real": [13, 29], "is_master_ordin": [13, 16], "multi": [13, 14, 16, 24, 28, 35], "num_host": 13, "boolean": 13, "reduce_typ": 13, "pin_layout": 13, "xm": [13, 16, 17, 19, 21, 24, 26, 28, 29, 30, 31, 32, 33, 36], "reduce_sum": 13, "reduce_mul": 13, "reduce_and": 13, "reduce_or": 13, "reduce_min": 13, "reduce_max": 13, "layout": [13, 22, 33, 36], "pine": 13, "potenti": [13, 17, 19], "corrupt": 13, "unpin": 13, "hlomodul": 13, "hold": [13, 35], "channel_id": 13, "use_global_device_id": 13, "channel": [13, 33], "replicagroup": 13, "all_to_al": 13, "split_dimens": 13, "concat_dimens": 13, "split_count": 13, "www": 13, "operation_semant": 13, "upon": 13, "split": [13, 36], "concat": 13, "add_step_closur": 13, "closur": 13, "run_async": 13, "report": [13, 16], "consol": 13, "tensorboard": [13, 23], "intermediari": 13, "inspect": [13, 38], "materi": [13, 18, 19, 20, 25, 34, 35], "queu": 13, "though": [13, 17, 28], "advis": 13, "throttl": 13, "event": 13, "asynchron": [13, 16, 18, 35, 37], "wait_device_op": 13, "async": [13, 29], "whose": [13, 14, 36], "optimizer_step": [13, 16, 17, 18, 20, 24, 26, 28, 31], "optimizer_arg": 13, "gradid": 13, "parallelload": [13, 35], "dataparallel": 13, "loader": [13, 18, 19, 21, 29], "dictionari": 13, "gradient": [13, 16, 17, 18, 24, 26, 31, 37], "file_or_path": 13, "textio": 13, "master_onli": [13, 16, 31], "global_mast": [13, 16], "care": [13, 17, 19, 25, 34], "taken": [13, 17, 18, 19, 25, 28, 34, 37], "view": [13, 16, 17, 19, 24], "recreat": [13, 17], "destin": [13, 17], "nest": [13, 31], "obj_to_sav": 13, "path_to_sav": 13, "rendezv": [13, 16], "byte": 13, "xla_rendezv": 13, "sent": [13, 18, 19], "exchang": 13, "posit": 13, "mesh_reduc": 13, "reduce_fn": 13, "toxlatensorarena": 13, "receiv": 13, "np": [13, 32, 36], "test_accuraci": 13, "set_rng_stat": 13, "get_rng_stat": 13, "get_memory_info": 13, "memoryinfo": 13, "bytes_us": 13, "290816": 13, "bytes_limit": 13, "34088157184": 13, "peak_bytes_us": 13, "500816": 13, "get_stablehlo": 13, "var": [13, 35], "xla_hlo_debug": [13, 19], "get_stablehlo_bytecod": 13, "bytecod": [13, 29], "mpdeviceload": [13, 16, 17, 20, 21, 35], "kwarg": [13, 31, 35], "dataload": [13, 15, 16, 17, 24, 28, 35, 37], "background": [13, 24, 37], "upload": [13, 23, 35], "per_device_load": [13, 35], "constructor": 13, "train_device_load": 13, "train_load": [13, 16, 17, 24, 35], "xla_multiprocess": 13, "nproc": 13, "daemon": 13, "start_method": 13, "moment": 13, "valueerror": [13, 38], "mark_shard": [13, 27, 32, 35, 36], "xlashardedtensor": [13, 37], "partition_spec": [13, 35, 36], "nonetyp": 13, "annot": [13, 35], "partit": [13, 35], "spec": [13, 35], "spmdpartition": [13, 35], "topolog": [13, 17, 35], "partitionspec": 13, "ax": [13, 35, 36], "element": [13, 25, 32, 34, 35, 36, 38], "axi": [13, 32, 36], "mesh_shap": [13, 32, 35, 36], "num_devic": [13, 32, 35, 36], "device_id": [13, 32, 35, 36], "clear_shard": 13, "cast": [13, 16, 26], "t1": [13, 17, 19, 36], "get_1d_mesh": 13, "set_global_mesh": 13, "get_global_mesh": 13, "axis_nam": [13, 35], "ndarrai": 13, "flatten": [13, 24], "reshap": 13, "fill": 13, "row": [13, 36], "major": [13, 22, 36], "global_runtime_device_attribut": [13, 36], "length": [13, 25, 34], "get_xla_supported_devic": 13, "get_logical_mesh": [13, 36], "ordereddict": [13, 35, 36], "hybridmesh": [13, 35], "ici_mesh_shap": [13, 35], "dcn_mesh_shap": [13, 35], "hybrid": 13, "ici": 13, "dcn": [13, 35], "increas": [13, 27], "intens": 13, "mdl": 13, "inner": [13, 31, 35], "outer": [13, 31, 32, 35], "slice": [13, 16, 20, 21, 35, 36], "eager_mod": [13, 15], "d": [13, 16, 25, 26, 34], "eagerli": [13, 15, 17, 19, 25, 34], "metrics_report": [13, 19], "short_metrics_report": [13, 19], "counter_nam": 13, "metric_nam": 13, "counter_valu": 13, "metric_data": 13, "total_sampl": 13, "retain": 13, "circular": 13, "buffer": [13, 27], "in_tensor": 14, "randint": [14, 33], "out_tensor": 14, "nonzero": [14, 19, 21, 23, 25, 34, 38], "word": [14, 25, 27, 34], "25": 14, "further": [14, 20, 21, 23, 28], "categor": 14, "unbound": 14, "alloc": [14, 36], "infinit": [14, 32, 38], "phase": [14, 15, 24], "perceptron": 14, "mlp": 14, "xla_experiment": 14, "masked_select": 14, "masked_scatt": 14, "your_script": [14, 21], "100": [14, 16, 19, 24, 27, 31], "29": [14, 28, 29], "49": [14, 29], "03": 14, "102": 14, "hit": [14, 25, 34], "198": 14, "1953": 14, "motiv": 14, "excess": 14, "half": [14, 38], "try": [14, 19, 21, 23, 25, 34], "ds": 14, "test_dynamic_shape_model": 14, "testdynamicshapemodel": 14, "test_backward_pass_with_dynamic_input": 14, "deep": [15, 19], "record": [15, 17, 18, 19, 22, 27], "defer": [15, 17, 18, 24], "approach": [15, 17, 18, 25, 28, 31, 34, 38], "usabl": 15, "ambigu": 15, "struggl": 15, "distinguish": 15, "whenev": 15, "preprocess": [15, 33], "expens": [15, 19, 25, 34], "difficulti": 15, "opaqu": [15, 17, 19], "natur": 15, "shift": [15, 16], "priorit": 15, "preserv": [15, 17, 19], "immedi": [15, 16, 17, 18, 22, 35], "flexibl": [15, 33], "decor": [15, 27], "mark": 15, "boundari": [15, 16], "feedback": 15, "outsid": [15, 16, 17], "leak": 15, "catch": [15, 17], "accident": 15, "compiled_model": 15, "awai": [15, 18], "summar": [15, 26], "temporarili": 15, "resum": [15, 31], "abstract": [15, 16, 33, 35], "balanc": 15, "distinct": [15, 16, 18], "workflow": [15, 17, 22], "advantag": [15, 17, 21, 22], "enclos": 15, "step_fn": 15, "logit": [15, 32], "aim": [15, 16, 22, 25, 34], "quantifi": 15, "conduct": 15, "llama2": 15, "fake": [15, 37], "300": [15, 19], "measur": [15, 23], "clearli": 15, "illustr": [15, 16, 20, 21, 23], "147": 15, "65": [15, 19], "tradit": [15, 29], "45": 15, "li": 15, "throughput": 15, "seamless": 16, "necessit": 16, "adapt": 16, "occur": [16, 17, 38], "structur": [16, 18, 31, 35], "own": [16, 17, 31], "advanc": [16, 22, 36], "paradigm": 16, "often": [16, 18, 19, 22, 24, 25, 27, 34], "bfloat16": [16, 26, 33], "prefer": [16, 26], "float16": [16, 26], "doesn": [16, 17, 18, 19, 25, 32, 34], "essenti": [16, 18, 38], "is_avail": 16, "acquir": [16, 17, 24], "lazili": [16, 25, 34, 35, 37], "tell": [16, 20, 24, 25, 34], "actual": [16, 18, 21, 22, 25, 28, 34, 35], "signal": [16, 20], "portion": [16, 23], "implicitli": [16, 25, 34], "item": [16, 18, 19, 21, 23, 24, 38], "frequent": [16, 19], "callback": [16, 20, 21], "train_dataset": 16, "shuffl": [16, 24], "gpu_devic": 16, "mp_train_load": 16, "batch_idx": [16, 24], "prefetch": 16, "overlap": [16, 17, 23, 29, 35], "fashion": 16, "recap": 16, "mnistnet": [16, 24], "learning_r": [16, 24], "nllloss": [16, 17, 24], "_mp_mnist_fn": 16, "mnist_xla_distribut": 16, "dataset": [16, 19, 24, 28, 31], "__init__": [16, 17, 24, 27, 28, 33], "super": [16, 17, 24, 27, 28], "conv1": [16, 24], "conv2d": [16, 24, 26, 31], "kernel_s": [16, 24], "stride": [16, 19, 24], "pad": [16, 19, 20, 24, 25, 34, 36], "conv2": [16, 24], "fc1": [16, 24], "fc2": [16, 24], "relu": [16, 24, 26, 28], "max_pool2d": [16, 24, 26], "log_softmax": [16, 24, 26], "momentum": [16, 17, 24], "epoch": [16, 19, 21, 24, 31], "enumer": [16, 24, 37, 38], "log_interv": 16, "spam": 16, "0f": [16, 24], "tloss": [16, 24], "6f": [16, 24], "valid": [16, 38], "epoch_end": 16, "strictli": [16, 35], "state_dict": [16, 17, 31, 37], "01": [16, 24], "download": [16, 24, 31], "totensor": [16, 24], "1307": [16, 24], "3081": [16, 24], "distributedsampl": 16, "num_work": 16, "mp_mnist_fn": 16, "encapsul": 16, "mark_step": [16, 19], "redund": 16, "race": 16, "idiomat": 16, "60000": [16, 24], "315475": 16, "12800": [16, 24], "661397": 16, "25600": [16, 24], "11": [16, 19, 24, 25, 34], "468286": 16, "230400": 16, "96": [16, 24, 28], "191208": 16, "315434": 16, "163842": 16, "042292": 16, "050310": 16, "excel": 16, "extend": [16, 26, 38], "syncfre": [16, 26], "autocast": [16, 26], "autosc": 16, "model_xla": 16, "cpu_state_dict": 16, "model_cpu": 16, "load_state_dict": [16, 17, 37], "portabl": 16, "safest": 16, "spmd_distributed_checkpoint": 16, "nvprof": 16, "nsight": 16, "won": [16, 25, 26, 34], "concept": [16, 22, 24, 35, 36], "strive": 16, "evalu": [16, 17, 19, 20, 21, 22, 25, 27, 34], "fix": [16, 17, 19, 20, 23, 27, 29, 32], "strategi": [16, 36], "unsupport": 16, "coverag": [16, 25, 34], "fall": [16, 21, 32], "troubleshoot": [16, 17], "pseudo": [16, 27], "highlight": [16, 17, 20], "mp_loader": 16, "master_ordin": 16, "regular": [17, 19, 33], "t0": 17, "mm": [17, 26, 38], "neural": [17, 24, 38], "l_in": 17, "l_out": 17, "floattensor": 17, "distribut": [17, 19, 22, 24, 27, 31, 32, 35, 36], "mp_device_load": 17, "multithread": [17, 19], "assign": [17, 18, 21], "onto": [17, 20], "preload": [17, 20], "batches_per_execut": 17, "consolid": [17, 31], "all_reduce_gradi": 17, "parent": 17, "talk": 17, "howto": 17, "focu": [17, 22, 25, 34], "train_mnist_xla": 17, "16": [17, 22, 31, 33, 36], "infrastructur": 17, "awar": 17, "regard": [17, 29], "fakedata": 17, "fuse": [17, 20], "invis": 17, "caller": 17, "insert": [17, 23], "paper": 17, "unlik": [17, 20], "appreci": 17, "accommod": 17, "footprint": 17, "xser": 17, "stream": 17, "amount": [17, 19, 20, 25, 34], "restor": 17, "unavail": [17, 19], "aw": 17, "incorrectli": 17, "solut": [17, 19, 25, 33, 34, 38], "feed": 17, "testmodel": 17, "pre": 17, "determin": 17, "warn": [17, 19, 38], "pt_xla_debug_level": [17, 19], "_set_allow_execut": 17, "earli": [17, 25, 34], "relat": [17, 21], "consum": [17, 25, 34], "disk": 17, "your_cache_path": 17, "mount": 17, "mp_fn": 17, "tmp": [17, 19, 31], "xla_cache_": 17, "runnabl": [17, 28, 32], "emploi": 18, "primarili": 18, "side": [18, 25, 27, 34], "period": [18, 23], "spend": [18, 20], "durat": [18, 23, 37], "conceptu": [18, 36, 38], "start_tim": 18, "perf_count": 18, "matmul": [18, 26, 38], "incorrect": 18, "end_tim": 18, "elapsed_tim": 18, "predominantli": 18, "took": 18, "devid": 18, "exemplifi": 18, "warm": 18, "translat": [18, 19], "steadi": 18, "benchmark": 18, "isn": [18, 25, 34, 37], "exclud": 18, "sever": 18, "condition": 18, "unlazi": 18, "run_model": 18, "start_loop_tim": 18, "num_step": 18, "FOR": 18, "end_loop_tim": 18, "elapsed_loop_tim": 18, "spent": [18, 19], "largli": 18, "proce": [18, 25, 34], "inclus": 18, "lag": 18, "behind": [18, 24], "run_model_step": 18, "subject": 19, "peculiar": 19, "detial": 19, "cu121": 19, "t2": [19, 36], "200": 19, "nightli": [19, 22, 31, 35], "rx": 19, "conclud": 19, "diagnos": 19, "extrem": [19, 27], "slip": 19, "analyz": [19, 23], "summari": 19, "21": [19, 24], "transferfromdevicetim": 19, "23": [19, 38], "12": [19, 29, 31], "hash": 19, "c74c3b91b855b2b123f833b0d5f86943": 19, "107": 19, "frame": 19, "dk3": 19, "1055": 19, "44": 19, "__next__": 19, "train_loop_fn": 19, "48": [19, 28], "start_train": 19, "73": 19, "548000": 19, "gb": 19, "922460": 19, "alias": [19, 26], "547871": 19, "124478": 19, "028210": 19, "cal": 19, "steptrac": 19, "tri": [19, 21], "frequenc": 19, "pair": 19, "met": 19, "destroi": 19, "202": 19, "06m09s401ms746": 19, "001u": 19, "778ms572": 19, "062u": 19, "425201": 19, "001ms32": 19, "778u": 19, "001ms61": 19, "283u": 19, "001ms79": 19, "236u": 19, "001ms110": 19, "973u": 19, "001ms228": 19, "773u": 19, "001ms339": 19, "183u": 19, "001ms434": 19, "305u": 19, "002ms921": 19, "063u": 19, "21s102ms853": 19, "173u": 19, "cachedsynctensor": 19, "395": [19, 28], "area": 19, "rout": 19, "qualifi": 19, "33": [19, 28, 29], "_local_scalar_dens": 19, "clear_al": 19, "xla_dynamo_debug": 19, "bottleneck": [19, 20, 21, 23, 27], "notebook": [19, 38], "train_resnet_benchmark": 19, "bad": 19, "degrad": [19, 21], "speedup": [19, 29], "indirect": 19, "mask": [19, 25, 34], "variat": 19, "ask": [19, 25, 34], "substitut": 19, "flow": 19, "clip_grad_norm": 19, "problemat": 19, "clip_grad_norm_": 19, "dramat": 19, "total_norm": 19, "zero": [19, 31, 37], "param_norm": 19, "grad": 19, "norm": [19, 38], "norm_typ": 19, "add_": 19, "clip_coef": 19, "max_norm": 19, "1e": [19, 29], "mul_": 19, "data_parallel": 19, "small": [19, 20, 23, 25, 28, 29, 34], "reconstruct": 19, "shallow": 19, "ty": 19, "made": [19, 21, 23, 25, 34], "_get_xla_tensors_text": [19, 25, 34], "_get_xla_tensors_hlo": 19, "prior": [19, 37], "degre": 19, "xla_ir_debug": 19, "henc": [19, 29], "respons": [19, 20, 29, 37], "propag": 19, "xla_save_tensors_fil": 19, "realli": [19, 25, 34], "big": [19, 25, 34, 38], "sheet": 19, "xla_save_tensors_fmt": 19, "graphviz": 19, "xla_flag": 19, "xla_dump_to": 19, "dir_nam": 19, "unoptim": 19, "optimz": 19, "xla_metrics_fil": 19, "xla_save_hlo_fil": 19, "offend": 19, "xla_sync_wait": 19, "xla_use_eager_debug_mod": 19, "bypass": 19, "overal": [19, 23], "optimizaiton": 19, "tf_cpp_log_thread_id": 19, "tf_cpp_vmodul": 19, "vlog": 19, "form": [19, 25, 34], "tf_cpp_min_log_level": 19, "tf_vlog": 19, "xla_dump_hlo_graph": 19, "xla_util": 19, "save1": 19, "xla_graph_executor": 19, "pjrt_computation_cli": 19, "dir": 19, "pytorch_test_with_slow": 19, "test_torch": 19, "test_put_xla_uint8": 19, "torch_test_devic": 19, "pytorch_test_bas": 19, "fed": 20, "pod": [20, 22], "attach": [20, 35], "xla_tensor_z": 20, "cut": [20, 25, 34], "transferfromdevic": [20, 23], "properti": [20, 25, 34], "suppos": 20, "tensors_on_devic": 20, "z": [20, 25, 34, 38], "subgraph": [20, 25, 34], "far": 20, "fusion": [20, 22], "worth": [20, 25, 34], "magic": [20, 25, 34], "treat": [20, 36], "xla_no_special_scalar": 20, "guidelin": 21, "rememb": 21, "txt2img": 21, "prompt": 21, "photograph": 21, "astronaut": 21, "ride": 21, "hors": 21, "modif": [21, 22, 24], "ldm": 21, "ddim": 21, "precision_scop": 21, "addition": [21, 26, 31], "frozenclipembedd": 21, "simplic": [21, 25, 34], "top": 21, "attr": 21, "statement": [21, 25, 34], "bar": 21, "stop": 21, "difficult": 21, "discuss": 21, "analysi": [21, 29], "investig": [21, 23, 28, 38], "cover": [21, 24, 35], "huggingfac": 21, "sd": 21, "xl": [21, 23], "cd": [21, 31], "text_to_imag": 21, "inference_tpu_single_devic": 21, "lora": 21, "model_id": 21, "stabilityai": 21, "9": [21, 25, 28, 31, 34, 38], "pipelin": [21, 23], "dpmsolvermultistepschedul": 21, "txt": 21, "invisible_watermark": 21, "safetensor": 21, "agre": 21, "licens": 21, "card": 21, "cli": 21, "_your_copied_token__": 21, "pipe": 21, "hour": 21, "wherea": 21, "likewis": 21, "gpt": 21, "min": 21, "mayb": 21, "notic": [21, 38], "piec": 21, "__call__": 21, "caveat": [21, 23], "unnecessari": [21, 27, 35], "communit": 21, "my_funct": 21, "debug_single_process": 21, "tpu_nam": [21, 22], "hypercomput": 21, "recip": 21, "algebra": 22, "research": [22, 38], "massiv": 22, "inferenc": 22, "frontend": [22, 25, 34], "readabl": 22, "opcod": 22, "seri": 22, "highli": 22, "tailor": 22, "deeper": 22, "dive": 22, "deliv": 22, "tackl": 22, "ambiti": 22, "know": [22, 25, 27, 28, 34], "love": 22, "smooth": 22, "minor": [22, 38], "compel": 22, "price": 22, "ratio": 22, "focus": 22, "theoret": [22, 25, 34], "v5": 22, "v6": 22, "nvidia": [22, 38], "runtime_vers": 22, "project_id": 22, "accelerator_typ": 22, "your_tpu_nam": 22, "subnetwork": 22, "tpusubnet": 22, "pip3": 22, "cp38": 22, "linux_x86_64": 22, "whl": 22, "apt": 22, "libopenbla": 22, "libgl1": 22, "diffus": [22, 23], "thumb": 23, "constantli": 23, "idl": 23, "inference_tpu_": 23, "capture_profil": 23, "gap": 23, "xp": 23, "u": 23, "busi": 23, "scroll": 23, "occupi": 23, "latter": [23, 31], "largest": 23, "zoom": 23, "timelin": 23, "examin": 23, "did": 23, "pipe_watermark": 23, "closer": 23, "preced": 23, "proceed": [23, 32], "watermark": 23, "cv2": 23, "pywt": 23, "leav": 23, "broken": 23, "rerun": 23, "scale_model_input": 23, "dynamo": [23, 29, 33], "walk": 24, "classic": 24, "cnn": 24, "successfulli": 24, "mnist_xla_quickstart": 24, "28x28": 24, "pool": 24, "train_mnist": 24, "303487": 24, "6400": 24, "702035": 24, "492530": 24, "19200": 24, "294703": 24, "43": [24, 29], "191667": 24, "32000": 24, "53": 24, "233557": 24, "38400": 24, "135758": 24, "44800": 24, "75": [24, 31], "257190": 24, "51200": 24, "85": 24, "121358": 24, "57600": 24, "073349": 24, "obtain": 24, "scene": 24, "agnost": 24, "congratul": 24, "ve": [24, 25, 34], "advic": 24, "hurt": [25, 34], "hard": [25, 28, 29, 34], "pov": [25, 34], "sai": [25, 34], "assur": [25, 34], "gone": [25, 34], "explan": [25, 34], "mainli": [25, 34], "beginn": [25, 34], "propos": [25, 34], "reli": [25, 34], "impract": [25, 34], "assumpt": [25, 34], "ye": [25, 33, 34], "sentenc": [25, 34], "bucket": [25, 34, 37], "kinda": [25, 34], "anti": [25, 34], "matter": [25, 34], "workaround": [25, 34], "okai": [25, 34], "teach": [25, 34], "sort": [25, 34], "obviou": [25, 34], "s64": [25, 34], "inde": [25, 34], "_get_xla_tensor_dimension_s": [25, 34], "commonli": [25, 34], "wrong": [25, 34], "wors": [25, 34], "upper": [25, 34], "nit": [25, 34], "solv": [25, 34], "kept": [25, 34], "accessor": [25, 34], "2d": [25, 32, 34, 36], "doubl": [25, 34, 38], "overload": [25, 34], "IS": [25, 34], "explod": [25, 34], "convers": [25, 34], "cheap": [25, 34], "hoc": [25, 34], "think": [25, 34], "verison": [25, 34], "bla": [25, 34], "blabla": [25, 34], "uglier": [25, 34], "win": [25, 34], "pars": [25, 34], "torchscript": [25, 34], "somehow": [25, 34], "merg": [25, 34], "properli": [25, 34], "thought": [25, 34], "trivial": [25, 34], "effort": [25, 34, 35], "why": [25, 34], "bandwidth": [25, 34], "automag": [25, 34], "gold": [25, 34], "smart": [25, 34], "trick": [25, 34], "tbh": [25, 34], "longer": [25, 34], "unawar": [25, 34], "hope": [25, 34], "smash": [25, 34], "blocker": [25, 34], "ahead": [25, 34], "nnc": [25, 34], "exactli": [25, 27, 34], "brian": [25, 34], "hirsh": [25, 34], "bdhirsh": [25, 34], "question": [25, 34], "Is": [25, 34], "stick": [25, 34], "torch_warn": [25, 34], "yea": [25, 34], "hei": [25, 34], "blaze": [25, 34], "abil": [25, 28, 34], "devirtu": [25, 34], "sound": [25, 34], "great": [25, 34], "truth": [25, 34], "irvalu": [25, 34], "enforc": [25, 34], "discrep": [25, 34], "followup": [25, 34], "1000": [25, 34], "my": [25, 34, 37], "presenc": [25, 34], "get_dimention_s": [25, 34], "didn": [25, 34], "exponenti": [25, 34], "blowup": [25, 34], "fewer": [25, 34], "opportun": [25, 34], "recogn": [25, 29, 34], "feasibl": [25, 34], "annoi": [25, 34], "wasn": [25, 34], "materiz": [25, 34], "combo": [25, 34], "datatyp": 26, "es": 26, "elig": 26, "suppli": 26, "addmm": 26, "addmm_": 26, "float64": 26, "respect": [26, 36], "unlist": 26, "__matmul__": 26, "addbmm": 26, "addmv": 26, "addr": 26, "baddbmm": 26, "bmm": 26, "conv1d": 26, "conv3d": 26, "conv_transpose1d": 26, "conv_transpose2d": 26, "conv_transpose3d": 26, "prelu": 26, "batch_norm": 26, "binary_cross_entropy_with_logit": 26, "prod": 26, "cdist": 26, "chloeski": 26, "invers": 26, "reflection_pad": 26, "replication_pad": 26, "mse_loss": 26, "cosine_embbeding_loss": 26, "nll_loss": 26, "multilabel_margin_loss": 26, "qr": 26, "svd": 26, "triangular_solv": 26, "linalg_svd": 26, "linalg_inv_ex": 26, "widest": 26, "index_copi": 26, "imagenet": 26, "elimin": 27, "primer": 27, "exce": 27, "math": 27, "Such": 27, "repeatedli": 27, "do_some_math": 27, "simul": 27, "ten": [27, 30], "func": 27, "functional_cal": 27, "mymodul": [27, 35], "pure_forward": 27, "param": 27, "cached_forward": 27, "named_paramet": 27, "named_buff": 27, "unit": [27, 28, 38], "languag": 27, "testbridge_test_onli": 27, "test_trace_transformer_with_spda_attent": 27, "test_assume_pur": 27, "benchmark_iter": 27, "140": 27, "1342": 27, "24": 27, "1658": 27, "pai": 27, "front": 27, "recurs": [27, 31, 32], "minimum": [28, 31, 32, 38], "nccl": 28, "new_rank": 28, "ddp_model": 28, "launcher": 28, "demo_fn": 28, "five": 28, "sy": 28, "tempfil": 28, "cleanup": 28, "destroy_process_group": 28, "toymodel": 28, "net1": 28, "1000000": 28, "net2": 28, "demo_bas": 28, "label": 28, "run_demo": 28, "tot": 28, "statist": 28, "median": 28, "90th": 28, "deviat": 28, "cv": 28, "418": 28, "54": 28, "419": 28, "430": 28, "40": 28, "76": 28, "02": [28, 38], "97": 28, "407": 28, "60": 28, "39": 28, "seem": 28, "17864": 28, "20108": 28, "24351": 28, "74": 28, "5866": 28, "83": [28, 38], "10701": 28, "11770": 28, "00": 28, "14313": 28, "78": 28, "3102": 28, "92": 28, "41": [28, 29], "round": [28, 38], "heavili": 28, "sens": 28, "amort": 28, "logdir": 28, "o": 28, "converg": 28, "caution": 28, "known": 28, "crash": 28, "unmodifi": 29, "hook": 29, "biggest": [29, 31], "torchfx": 29, "technolog": 29, "a_xla": 29, "b_xla": 29, "compiled_cod": 29, "eval_model": 29, "xla_resnet18": 29, "eval": 29, "dynamo_resnet18": 29, "no_grad": 29, "resnet": 29, "18": 29, "bench": 29, "59": 29, "resnext50_32x4d": 29, "91": 29, "alexnet": 29, "28": 29, "mobilenet_v2": 29, "62": 29, "mnasnet1_0": 29, "68": 29, "vgg16": 29, "bert_pytorch": 29, "squeezenet1_1": 29, "timm_vision_transform": 29, "52": 29, "geomean": 29, "04": 29, "train_model": 29, "crossentropyloss": 29, "pred": 29, "train_model_main": 29, "dynamo_train_model": 29, "xla_optim": 29, "weight_decai": 29, "extract": 29, "07": 29, "81": 29, "87": 29, "fwd": 29, "bwd": 29, "e2": 29, "hide": 29, "larger": [29, 31], "wit": 29, "promis": 29, "expand": 29, "excit": 29, "upcom": [29, 35], "invest": 29, "_higher_order_op": 30, "fori_loop": 30, "cond_fn": 30, "body_fn": 30, "bodi": 30, "iteri": 30, "init_v": 30, "functionaltensor": 30, "lvl": 30, "51": 30, "xlafullyshardeddataparallel": 31, "my_modul": [31, 32], "adam": [31, 32], "0001": [31, 32], "leftov": [31, 32], "arxiv": 31, "1910": 31, "02054": 31, "reshard_after_forward": 31, "test_train_mp_mnist_fsdp_with_ckpt": 31, "test_train_mp_imagenet_fsdp": 31, "interleav": 31, "submodul": 31, "fsdpvitmodel": 31, "checkpoint_modul": [31, 32], "3524": 31, "auto_wrap_polici": [31, 32], "size_based_auto_wrap_polici": 31, "polici": [31, 35], "100m": 31, "transformer_auto_wrap_polici": [31, 32], "transformer_layer_cl": [31, 32], "auto_wrapper_cal": 31, "remateri": 31, "get_shard_metadata": 31, "consolidate_sharded_model_checkpoint": 31, "stitch": 31, "ckpt": 31, "shard_metadata": 31, "ckpt_path": 31, "pth": 31, "consolidate_sharded_ckpt": 31, "ckpt_prefix": 31, "your_sharded_checkpoint_fil": 31, "ckpt_suffix": 31, "_rank": 31, "inspir": 31, "fairscal": 31, "fullyshardeddataparallel": 31, "readthedoc": 31, "resort": 31, "train_resnet_fsdp_auto_wrap": 31, "newer": [31, 38], "98": 31, "drop_last": 31, "use_nested_fsdp": 31, "use_gradient_checkpoint": 31, "final_ckpt": 31, "1k": 31, "datadir": 31, "test_set_batch_s": 31, "eval_interv": 31, "num_warmup_epoch": 31, "lr_scheduler_divide_every_n_epoch": 31, "lr_scheduler_divisor": 31, "residu": 31, "algorithm": [31, 32, 38], "ronghanghu": 31, "vit_10b_fsdp_exampl": 31, "vit": 31, "review": 32, "spmd_fully_sharded_data_parallel": 32, "spmdfullyshardeddataparallel": 32, "fsdpv2": 32, "autowrap": 32, "decoderlay": 32, "functool": 32, "decoder_only_model": 32, "shard_output": 32, "0th": 32, "children": 32, "blockwis": 33, "int4": 33, "analog": 33, "classifi": 33, "choos": [33, 37], "docstr": 33, "xla_quantized_matmul": 33, "n_input_featur": 33, "n_output_featur": 33, "w_int": 33, "127": 33, "int8": 33, "scaler": 33, "matmul_output": 33, "quantized_matmul": 33, "x_xla": 33, "w_int_xla": 33, "scaler_xla": 33, "matmul_output_xla": 33, "w": 33, "f_dynamo": 33, "dynamo_out_xla": 33, "myqlinearforxlabackend": 33, "load_weight": 33, "processed_w": 33, "processed_scal": 33, "stuff": 33, "orig_model": 33, "mymodel": 33, "q_weight": 33, "q_weights_for_xla": 33, "process_for_xla": 33, "q_linear": 33, "xlaquantizedlinear": 33, "in_featur": 33, "out_featur": 33, "load_quantized_weight": 33, "sym": 33, "asym": 33, "w8a16": 33, "w8a8": 33, "w4a8": 33, "input_shard": 35, "4d": 35, "shardingspec": 35, "input_mesh": 35, "s2": 35, "s3": 35, "s4": 35, "_after": 35, "_the": 35, "forth": 35, "techniqu": 35, "physic": [35, 36, 38], "decis": 35, "nice": 35, "arrang": [35, 36], "center": 35, "multislic": 35, "denot": 35, "hardcod": 35, "rfc": 35, "delai": 35, "subclass": 35, "__torch_dispatch__": 35, "global_tensor": 35, "local_shard": 35, "xlashard": 35, "ongo": 35, "distributedtensor": 35, "proof": 35, "distribute_tensor": 35, "init_device_mesh": 35, "big_tensor": 35, "100000": 35, "88": 35, "my_dtensor": 35, "stai": 35, "dynamo_mark_shard": 35, "placement": 35, "visualize_tensor_shard": 35, "visualize_shard": 35, "rich": 35, "2x2": 35, "generated_t": 35, "use_color": 35, "style": [35, 36], "tile": 35, "partial_repl": 35, "envvar": 35, "xla_auto_spmd": 35, "distribute_modul": 35, "auto_polici": 35, "device_mesh": 35, "sharded_model": 35, "behvaior": 35, "xla_auto_use_group_shard": 35, "reshard": 35, "xla_auto_spmd_mesh": 35, "unset": 35, "matric": [36, 38], "book": 36, "hint": 36, "dimension": 36, "mpi": 36, "necessarili": 36, "3d": 36, "1d": 36, "interconnect": 36, "core_on_chip": 36, "num_cor": 36, "coord": 36, "attribut": 36, "slice_index": 36, "coordin": 36, "divis": 36, "dedic": 37, "planner": 37, "spmdsaveplann": 37, "spmdloadplann": 37, "dist_cp": 37, "distributed_checkpoint": 37, "xc": 37, "storage_writ": 37, "filesystemwrit": 37, "checkpoint_dir": 37, "storage_read": 37, "filesystemread": 37, "all_step": 37, "save_async": 37, "preemption": 37, "detect": 37, "provis": 37, "queuedresourc": 37, "autocheckpoint": 37, "chkpt_on_preempt": 37, "fsspec": 37, "filesystem": 37, "prime_optim": 37, "chkpt_mgr": 37, "gs": 37, "tracked_step": 37, "best_step": 37, "prime": 37, "unprim": 37, "destruct": 37, "yaoshiang": 38, "ho": 38, "2025": 38, "05": 38, "silicon": 38, "inexpens": 38, "tradeoff": 38, "v100": 38, "tensorcor": 38, "numer": 38, "tf32": 38, "mantissa": 38, "intuit": 38, "imagin": 38, "digit": 38, "decim": 38, "111": 38, "222": 38, "84": 38, "021642": 38, "twice": 38, "72": 38, "011": 38, "022": 38, "compris": 38, "fourth": 38, "ignor": 38, "000242": 38, "littl": 38, "rel": 38, "2002": 38, "1012": 38, "0214": 38, "tripl": 38, "idea": 38, "medium": 38, "nine": 38, "hh": 38, "hm": 38, "mh": 38, "hl": 38, "lh": 38, "lm": 38, "room": 38, "varianc": 38, "set_printopt": 38, "sci_mod": 38, "linewidth": 38, "240": 38, "epsilon": 38, "ep": 38, "finfo": 38, "0078125": 38, "00000000000000000000": 38, "00781250000000000000": 38, "vice": 38, "versa": 38, "encourag": 38, "rather": 38, "struct": 38, "binary_fraction_to_fp32": 38, "bstr": 38, "0b1": 38, "invalid": 38, "fraction_bit": 38, "fp32_to_binary_fract": 38, "fp32_float": 38, "x_byte": 38, "endian": 38, "ieee": 38, "754": 38, "as_int": 38, "unpack": 38, "uint32": 38, "sign": 38, "31": 38, "expon": 38, "0xff": 38, "0x7fffff": 38, "0b": 38, "08b": 38, "023b": 38, "get_rand_matrix": 38, "diagon": 38, "1024": 38, "999": 38, "ey": 38, "rand_": 38, "bf16_ep": 38, "one_plus_half_ep": 38, "00390625": 38, "8th": 38, "lost": 38, "reconfirm": 38, "ones_bf16": 38, "01111111": 38, "00000001000000000000000": 38, "00000000000000000000000": 38, "wise": 38, "z_ref": 38, "00000010000000010000000": 38, "0078277587890625": 38, "saw": 38, "01110000101000111101100": 38, "440000057220459": 38, "01110000101000111101101": 38, "4400001764297485": 38}, "objects": {"": [[13, 0, 0, "-", "torch_xla"]], "torch_xla": [[13, 0, 0, "-", "backends"], [13, 1, 1, "", "compile"], [13, 1, 1, "", "device"], [13, 1, 1, "", "device_count"], [13, 1, 1, "", "devices"], [13, 0, 0, "-", "experimental"], [13, 1, 1, "", "manual_seed"], [13, 0, 0, "-", "runtime"], [13, 1, 1, "", "sync"]], "torch_xla.backends": [[13, 1, 1, "", "get_mat_mul_precision"], [13, 1, 1, "", "set_mat_mul_precision"]], "torch_xla.core": [[13, 0, 0, "-", "xla_model"]], "torch_xla.core.xla_model": [[13, 1, 1, "", "add_step_closure"], [13, 1, 1, "", "all_gather"], [13, 1, 1, "", "all_reduce"], [13, 1, 1, "", "all_to_all"], [13, 1, 1, "", "get_memory_info"], [13, 1, 1, "", "get_rng_state"], [13, 1, 1, "", "get_stablehlo"], [13, 1, 1, "", "get_stablehlo_bytecode"], [13, 1, 1, "", "is_master_ordinal"], [13, 1, 1, "", "mesh_reduce"], [13, 1, 1, "", "optimizer_step"], [13, 1, 1, "", "rendezvous"], [13, 1, 1, "", "save"], [13, 1, 1, "", "set_rng_state"], [13, 1, 1, "", "wait_device_ops"], [13, 1, 1, "", "xla_device"], [13, 1, 1, "", "xla_device_hw"]], "torch_xla.debug": [[13, 0, 0, "-", "metrics"]], "torch_xla.debug.metrics": [[13, 1, 1, "", "counter_names"], [13, 1, 1, "", "counter_value"], [13, 1, 1, "", "metric_data"], [13, 1, 1, "", "metric_names"], [13, 1, 1, "", "metrics_report"], [13, 1, 1, "", "short_metrics_report"]], "torch_xla.distributed": [[13, 0, 0, "-", "parallel_loader"], [13, 0, 0, "-", "spmd"], [13, 0, 0, "-", "xla_multiprocessing"]], "torch_xla.distributed.parallel_loader": [[13, 2, 1, "", "MpDeviceLoader"]], "torch_xla.distributed.spmd": [[13, 2, 1, "", "HybridMesh"], [13, 2, 1, "", "Mesh"], [13, 1, 1, "", "clear_sharding"], [13, 1, 1, "", "get_1d_mesh"], [13, 1, 1, "", "get_global_mesh"], [13, 1, 1, "", "mark_sharding"], [13, 1, 1, "", "set_global_mesh"]], "torch_xla.distributed.xla_multiprocessing": [[13, 1, 1, "", "spawn"]], "torch_xla.experimental": [[13, 1, 1, "", "eager_mode"]], "torch_xla.runtime": [[13, 1, 1, "", "addressable_device_count"], [13, 1, 1, "", "device_type"], [13, 1, 1, "", "get_master_ip"], [13, 1, 1, "", "global_device_count"], [13, 1, 1, "", "global_ordinal"], [13, 1, 1, "", "global_runtime_device_count"], [13, 1, 1, "", "initialize_cache"], [13, 1, 1, "", "is_spmd"], [13, 1, 1, "", "local_device_count"], [13, 1, 1, "", "local_ordinal"], [13, 1, 1, "", "local_process_count"], [13, 1, 1, "", "use_spmd"], [13, 1, 1, "", "world_size"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"]}, "titleterms": {"learn": [0, 11], "about": 0, "tpu": [0, 3, 11, 12, 16, 17, 21, 22, 26, 31, 35, 38], "build": [1, 4], "bazel": 1, "depend": [1, 7], "how": [1, 15, 27, 28, 33, 36], "xla": [1, 2, 3, 6, 7, 11, 13, 15, 16, 17, 18, 19, 20, 21, 22, 24, 26, 31, 33, 36, 38], "librari": 1, "torch": [1, 9, 10, 12, 15, 35], "plugin": [1, 6], "remot": 1, "cach": [1, 8, 17, 20], "run": [1, 2, 17, 19, 21, 24, 35], "test": [1, 2, 5, 19, 30], "code": [1, 3, 16, 21, 33], "coverag": 1, "languag": 1, "server": 1, "pytorch": [1, 2, 3, 4, 6, 7, 9, 11, 13, 15, 16, 17, 18, 19, 20, 21, 22, 24, 31, 36, 38], "codegen": 2, "migrat": [2, 16], "guid": [2, 5, 36], "befor": [2, 5], "you": [2, 4, 5, 8, 25, 34], "start": [2, 5, 11, 25, 34], "file": [2, 4, 5], "structur": [2, 5], "old": 2, "op": [2, 5, 10, 33], "lower": [2, 5, 10, 38], "step": [2, 3, 22, 24], "1": [2, 21, 25, 34], "identifi": 2, "2": [2, 21, 25, 34], "inspect": 2, "gener": [2, 9], "lazyir": 2, "h": 2, "3": [2, 25, 34], "implement": [2, 6, 21], "miss": 2, "ir": 2, "function": [2, 27], "torch_xla": [2, 13, 15, 18, 25], "csrc": 2, "ops_xla_shape_fn": 2, "cpp": 2, "4": 2, "ops_lower_fn": 2, "5": 2, "cleanup": 2, "verifi": [2, 4], "result": 2, "sampl": 2, "pr": 2, "configur": [3, 4], "A": [3, 4, 19], "develop": 3, "environ": [3, 19], "visual": 3, "studio": 3, "creat": [3, 17], "connect": 3, "your": [3, 4, 7, 24], "set": 3, "up": [3, 27], "workspac": 3, "next": [3, 22, 24], "c": [4, 6], "debug": [4, 13, 17, 19, 35], "why": [4, 22], "would": 4, "need": 4, "thi": [4, 8], "instal": [4, 31], "gdb": 4, "The": [4, 19, 24], "gnu": 4, "project": 4, "debugg": 4, "symbol": 4, "built": [4, 7], "vscode": 4, "lldb": 4, "realist": 4, "command": 4, "futur": 4, "work": [4, 15], "understand": [5, 16, 19], "oper": [5, 9, 19, 25, 26, 33, 34], "unit": [5, 19], "tip": 5, "custom": [6, 7], "hardwar": [6, 22, 38], "pjrt": [6, 12], "api": [6, 10, 11, 13, 15], "packag": 6, "kernel": 7, "via": 7, "palla": 7, "adopt": 7, "abov": 7, "compat": [7, 8], "us": [7, 8, 9, 22, 25, 27, 28, 32, 33, 34, 36], "flashattent": 7, "exampl": [7, 8, 16, 21, 26, 30, 31], "usag": [7, 30], "integr": [7, 29, 35], "pagedattent": 7, "write": 7, "own": 7, "optim": [8, 16, 30, 35, 37], "repeat": 8, "layer": 8, "scan": 8, "scan_lay": 8, "when": [8, 25, 34], "should": 8, "limit": [8, 27], "aotautograd": 8, "requir": 8, "compil": [8, 15, 17, 19, 20, 35], "time": [8, 17, 18], "experi": 8, "refer": [8, 11, 21], "export": 9, "stablehlo": 9, "extract_jax": 9, "inlin": 9, "some": [9, 25, 34], "weight": 9, "preserv": 9, "high": 9, "level": 9, "composit": 9, "support": [10, 26, 33], "distribut": [10, 11, 12, 13, 16, 28, 37], "collect": 10, "stack": 10, "non": 10, "dynamo": [10, 19], "case": [10, 18, 25, 30, 34, 38], "descript": 10, "document": 11, "get": [11, 19, 38], "tutori": 11, "basic": [11, 19], "train": [11, 16, 24, 29, 31], "advanc": [11, 20, 35], "techniqu": 11, "troubleshoot": [11, 19, 34], "contribut": 11, "runtim": [12, 13], "tl": 12, "dr": 12, "benefit": 12, "quickstart": [12, 24], "cpu": [12, 17], "pod": [12, 17, 21, 31, 35], "docker": 12, "differ": [12, 16], "from": [12, 16, 17, 25, 34], "xrt": 12, "multithread": 12, "v2": 12, "v3": [12, 31], "chang": 12, "xm": 12, "rendezv": 12, "perform": [12, 15, 16, 18, 19, 23], "new": 12, "backend": 13, "xla_model": 13, "spmd": [13, 32, 35, 36], "experiment": 13, "dynam": [14, 25, 34], "shape": [14, 25, 34], "bound": [14, 25, 34], "s": [15, 25, 34], "interact": 15, "eager": 15, "mode": [15, 36], "overview": [15, 22], "challeng": 15, "lazytensor": 15, "vs": [15, 16, 18], "benchmark": [15, 19, 27, 28], "gpu": 16, "kei": [16, 24], "core": 16, "modif": 16, "devic": [16, 17, 21, 35, 36], "handl": 16, "lazi": [16, 17], "execut": [16, 18, 19, 20], "synchron": [16, 20], "scalabl": 16, "data": [16, 19, 20, 28, 31, 32, 35], "load": [16, 17, 20, 35], "automat": [16, 26], "mix": [16, 26], "precis": [16, 26, 38], "amp": [16, 26], "other": 16, "import": 16, "consider": 16, "workflow": 16, "transform": 16, "conceptu": 16, "an": 17, "tensor": [17, 19, 25, 34], "ar": 17, "model": [17, 24, 33], "singl": [17, 21], "multipl": [17, 21], "multi": 17, "process": [17, 31, 37], "deep": 17, "dive": 17, "memori": [17, 30], "layout": 17, "move": 17, "save": 17, "unexpect": 17, "materi": 17, "dure": 17, "aot": 17, "ahead": 17, "trace": [17, 18, 27], "flag": 17, "recommend": 17, "further": [17, 36], "read": [17, 36], "illustr": 18, "common": [18, 19], "pitfal": 18, "measur": 18, "onli": 18, "end": 18, "trigger": 18, "ensur": 18, "complet": 18, "studi": 18, "correctli": 18, "profil": [18, 19, 23], "loop": [18, 30], "sync": 18, "saniti": 19, "check": 19, "version": 19, "simpl": [19, 30], "calcul": 19, "resnet": [19, 31], "With": 19, "fake": [19, 28], "tool": [19, 35], "auto": [19, 35], "metric": 19, "analysi": [19, 23], "report": 19, "clear": 19, "known": 19, "caveat": 19, "quirk": 19, "more": 19, "variabl": 19, "combin": 19, "reproduc": 19, "ci": 19, "cd": 19, "failur": 19, "topic": [20, 35], "block": 20, "barrier": 20, "graph": 20, "convert": 21, "stabl": 21, "diffus": 21, "infer": [21, 29], "lightn": 21, "hf": 21, "target": 22, "setup": 22, "first": [24, 25, 34], "prerequisit": 24, "mnist": [24, 28, 31], "script": [24, 31], "explan": 24, "specif": 24, "part": 24, "takeawai": 24, "sourc": 25, "recompil": [25, 34], "let": [25, 34], "fact": [25, 34], "constraint": [25, 34], "input": [25, 34], "dataset": [25, 34], "output": [25, 32, 34], "can": [25, 34], "fix": [25, 34], "without": [25, 34], "queri": [25, 34], "its": [25, 34], "real": [25, 28, 34], "dimens": [25, 34], "what": [25, 34, 36], "control": [25, 30, 34, 38], "flow": [25, 34], "conclus": [25, 34, 38], "appendix": [25, 34], "best": 26, "practic": 26, "speed": 27, "assume_pur": 27, "background": [27, 28], "motiv": [27, 28], "nn": 27, "modul": [27, 33], "parallel": [28, 31, 32], "ddp": 28, "distributeddataparallel": 28, "resnet50": 28, "disclaim": 28, "torchdynamo": 29, "featur": 29, "gap": 29, "take": 29, "awai": 29, "util": 30, "while_loop": 30, "group": [30, 37], "pure": 30, "python": 30, "while": 30, "fulli": [31, 32], "shard": [31, 32, 35, 36], "fsdp": [31, 32], "One": 31, "per": 31, "acceler": 31, "imagenet": 31, "clone": 31, "repo": 31, "8": 31, "50": 31, "10": 31, "billion": 31, "paramet": 31, "gradient": 32, "checkpoint": [32, 37], "quantiz": 33, "call": 33, "swap": 33, "matrix": 33, "multipli": 33, "awar": 35, "host": 35, "virtual": 35, "hybrid": 35, "mesh": [35, 36], "xlashardedtensor": 35, "dtensor": 35, "activ": 35, "user": 36, "partit": 36, "spec": 36, "which": 36, "hold": 36, "checkpointmanag": 37, "restor": 37, "state": 37, "mxu": 38, "float": 38, "point": 38, "introduct": 38, "higher": 38, "math": 38, "prepar": 38, "readi": 38, "look": 38, "directli": 38, "bit": 38, "examin": 38, "number": 38, "fp32": 38, "bfloat16": 38, "edg": 38}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})