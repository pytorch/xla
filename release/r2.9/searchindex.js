Search.setIndex({"docnames": ["accelerators/tpu", "contribute/bazel", "contribute/codegen_migration", "contribute/configure-environment", "contribute/cpp_debugger", "contribute/op_lowering", "contribute/plugins", "features/pallas", "features/scan", "features/stablehlo", "features/torch_distributed", "index", "learn/_pjrt", "learn/api-guide", "learn/dynamic_shape", "learn/eager", "learn/pytorch-on-xla-devices", "learn/trace-vs-execution-time", "learn/troubleshoot", "learn/xla-advanced", "learn/xla-examples", "learn/xla-overview", "learn/xla-profiling", "notes/source_of_recompilation", "perf/amp", "perf/assume_pure", "perf/ddp", "perf/dynamo", "perf/fori_loop", "perf/fsdp_collectives", "perf/fsdp_spmd", "perf/quantized_ops", "perf/recompilation", "perf/spmd_advanced", "perf/spmd_basic", "perf/spmd_distributed_checkpoint", "tutorials/precision_tutorial"], "filenames": ["accelerators/tpu.md", "contribute/bazel.md", "contribute/codegen_migration.md", "contribute/configure-environment.md", "contribute/cpp_debugger.md", "contribute/op_lowering.md", "contribute/plugins.md", "features/pallas.md", "features/scan.md", "features/stablehlo.md", "features/torch_distributed.md", "index.rst", "learn/_pjrt.md", "learn/api-guide.rst", "learn/dynamic_shape.md", "learn/eager.md", "learn/pytorch-on-xla-devices.md", "learn/trace-vs-execution-time.md", "learn/troubleshoot.md", "learn/xla-advanced.md", "learn/xla-examples.md", "learn/xla-overview.md", "learn/xla-profiling.md", "notes/source_of_recompilation.md", "perf/amp.md", "perf/assume_pure.md", "perf/ddp.md", "perf/dynamo.md", "perf/fori_loop.md", "perf/fsdp_collectives.md", "perf/fsdp_spmd.md", "perf/quantized_ops.md", "perf/recompilation.md", "perf/spmd_advanced.md", "perf/spmd_basic.md", "perf/spmd_distributed_checkpoint.md", "tutorials/precision_tutorial.ipynb"], "titles": ["Learn about TPUs", "Building with Bazel", "Codegen Migration Guide", "Configure A Development Environment", "C++ Debugging", "Op Lowering Guide", "Custom Hardware Plugins", "Custom Kernels via Pallas", "Optimizing Repeated Layers with <code class=\"docutils literal notranslate\"><span class=\"pre\">scan</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">scan_layers</span></code>", "Torch Export to StableHLO", "Support for Torch Distributed", "PyTorch/XLA documentation", "PJRT Runtime", "PyTorch/XLA API", "Dynamic Shapes", "PyTorch/XLA Compile API and it\u2019s interaction with Eager mode.", "PyTorch on XLA Devices", "Tracing Time vs. Execution Time in PyTorch/XLA", "Troubleshooting Basics", "Advanced Topics in PyTorch XLA", "Converting code to PyTorch XLA", "Pytorch/XLA Overview", "Profiling and performance analysis", "Source of recompilations in torch_xla", "Automatic Mixed Precision", "Speed Up Tracing with <code class=\"docutils literal notranslate\"><span class=\"pre\">&#64;assume_pure</span></code>", "Distributed Data Parallel (DDP)", "TorchDynamo Integration", "Optimize Memory Utilization with <code class=\"docutils literal notranslate\"><span class=\"pre\">while_loop</span></code>", "Fully Sharded Data Parallel (FSDP) with One Process Per Accelerator", "Fully Sharded Data Parallel (FSDP) using SPMD", "Quantized Operations", "Troubleshooting recompilations", "SPMD advanced topics", "SPMD User Guide", "Distributed Checkpointing", "Control MXU Floating Point Precision"], "terms": {"googl": [0, 7, 12, 16, 21, 36], "cloud": [0, 1, 3, 6, 12, 16, 21, 27, 35], "ar": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 31, 32, 33, 34, 35, 36], "custom": [0, 2, 3, 4, 8, 9, 10, 11, 13, 15, 21, 23, 26, 29, 31, 32, 33, 34], "design": [0, 8, 12, 15, 16, 21, 27], "ai": [0, 20, 21], "acceler": [0, 3, 11, 12, 13, 14, 15, 16, 20, 21, 24, 36], "which": [0, 1, 2, 4, 5, 6, 9, 10, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 27, 29, 30, 32, 33, 35, 36], "optim": [0, 4, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 29, 30, 32, 36], "train": [0, 7, 8, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 24, 25, 33, 35, 36], "infer": [0, 2, 11, 13, 15, 16, 21, 22, 24, 33], "larg": [0, 8, 12, 14, 19, 20, 21, 22, 23, 29, 32, 34], "model": [0, 2, 5, 8, 9, 11, 12, 13, 14, 15, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 32, 33, 34, 35, 36], "thei": [0, 1, 5, 6, 9, 10, 12, 13, 16, 17, 18, 19, 23, 24, 32, 33, 34], "ideal": [0, 1, 2, 23, 27, 32], "varieti": 0, "us": [0, 1, 2, 3, 4, 5, 6, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 22, 24, 27, 29, 33, 35, 36], "case": [0, 1, 2, 5, 8, 9, 12, 13, 16, 18, 19, 20, 21, 22, 25, 27, 30, 33], "chatbot": [0, 21], "code": [0, 2, 4, 5, 8, 9, 11, 12, 13, 15, 16, 17, 18, 19, 21, 22, 23, 25, 26, 27, 32, 33], "gener": [0, 4, 5, 12, 13, 15, 16, 18, 19, 20, 21, 23, 32, 36], "media": [0, 21], "content": [0, 13, 21], "synthet": 0, "speech": 0, "vision": [0, 21, 29], "servic": [0, 1, 12, 21], "recommend": [0, 1, 2, 3, 4, 5, 12, 13, 15, 21, 33, 36], "engin": [0, 18, 21], "person": 0, "among": 0, "other": [0, 1, 2, 4, 5, 7, 8, 12, 13, 14, 16, 18, 20, 21, 23, 24, 25, 26, 29, 30, 31, 32, 34], "scale": [0, 9, 11, 12, 13, 21, 24, 25, 27, 34], "cost": [0, 11, 15, 21, 25, 27, 36], "effici": [0, 8, 9, 11, 15, 18, 21, 27, 34], "wide": [0, 5, 21, 23, 32], "rang": [0, 5, 8, 12, 13, 17, 21, 25, 30, 33, 34, 36], "workload": [0, 12, 15, 16, 18, 21, 33, 34], "span": [0, 2, 15], "fine": 0, "tune": [0, 33, 34], "provid": [0, 1, 2, 5, 6, 7, 8, 13, 15, 16, 17, 18, 20, 21, 23, 24, 27, 28, 29, 31, 32, 33, 34, 35, 36], "versatil": [0, 21], "lead": [0, 8, 15, 16, 17, 18, 20, 21, 22, 25], "framework": [0, 21, 23, 31, 32], "includ": [0, 1, 5, 12, 13, 17, 18, 21, 23, 24, 28, 32, 34, 35, 36], "pytorch": [0, 5, 8, 10, 12, 14, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 33, 35], "jax": [0, 6, 7, 8, 9, 12, 21], "tensorflow": [0, 1, 6, 12, 13, 18, 21, 23, 32], "seamlessli": [0, 21], "orchestr": 0, "through": [0, 2, 5, 6, 7, 8, 10, 16, 19, 21, 23, 24, 32, 35, 36], "integr": [0, 11, 15, 31, 34], "kubernet": 0, "gke": 0, "leverag": [0, 21], "dynam": [0, 2, 5, 11, 16, 18, 19, 27], "schedul": [0, 20, 22], "improv": [0, 12, 16, 18, 19, 20, 21, 22, 24, 27, 33, 34], "scalabl": [0, 21], "all": [0, 1, 2, 4, 5, 8, 9, 10, 12, 13, 16, 17, 18, 19, 20, 21, 23, 25, 26, 29, 32, 33, 35], "need": [0, 1, 2, 5, 9, 12, 13, 16, 17, 18, 19, 20, 21, 23, 26, 29, 30, 32, 33, 34, 36], "simultan": [0, 34], "look": [0, 2, 4, 5, 8, 15, 16, 18, 20, 22, 33], "simplest": [0, 34, 36], "wai": [0, 1, 5, 7, 9, 10, 12, 13, 16, 17, 22, 23, 26, 27, 31, 32, 33, 34], "develop": [0, 1, 4, 11, 15, 16, 21, 26, 27, 31, 34], "can": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 24, 25, 26, 27, 29, 30, 31, 33, 34, 35, 36], "also": [0, 1, 2, 4, 5, 6, 9, 10, 12, 13, 16, 18, 19, 20, 21, 22, 23, 25, 27, 29, 30, 31, 32, 33, 34, 36], "vertex": 0, "fulli": [0, 11, 12, 15, 18, 34], "manag": [0, 7, 13, 24, 35], "platform": [0, 13], "For": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 34], "more": [0, 1, 2, 3, 4, 5, 7, 9, 12, 13, 15, 16, 20, 21, 23, 25, 32, 33, 34, 36], "inform": [0, 2, 3, 4, 12, 13, 15, 16, 18, 22, 23, 32, 36], "see": [0, 1, 2, 3, 4, 5, 6, 8, 9, 12, 13, 14, 15, 16, 18, 20, 21, 22, 23, 25, 27, 29, 32, 36], "introduct": [0, 7], "set": [0, 1, 4, 8, 10, 12, 13, 18, 19, 20, 23, 27, 29, 32, 33, 34, 35, 36], "up": [0, 1, 2, 4, 11, 12, 16, 17, 20, 21, 22, 23, 27, 30, 32, 36], "environ": [0, 1, 4, 11, 12, 14, 16, 19, 26, 33, 34, 35], "resourc": [0, 13, 18], "free": [1, 5, 9, 18, 24, 26, 29], "softwar": [1, 18], "tool": [1, 5, 22, 29, 34, 36], "autom": 1, "openxla": [1, 6, 9, 15, 21, 27, 31], "both": [1, 3, 4, 5, 10, 12, 15, 20, 23, 27, 29, 30, 31, 32, 34, 35], "make": [1, 3, 4, 9, 12, 16, 17, 18, 19, 20, 21, 22, 23, 26, 27, 32, 33, 36], "good": [1, 2, 5, 22, 23, 32, 33], "fit": [1, 2, 22, 29], "well": [1, 2, 6, 12, 13, 20, 22, 23, 32, 33, 34], "extern": [1, 3, 7], "seen": [1, 17, 19, 27], "workspac": [1, 18], "file": [1, 3, 8, 12, 13, 18, 20, 22, 24, 25, 26], "http_archiv": 1, "name": [1, 3, 4, 5, 12, 13, 18, 23, 30, 32, 33, 34], "patch_arg": 1, "l": [1, 36], "p1": 1, "patch_tool": 1, "patch": [1, 18], "openxla_patch": 1, "no_fortifi": 1, "diff": [1, 12, 20], "strip_prefix": 1, "xla_hash": 1, "url": 1, "http": [1, 2, 3, 7, 8, 9, 12, 13, 18, 20, 21, 29], "github": [1, 2, 3, 4, 5, 8, 12, 13, 18, 20, 26, 29], "com": [1, 2, 3, 7, 8, 12, 13, 18, 20, 21, 29], "archiv": 1, "tar": 1, "gz": 1, "you": [1, 3, 6, 7, 9, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 25, 26, 27, 29, 30, 33, 34, 36], "specifi": [1, 4, 9, 10, 13, 15, 16, 17, 21, 29, 33, 34], "revis": 1, "want": [1, 4, 5, 9, 13, 16, 18, 20, 23, 27, 32, 33, 34], "field": 1, "alwai": [1, 12, 16, 18, 23, 32, 34], "determinist": 1, "commit": [1, 20], "aka": 1, "pin": [1, 13], "mai": [1, 2, 4, 6, 8, 12, 16, 18, 19, 20, 22, 23, 24, 25, 32, 33, 34, 36], "ad": [1, 4, 5, 9, 13, 16, 17, 18, 19, 20, 22, 23, 25, 27, 28, 32, 33, 36], "resolv": 1, "prepar": [1, 17], "hermet": 1, "differ": [1, 2, 6, 13, 15, 16, 18, 20, 22, 23, 25, 26, 28, 29, 30, 32, 33, 34, 36], "mechan": [1, 8, 17], "deploi": 1, "becaus": [1, 2, 8, 12, 15, 16, 19, 20, 22, 24, 25, 33, 36], "local": [1, 3, 12, 13, 16, 18, 33], "checkout": [1, 8, 18], "thi": [1, 2, 3, 5, 6, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 31, 32, 33, 34, 35, 36], "ha": [1, 2, 3, 4, 5, 7, 8, 9, 12, 13, 16, 17, 19, 20, 22, 23, 32, 33, 34, 36], "built": [1, 3, 34, 36], "from": [1, 2, 3, 4, 5, 7, 8, 9, 10, 13, 14, 15, 18, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 33, 34, 35, 36], "sourc": [1, 2, 4, 5, 6, 8, 11, 12, 13, 18, 21, 32], "instal": [1, 2, 3, 5, 6, 7, 11, 12, 18, 20, 21], "system": [1, 21, 34, 36], "version": [1, 2, 3, 4, 7, 12, 16, 20, 21, 22, 24, 25, 33], "compat": [1, 12, 21, 31, 35], "e": [1, 3, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 25, 29, 31, 32, 33, 34], "g": [1, 3, 4, 9, 10, 12, 13, 14, 15, 17, 18, 19, 21, 23, 25, 31, 32, 33, 34], "codegen": [1, 5, 11], "torchgen": [1, 2], "python": [1, 2, 3, 4, 5, 6, 8, 9, 11, 12, 13, 14, 17, 18, 19, 20, 21, 22, 23, 26, 27, 32, 33], "modul": [1, 7, 8, 9, 13, 16, 18, 26, 29, 30, 33, 36], "should": [1, 2, 3, 5, 6, 12, 13, 16, 17, 18, 22, 23, 24, 28, 29, 32, 33, 34, 35], "The": [1, 2, 3, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19, 20, 21, 22, 23, 25, 26, 27, 29, 31, 32, 33, 34, 35, 36], "directori": [1, 2, 5, 8], "either": [1, 5, 10, 12, 13, 18, 23, 24, 32], "bzl": 1, "overriden": 1, "command": [1, 2, 3, 8, 12, 16, 18, 20, 21, 26, 29], "line": [1, 2, 4, 9, 13, 15, 16, 18, 20, 23, 29, 32], "override_repositori": 1, "org_tensorflow": 1, "path": [1, 4, 6, 13, 16, 18, 21, 23, 29, 32], "export": [1, 2, 3, 5, 11, 12, 18, 21], "tf_repo": 1, "torch_repo": 1, "pleas": [1, 2, 5, 10, 12, 13, 16, 18, 24, 29, 30, 31, 33, 36], "sure": [1, 4, 16, 17, 18, 36], "overridden": [1, 2], "repositori": [1, 12], "appropri": [1, 16, 22], "been": [1, 4, 5, 12, 13, 16, 19, 20, 23, 32, 33], "use_cuda": [1, 4], "0": [1, 2, 3, 4, 6, 8, 9, 11, 12, 13, 14, 16, 18, 19, 20, 21, 23, 25, 26, 27, 28, 29, 30, 32, 33, 34, 36], "setup": [1, 2, 4, 6, 9, 16, 26], "py": [1, 2, 3, 4, 5, 8, 10, 12, 14, 15, 16, 18, 20, 22, 25, 26, 29], "bdist_wheel": 1, "expect": [1, 2, 6, 12, 13, 16, 18, 23, 27, 31, 32, 36], "object": [1, 9, 13, 33], "present": [1, 35], "new_local_repositori": 1, "build_fil": 1, "pytorch_local_dir": 1, "header": 1, "directli": [1, 2, 5, 6, 12, 13, 16, 18, 20, 21, 23, 24, 29, 32, 33, 35], "share": [1, 2, 6, 12, 16, 18, 33], "libtorch": 1, "so": [1, 2, 6, 9, 12, 13, 14, 16, 18, 19, 20, 21, 23, 29, 32, 35, 36], "same": [1, 2, 5, 6, 8, 12, 13, 16, 18, 19, 21, 22, 23, 24, 25, 28, 31, 32, 33, 34, 36], "where": [1, 3, 7, 8, 10, 12, 13, 15, 16, 17, 18, 22, 23, 29, 30, 32, 34, 36], "lib": [1, 4, 6], "contain": [1, 2, 5, 6, 8, 9, 12, 13, 18, 20, 22, 23, 25, 32, 34], "work": [1, 2, 8, 9, 10, 12, 13, 14, 16, 17, 18, 23, 25, 27, 31, 32, 33], "s": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 16, 17, 18, 20, 21, 22, 24, 25, 26, 27, 31, 33, 35, 36], "requir": [1, 2, 5, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 23, 32, 33, 35, 36], "pass": [1, 5, 8, 9, 12, 13, 15, 17, 19, 20, 24, 25, 33, 34, 36], "isystemextern": 1, "compil": [1, 4, 5, 6, 9, 11, 12, 13, 14, 17, 20, 21, 22, 23, 27, 30, 31, 32, 34, 35], "find": [1, 2, 5, 7, 8, 12, 18, 20, 22, 26, 30], "satisfi": [1, 33], "them": [1, 2, 5, 8, 12, 13, 15, 16, 17, 18, 19, 20, 23, 32, 34, 36], "some": [1, 2, 5, 8, 12, 13, 14, 16, 18, 25, 26, 31, 33, 34, 36], "user": [1, 3, 4, 6, 8, 11, 12, 15, 16, 18, 19, 23, 27, 28, 30, 31, 32, 33, 35], "bring": [1, 2], "pybind11": 1, "embed": [1, 8], "link": [1, 2], "against": [1, 26], "libpython": 1, "instead": [1, 9, 10, 12, 13, 16, 18, 20, 21, 23, 25, 26, 27, 29, 32, 33, 35], "These": [1, 2, 5, 7, 8, 12, 19, 20, 31, 35, 36], "pybind11_emb": 1, "option": [1, 2, 3, 4, 6, 12, 13, 18, 31, 33, 35], "transit": [1, 15, 16, 21], "simpl": [1, 2, 7, 8, 12, 19, 24, 29], "torch_xla": [1, 3, 5, 6, 7, 8, 10, 11, 12, 14, 16, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36], "csrc": [1, 5], "runtim": [1, 2, 3, 6, 11, 16, 18, 26, 29, 33, 34, 35], "configr": 1, "via": [1, 3, 11, 12, 15, 17, 21, 28, 29, 33, 34], "bazelrc": 1, "take": [1, 2, 8, 9, 13, 16, 17, 18, 20, 21, 22, 23, 32, 33], "flag": [1, 2, 4, 9, 13, 14], "config": [1, 2, 3, 9], "remote_cach": 1, "configur": [1, 2, 5, 11, 12, 13, 16, 18, 20, 35], "gcloud": [1, 3, 12, 16, 20, 21], "usual": [1, 2, 4, 5, 16, 18], "faster": [1, 4, 12, 19, 20, 23, 25, 27, 32], "authent": [1, 12], "easi": [1, 8, 12, 16, 23, 32, 36], "express": [1, 25, 34], "complex": [1, 15, 25, 27], "lot": [1, 16, 18, 19, 23, 32], "gain": [1, 12], "have": [1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 15, 16, 18, 19, 20, 21, 22, 23, 25, 26, 27, 29, 30, 32, 33, 35, 36], "singl": [1, 8, 12, 13, 15, 19, 21, 22, 23, 26, 27, 29, 30, 32, 33, 34], "graph": [1, 8, 9, 12, 13, 15, 16, 17, 18, 20, 21, 22, 23, 25, 26, 27, 32, 33], "everyth": [1, 9, 23, 26, 32], "therefor": [1, 16, 18, 20, 22], "separ": [1, 2, 4, 5, 9, 15, 16, 19, 27, 29, 30], "rest": [1, 18, 23, 32], "plu": [1, 17, 26, 28], "whole": [1, 13, 15, 23, 27, 32], "everythin": 1, "els": [1, 9, 16, 18, 23, 32], "enough": [1, 22, 23, 32], "normal": [1, 2, 12, 16, 23, 30, 32, 33], "achiev": [1, 5, 15, 26, 34], "invok": [1, 2, 27, 33], "standard": [1, 17], "c": [1, 2, 5, 11, 12, 18, 23, 24, 25, 32], "bind": 1, "simpli": [1, 8, 15], "_xlac": [1, 16, 18, 23, 32], "client": [1, 6, 12, 13], "togeth": [1, 12, 16, 26, 29, 33, 34], "when": [1, 2, 4, 5, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 27, 29, 33, 34, 35, 36], "chang": [1, 4, 5, 11, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 31, 32, 33], "abl": [1, 16, 23, 32, 35, 36], "without": [1, 5, 8, 9, 12, 13, 15, 16, 17, 18, 19, 20, 22, 33, 34, 35, 36], "iter": [1, 8, 13, 14, 15, 16, 17, 18, 19, 27, 33], "cycl": [1, 16], "come": [1, 13, 23, 32], "There": [1, 2, 9, 16, 18, 22, 23, 26, 27, 32, 33], "plenti": 1, "backend": [1, 2, 10, 11, 12, 15, 21, 23, 27, 28, 31, 32, 33, 35, 36], "we": [1, 2, 3, 4, 5, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 25, 26, 27, 28, 29, 30, 32, 33], "our": [1, 2, 3, 4, 5, 6, 7, 10, 12, 16, 18, 21, 23, 24, 26, 27, 32, 33, 34], "gc": [1, 35], "storag": [1, 3, 7, 16, 18, 21, 29, 35], "under": [1, 2, 5, 8, 12, 13, 15, 16, 26], "disabl": [1, 13, 15, 16, 18, 19, 20], "default": [1, 5, 9, 12, 13, 15, 16, 17, 18, 20, 24, 29, 33, 35, 36], "speed": [1, 4, 11, 13, 20, 21, 23, 27, 32, 36], "increment": [1, 2], "huge": [1, 18, 20, 23, 26, 32], "margin": 1, "almost": 1, "enabl": [1, 4, 8, 13, 14, 15, 16, 18, 19, 21, 22, 24, 26, 31, 33, 34, 35], "ci": [1, 5], "To": [1, 2, 3, 4, 5, 6, 7, 8, 12, 13, 14, 15, 16, 17, 18, 20, 22, 23, 29, 30, 32, 33, 35, 36], "machin": [1, 3, 12, 18, 19, 21, 22], "ensur": [1, 8, 13, 16, 23, 25, 30, 32, 33, 35], "credenti": 1, "auth": [1, 12], "applic": [1, 18, 21, 31, 35], "login": [1, 20], "launch": [1, 4, 12, 13, 14, 16, 17, 20, 26, 27, 29], "browser": 1, "gcp": [1, 3, 12], "variou": [1, 15, 21], "individu": [1, 29, 30, 34], "who": [1, 4, 26], "access": [1, 2, 5, 7, 12, 13, 16, 17, 18, 19, 20, 23, 32, 35, 36], "project": [1, 3, 6, 12, 16, 21], "one": [1, 2, 5, 7, 8, 12, 13, 16, 18, 19, 20, 22, 23, 27, 28, 29, 30, 32, 33, 34, 36], "onli": [1, 2, 4, 5, 8, 10, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 32, 34, 35, 36], "google_default_credenti": 1, "token": [1, 15, 20, 31], "out": [1, 5, 8, 9, 12, 13, 16, 18, 20, 24, 27, 33, 36], "box": [1, 5, 33], "log": [1, 18, 19, 20], "permiss": 1, "add": [1, 2, 4, 5, 13, 16, 19, 20, 22, 23, 27, 28, 29, 32], "new": [1, 2, 3, 4, 5, 10, 16, 17, 18, 19, 20, 23, 27, 32, 33], "role": [1, 15], "In": [1, 2, 4, 5, 6, 7, 8, 10, 12, 13, 14, 16, 17, 18, 19, 20, 23, 24, 25, 27, 32, 33, 34, 35, 36], "account": [1, 20], "kei": [1, 3, 6, 8, 12, 18, 19, 21, 35], "google_credenti": 1, "On": [1, 12, 13, 35], "docker": 1, "network": [1, 12, 13, 16, 18, 24, 33, 34, 36], "cloudbuild": 1, "down": [1, 4, 5, 20, 36], "imag": [1, 12, 21, 23, 26, 29, 32], "do": [1, 2, 4, 5, 9, 12, 13, 14, 16, 18, 19, 20, 22, 23, 24, 25, 26, 29, 31, 32, 33, 36], "doe": [1, 2, 4, 12, 13, 14, 16, 17, 18, 19, 22, 23, 25, 32, 33, 34], "read": [1, 3, 5, 12, 13, 33], "write": [1, 5, 13, 16, 17, 34], "silo": 1, "each": [1, 2, 4, 5, 10, 12, 13, 16, 17, 18, 19, 20, 23, 25, 27, 29, 30, 32, 33, 34, 35, 36], "uniqu": [1, 16, 20, 23, 25, 32], "benefit": [1, 4, 15, 21, 31, 35], "consist": [1, 10, 12, 17], "remote_default_exec_properti": 1, "some_silo_kei": 1, "bazel_remote_cach": 1, "1": [1, 3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 19, 22, 25, 26, 27, 28, 29, 30, 33, 34, 36], "silo_nam": 1, "your": [1, 2, 6, 8, 9, 12, 16, 17, 18, 19, 20, 21, 23, 25, 26, 30, 32, 33, 34, 35, 36], "tpuvm_mod": 1, "gcloud_service_key_fil": 1, "application_default_credenti": 1, "json": [1, 4], "might": [1, 2, 5, 13, 16, 18, 19, 20, 22, 23, 32], "help": [1, 16, 18, 19, 21, 22, 23, 32], "too": [1, 4, 18, 23, 32], "cannot": [1, 7, 8, 22, 23, 24, 29, 32, 36], "here": [1, 2, 5, 7, 9, 14, 16, 17, 19, 20, 23, 26, 27, 29, 30, 32, 33, 34, 35], "author": [1, 36], "usernam": [1, 4], "behavior": [1, 2, 5, 12, 13, 16, 18, 25], "function": [1, 5, 6, 7, 8, 9, 10, 13, 15, 16, 18, 20, 22, 27, 28, 30, 31, 35, 36], "intend": [1, 15], "first": [1, 2, 3, 8, 9, 13, 14, 17, 18, 19, 20, 22, 26, 33, 34, 35, 36], "time": [1, 2, 3, 4, 11, 12, 13, 14, 18, 19, 20, 22, 23, 25, 27, 28, 32, 33, 36], "slow": [1, 4, 8, 18, 20], "scratch": [1, 2], "veri": [1, 6, 7, 16, 19, 20, 23, 32], "fast": [1, 23, 32], "updat": [1, 2, 4, 9, 10, 16, 17, 20, 21, 23, 32, 33], "onc": [1, 10, 13, 16, 18, 19, 20, 23, 25, 27, 32, 33, 36], "again": [1, 2, 4, 16, 19, 36], "bit": [1, 13, 16, 31], "slower": [1, 15, 18, 19, 26, 36], "per": [1, 11, 12, 13, 15, 16, 18, 26, 27, 31], "until": [1, 13, 16, 17, 19, 35], "next": [1, 4, 13, 17, 18, 19, 20, 23, 31, 32, 33, 36], "quit": 1, "current": [1, 4, 6, 7, 13, 14, 15, 16, 17, 22, 23, 25, 27, 28, 30, 31, 32, 33], "migrat": [1, 11, 12], "futur": [1, 2, 3, 6, 12, 15, 16, 18, 22, 23, 25, 30, 32], "plafrom": 1, "cpp": [1, 4, 5, 18], "main": [1, 3, 9, 10, 12, 15, 33], "Of": 1, "cours": 1, "pjrt": [1, 13, 16, 21, 33], "Not": 1, "environment": 1, "variabl": [1, 3, 4, 12, 14, 19, 23, 32], "miss": [1, 5, 13, 18], "common": [1, 12, 16, 23, 30, 31, 32, 34, 35], "part": [1, 2, 6, 12, 13, 15, 18, 19, 22, 33, 36], "ones": [1, 13, 23, 32], "helper": [1, 2, 13], "script": [1, 2, 3, 7, 12, 16, 17, 18, 20, 22, 24, 26, 36], "run_test": 1, "sh": 1, "r": [1, 20], "xla_client": 1, "pure": [1, 2, 8, 15, 25], "easili": [1, 5, 23, 27, 32], "execut": [1, 4, 11, 12, 13, 15, 16, 20, 21, 22, 23, 24, 25, 26, 27, 32, 33, 34, 36], "parallel": [1, 11, 12, 13, 18, 19, 21, 33, 34], "sinc": [1, 2, 5, 12, 16, 18, 22, 23, 24, 26, 27, 30, 32, 33, 35], "xrt": [1, 13], "port": 1, "tpu": [1, 2, 5, 6, 7, 8, 13, 14, 15, 17, 18, 22, 26, 27, 28, 34, 35], "devic": [1, 2, 3, 5, 6, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 31, 32, 35, 36], "avail": [1, 12, 13, 16, 18, 19, 20, 23, 29, 32], "reason": [1, 2, 5, 12, 20, 26], "bundl": 1, "target": [1, 12, 15, 16, 22, 23, 24, 27, 32], "sequenti": [1, 13], "calcul": [1, 15, 36], "visual": [1, 33, 34, 36], "lcov": 1, "describ": [1, 2, 3, 4, 9, 13, 16, 20, 22, 24, 26, 34], "document": [1, 2, 3, 5, 6, 9, 12, 16, 24, 25, 26, 31], "editor": 1, "choic": [1, 23, 32], "gutter": 1, "vscode": 1, "power": 1, "like": [1, 2, 3, 4, 5, 7, 8, 9, 12, 13, 15, 16, 17, 18, 19, 21, 23, 24, 29, 32, 33, 36], "clangd": 1, "refer": [1, 2, 5, 7, 10, 12, 13, 14, 16, 21, 29, 31, 33, 34], "autocomplet": 1, "semant": [1, 5, 18, 23, 32], "understand": [1, 9, 15, 17, 20, 22, 23, 32], "underli": [1, 13, 16, 34], "stack": [1, 4, 8, 16, 18, 23, 24, 32, 33], "combin": [1, 5, 8, 13, 23, 25, 32], "studio": 1, "extens": [1, 3, 4, 5, 6], "featur": [1, 4, 7, 9, 12, 14, 18, 21, 26, 31, 33, 34, 35], "assist": 1, "edit": 1, "As": [1, 2, 4, 8, 9, 19, 20, 22, 23, 25, 30, 32], "distutil": 1, "ltc": 2, "lazi": [2, 13, 15, 17, 18, 21, 23, 25, 27, 32, 33], "tensor": [2, 4, 5, 8, 9, 10, 11, 12, 13, 14, 17, 19, 20, 21, 22, 24, 25, 27, 28, 30, 31, 33, 34, 36], "core": [2, 4, 5, 10, 11, 12, 13, 15, 16, 17, 18, 20, 21, 22, 24, 26, 27, 28, 29, 30, 31, 34], "clean": [2, 4, 18, 27], "exist": [2, 12, 13, 16, 18, 21, 27, 33], "stub": 2, "over": [2, 4, 8, 12, 13, 15, 16, 19, 20, 29, 34, 35], "6": [2, 3, 5, 8, 13, 18, 20, 23, 32, 34, 36], "were": [2, 15, 16, 18, 19, 20, 22, 23, 32, 36], "complet": [2, 13, 15, 16, 18], "process": [2, 4, 5, 6, 10, 11, 12, 13, 15, 18, 20, 21, 22, 26, 31], "found": [2, 12, 20, 36], "ref": [2, 3, 12], "oper": [2, 4, 8, 10, 11, 12, 13, 15, 16, 17, 19, 20, 21, 22, 25, 34, 35, 36], "xla_native_funct": [2, 5], "yaml": [2, 5], "replac": [2, 4, 8, 20, 28], "support": [2, 6, 7, 8, 9, 11, 12, 13, 14, 21, 23, 25, 27, 28, 29, 32, 33, 35, 36], "an": [2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 17, 18, 19, 20, 21, 23, 24, 25, 26, 27, 29, 30, 32, 33, 34, 35, 36], "equival": [2, 36], "full_codegen": 2, "NOT": 2, "introduc": [2, 7, 10, 12, 15, 18, 19, 22, 25, 26, 33], "ani": [2, 4, 7, 12, 13, 14, 15, 16, 18, 20, 21, 22, 23, 25, 26, 29, 30, 32, 33, 34, 35, 36], "purpos": [2, 5, 8, 15, 31], "info": [2, 4, 13, 18, 23, 32, 34, 36], "about": [2, 3, 11, 12, 13, 15, 16, 20, 21, 23, 32, 34], "dispatch": [2, 4, 5, 17, 35], "exyang": 2, "blog": [2, 25], "post": [2, 13, 18, 25], "follow": [2, 4, 5, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 26, 29, 30, 32, 33, 34], "instruct": [2, 4, 5, 17, 19, 20], "depend": [2, 3, 5, 14, 15, 16, 20, 23, 24, 25, 32, 34], "build": [2, 5, 11, 15, 16, 17, 20, 22, 29, 36], "It": [2, 3, 4, 5, 8, 10, 13, 14, 16, 17, 19, 20, 21, 22, 23, 27, 29, 30, 31, 32, 33, 34, 36], "experi": [2, 4, 5, 12, 15, 21, 26, 35, 36], "workstat": [2, 5], "cpu": [2, 5, 10, 13, 17, 18, 19, 20, 22, 23, 29, 31, 32, 33, 35, 36], "pjrt_devic": [2, 5, 6, 12, 14, 16, 18, 26, 28, 36], "re": [2, 12, 13, 15, 18, 22, 23, 24, 25, 28, 32], "familiar": [2, 11, 16, 21], "issu": [2, 5, 8, 12, 13, 15, 16, 18, 20, 22, 24, 26, 30], "3560": 2, "track": [2, 18, 35], "statu": [2, 18], "put": [2, 5, 16, 18, 26, 36], "alia": [2, 10, 13], "avoid": [2, 16, 18, 19, 20, 22, 24], "duplic": 2, "mention": [2, 5, 23, 27, 32], "below": [2, 5, 9, 10, 12, 16, 20, 23, 24, 32, 35], "live": [2, 5, 13, 23, 32], "folder": [2, 3, 4, 5], "except": [2, 5, 19, 21, 22, 33], "torch": [2, 3, 4, 7, 8, 11, 13, 14, 16, 17, 18, 20, 21, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 34, 35, 36], "shape_infer": 2, "shape": [2, 5, 7, 8, 9, 11, 13, 18, 19, 21, 25, 28, 33, 34, 36], "defin": [2, 4, 5, 7, 9, 13, 17, 20, 24, 28, 30, 33, 34, 36], "input": [2, 5, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19, 21, 24, 25, 28, 30, 33, 34, 35], "return": [2, 5, 6, 7, 8, 9, 10, 13, 15, 16, 18, 20, 23, 25, 26, 27, 28, 31, 32, 33, 35, 36], "output": [2, 3, 4, 7, 8, 9, 10, 12, 13, 16, 18, 24, 25, 26, 27, 28, 29, 33, 36], "manual": [2, 5, 7, 18, 29], "gen_lazy_tensor": 2, "data": [2, 10, 11, 12, 13, 15, 16, 17, 20, 21, 23, 24, 27, 32, 34, 35], "aten": [2, 4, 5, 9, 18, 23, 32], "specif": [2, 4, 8, 13, 15, 16, 17, 19, 20, 21, 22, 26, 31, 34], "run_gen_lazy_tensor": 2, "dest": 2, "lazy_ir": 2, "class": [2, 6, 8, 9, 10, 13, 16, 25, 26, 29, 31, 34, 35, 36], "genlazyir": 2, "back": [2, 5, 13, 16, 18, 20, 33], "todai": [2, 14], "most": [2, 6, 12, 13, 17, 18, 27], "categori": [2, 30], "goal": [2, 3, 5, 10, 36], "move": [2, 12, 13, 18, 23, 25, 26, 32, 35, 36], "necessari": [2, 13, 18, 20, 24], "call": [2, 4, 5, 9, 10, 12, 13, 14, 15, 16, 18, 20, 21, 22, 23, 24, 25, 27, 28, 29, 32, 33, 35, 36], "upstream": [2, 10, 14, 25], "api": [2, 5, 9, 12, 16, 21, 23, 26, 27, 29, 31, 32, 33, 35], "xlanativefunct": [2, 5], "column": 2, "declar": [2, 5], "anoth": [2, 14, 16, 18, 20, 23, 32, 36], "wrap": [2, 5, 6, 7, 13, 16, 19, 20, 22, 24, 25, 26, 29, 30, 31, 33], "around": [2, 12, 23, 29, 32, 34], "xlatensor": [2, 5, 13, 33], "construct": [2, 5, 16, 19, 29, 33, 35], "aten_xla_typ": [2, 5], "Will": 2, "method": [2, 9, 12, 13, 17, 24, 30, 33, 35], "map": [2, 5, 10, 13], "node": [2, 5, 10, 12, 13, 18, 23, 32], "remov": [2, 12, 18, 20], "tensor_method": [2, 5], "possibl": [2, 12, 16, 18, 21, 22, 29, 30, 33, 36], "multipl": [2, 10, 13, 15, 17, 19, 23, 26, 27, 31, 32, 34, 36], "few": [2, 16, 18, 20, 23, 26, 32, 35], "simpler": [2, 12], "go": [2, 16, 20, 24, 33], "unari": 2, "binari": [2, 4, 6, 21, 27, 36], "exampl": [2, 3, 4, 5, 6, 9, 10, 12, 13, 14, 15, 16, 18, 19, 21, 22, 23, 25, 26, 27, 30, 31, 32, 33, 34, 35, 36], "characterist": 2, "fallback": [2, 5], "_adaptive_avg_pool3d": 2, "condit": [2, 15, 16, 23, 28, 32], "issupportedadaptivepool": 2, "xlahelp": 2, "i64list": 2, "self": [2, 5, 6, 8, 9, 10, 13, 16, 20, 25, 26, 31, 33], "size": [2, 8, 10, 12, 14, 16, 18, 19, 20, 22, 23, 32, 34, 35, 36], "output_size_list": 2, "pool_dim": 2, "nativ": [2, 4, 5, 12, 15, 18, 24, 26, 33], "call_fallback_fn": 2, "xla_fallback": 2, "aten_op": 2, "output_s": 2, "wip": 2, "evolv": 2, "At": [2, 4, 6, 13, 21], "point": [2, 3, 4, 5, 6, 11, 13, 16, 17, 21, 22, 23, 24, 32], "self_tensor": 2, "static": [2, 14, 15, 23, 32], "bool": [2, 13], "sync_upd": 2, "sys_util": 2, "getenvbool": 2, "xla_tensor_update_sync": 2, "true": [2, 4, 8, 12, 13, 15, 17, 19, 20, 23, 26, 29, 32, 33, 35, 36], "xla_check": 2, "dst_tensor": 2, "updatefromtensor": 2, "sync": [2, 12, 13, 15, 16, 18, 19, 20, 21, 22, 24, 26], "complic": [2, 5, 7, 15], "would": [2, 3, 5, 12, 13, 16, 17, 18, 20, 23, 28, 32, 36], "someth": [2, 8, 20, 22], "ab": [2, 29], "const": [2, 5, 10], "torch_lazy_fn_count": 2, "bridg": [2, 21, 27], "atenfromxlatensor": 2, "getxlatensor": 2, "fail": [2, 4, 13, 16, 18, 35], "explain": [2, 6, 16, 18, 19, 20, 23, 25, 32], "later": [2, 19, 22, 25], "still": [2, 10, 12, 16, 17, 23, 24, 26, 32, 35], "If": [2, 3, 4, 5, 8, 9, 12, 13, 16, 17, 18, 19, 20, 21, 22, 23, 25, 31, 32, 33, 34, 36], "while": [2, 8, 9, 10, 11, 13, 15, 16, 17, 19, 21, 23, 26, 32], "error": [2, 9, 13, 16, 18], "involv": [2, 13, 17, 23, 32, 33], "problem": [2, 23, 32], "yet": [2, 5, 10], "attempt": [2, 35], "unblock": [2, 35], "snippet": [2, 4, 16, 33, 34], "auto": [2, 5, 13, 29, 35], "common_devic": 2, "getxladevic": 2, "torch_internal_assert": 2, "xlatensorptr": 2, "lazy_self": 2, "getxlatensororcreateforwrappednumb": 2, "nodeptr": 2, "reusenod": 2, "getirvalu": 2, "makenod": 2, "cachenod": 2, "creat": [2, 4, 9, 11, 12, 13, 18, 19, 20, 21, 24, 25, 26, 33, 34, 35, 36], "std": [2, 10, 26], "get": [2, 5, 12, 13, 14, 20, 21, 23, 26, 29, 31, 32], "check": [2, 3, 5, 9, 13, 16, 31], "reus": [2, 8, 16, 19, 20, 21, 25], "previou": [2, 4, 12, 16, 17, 20, 23, 32, 34, 36], "creation": [2, 13], "correspond": [2, 5, 10, 13, 19, 24, 29, 33, 34], "cach": [2, 7, 13, 14, 21, 25], "newli": 2, "And": [2, 23, 26, 32, 33], "within": [2, 13, 15, 16, 18, 22, 31, 34, 35], "note": [2, 3, 7, 10, 12, 13, 15, 16, 18, 19, 20, 22, 23, 27, 29, 30, 31, 32, 34], "done": [2, 3, 7, 16, 18, 19, 20, 22, 23, 32, 36], "public": [2, 12], "xlanod": 2, "xlavalu": 2, "opkind": [2, 5], "absoutputshap": 2, "num_output": [2, 23, 32], "mhash": 2, "string": [2, 10, 13, 33, 36], "tostr": 2, "overrid": [2, 13], "stringstream": 2, "ss": 2, "str": [2, 6, 9, 13, 36], "xlaopvector": 2, "loweringcontext": 2, "loctx": 2, "A": [2, 6, 11, 12, 13, 15, 16, 17, 19, 23, 24, 30, 31, 32, 33, 34], "coupl": [2, 16, 18], "thing": [2, 18, 22, 25], "keep": [2, 3, 12, 14, 18, 23, 32, 36], "mind": [2, 12, 18], "clone": [2, 12, 18, 20], "even": [2, 12, 13, 15, 16, 18, 23, 25, 26, 32, 36], "everi": [2, 5, 7, 8, 12, 13, 16, 18, 23, 25, 27, 32, 33, 35], "outputshap": 2, "xla_shap": 2, "overli": 2, "simplifi": 2, "buildxxxop": 2, "slightli": [2, 5, 13], "better": [2, 5, 12, 15, 16, 18, 20, 22, 23, 27, 28, 32], "maximumoutputshap": 2, "lower_for_shape_fn": 2, "absl": 2, "xlaop": [2, 5], "operand": 2, "promot": 2, "max": [2, 23, 32, 35], "second": [2, 8, 9, 14, 15, 18, 20, 26, 34], "inferoutputshap": 2, "comput": [2, 3, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 32, 33, 34], "logic": [2, 8, 13, 23, 28, 32, 33, 34], "two": [2, 4, 6, 12, 13, 16, 17, 18, 19, 20, 22, 23, 32, 33, 34, 36], "xla_input": 2, "getoutputop": 2, "returnop": 2, "buildab": 2, "origin": [2, 20], "genericop": 2, "modifi": [2, 16, 20, 24, 27, 33, 36], "abov": [2, 5, 6, 9, 13, 14, 16, 18, 19, 20, 22, 23, 26, 27, 32, 34], "delet": 2, "sometim": [2, 19, 21, 23, 32], "being": [2, 13, 16, 19, 26, 34, 36], "tensor_op": 2, "cross": [2, 13, 16, 33], "s1": [2, 33], "sub": 2, "mul": [2, 13, 23, 32, 36], "u2": 2, "v3": [2, 16, 26], "u3": 2, "v2": [2, 3, 16], "irnod": 2, "those": [2, 4, 5, 13, 18, 22, 26], "long": [2, 8, 15, 17, 18, 19, 20, 22, 23, 26, 32], "term": [2, 15, 18, 23, 32, 36], "rid": [2, 23, 32], "composit": [2, 5], "end": [2, 5, 12, 13, 14, 16, 18, 19, 20, 26, 29, 30], "exp": 2, "pow": 2, "norm_exp": 2, "vector": 2, "don": [2, 5, 12, 14, 16, 18, 23, 29, 32], "t": [2, 5, 12, 13, 14, 16, 17, 18, 23, 24, 29, 30, 32, 33, 34, 35], "build_cpp_test": 2, "skip": [2, 5, 18, 27], "desir": [2, 20, 34, 35], "test_ptxla": 2, "gtest_filt": 2, "atenxlatensortest": 2, "testab": 2, "correct": [2, 17, 23, 25, 32], "counter": [2, 5, 13, 18], "correctli": [2, 18, 30], "bitwise_left_shift": 2, "pull": [2, 24, 26, 29], "8865": 2, "erf": 2, "erfc": 2, "erfinv": 2, "3659": 2, "binary_cross_entropi": [2, 24], "backward": [2, 5, 8, 12, 15, 16, 24, 26, 27, 29, 30], "3809": 2, "scalar": [2, 5, 13, 18, 23, 32], "addcdiv": 2, "addcmul": 2, "3768": 2, "neg": 2, "index": [2, 3, 6, 7, 12, 13, 16, 18, 20, 34], "amin": 2, "amax": 2, "3771": 2, "special": [2, 9, 19, 33, 36], "partial": [2, 23, 29, 30, 32], "adaptive_avgpool3d": 2, "3790": 2, "guid": [3, 4, 7, 8, 11, 12, 16, 19, 21, 22, 29, 30, 33], "interact": [3, 11, 12], "start": [3, 4, 12, 16, 17, 18, 20, 22], "colab": [3, 18, 36], "kaggl": 3, "preinstal": [3, 12], "ecosystem": [3, 15, 21, 31], "packag": [3, 11, 16, 21, 24, 26, 36], "date": [3, 36], "list": [3, 4, 5, 8, 13, 20, 24, 25, 28, 33, 34], "readm": [3, 18, 20], "prerequisit": [3, 33], "remot": 3, "quota": 3, "request": [3, 4, 5, 13, 18, 20, 23, 24, 26, 32, 33, 34], "offici": [3, 4, 18], "ssh": [3, 12, 16, 20, 21], "regist": [3, 5, 6, 9, 10, 12, 35], "agent": 3, "alreadi": [3, 7, 13, 18, 22, 23, 26, 29, 32, 35], "befor": [3, 4, 7, 10, 12, 13, 16, 17, 18, 19, 22, 23, 24, 26, 27, 30, 32, 33, 35, 36], "begin": [3, 16, 17, 33, 36], "zone": [3, 12, 16, 20, 21], "tpu_typ": 3, "8": [3, 8, 9, 12, 13, 15, 16, 19, 20, 21, 22, 23, 26, 27, 31, 32, 33, 34], "vm": [3, 12, 16, 18, 20, 21, 26], "assum": [3, 6, 7, 13, 16, 17, 23, 26, 30, 32, 33, 34], "id_ed25519": 3, "type": [3, 4, 6, 9, 12, 13, 16, 17, 18, 21, 24, 26, 36], "ubuntu2204": 3, "base": [3, 10, 12, 13, 15, 16, 18, 20, 21, 23, 25, 29, 32, 33, 34, 36], "metadata": [3, 18], "cat": [3, 24], "pub": 3, "ip": [3, 12, 13, 35], "format": [3, 9, 13, 18, 21, 27, 31, 36], "valu": [3, 4, 5, 8, 12, 13, 14, 16, 18, 19, 20, 23, 25, 28, 32, 33, 36], "networkendpoint": 3, "accessconfig": 3, "externalip": 3, "123": 3, "give": [3, 18, 22, 31, 33, 34], "friendli": 3, "easier": [3, 20, 23, 32], "echo": 3, "host": [3, 12, 13, 16, 17, 18, 19, 20, 21, 22, 24, 29, 35], "n": [3, 13, 26, 31, 34], "hostnam": 3, "test": [3, 4, 6, 7, 12, 14, 25, 26, 29, 36], "vs": [3, 8, 11, 12, 23, 32], "palett": 3, "select": [3, 4, 12, 13, 35], "visualstudio": 3, "doc": [3, 7, 8, 12, 13, 16, 23, 32], "__": [3, 12], "just": [3, 7, 12, 16, 17, 23, 26, 29, 32, 35], "titl": [3, 12], "open": [3, 4, 5, 6, 12, 18, 21], "window": 3, "termin": [3, 35], "mkdir": 3, "ptxla": 3, "Then": [3, 4, 9, 20], "ui": 3, "venv": 3, "virtual": [3, 4, 13], "latest": [3, 7, 16], "releas": [3, 6, 7, 10, 12, 15, 16, 18, 21, 27, 29, 30, 31, 33], "pip": [3, 7, 11, 20], "numpi": [3, 7, 9, 13, 22, 34], "f": [3, 7, 9, 13, 16, 26, 29, 31, 35, 36], "googleapi": [3, 7, 21], "libtpu": [3, 6, 12, 36], "wheel": [3, 21, 29], "html": [3, 7, 12, 13, 29], "import": [3, 4, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 18, 19, 20, 24, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36], "set_device_typ": 3, "print": [3, 4, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 23, 25, 26, 27, 32, 33, 35, 36], "real_devic": 3, "run": [3, 4, 5, 7, 8, 12, 13, 14, 15, 17, 19, 21, 22, 23, 24, 25, 26, 27, 29, 31, 32, 34, 35, 36], "2": [3, 4, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 21, 22, 25, 27, 28, 29, 30, 31, 33, 34, 36], "3": [3, 5, 6, 7, 8, 9, 13, 15, 18, 19, 20, 27, 28, 29, 31, 33, 34, 36], "4": [3, 6, 7, 8, 9, 12, 13, 16, 18, 20, 23, 27, 28, 29, 31, 32, 33, 34, 36], "5": [3, 8, 10, 13, 14, 18, 20, 23, 25, 26, 29, 31, 32, 34], "7": [3, 13, 18, 26, 27, 34, 36], "number": [3, 4, 8, 12, 13, 14, 15, 18, 19, 20, 25, 29, 33, 34], "vari": [3, 12, 15, 23, 30, 32], "That": [3, 8, 23, 25, 32], "now": [3, 9, 10, 12, 16, 19, 20, 22, 23, 32, 33, 36], "realist": 3, "show": [4, 8, 9, 10, 12, 16, 18, 26, 36], "how": [4, 5, 7, 8, 9, 10, 13, 16, 17, 18, 20, 21, 22, 23, 24, 32, 33, 36], "contributor": 4, "xla": [4, 5, 8, 9, 10, 12, 14, 22, 23, 25, 26, 27, 28, 30, 32, 33, 35], "conda": 4, "forg": 4, "probabl": [4, 23, 32], "interest": [4, 26, 36], "o0": 4, "use_custom_debinfo": 4, "file1": 4, "file2": 4, "caus": [4, 5, 12, 13, 15, 16, 18, 22, 23, 32], "prevent": [4, 13, 15, 20, 27, 33], "perform": [4, 5, 7, 9, 10, 11, 13, 16, 19, 20, 21, 24, 25, 26, 27, 29, 31, 33, 36], "meaning": 4, "semicolon": 4, "let": [4, 7, 12, 15, 16, 18, 20, 22, 27], "suggest": [4, 18], "step": [4, 8, 12, 13, 15, 16, 17, 18, 20, 22, 23, 25, 26, 27, 29, 30, 32, 33, 35], "identifi": [4, 6, 13, 15, 16, 34, 35, 36], "similar": [4, 5, 12, 15, 20, 21, 22, 26, 28, 31], "src": [4, 35], "linear": [4, 12, 13, 16, 21, 24, 25, 26, 31], "breakpoint": 4, "session": 4, "discov": [4, 35], "addit": [4, 5, 6, 12, 16, 18, 19, 20, 22, 24, 26], "rebuild": 4, "newfil": 4, "readi": [4, 20], "howev": [4, 5, 7, 8, 9, 15, 18, 19, 20, 22, 33], "full": [4, 13, 16, 17, 18, 29, 36], "unfortun": 4, "touch": [4, 26, 35], "its": [4, 5, 10, 12, 14, 15, 16, 17, 18, 21, 25, 26, 27, 29, 33, 36], "timestamp": [4, 17], "reliabl": [4, 12], "rebuilt": 4, "wa": [4, 12, 13, 15, 18, 22, 23, 32, 35, 36], "use_rocm_kernel_assert": 4, "off": [4, 13, 19], "has_wmissing_prototyp": 4, "has_werror_missing_prototyp": 4, "util": [4, 7, 9, 11, 13, 15, 16, 18, 26, 29, 30, 31, 34, 35], "scalarop": 4, "emptytensor": 4, "shut": 4, "must": [4, 5, 6, 8, 10, 12, 13, 16, 17, 18, 25, 30, 35], "pack": [4, 36], "publish": 4, "microsoft": 4, "search": [4, 5], "ms": [4, 25], "cpptool": 4, "tab": 4, "sampl": [4, 9, 12, 13, 18], "ll": [4, 5, 8, 23, 32, 36], "adjust": [4, 16], "match": [4, 5, 9, 13, 15, 16, 18], "interpret": [4, 13, 23, 32, 36], "cppdbg": 4, "program": [4, 7, 8, 9, 13, 16, 18, 19, 23, 27, 32, 33, 34], "home": 4, "miniconda3": 4, "env": [4, 12, 13, 33], "torch310": 4, "bin": 4, "arg": [4, 9, 13, 16, 20, 28, 29], "cwd": 4, "workspacefold": 4, "externalconsol": 4, "fals": [4, 9, 10, 13, 16, 17, 29, 33, 36], "mimod": 4, "setupcommand": 4, "descript": 4, "pretti": [4, 16, 23, 26, 32], "text": [4, 18], "ignorefailur": 4, "disassembl": 4, "flavor": 4, "intel": 4, "prelaunchtask": 4, "activ": [4, 8, 13, 16, 18, 26, 29, 30, 31], "midebuggerpath": 4, "locat": [4, 13], "But": [4, 16, 18, 23, 32, 36], "quirk": 4, "switch": [4, 8, 15, 16, 18, 23, 26, 32], "between": [4, 10, 12, 14, 15, 16, 18, 19, 21, 22, 23, 24, 26, 28, 32, 33, 36], "vadimcn": 4, "id": [4, 12, 13, 18, 21, 34], "click": 4, "left": [4, 18], "red": 4, "dot": [4, 9, 18], "displai": [4, 22], "indic": [4, 8, 13, 18, 22, 23, 32, 34], "dropdown": 4, "right": [4, 15, 17, 23, 27, 32], "green": 4, "plai": 4, "button": 4, "rule": [4, 22, 24], "after": [4, 5, 8, 10, 12, 13, 15, 16, 17, 18, 20, 23, 28, 32, 33], "empti": [4, 13], "white": 4, "circl": 4, "load": [4, 12, 13, 18, 21, 26, 29, 31, 35], "librari": [4, 5, 6, 9, 20, 21, 22, 34, 35], "trigger": [4, 15, 18, 19, 20, 23, 25, 32], "einsum": [4, 25], "yellow": 4, "arrow": 4, "collect": [4, 12, 26, 27, 34, 35], "certain": [4, 10, 18, 23, 24, 32, 36], "diagnost": 4, "turn": [4, 18, 36], "cuda": [4, 13, 16, 17, 20, 23, 31, 32], "handl": [4, 6, 17, 18, 23, 29, 30, 32, 33, 34], "trace": [4, 8, 11, 12, 13, 15, 18, 19, 21, 22, 23, 24, 26, 27, 32, 33], "ld_library_path": 4, "cflag": 4, "dhas_torch_show_dispatch_trac": 4, "demonstr": [4, 8, 10, 15, 22, 24, 35, 36], "offer": [5, 9, 13, 15, 21, 30, 31], "implement": [5, 7, 8, 10, 11, 12, 15, 18, 23, 27, 29, 30, 32], "gpu": [5, 7, 14, 18, 20, 21, 36], "convert": [5, 9, 11, 13, 16, 21, 22, 25, 26, 36], "higher": [5, 8, 18, 35], "level": [5, 8, 13, 18, 21, 22, 27, 31, 35], "represent": [5, 8, 13, 16, 21, 36], "i": [5, 8, 9, 12, 13, 16, 23, 25, 29, 32, 33, 34, 36], "hlo": [5, 8, 13, 16, 18, 19, 21], "beyond": 5, "scope": 5, "forward": [5, 9, 15, 16, 24, 25, 26, 27, 30, 31], "haven": [5, 23, 32], "signific": [5, 15, 17, 18, 19, 20, 21, 22, 27], "slowdown": [5, 18, 26], "best": [5, 7, 15, 27, 31, 34], "what": [5, 16, 19, 20, 25], "debug": [5, 11, 15, 23, 31, 32, 34], "pt": [5, 12, 16, 18, 21], "profil": [5, 11, 12, 20, 21], "_ctc_loss": [5, 18], "_ctc_loss_backward": [5, 18], "contribut": [5, 36], "definit": [5, 16, 23, 32], "native_funct": 5, "kernel": [5, 8, 9, 11, 23, 31, 32], "aten_fallback": 5, "h": [5, 36], "repo": [5, 16, 18, 20, 26], "sequenc": [5, 8, 13], "explicitli": [5, 15, 16, 17, 18, 19, 23, 24, 32], "compos": 5, "serv": [5, 20], "interfac": [5, 6, 16, 18, 35], "machineri": [5, 9], "registerxla": 5, "registerautogradxla": 5, "entri": [5, 6], "pytorch_xla": 5, "world": [5, 7, 12, 23, 27, 32, 35], "written": [5, 20, 35], "paramet": [5, 9, 12, 13, 16, 18, 24, 25, 26, 30, 33, 35], "result": [5, 8, 10, 12, 13, 14, 16, 17, 18, 19, 20, 21, 26, 28, 33, 36], "wrapper": [5, 15, 16, 26, 29, 30], "inplac": [5, 13, 33], "ir": [5, 13, 18, 19, 21, 23, 25, 32], "insid": [5, 16, 19, 20, 22, 25, 33], "stand": 5, "intermedi": [5, 8, 12, 18, 19, 21, 36], "smaller": [5, 19, 20, 22, 23, 32], "inherit": 5, "dai": 5, "unless": [5, 18, 23, 32], "verifi": [5, 11, 13, 36], "test_oper": 5, "test_aten_xla_tensor": 5, "yield": [5, 16, 18, 36], "break": [5, 15, 19, 20, 23, 32, 36], "grasp": 5, "capabl": [5, 21], "minim": [5, 11, 21, 22], "pr": [5, 18, 29], "vanilla": 5, "lerp": 5, "variant": [5, 23, 24, 32], "lerp_": 5, "scalar_out": 5, "tensor_out": 5, "prototyp": [5, 33], "weight": [5, 13, 18, 30, 31], "lerp_out": 5, "namespac": [5, 18], "wrapper_scalar_lerp": 5, "No": [5, 12, 14, 23, 25, 31, 32], "deviceguard": 5, "omit": [5, 34], "anonym": 5, "wrapper_scalar_lerp_": 5, "wrapper_scalar_lerp__tmp": 5, "_copy_from": 5, "m": [5, 9, 10, 23, 29, 32, 34, 36], "impl": [5, 9, 10], "torch_fn": 5, "automat": [5, 6, 11, 12, 13, 16, 18, 19, 23, 29, 32, 34, 35], "explicit": [5, 17, 21, 24, 29], "place": [5, 10, 13, 20, 22, 24, 33, 35, 36], "interned_str": 5, "symbol": [5, 23, 32], "submit": [5, 17, 18, 19, 24], "team": [6, 27], "tf": [6, 18, 23, 32], "close": [6, 15], "expos": [6, 12, 16, 19, 33], "deviceplugin": 6, "short": [6, 18, 23, 32], "pjrtclient": 6, "mirror": 6, "pjrt_api": 6, "straightforward": [6, 13, 22], "detail": [6, 7, 8, 9, 10, 12, 13, 16, 18, 23, 32, 34], "concret": [6, 23, 32], "placehold": 6, "pjrt_library_path": 6, "extra": [6, 26, 30, 36], "multiprocess": [6, 12, 13, 16], "compon": [6, 36], "least": [6, 13, 22], "cpuplugin": 6, "def": [6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 20, 25, 26, 27, 28, 30, 31, 36], "library_path": 6, "os": [6, 12, 16, 26], "join": [6, 13], "dirnam": 6, "__file__": 6, "pjrt_c_api_cpu_plugin": 6, "exmapl": 6, "pyproject": 6, "toml": 6, "torch_xla_cpu_plugin": 6, "With": [6, 7, 12, 14, 23, 27, 32], "initi": [6, 10, 12, 13, 16, 17, 20, 26, 28, 35], "experiment": [6, 7, 8, 11, 12, 14, 15, 25, 26, 27, 28, 30, 31, 33, 35], "state": [6, 8, 13, 17, 29], "becom": [6, 7, 8, 12, 15, 16, 18, 20, 23, 32], "stabl": [6, 12, 21, 22, 29], "rise": 7, "openai": 7, "triton": 7, "popular": 7, "commun": [7, 10, 12, 13, 16, 19, 20, 22, 27, 34], "instanc": [7, 10, 13, 29, 35], "order": [7, 8, 13, 16, 17, 18, 20, 22, 33, 34], "pariti": 7, "continu": [7, 12, 21, 27], "push": 7, "custom_kernel": 7, "jax_import_guard": 7, "pl": [7, 12, 16, 33], "jnp": [7, 9], "add_vectors_kernel": 7, "x_ref": 7, "y_ref": 7, "o_ref": 7, "x": [7, 8, 9, 13, 16, 18, 19, 23, 25, 26, 28, 29, 30, 31, 32, 33, 34, 36], "y": [7, 8, 9, 13, 18, 19, 21, 23, 25, 29, 30, 31, 32, 33, 34, 36], "jit": [7, 9, 16, 27], "add_vector": 7, "arrai": [7, 9, 13, 22, 30, 34], "pallas_cal": 7, "out_shap": 7, "shapedtypestruct": 7, "dtype": [7, 9, 12, 23, 24, 25, 31, 32, 36], "otherwis": [7, 13, 18, 19, 21, 22, 23, 30, 32], "hang": 7, "lock": 7, "q": [7, 9], "randn": [7, 9, 12, 13, 15, 16, 25, 26, 27, 31, 33, 34], "128": [7, 8, 9, 12, 29, 31], "k": [7, 9, 18], "v": [7, 9, 25], "make_kernel_from_palla": 7, "pt_kernel": 7, "lambda": [7, 25, 29], "liner": 7, "flash": [7, 8], "attent": [7, 8, 9], "besid": 7, "op": [7, 8, 9, 11, 13, 15, 17, 18, 19, 23, 24, 32, 33, 34], "suppor": 7, "flash_attent": [7, 25], "paged_attent": 7, "queri": [7, 12], "squeez": 7, "dim": [7, 8, 13], "key_cach": 7, "value_cach": 7, "context_len": 7, "block_tabl": 7, "pages_per_compute_block": 7, "megacore_mod": 7, "none": [7, 9, 10, 13, 18, 30, 33, 34], "vllm": 7, "effect": [7, 13, 25, 36], "memori": [7, 11, 13, 14, 18, 21, 22, 23, 29, 32], "kv": 7, "proper": [7, 34], "jax_nightly_releas": 7, "jaxlib_nightly_releas": 7, "authorit": 7, "dev": [7, 21, 26], "en": [7, 29], "consid": [8, 12, 16, 17, 19, 20], "mani": [8, 12, 13, 18, 20, 21, 22, 23, 25, 32, 36], "homogen": 8, "llm": [8, 20], "drop": [8, 14, 18], "loop": [8, 15, 16, 18, 19, 20, 21, 22, 23, 25, 30, 32, 35], "bunch": [8, 9], "decod": [8, 15, 25], "subsequ": [8, 17, 20, 21], "significantli": [8, 12, 15, 16, 20, 21], "reduc": [8, 10, 12, 13, 14, 16, 17, 18, 19, 20, 22, 29], "hand": [8, 16], "lower": [8, 9, 11, 15, 18, 21, 23, 24, 32], "lax": 8, "Its": [8, 13, 15], "primari": [8, 21], "hood": 8, "itself": [8, 13, 21, 29], "typic": [8, 13, 17, 21], "transform": [8, 17, 20, 29, 34], "run_decoder_lay": 8, "hidden_st": 8, "decoder_lay": 8, "unrol": 8, "flat": [8, 34], "shown": [8, 12, 15, 23, 32], "decoder_with_scan": 8, "root": [8, 13, 23, 32, 36], "python3": [8, 12, 14, 16, 18, 20, 25, 29], "train_decoder_only_bas": [8, 15, 18], "decoderwithscan": 8, "appli": [8, 10, 13, 16, 17, 24, 29, 30, 35], "dimens": [8, 13, 14, 33, 34], "carri": [8, 23, 32, 33], "along": [8, 13, 17, 29, 34], "fn": [8, 13], "callabl": [8, 13, 29], "tupl": [8, 9, 13, 23, 28, 30, 32, 34], "init": [8, 12, 16, 26, 27, 28], "xs": [8, 13, 30, 33, 34], "roughli": [8, 36], "equal": [8, 34, 36], "ys": 8, "len": [8, 13, 19], "append": [8, 18], "scan_exampl": 8, "scan_example_cumsum": 8, "cumul": [8, 17, 28], "sum": [8, 10, 13, 29, 30], "scan_example_pytre": 8, "pytre": 8, "final": [8, 17, 26, 33, 36], "histori": 8, "15": [8, 20, 36], "count": [8, 13, 18], "mean": [8, 12, 13, 14, 15, 16, 17, 18, 19, 22, 23, 26, 30, 32, 33], "0000": 8, "5000": 8, "figur": [8, 10, 14, 34], "repe": 8, "bound": 8, "compar": [8, 12, 16, 18, 26, 27, 28], "overhead": [8, 12, 15, 17, 25, 26, 27], "especi": [8, 12, 13, 15, 20, 21, 27, 33], "finish": [8, 13, 17, 22], "9m35": 8, "4m59": 8, "hidden": 8, "num": 8, "head": 8, "512": [8, 34], "500": 8, "metric": [8, 13, 26], "is_fn_pur": 8, "is_layer_pur": 8, "final_carri": 8, "init_scan": 8, "xs_scan": 8, "input_data": 8, "traceabl": [8, 10], "particular": [8, 20, 22], "palla": [8, 11], "incompat": 8, "save": [8, 13, 18, 21, 25, 29, 35], "chip": [8, 12, 15], "256": [8, 12], "50": [8, 18, 20, 28], "2048": [8, 12], "compiletim": [8, 18], "totalsampl": [8, 18], "accumul": [8, 13, 21], "02m57s694ms418": 8, "595u": 8, "valuer": [8, 18], "02s112ms586": 8, "097u": 8, "rate": [8, 18, 26], "054285": 8, "percentil": [8, 18], "023ms113": 8, "470u": 8, "10": [8, 12, 13, 16, 18, 20, 23, 25, 26, 27, 28, 31, 32, 35, 36], "20": [8, 14, 16, 18, 26, 31, 36], "54s644ms733": 8, "284u": 8, "80": [8, 18], "01m03s028ms571": 8, "841u": 8, "90": [8, 18], "95": [8, 18], "99": [8, 18, 26], "29s996ms941": 8, "409u": 8, "02s529ms591": 8, "388u": 8, "158152": 8, "018ms636": 8, "571u": 8, "11s983ms003": 8, "171u": 8, "18s995ms301": 8, "667u": 8, "maximum": [8, 13, 14, 22, 31], "1m03": 8, "19": [8, 26, 27, 36], "7253": 8, "comment": [8, 23, 32], "accomplish": 9, "exportedprogram": 9, "fx": [9, 27], "exported_program_to_stablehlo": 9, "mlir": 9, "torchvis": [9, 15, 27], "torchax": 9, "tx": 9, "resnet18": [9, 15, 27], "sample_input": 9, "224": [9, 15], "mlir_modul": 9, "store": [9, 13, 18], "feel": [9, 18, 26], "explor": [9, 21], "org": [9, 12, 13, 29], "tutori": [9, 13, 18, 20, 26, 33, 36], "jfunc": 9, "shapeddtypestruct": 9, "float32": [9, 24, 36], "last": [9, 18, 34, 36], "constant": [9, 18, 19, 33], "convent": 9, "ed": 9, "appear": [9, 16, 18, 22], "paramt": 9, "jfunc_inlin": 9, "scaled_dot_product_attent": 9, "decompos": 9, "low": [9, 14, 18, 36], "dure": [9, 13, 17, 18, 19, 22, 27, 29, 33], "captur": [9, 13, 15, 17, 18, 19, 20, 22], "downstream": [9, 24], "ml": [9, 34, 36], "crucial": [9, 15, 17], "geneart": 9, "pattern": [9, 18, 23, 27, 32], "challeng": 9, "prone": 9, "robust": 9, "outlin": [9, 31], "pratic": 9, "scaled_product_attent": 9, "centric": 9, "unittest": 9, "nn": [9, 12, 13, 16, 26, 27, 29, 31, 33], "impl_abstract": 9, "jaten": 9, "jlibrari": 9, "mylib": 9, "basic": [9, 15, 16, 23, 26, 32], "sdpa": 9, "compositeexplicitautograd": 9, "_mylib_scaled_dot_product_attent": 9, "product": [9, 13, 36], "transpos": [9, 23, 32], "dropout_p": 9, "is_caus": 9, "_mylib_scaled_dot_product_attention_meta": 9, "empty_lik": 9, "decomposit": 9, "register_torch_composit": 9, "softmax": 9, "register_jax_composit": 9, "_aten_softmax": 9, "_softmax": 9, "static_argnum": 9, "librarytest": 9, "testcas": 9, "manual_se": [9, 12, 13], "default_env": 9, "use_torch_native_for_cpu_tensor": 9, "test_basic_sdpa_librari": 9, "customopexampl": 9, "rand": [9, 23, 32, 36], "32": [9, 13, 18, 21, 22, 34], "64": [9, 15, 27, 29], "module_str": 9, "todo": 9, "produc": [9, 17, 23, 24, 26, 32], "assertin": 9, "__name__": [9, 12, 16, 26], "__main__": [9, 12, 16, 26], "emit": 9, "repres": [9, 12, 13, 23, 32, 36], "region": [9, 13, 18, 24, 33], "th": [9, 34], "xla_model": [10, 11, 12, 16, 17, 18, 20, 24, 26, 27, 28, 29, 30, 31, 34], "adopt": [10, 23, 32], "reimplement": [10, 12], "_c10d_function": 10, "all_reduc": [10, 13], "processgroupxla": 10, "deriv": 10, "processgroup": 10, "xla_backend": [10, 12, 26, 35], "_create_xla_process_group": 10, "prefix_stor": 10, "rank": [10, 12, 13, 26, 29, 34, 35], "timeout": 10, "assert": [10, 26, 36], "xr": [10, 12, 13, 16, 26, 29, 30, 33, 34, 35], "is_spmd": [10, 13], "spmd": [10, 11, 16, 19, 25, 35], "group": [10, 12, 13, 26, 33], "_register_xla_backend": 10, "dist": [10, 12, 26, 35], "register_backend": 10, "allreduc": 10, "all_reduce_opt": 10, "allgath": 10, "output_tensors_list": 10, "input_tensor": 10, "opt": [10, 16], "_mp_fn": [10, 12, 16], "init_process_group": [10, 12, 26, 35], "init_method": [10, 12, 35], "progress": [10, 20], "blob": [10, 12, 13], "distributed_c10d": 10, "_exception_logg": 10, "all_gath": [10, 12, 13], "tensor_list": 10, "async_op": 10, "_get_default_group": 10, "remap": 10, "_functional_collect": 10, "all_reduce_inplac": 10, "eventu": 10, "reach": [10, 13, 36], "rewrit": [10, 22, 23, 32, 33], "reduceop": 10, "group_nam": 10, "torch_library_impl": 10, "four": [10, 19], "align": [10, 15], "signatur": 10, "remain": [10, 16, 20, 23, 32], "restrict": 10, "usag": [10, 13, 15, 18, 22, 23, 29, 30, 32, 35], "test_collective_ops_tpu": 10, "scenario": [10, 17, 21, 27], "reduct": [10, 13], "aggreg": 10, "all_gather_into_tensor": 10, "gather": [10, 13, 18, 33], "reduce_scatter_tensor": 10, "across": [10, 11, 12, 13, 15, 16, 18, 29, 30, 34], "all_to_all_singl": 10, "output_split_s": 10, "input_split_s": 10, "although": [10, 12, 23, 32, 36], "accept": [10, 33], "argument": [10, 13, 17, 20, 24, 25, 27, 29], "1s": 10, "limit": [10, 12, 13, 16], "reflect": [10, 17, 34], "compromis": 10, "maintain": [10, 11, 36], "constraint": [10, 12, 18], "alltoal": [10, 13], "high": [11, 13, 14, 21, 26, 31, 36], "job": [11, 13, 19, 27], "thousand": [11, 12], "mfu": 11, "hardwar": [11, 13, 15, 18, 20, 24], "__version__": [11, 18], "overview": 11, "analysi": [11, 20, 27], "topic": [11, 21, 34], "control": [11, 13, 14, 16, 18, 33], "mxu": 11, "float": [11, 13, 23, 24, 32], "precis": [11, 13], "checkpoint": [11, 12, 19, 21, 29, 34], "ddp": [11, 12], "shard": [11, 13, 35], "fsdp": [11, 13, 33, 34], "One": [11, 13, 14, 16, 19], "stablehlo": [11, 13], "mix": [11, 13, 34], "torchdynamo": 11, "quantiz": 11, "repeat": [11, 21], "layer": [11, 14, 15, 25, 29, 30, 33], "scan": 11, "scan_lay": 11, "while_loop": 11, "assume_pur": 11, "eager": [11, 13, 17, 23, 26, 31, 32], "mode": [11, 13, 17, 23, 26, 31, 32, 33, 35, 36], "recompil": [11, 14, 15, 16, 18, 19], "bazel": 11, "plugin": [11, 12, 21], "encount": [12, 16, 18], "bug": [12, 18, 26], "tag": [12, 13], "r2": [12, 18, 33], "renam": 12, "torchrun": [12, 16], "xpu": 12, "neuron": [12, 16], "xrt_tpu_config": 12, "impact": [12, 13, 15, 18, 23, 26, 32, 36], "30": [12, 29], "preview": 12, "thread": [12, 13, 16, 18, 35], "safe": 12, "section": [12, 16, 18, 20, 22, 33, 34], "broadcast": 12, "replica": [12, 13], "broadcast_master_param": 12, "random": [12, 13, 15, 19, 25, 31, 36], "global": [12, 13, 16, 25, 33, 35], "rng": [12, 13], "pjrt_backend": 12, "v4": [12, 13, 15, 16, 19, 20, 21, 22, 27, 33], "distributeddataparallel": 12, "parallel_load": [12, 13, 16, 18], "global_ordin": [12, 13, 16, 26, 29], "world_siz": [12, 13, 26, 29, 33], "42": [12, 25], "gradient_as_bucket_view": [12, 26], "loss_fn": [12, 15, 16, 24, 26, 27], "mseloss": [12, 26], "sgd": [12, 16, 24, 26, 27], "lr": [12, 16, 26, 27, 29, 30], "001": [12, 26], "zero_grad": [12, 15, 16, 24, 26], "loss": [12, 15, 16, 24, 27, 29, 30, 36], "confirm": 12, "p": [12, 18, 23, 32, 36], "localservic": 12, "localhost": 12, "51011": 12, "master_addr": 12, "master_port": 12, "12355": 12, "Or": [12, 16, 23, 32], "grpc": 12, "torchbench": 12, "observ": [12, 15, 26], "35": [12, 18], "copi": [12, 13, 16, 18, 20], "worker": [12, 13, 16, 20, 21, 29, 30, 35], "tpuvm": [12, 16, 21, 33], "learn": [12, 15, 21, 34, 36], "mnist": [12, 16, 18, 24], "test_train_mp_mnist": [12, 26], "fake_data": [12, 18, 26], "alpha": [12, 16], "central2": [12, 21], "b": [12, 13, 17, 21, 23, 24, 25, 27, 32, 34], "resnet50": [12, 15, 16, 27, 29], "git": [12, 18, 20, 29], "depth": [12, 18], "branch": [12, 18, 23, 32], "test_train_mp_imagenet": [12, 18, 26], "batch_siz": [12, 29], "num_epoch": [12, 26, 29], "By": [12, 13, 20, 23, 32, 36], "tpu_process_bound": 12, "tpu_visible_chip": 12, "r1": 12, "13": [12, 16, 26, 28], "docker_imag": 12, "gcr": 12, "io": [12, 29], "privat": 12, "sudo": [12, 21], "rm": 12, "privileg": 12, "net": [12, 22, 24], "mostli": [12, 29], "interchang": 12, "perspect": [12, 16], "subtl": 12, "importantli": [12, 25], "architectur": [12, 29], "spawn": [12, 13, 16, 20], "server": [12, 13, 22], "thu": [12, 15, 17, 18], "batch": [12, 16, 18, 19, 20, 22, 33], "latenc": 12, "serial": [12, 16], "deseri": 12, "send": [12, 16, 19, 20, 33], "constrain": [12, 13], "direct": [12, 17, 18], "independ": [12, 15, 16, 18], "plan": 12, "xla_dist": 12, "scp": [12, 16], "sdk": 12, "enhanc": [12, 15], "stabil": [12, 18, 24], "xmp": [12, 16, 20], "ident": 12, "substanti": 12, "mesh": [12, 13, 30], "master": [12, 13, 16, 35], "connect": [12, 13, 33], "practic": [12, 15, 23, 30, 32, 34], "unreli": 12, "due": [12, 15, 18, 19, 22, 36], "inbound": 12, "could": [12, 19, 23, 32, 33, 36], "failur": 12, "forc": [12, 13, 18, 23, 28, 32], "entir": [12, 29], "restart": 12, "much": [12, 16, 19, 20, 22, 23, 25, 27, 32], "impos": 12, "payload": [12, 13], "transfer": [12, 13, 17, 18, 22, 33], "middl": [12, 22, 23, 32], "unwant": 12, "permit": 12, "subset": [12, 34], "particip": [12, 13], "old": 12, "alter": 12, "synchron": [12, 15, 16, 21, 33, 35], "barrier": [12, 13, 16, 17, 20], "all_gather_object": 12, "gloo": [12, 26, 35], "new_group": 12, "subgroup": 12, "monitor": 12, "context": [12, 13, 15, 18, 23, 24, 32], "altern": [12, 21, 23, 24, 31, 32], "less": [12, 23, 27, 32, 36], "than": [12, 18, 23, 26, 29, 32, 36], "perf": [12, 23, 32], "md": [12, 13], "strongli": 12, "_all_gath": 12, "int": [12, 13, 23, 25, 32, 33, 36], "int32": 12, "zeros_lik": 12, "_": [12, 17, 27, 28], "get_world_s": 12, "pjrt_distribut": 12, "averag": 12, "task": [12, 15], "175": 12, "chart": 12, "breakdown": 12, "tfrt": 12, "legaci": 12, "streamexecutor": 12, "tpu_legaci": 12, "happen": [12, 13, 15, 16, 18, 19, 20, 22, 23, 32], "comparison": [12, 34], "given": [13, 18, 19, 23, 25, 26, 29, 32, 34, 36], "device_count": [13, 33], "address": [13, 15, 33], "wait": [13, 17, 18, 22], "reset_scop": 13, "pend": [13, 17], "whether": [13, 16, 24], "block": [13, 17, 29, 33], "reset": 13, "scopecontext": 13, "full_graph": [13, 15], "max_different_graph": 13, "lazytensor": [13, 19, 21], "decid": [13, 18, 23, 25, 32], "funciton": 13, "act": [13, 16, 21], "throw": [13, 16], "exit": [13, 18, 24, 26], "pt_xla_debug": 13, "messag": [13, 16, 18], "dump": [13, 18], "allow": [13, 16, 18, 20, 21, 22, 24, 33, 34, 35, 36], "rais": [13, 18, 36], "exceed": 13, "foo": 13, "sin": [13, 25], "co": 13, "foo2": 13, "compiled_foo2": 13, "seed": 13, "integ": [13, 18, 34], "subpackag": 13, "mp": 13, "etc": [13, 18, 23, 32, 33], "set_mat_mul_precis": [13, 36], "liter": 13, "highest": [13, 35, 36], "mat": [13, 36], "conv": 13, "32bit": 13, "matrix": [13, 16, 17, 36], "convolut": 13, "trade": [13, 19, 23, 32], "accuraci": [13, 26, 29, 36], "fastest": 13, "downcast": 13, "fp32": 13, "bf16": [13, 36], "multipli": [13, 16, 34, 36], "three": [13, 16, 36], "approxim": 13, "14": 13, "slowest": 13, "six": [13, 36], "22": [13, 26], "precision_tutori": 13, "empir": [13, 36], "behav": [13, 18, 36], "get_mat_mul_precis": 13, "device_typ": 13, "local_process_count": 13, "local_device_count": 13, "total": [13, 17, 23, 32, 34, 36], "addressable_device_count": 13, "visibl": [13, 23, 32], "global_device_count": 13, "global_runtime_device_count": [13, 30, 33, 34], "ordin": [13, 16], "guarante": [13, 17, 25], "predict": 13, "relationship": [13, 16, 18], "nor": 13, "contigu": [13, 16, 18], "local_ordin": 13, "get_master_ip": 13, "retriev": [13, 16, 23, 27, 32, 33, 34, 36], "discoveri": 13, "use_spmd": [13, 33, 34, 35], "non": [13, 15, 23, 24, 25, 32, 34], "replic": [13, 33, 34], "spmd_advanc": 13, "initialize_cach": [13, 16], "readonli": [13, 16], "persist": [13, 16, 35], "xla_devic": 13, "devkind": 13, "deprec": 13, "xla_device_hw": 13, "union": 13, "real": [13, 27], "is_master_ordin": 13, "multi": [13, 14, 26, 33], "num_host": 13, "boolean": 13, "reduce_typ": 13, "pin_layout": 13, "xm": [13, 16, 18, 20, 24, 26, 27, 28, 29, 30, 31, 34], "reduce_sum": 13, "reduce_mul": 13, "reduce_and": 13, "reduce_or": 13, "reduce_min": 13, "reduce_max": 13, "layout": [13, 21, 31, 34], "pine": 13, "potenti": [13, 16, 18], "corrupt": 13, "unpin": 13, "hlomodul": 13, "hold": [13, 33], "channel_id": 13, "use_global_device_id": 13, "channel": [13, 31], "replicagroup": 13, "all_to_al": 13, "split_dimens": 13, "concat_dimens": 13, "split_count": 13, "www": 13, "operation_semant": 13, "upon": 13, "split": [13, 34], "concat": 13, "add_step_closur": 13, "closur": 13, "run_async": 13, "report": 13, "consol": 13, "tensorboard": [13, 22], "intermediari": 13, "inspect": [13, 36], "materi": [13, 17, 18, 19, 23, 32, 33], "queu": 13, "though": [13, 16, 26], "advis": 13, "throttl": 13, "event": 13, "asynchron": [13, 17, 33, 35], "wait_device_op": 13, "async": [13, 27], "whose": [13, 14, 34], "optimizer_step": [13, 16, 17, 19, 24, 26, 29], "optimizer_arg": 13, "dict": [13, 25, 29], "gradid": 13, "parallelload": [13, 33], "dataparallel": 13, "loader": [13, 17, 18, 20, 27], "dictionari": 13, "gradient": [13, 16, 17, 24, 29, 35], "file_or_path": 13, "textio": 13, "master_onli": [13, 29], "global_mast": 13, "care": [13, 16, 18, 23, 32], "taken": [13, 16, 17, 18, 23, 26, 32, 35], "view": [13, 16, 18], "recreat": [13, 16], "destin": [13, 16], "nest": [13, 29], "obj_to_sav": 13, "path_to_sav": 13, "rendezv": 13, "byte": 13, "xla_rendezv": 13, "sent": [13, 17, 18], "exchang": 13, "posit": 13, "mesh_reduc": 13, "reduce_fn": 13, "toxlatensorarena": 13, "receiv": 13, "np": [13, 30, 34], "test_accuraci": 13, "set_rng_stat": 13, "get_rng_stat": 13, "get_memory_info": 13, "memoryinfo": 13, "bytes_us": 13, "290816": 13, "bytes_limit": 13, "34088157184": 13, "peak_bytes_us": 13, "500816": 13, "get_stablehlo": 13, "var": [13, 33], "xla_hlo_debug": [13, 18], "get_stablehlo_bytecod": 13, "bytecod": [13, 27], "mpdeviceload": [13, 16, 19, 20, 33], "kwarg": [13, 29, 33], "dataload": [13, 15, 16, 26, 33, 35], "background": [13, 35], "upload": [13, 22, 33], "per_device_load": [13, 33], "constructor": 13, "train_device_load": 13, "train_load": [13, 16, 33], "xla_multiprocess": 13, "nproc": 13, "daemon": 13, "start_method": 13, "moment": 13, "valueerror": [13, 36], "mark_shard": [13, 25, 30, 33, 34], "xlashardedtensor": [13, 35], "partition_spec": [13, 33, 34], "nonetyp": 13, "annot": [13, 33], "partit": [13, 33], "spec": [13, 33], "intern": [13, 15, 16, 17, 18, 23, 32, 33, 36], "spmdpartition": [13, 33], "topolog": [13, 16, 33], "partitionspec": 13, "ax": [13, 33, 34], "element": [13, 23, 30, 32, 33, 34, 36], "axi": [13, 30, 34], "mesh_shap": [13, 30, 33, 34], "num_devic": [13, 30, 33, 34], "device_id": [13, 30, 33, 34], "clear_shard": 13, "clear": [13, 15], "cast": [13, 24], "t1": [13, 16, 18, 34], "get_1d_mesh": 13, "set_global_mesh": 13, "get_global_mesh": 13, "axis_nam": [13, 33], "ndarrai": 13, "flatten": 13, "reshap": 13, "fill": 13, "row": [13, 34], "major": [13, 21, 34], "global_runtime_device_attribut": [13, 34], "length": [13, 23, 32], "get_xla_supported_devic": 13, "get_logical_mesh": [13, 34], "ordereddict": [13, 33, 34], "hybridmesh": [13, 33], "ici_mesh_shap": [13, 33], "dcn_mesh_shap": [13, 33], "hybrid": 13, "ici": 13, "dcn": [13, 33], "increas": [13, 25], "intens": 13, "mdl": 13, "inner": [13, 29, 33], "outer": [13, 29, 30, 33], "slice": [13, 19, 20, 33, 34], "eager_mod": [13, 15], "d": [13, 23, 24, 32], "eagerli": [13, 15, 16, 18, 23, 32], "metrics_report": [13, 18], "short_metrics_report": [13, 18], "counter_nam": 13, "metric_nam": 13, "counter_valu": 13, "metric_data": 13, "total_sampl": 13, "retain": 13, "circular": 13, "buffer": [13, 25], "in_tensor": 14, "randint": [14, 31], "out_tensor": 14, "nonzero": [14, 18, 20, 22, 23, 32, 36], "word": [14, 23, 25, 32], "25": 14, "further": [14, 19, 20, 22, 26], "categor": 14, "unbound": 14, "alloc": [14, 34], "infinit": [14, 30, 36], "phase": [14, 15], "perceptron": 14, "mlp": 14, "xla_experiment": 14, "masked_select": 14, "masked_scatt": 14, "your_script": [14, 20], "100": [14, 18, 25, 29], "29": [14, 26, 27], "49": [14, 27], "03": 14, "102": 14, "hit": [14, 23, 32], "198": 14, "1953": 14, "motiv": 14, "excess": 14, "half": [14, 36], "try": [14, 18, 20, 22, 23, 32], "ds": 14, "test_dynamic_shape_model": 14, "testdynamicshapemodel": 14, "test_backward_pass_with_dynamic_input": 14, "deep": [15, 18], "record": [15, 16, 17, 18, 21, 25], "defer": [15, 16, 17], "approach": [15, 16, 17, 23, 26, 29, 32, 36], "usabl": 15, "ambigu": 15, "struggl": 15, "distinguish": 15, "whenev": 15, "preprocess": [15, 31], "expens": [15, 18, 23, 32], "difficulti": 15, "opaqu": [15, 16, 18], "natur": 15, "shift": 15, "priorit": 15, "preserv": [15, 16, 18], "immedi": [15, 16, 17, 21, 33], "flexibl": [15, 31], "decor": [15, 25], "mark": 15, "boundari": 15, "feedback": 15, "outsid": [15, 16], "leak": 15, "catch": [15, 16], "accident": 15, "compiled_model": 15, "awai": [15, 17], "summar": [15, 24], "temporarili": 15, "resum": [15, 29], "abstract": [15, 31, 33], "balanc": 15, "distinct": [15, 17], "workflow": [15, 16, 21], "advantag": [15, 16, 20, 21], "enclos": 15, "step_fn": 15, "logit": [15, 30], "aim": [15, 21, 23, 32], "quantifi": 15, "conduct": 15, "llama2": 15, "fake": [15, 35], "300": [15, 18], "measur": [15, 22], "clearli": 15, "illustr": [15, 19, 20, 22], "147": 15, "65": [15, 18], "tradit": [15, 27], "45": 15, "li": 15, "throughput": 15, "regular": [16, 18, 31], "t0": 16, "mm": [16, 24, 36], "neural": [16, 36], "l_in": 16, "l_out": 16, "floattensor": 16, "highlight": [16, 19], "nllloss": 16, "momentum": 16, "acquir": 16, "distribut": [16, 18, 21, 25, 29, 30, 33, 34], "mp_device_load": 16, "multithread": [16, 18], "assign": [16, 17, 20], "own": [16, 29], "onto": [16, 19], "preload": [16, 19], "overlap": [16, 22, 27, 33], "batches_per_execut": 16, "consolid": [16, 29], "all_reduce_gradi": 16, "parent": 16, "talk": 16, "howto": 16, "focu": [16, 21, 23, 32], "train_mnist_xla": 16, "16": [16, 21, 29, 31, 34], "infrastructur": 16, "awar": 16, "regard": [16, 27], "fakedata": 16, "fuse": [16, 19], "invis": 16, "caller": 16, "insert": [16, 22], "paper": 16, "unlik": [16, 19], "appreci": 16, "accommod": 16, "previous": 16, "state_dict": [16, 29, 35], "footprint": 16, "xser": 16, "stream": 16, "amount": [16, 18, 19, 23, 32], "restor": 16, "load_state_dict": [16, 35], "unavail": [16, 18], "aw": 16, "occur": [16, 36], "evalu": [16, 18, 19, 20, 21, 23, 25, 32], "fix": [16, 18, 19, 22, 25, 27, 30], "incorrectli": 16, "solut": [16, 18, 23, 31, 32, 36], "feed": 16, "testmodel": 16, "__init__": [16, 25, 26, 31], "super": [16, 25, 26], "pre": 16, "determin": 16, "warn": [16, 18, 36], "pt_xla_debug_level": [16, 18], "_set_allow_execut": 16, "earli": [16, 23, 32], "relat": [16, 20], "troubleshoot": 16, "consum": [16, 23, 32], "doesn": [16, 17, 18, 23, 30, 32], "disk": 16, "your_cache_path": 16, "mount": 16, "mp_fn": 16, "tmp": [16, 18, 29], "xla_cache_": 16, "runnabl": [16, 26, 30], "essenti": [17, 36], "emploi": 17, "primarili": 17, "side": [17, 23, 25, 32], "period": [17, 22], "spend": [17, 19], "durat": [17, 22, 35], "conceptu": [17, 34, 36], "start_tim": 17, "perf_count": 17, "matmul": [17, 24, 36], "incorrect": 17, "end_tim": 17, "elapsed_tim": 17, "predominantli": 17, "took": 17, "actual": [17, 20, 21, 23, 26, 32, 33], "devid": 17, "exemplifi": 17, "warm": 17, "translat": [17, 18], "isol": 17, "steadi": 17, "benchmark": 17, "isn": [17, 23, 32, 35], "exclud": 17, "sever": 17, "item": [17, 18, 20, 22, 36], "condition": 17, "often": [17, 18, 21, 23, 25, 32], "unlazi": 17, "structur": [17, 29, 33], "run_model": 17, "start_loop_tim": 17, "num_step": 17, "FOR": 17, "end_loop_tim": 17, "elapsed_loop_tim": 17, "spent": [17, 18], "largli": 17, "proce": [17, 23, 32], "inclus": 17, "lag": 17, "behind": 17, "run_model_step": 17, "subject": 18, "peculiar": 18, "detial": 18, "cu121": 18, "t2": [18, 34], "200": 18, "nightli": [18, 21, 29, 33], "rx": 18, "conclud": 18, "diagnos": 18, "extrem": [18, 25], "slip": 18, "analyz": [18, 22], "summari": 18, "frequent": 18, "21": 18, "11": [18, 23, 32], "transferfromdevicetim": 18, "23": [18, 36], "12": [18, 27, 29], "hash": 18, "c74c3b91b855b2b123f833b0d5f86943": 18, "107": 18, "frame": 18, "dk3": 18, "1055": 18, "44": 18, "__next__": 18, "train_loop_fn": 18, "48": [18, 26], "start_train": 18, "73": 18, "548000": 18, "gb": 18, "922460": 18, "alias": [18, 24], "547871": 18, "124478": 18, "028210": 18, "cal": 18, "steptrac": 18, "tri": [18, 20], "mark_step": 18, "frequenc": 18, "pair": 18, "met": 18, "destroi": 18, "202": 18, "06m09s401ms746": 18, "001u": 18, "778ms572": 18, "062u": 18, "425201": 18, "001ms32": 18, "778u": 18, "001ms61": 18, "283u": 18, "001ms79": 18, "236u": 18, "001ms110": 18, "973u": 18, "001ms228": 18, "773u": 18, "001ms339": 18, "183u": 18, "001ms434": 18, "305u": 18, "002ms921": 18, "063u": 18, "21s102ms853": 18, "173u": 18, "cachedsynctensor": 18, "395": [18, 26], "area": 18, "rout": 18, "qualifi": 18, "33": [18, 26, 27], "_local_scalar_dens": 18, "epoch": [18, 20, 29], "clear_al": 18, "xla_dynamo_debug": 18, "bottleneck": [18, 19, 20, 22, 25], "notebook": [18, 36], "train_resnet_benchmark": 18, "bad": 18, "degrad": [18, 20], "speedup": [18, 27], "indirect": 18, "mask": [18, 23, 32], "variat": 18, "pad": [18, 19, 23, 32, 34], "ask": [18, 23, 32], "substitut": 18, "flow": 18, "clip_grad_norm": 18, "problemat": 18, "clip_grad_norm_": 18, "dramat": 18, "total_norm": 18, "zero": [18, 29, 35], "param_norm": 18, "grad": 18, "norm": [18, 36], "norm_typ": 18, "add_": 18, "clip_coef": 18, "max_norm": 18, "1e": [18, 27], "mul_": 18, "data_parallel": 18, "dataset": [18, 26, 29], "small": [18, 19, 22, 23, 26, 27, 32], "stride": 18, "reconstruct": 18, "shallow": 18, "ty": 18, "made": [18, 20, 22, 23, 32], "_get_xla_tensors_text": [18, 23, 32], "_get_xla_tensors_hlo": 18, "prior": [18, 35], "degre": 18, "xla_ir_debug": 18, "henc": [18, 27], "respons": [18, 19, 27, 35], "propag": 18, "xla_save_tensors_fil": 18, "realli": [18, 23, 32], "big": [18, 23, 32, 36], "sheet": 18, "xla_save_tensors_fmt": 18, "graphviz": 18, "xla_flag": 18, "xla_dump_to": 18, "dir_nam": 18, "unoptim": 18, "optimz": 18, "xla_metrics_fil": 18, "xla_save_hlo_fil": 18, "offend": 18, "xla_sync_wait": 18, "xla_use_eager_debug_mod": 18, "bypass": 18, "overal": [18, 22], "optimizaiton": 18, "tf_cpp_log_thread_id": 18, "tf_cpp_vmodul": 18, "vlog": 18, "form": [18, 23, 32], "tf_cpp_min_log_level": 18, "tf_vlog": 18, "xla_dump_hlo_graph": 18, "xla_util": 18, "save1": 18, "xla_graph_executor": 18, "pjrt_computation_cli": 18, "dir": 18, "pytorch_test_with_slow": 18, "test_torch": 18, "test_put_xla_uint8": 18, "torch_test_devic": 18, "pytorch_test_bas": 18, "fed": 19, "pod": [19, 21], "attach": [19, 33], "callback": [19, 20], "xla_tensor_z": 19, "cut": [19, 23, 32], "transferfromdevic": [19, 22], "tell": [19, 23, 32], "properti": [19, 23, 32], "suppos": 19, "tensors_on_devic": 19, "z": [19, 23, 32, 36], "subgraph": [19, 23, 32], "signal": 19, "far": 19, "fusion": [19, 21], "worth": [19, 23, 32], "magic": [19, 23, 32], "treat": [19, 34], "xla_no_special_scalar": 19, "guidelin": 20, "rememb": 20, "txt2img": 20, "prompt": 20, "photograph": 20, "astronaut": 20, "ride": 20, "hors": 20, "modif": [20, 21], "ldm": 20, "ddim": 20, "precision_scop": 20, "addition": [20, 24, 29], "frozenclipembedd": 20, "simplic": [20, 23, 32], "top": 20, "attr": 20, "statement": [20, 23, 32], "bar": 20, "stop": 20, "fall": [20, 30], "difficult": 20, "discuss": 20, "investig": [20, 22, 26, 36], "cover": [20, 33], "huggingfac": 20, "sd": 20, "xl": [20, 22], "cd": [20, 29], "text_to_imag": 20, "inference_tpu_single_devic": 20, "lora": 20, "model_id": 20, "stabilityai": 20, "9": [20, 23, 26, 29, 32, 36], "pipelin": [20, 22], "dpmsolvermultistepschedul": 20, "txt": 20, "invisible_watermark": 20, "safetensor": 20, "agre": 20, "licens": 20, "card": 20, "cli": 20, "_your_copied_token__": 20, "pipe": 20, "hour": 20, "wherea": 20, "likewis": 20, "gpt": 20, "min": 20, "mayb": 20, "notic": [20, 36], "piec": 20, "__call__": 20, "caveat": [20, 22], "unnecessari": [20, 25, 33], "communit": 20, "my_funct": 20, "debug_single_process": 20, "tpu_nam": [20, 21], "hypercomput": 20, "recip": 20, "algebra": 21, "research": [21, 36], "massiv": 21, "inferenc": 21, "frontend": [21, 23, 32], "readabl": 21, "opcod": 21, "seri": 21, "highli": 21, "tailor": 21, "deeper": 21, "dive": 21, "deliv": 21, "tackl": 21, "ambiti": 21, "know": [21, 23, 25, 26, 32], "love": 21, "smooth": 21, "minor": [21, 36], "compel": 21, "price": 21, "ratio": 21, "focus": 21, "theoret": [21, 23, 32], "v5": 21, "v6": 21, "nvidia": [21, 36], "runtime_vers": 21, "project_id": 21, "accelerator_typ": 21, "your_tpu_nam": 21, "subnetwork": 21, "tpusubnet": 21, "pip3": 21, "cp38": 21, "linux_x86_64": 21, "whl": 21, "apt": 21, "libopenbla": 21, "libgl1": 21, "diffus": [21, 22], "advanc": [21, 34], "concept": [21, 33, 34], "thumb": 22, "constantli": 22, "idl": 22, "inference_tpu_": 22, "capture_profil": 22, "gap": 22, "xp": 22, "u": 22, "portion": 22, "busi": 22, "scroll": 22, "occupi": 22, "latter": [22, 29], "largest": 22, "zoom": 22, "timelin": 22, "examin": 22, "did": 22, "pipe_watermark": 22, "closer": 22, "preced": 22, "proceed": [22, 30], "watermark": 22, "cv2": 22, "pywt": 22, "leav": 22, "broken": 22, "rerun": 22, "scale_model_input": 22, "dynamo": [22, 27, 31], "hurt": [23, 32], "hard": [23, 26, 27, 32], "pov": [23, 32], "sai": [23, 32], "assur": [23, 32], "gone": [23, 32], "coverag": [23, 32], "explan": [23, 32], "mainli": [23, 32], "beginn": [23, 32], "propos": [23, 32], "reli": [23, 32], "impract": [23, 32], "assumpt": [23, 32], "ye": [23, 31, 32], "sentenc": [23, 32], "bucket": [23, 32, 35], "kinda": [23, 32], "anti": [23, 32], "matter": [23, 32], "workaround": [23, 32], "okai": [23, 32], "teach": [23, 32], "sort": [23, 32], "obviou": [23, 32], "s64": [23, 32], "inde": [23, 32], "_get_xla_tensor_dimension_s": [23, 32], "commonli": [23, 32], "wrong": [23, 32], "wors": [23, 32], "upper": [23, 32], "nit": [23, 32], "solv": [23, 32], "kept": [23, 32], "accessor": [23, 32], "2d": [23, 30, 32, 34], "implicitli": [23, 32], "doubl": [23, 32, 36], "overload": [23, 32], "IS": [23, 32], "explod": [23, 32], "convers": [23, 32], "cheap": [23, 32], "ve": [23, 32], "hoc": [23, 32], "think": [23, 32], "verison": [23, 32], "bla": [23, 32], "blabla": [23, 32], "uglier": [23, 32], "win": [23, 32], "pars": [23, 32], "torchscript": [23, 32], "somehow": [23, 32], "merg": [23, 32], "lazili": [23, 32, 33, 35], "properli": [23, 32], "thought": [23, 32], "trivial": [23, 32], "effort": [23, 32, 33], "why": [23, 32], "bandwidth": [23, 32], "automag": [23, 32], "gold": [23, 32], "smart": [23, 32], "trick": [23, 32], "tbh": [23, 32], "longer": [23, 32], "unawar": [23, 32], "hope": [23, 32], "smash": [23, 32], "blocker": [23, 32], "ahead": [23, 32], "nnc": [23, 32], "exactli": [23, 25, 32], "brian": [23, 32], "hirsh": [23, 32], "bdhirsh": [23, 32], "question": [23, 32], "Is": [23, 32], "stick": [23, 32], "torch_warn": [23, 32], "yea": [23, 32], "hei": [23, 32], "won": [23, 24, 32], "blaze": [23, 32], "abil": [23, 26, 32], "devirtu": [23, 32], "sound": [23, 32], "great": [23, 32], "truth": [23, 32], "irvalu": [23, 32], "enforc": [23, 32], "discrep": [23, 32], "followup": [23, 32], "1000": [23, 32], "my": [23, 32, 35], "presenc": [23, 32], "get_dimention_s": [23, 32], "didn": [23, 32], "exponenti": [23, 32], "blowup": [23, 32], "fewer": [23, 32], "opportun": [23, 32], "recogn": [23, 27, 32], "feasibl": [23, 32], "annoi": [23, 32], "wasn": [23, 32], "materiz": [23, 32], "combo": [23, 32], "extend": [24, 36], "datatyp": 24, "float16": 24, "bfloat16": [24, 31], "syncfre": 24, "autocast": 24, "es": 24, "elig": 24, "suppli": 24, "addmm": 24, "addmm_": 24, "prefer": 24, "float64": 24, "respect": [24, 34], "unlist": 24, "__matmul__": 24, "addbmm": 24, "addmv": 24, "addr": 24, "baddbmm": 24, "bmm": 24, "conv1d": 24, "conv2d": [24, 29], "conv3d": 24, "conv_transpose1d": 24, "conv_transpose2d": 24, "conv_transpose3d": 24, "relu": [24, 26], "prelu": 24, "max_pool2d": 24, "batch_norm": 24, "log_softmax": 24, "binary_cross_entropy_with_logit": 24, "prod": 24, "cdist": 24, "chloeski": 24, "invers": 24, "reflection_pad": 24, "replication_pad": 24, "mse_loss": 24, "cosine_embbeding_loss": 24, "nll_loss": 24, "multilabel_margin_loss": 24, "qr": 24, "svd": 24, "triangular_solv": 24, "linalg_svd": 24, "linalg_inv_ex": 24, "widest": 24, "index_copi": 24, "imagenet": 24, "elimin": 25, "primer": 25, "exce": 25, "math": 25, "pseudo": 25, "Such": 25, "repeatedli": 25, "do_some_math": 25, "simul": 25, "ten": [25, 28], "func": 25, "functional_cal": 25, "mymodul": [25, 33], "pure_forward": 25, "param": 25, "cached_forward": 25, "named_paramet": 25, "named_buff": 25, "unit": [25, 26, 36], "languag": 25, "testbridge_test_onli": 25, "test_trace_transformer_with_spda_attent": 25, "test_assume_pur": 25, "benchmark_iter": 25, "140": 25, "1342": 25, "24": 25, "1658": 25, "pai": 25, "front": 25, "recurs": [25, 29, 30], "minimum": [26, 29, 30, 36], "nccl": 26, "new_rank": 26, "ddp_model": 26, "launcher": 26, "demo_fn": 26, "five": 26, "sy": 26, "tempfil": 26, "cleanup": 26, "destroy_process_group": 26, "toymodel": 26, "net1": 26, "1000000": 26, "net2": 26, "demo_bas": 26, "label": 26, "run_demo": 26, "tot": 26, "statist": 26, "median": 26, "90th": 26, "deviat": 26, "cv": 26, "418": 26, "54": 26, "419": 26, "430": 26, "40": 26, "76": 26, "02": [26, 36], "97": 26, "407": 26, "60": 26, "39": 26, "seem": 26, "17864": 26, "20108": 26, "96": 26, "24351": 26, "74": 26, "5866": 26, "83": [26, 36], "10701": 26, "11770": 26, "00": 26, "14313": 26, "78": 26, "3102": 26, "92": 26, "41": [26, 27], "round": [26, 36], "heavili": 26, "sens": 26, "amort": 26, "logdir": 26, "o": 26, "converg": 26, "caution": 26, "known": 26, "crash": 26, "unmodifi": 27, "hook": 27, "biggest": [27, 29], "torchfx": 27, "technolog": 27, "a_xla": 27, "b_xla": 27, "compiled_cod": 27, "eval_model": 27, "xla_resnet18": 27, "eval": 27, "dynamo_resnet18": 27, "no_grad": 27, "resnet": 27, "18": 27, "bench": 27, "59": 27, "resnext50_32x4d": 27, "91": 27, "alexnet": 27, "28": 27, "mobilenet_v2": 27, "62": 27, "mnasnet1_0": 27, "68": 27, "vgg16": 27, "bert_pytorch": 27, "squeezenet1_1": 27, "timm_vision_transform": 27, "52": 27, "geomean": 27, "04": 27, "train_model": 27, "crossentropyloss": 27, "pred": 27, "train_model_main": 27, "dynamo_train_model": 27, "xla_optim": 27, "weight_decai": 27, "extract": 27, "07": 27, "43": 27, "81": 27, "87": 27, "fwd": 27, "bwd": 27, "e2": 27, "hide": 27, "larger": [27, 29], "wit": 27, "promis": 27, "expand": 27, "excit": 27, "upcom": [27, 33], "invest": 27, "_higher_order_op": 28, "fori_loop": 28, "cond_fn": 28, "body_fn": 28, "bodi": 28, "iteri": 28, "init_v": 28, "functionaltensor": 28, "lvl": 28, "51": 28, "xlafullyshardeddataparallel": 29, "my_modul": [29, 30], "adam": [29, 30], "0001": [29, 30], "leftov": [29, 30], "arxiv": 29, "1910": 29, "02054": 29, "reshard_after_forward": 29, "test_train_mp_mnist_fsdp_with_ckpt": 29, "test_train_mp_imagenet_fsdp": 29, "interleav": 29, "submodul": 29, "fsdpvitmodel": 29, "checkpoint_modul": [29, 30], "3524": 29, "auto_wrap_polici": [29, 30], "size_based_auto_wrap_polici": 29, "polici": [29, 33], "100m": 29, "transformer_auto_wrap_polici": [29, 30], "transformer_layer_cl": [29, 30], "auto_wrapper_cal": 29, "remateri": 29, "get_shard_metadata": 29, "consolidate_sharded_model_checkpoint": 29, "stitch": 29, "ckpt": 29, "shard_metadata": 29, "ckpt_path": 29, "pth": 29, "consolidate_sharded_ckpt": 29, "ckpt_prefix": 29, "your_sharded_checkpoint_fil": 29, "ckpt_suffix": 29, "_rank": 29, "inspir": 29, "fairscal": 29, "fullyshardeddataparallel": 29, "readthedoc": 29, "resort": 29, "train_resnet_fsdp_auto_wrap": 29, "newer": [29, 36], "98": 29, "drop_last": 29, "use_nested_fsdp": 29, "use_gradient_checkpoint": 29, "final_ckpt": 29, "75": 29, "download": 29, "1k": 29, "datadir": 29, "test_set_batch_s": 29, "eval_interv": 29, "num_warmup_epoch": 29, "lr_scheduler_divide_every_n_epoch": 29, "lr_scheduler_divisor": 29, "residu": 29, "algorithm": [29, 30, 36], "ronghanghu": 29, "vit_10b_fsdp_exampl": 29, "vit": 29, "review": 30, "spmd_fully_sharded_data_parallel": 30, "spmdfullyshardeddataparallel": 30, "fsdpv2": 30, "autowrap": 30, "decoderlay": 30, "functool": 30, "decoder_only_model": 30, "shard_output": 30, "0th": 30, "children": 30, "blockwis": 31, "int4": 31, "analog": 31, "classifi": 31, "choos": [31, 35], "docstr": 31, "xla_quantized_matmul": 31, "n_input_featur": 31, "n_output_featur": 31, "w_int": 31, "127": 31, "int8": 31, "scaler": 31, "matmul_output": 31, "quantized_matmul": 31, "x_xla": 31, "w_int_xla": 31, "scaler_xla": 31, "matmul_output_xla": 31, "w": 31, "f_dynamo": 31, "dynamo_out_xla": 31, "myqlinearforxlabackend": 31, "load_weight": 31, "processed_w": 31, "processed_scal": 31, "stuff": 31, "orig_model": 31, "mymodel": 31, "q_weight": 31, "q_weights_for_xla": 31, "process_for_xla": 31, "q_linear": 31, "xlaquantizedlinear": 31, "in_featur": 31, "out_featur": 31, "load_quantized_weight": 31, "sym": 31, "asym": 31, "w8a16": 31, "w8a8": 31, "w4a8": 31, "input_shard": 33, "4d": 33, "shardingspec": 33, "input_mesh": 33, "s2": 33, "s3": 33, "s4": 33, "_after": 33, "_the": 33, "forth": 33, "techniqu": 33, "physic": [33, 34, 36], "decis": 33, "nice": 33, "arrang": [33, 34], "center": 33, "multislic": 33, "denot": 33, "hardcod": 33, "rfc": 33, "delai": 33, "subclass": 33, "__torch_dispatch__": 33, "global_tensor": 33, "strictli": 33, "local_shard": 33, "xlashard": 33, "ongo": 33, "distributedtensor": 33, "proof": 33, "distribute_tensor": 33, "init_device_mesh": 33, "big_tensor": 33, "100000": 33, "88": 33, "my_dtensor": 33, "stai": 33, "dynamo_mark_shard": 33, "placement": 33, "visualize_tensor_shard": 33, "visualize_shard": 33, "rich": 33, "2x2": 33, "generated_t": 33, "use_color": 33, "style": [33, 34], "tile": 33, "partial_repl": 33, "envvar": 33, "xla_auto_spmd": 33, "distribute_modul": 33, "auto_polici": 33, "device_mesh": 33, "sharded_model": 33, "behvaior": 33, "xla_auto_use_group_shard": 33, "reshard": 33, "xla_auto_spmd_mesh": 33, "unset": 33, "matric": [34, 36], "book": 34, "hint": 34, "strategi": 34, "dimension": 34, "mpi": 34, "necessarili": 34, "3d": 34, "1d": 34, "interconnect": 34, "core_on_chip": 34, "num_cor": 34, "coord": 34, "attribut": 34, "slice_index": 34, "coordin": 34, "divis": 34, "dedic": 35, "planner": 35, "spmdsaveplann": 35, "spmdloadplann": 35, "dist_cp": 35, "distributed_checkpoint": 35, "xc": 35, "storage_writ": 35, "filesystemwrit": 35, "checkpoint_dir": 35, "storage_read": 35, "filesystemread": 35, "all_step": 35, "save_async": 35, "preemption": 35, "detect": 35, "provis": 35, "queuedresourc": 35, "autocheckpoint": 35, "chkpt_on_preempt": 35, "fsspec": 35, "filesystem": 35, "prime_optim": 35, "chkpt_mgr": 35, "gs": 35, "tracked_step": 35, "best_step": 35, "prime": 35, "enumer": [35, 36], "unprim": 35, "destruct": 35, "yaoshiang": 36, "ho": 36, "2025": 36, "05": 36, "silicon": 36, "inexpens": 36, "tradeoff": 36, "v100": 36, "tensorcor": 36, "numer": 36, "tf32": 36, "mantissa": 36, "intuit": 36, "imagin": 36, "digit": 36, "decim": 36, "111": 36, "222": 36, "84": 36, "021642": 36, "twice": 36, "72": 36, "011": 36, "022": 36, "compris": 36, "fourth": 36, "ignor": 36, "000242": 36, "littl": 36, "rel": 36, "2002": 36, "1012": 36, "0214": 36, "tripl": 36, "idea": 36, "medium": 36, "nine": 36, "hh": 36, "hm": 36, "mh": 36, "hl": 36, "lh": 36, "lm": 36, "room": 36, "varianc": 36, "valid": 36, "set_printopt": 36, "sci_mod": 36, "linewidth": 36, "240": 36, "epsilon": 36, "ep": 36, "finfo": 36, "0078125": 36, "00000000000000000000": 36, "00781250000000000000": 36, "vice": 36, "versa": 36, "encourag": 36, "rather": 36, "struct": 36, "binary_fraction_to_fp32": 36, "bstr": 36, "0b1": 36, "invalid": 36, "fraction_bit": 36, "fp32_to_binary_fract": 36, "fp32_float": 36, "x_byte": 36, "endian": 36, "ieee": 36, "754": 36, "as_int": 36, "unpack": 36, "uint32": 36, "sign": 36, "31": 36, "expon": 36, "0xff": 36, "0x7fffff": 36, "0b": 36, "08b": 36, "023b": 36, "get_rand_matrix": 36, "diagon": 36, "1024": 36, "999": 36, "ey": 36, "rand_": 36, "bf16_ep": 36, "one_plus_half_ep": 36, "00390625": 36, "8th": 36, "lost": 36, "reconfirm": 36, "ones_bf16": 36, "01111111": 36, "00000001000000000000000": 36, "00000000000000000000000": 36, "wise": 36, "z_ref": 36, "00000010000000010000000": 36, "0078277587890625": 36, "saw": 36, "01110000101000111101100": 36, "440000057220459": 36, "01110000101000111101101": 36, "4400001764297485": 36}, "objects": {"": [[13, 0, 0, "-", "torch_xla"]], "torch_xla": [[13, 0, 0, "-", "backends"], [13, 1, 1, "", "compile"], [13, 1, 1, "", "device"], [13, 1, 1, "", "device_count"], [13, 1, 1, "", "devices"], [13, 0, 0, "-", "experimental"], [13, 1, 1, "", "manual_seed"], [13, 0, 0, "-", "runtime"], [13, 1, 1, "", "sync"]], "torch_xla.backends": [[13, 1, 1, "", "get_mat_mul_precision"], [13, 1, 1, "", "set_mat_mul_precision"]], "torch_xla.core": [[13, 0, 0, "-", "xla_model"]], "torch_xla.core.xla_model": [[13, 1, 1, "", "add_step_closure"], [13, 1, 1, "", "all_gather"], [13, 1, 1, "", "all_reduce"], [13, 1, 1, "", "all_to_all"], [13, 1, 1, "", "get_memory_info"], [13, 1, 1, "", "get_rng_state"], [13, 1, 1, "", "get_stablehlo"], [13, 1, 1, "", "get_stablehlo_bytecode"], [13, 1, 1, "", "is_master_ordinal"], [13, 1, 1, "", "mesh_reduce"], [13, 1, 1, "", "optimizer_step"], [13, 1, 1, "", "rendezvous"], [13, 1, 1, "", "save"], [13, 1, 1, "", "set_rng_state"], [13, 1, 1, "", "wait_device_ops"], [13, 1, 1, "", "xla_device"], [13, 1, 1, "", "xla_device_hw"]], "torch_xla.debug": [[13, 0, 0, "-", "metrics"]], "torch_xla.debug.metrics": [[13, 1, 1, "", "counter_names"], [13, 1, 1, "", "counter_value"], [13, 1, 1, "", "metric_data"], [13, 1, 1, "", "metric_names"], [13, 1, 1, "", "metrics_report"], [13, 1, 1, "", "short_metrics_report"]], "torch_xla.distributed": [[13, 0, 0, "-", "parallel_loader"], [13, 0, 0, "-", "spmd"], [13, 0, 0, "-", "xla_multiprocessing"]], "torch_xla.distributed.parallel_loader": [[13, 2, 1, "", "MpDeviceLoader"]], "torch_xla.distributed.spmd": [[13, 2, 1, "", "HybridMesh"], [13, 2, 1, "", "Mesh"], [13, 1, 1, "", "clear_sharding"], [13, 1, 1, "", "get_1d_mesh"], [13, 1, 1, "", "get_global_mesh"], [13, 1, 1, "", "mark_sharding"], [13, 1, 1, "", "set_global_mesh"]], "torch_xla.distributed.xla_multiprocessing": [[13, 1, 1, "", "spawn"]], "torch_xla.experimental": [[13, 1, 1, "", "eager_mode"]], "torch_xla.runtime": [[13, 1, 1, "", "addressable_device_count"], [13, 1, 1, "", "device_type"], [13, 1, 1, "", "get_master_ip"], [13, 1, 1, "", "global_device_count"], [13, 1, 1, "", "global_ordinal"], [13, 1, 1, "", "global_runtime_device_count"], [13, 1, 1, "", "initialize_cache"], [13, 1, 1, "", "is_spmd"], [13, 1, 1, "", "local_device_count"], [13, 1, 1, "", "local_ordinal"], [13, 1, 1, "", "local_process_count"], [13, 1, 1, "", "use_spmd"], [13, 1, 1, "", "world_size"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"]}, "titleterms": {"learn": [0, 11], "about": 0, "tpu": [0, 3, 11, 12, 16, 20, 21, 24, 29, 33, 36], "build": [1, 4], "bazel": 1, "depend": [1, 7], "how": [1, 15, 25, 26, 31, 34], "xla": [1, 2, 3, 6, 7, 11, 13, 15, 16, 17, 18, 19, 20, 21, 24, 29, 31, 34, 36], "librari": 1, "torch": [1, 9, 10, 12, 15, 33], "plugin": [1, 6], "remot": 1, "cach": [1, 8, 16, 19], "run": [1, 2, 16, 18, 20, 33], "test": [1, 2, 5, 18, 28], "code": [1, 3, 20, 31], "coverag": 1, "languag": 1, "server": 1, "pytorch": [1, 2, 3, 4, 6, 7, 9, 11, 13, 15, 16, 17, 18, 19, 20, 21, 29, 34, 36], "codegen": 2, "migrat": 2, "guid": [2, 5, 34], "befor": [2, 5], "you": [2, 4, 5, 8, 23, 32], "start": [2, 5, 11, 23, 32], "file": [2, 4, 5], "structur": [2, 5], "old": 2, "op": [2, 5, 10, 31], "lower": [2, 5, 10, 36], "step": [2, 3, 21], "1": [2, 20, 23, 32], "identifi": 2, "2": [2, 20, 23, 32], "inspect": 2, "gener": [2, 9], "lazyir": 2, "h": 2, "3": [2, 23, 32], "implement": [2, 6, 20], "miss": 2, "ir": 2, "function": [2, 25], "torch_xla": [2, 13, 15, 17, 23], "csrc": 2, "ops_xla_shape_fn": 2, "cpp": 2, "4": 2, "ops_lower_fn": 2, "5": 2, "cleanup": 2, "verifi": [2, 4], "result": 2, "sampl": 2, "pr": 2, "configur": [3, 4], "A": [3, 4, 18], "develop": 3, "environ": [3, 18], "visual": 3, "studio": 3, "creat": [3, 16], "connect": 3, "your": [3, 4, 7], "set": 3, "up": [3, 25], "workspac": 3, "next": [3, 21], "c": [4, 6], "debug": [4, 13, 16, 18, 33], "why": [4, 21], "would": 4, "need": 4, "thi": [4, 8], "instal": [4, 29], "gdb": 4, "The": [4, 18], "gnu": 4, "project": 4, "debugg": 4, "symbol": 4, "built": [4, 7], "vscode": 4, "lldb": 4, "realist": 4, "command": 4, "futur": 4, "work": [4, 15], "understand": [5, 18], "oper": [5, 9, 18, 23, 24, 31, 32], "unit": [5, 18], "tip": 5, "custom": [6, 7], "hardwar": [6, 21, 36], "pjrt": [6, 12], "api": [6, 10, 11, 13, 15], "packag": 6, "kernel": 7, "via": 7, "palla": 7, "adopt": 7, "abov": 7, "compat": [7, 8], "us": [7, 8, 9, 21, 23, 25, 26, 30, 31, 32, 34], "flashattent": 7, "exampl": [7, 8, 20, 24, 28, 29], "usag": [7, 28], "integr": [7, 27, 33], "pagedattent": 7, "write": 7, "own": 7, "optim": [8, 28, 33, 35], "repeat": 8, "layer": 8, "scan": 8, "scan_lay": 8, "when": [8, 23, 32], "should": 8, "limit": [8, 25], "aotautograd": 8, "requir": 8, "compil": [8, 15, 16, 18, 19, 33], "time": [8, 16, 17], "experi": 8, "refer": [8, 11, 20], "export": 9, "stablehlo": 9, "extract_jax": 9, "inlin": 9, "some": [9, 23, 32], "weight": 9, "preserv": 9, "high": 9, "level": 9, "composit": 9, "support": [10, 24, 31], "distribut": [10, 11, 12, 13, 26, 35], "collect": 10, "stack": 10, "non": 10, "dynamo": [10, 18], "case": [10, 17, 23, 28, 32, 36], "descript": 10, "document": 11, "get": [11, 18, 36], "tutori": 11, "basic": [11, 18], "train": [11, 27, 29], "advanc": [11, 19, 33], "techniqu": 11, "troubleshoot": [11, 18, 32], "contribut": 11, "runtim": [12, 13], "tl": 12, "dr": 12, "benefit": 12, "quickstart": 12, "cpu": [12, 16], "pod": [12, 16, 20, 29, 33], "docker": 12, "differ": 12, "from": [12, 16, 23, 32], "xrt": 12, "multithread": 12, "v2": 12, "v3": [12, 29], "chang": 12, "xm": 12, "rendezv": 12, "perform": [12, 15, 17, 18, 22], "new": 12, "backend": 13, "xla_model": 13, "spmd": [13, 30, 33, 34], "experiment": 13, "dynam": [14, 23, 32], "shape": [14, 23, 32], "bound": [14, 23, 32], "s": [15, 23, 32], "interact": 15, "eager": 15, "mode": [15, 34], "overview": [15, 21], "challeng": 15, "lazytensor": 15, "vs": [15, 17], "benchmark": [15, 18, 25, 26], "devic": [16, 20, 33, 34], "an": 16, "tensor": [16, 18, 23, 32], "ar": 16, "model": [16, 31], "singl": [16, 20], "multipl": [16, 20], "multi": 16, "process": [16, 29, 35], "deep": 16, "dive": 16, "lazi": 16, "memori": [16, 28], "layout": 16, "move": 16, "save": 16, "load": [16, 19, 33], "unexpect": 16, "materi": 16, "dure": 16, "aot": 16, "ahead": 16, "trace": [16, 17, 25], "flag": 16, "recommend": 16, "further": [16, 34], "read": [16, 34], "execut": [17, 18, 19], "illustr": 17, "common": [17, 18], "pitfal": 17, "measur": 17, "onli": 17, "end": 17, "trigger": 17, "ensur": 17, "complet": 17, "studi": 17, "correctli": 17, "profil": [17, 18, 22], "loop": [17, 28], "sync": 17, "saniti": 18, "check": 18, "version": 18, "simpl": [18, 28], "calcul": 18, "resnet": [18, 29], "With": 18, "fake": [18, 26], "data": [18, 19, 26, 29, 30, 33], "tool": [18, 33], "auto": [18, 33], "metric": 18, "analysi": [18, 22], "report": 18, "clear": 18, "known": 18, "caveat": 18, "quirk": 18, "more": 18, "variabl": 18, "combin": 18, "reproduc": 18, "ci": 18, "cd": 18, "failur": 18, "topic": [19, 33], "synchron": 19, "block": 19, "barrier": 19, "graph": 19, "convert": 20, "stabl": 20, "diffus": 20, "infer": [20, 27], "lightn": 20, "hf": 20, "target": 21, "setup": 21, "sourc": 23, "recompil": [23, 32], "let": [23, 32], "first": [23, 32], "fact": [23, 32], "constraint": [23, 32], "input": [23, 32], "dataset": [23, 32], "output": [23, 30, 32], "can": [23, 32], "fix": [23, 32], "without": [23, 32], "queri": [23, 32], "its": [23, 32], "real": [23, 26, 32], "dimens": [23, 32], "what": [23, 32, 34], "control": [23, 28, 32, 36], "flow": [23, 32], "conclus": [23, 32, 36], "appendix": [23, 32], "automat": 24, "mix": 24, "precis": [24, 36], "amp": 24, "best": 24, "practic": 24, "speed": 25, "assume_pur": 25, "background": [25, 26], "motiv": [25, 26], "nn": 25, "modul": [25, 31], "parallel": [26, 29, 30], "ddp": 26, "distributeddataparallel": 26, "resnet50": 26, "mnist": [26, 29], "disclaim": 26, "torchdynamo": 27, "featur": 27, "gap": 27, "take": 27, "awai": 27, "util": 28, "while_loop": 28, "group": [28, 35], "pure": 28, "python": 28, "while": 28, "fulli": [29, 30], "shard": [29, 30, 33, 34], "fsdp": [29, 30], "One": 29, "per": 29, "acceler": 29, "script": 29, "imagenet": 29, "clone": 29, "repo": 29, "8": 29, "50": 29, "10": 29, "billion": 29, "paramet": 29, "gradient": 30, "checkpoint": [30, 35], "quantiz": 31, "call": 31, "swap": 31, "matrix": 31, "multipli": 31, "awar": 33, "host": 33, "virtual": 33, "hybrid": 33, "mesh": [33, 34], "xlashardedtensor": 33, "dtensor": 33, "activ": 33, "user": 34, "partit": 34, "spec": 34, "which": 34, "hold": 34, "checkpointmanag": 35, "restor": 35, "state": 35, "mxu": 36, "float": 36, "point": 36, "introduct": 36, "higher": 36, "math": 36, "prepar": 36, "readi": 36, "look": 36, "directli": 36, "bit": 36, "examin": 36, "number": 36, "fp32": 36, "bfloat16": 36, "edg": 36}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})